
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="paper_reproduction.html">
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>API Reference - COBRA-k</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="assets/external/unpkg.com/iframe-worker/shim.js"></script>
      
    
    
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="javascript/katex/katex.min.css">
    
      <link rel="stylesheet" href="css-extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cobra-k-api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="COBRA-k" class="md-header__button md-logo" aria-label="COBRA-k" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            COBRA-k
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="COBRA-k" class="md-nav__button md-logo" aria-label="COBRA-k" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    COBRA-k
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Start
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="installation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="model_from_scratch.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Create model from scratch
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="model_io.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. Load/Save models
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="lps.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Linear Programs & Pretty-Print
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="milps.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. Mixed-Integer Linear Programs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="nlps.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6. Nonlinear COBRA-k Programs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="evolutionary.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7. Evolutionary Optimization
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="construct_own.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    8. Construct Own Optimizations
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="add_data.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    9. Automatic data collection
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="parameter_corrections.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10. Parameter corrections
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="utilities.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    11. More utilities
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="paper_reproduction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    12. Paper result reproduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="api.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cobrak" class="md-nav__link">
    <span class="md-ellipsis">
      cobrak
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.exit_signal_handler" class="md-nav__link">
    <span class="md-ellipsis">
      exit_signal_handler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.set_logging_handler" class="md-nav__link">
    <span class="md-ellipsis">
      set_logging_handler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.set_logging_level" class="md-nav__link">
    <span class="md-ellipsis">
      set_logging_level
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.setup_rich_tracebacks" class="md-nav__link">
    <span class="md-ellipsis">
      setup_rich_tracebacks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.bigg_metabolites_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      bigg_metabolites_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bigg_metabolites_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.bigg_metabolites_functionality.bigg_parse_metabolites_file" class="md-nav__link">
    <span class="md-ellipsis">
      bigg_parse_metabolites_file
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bigg_parse_metabolites_file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.bigg_metabolites_functionality.bigg_parse_metabolites_file--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.bigg_metabolites_functionality.bigg_parse_metabolites_file--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.brenda_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      brenda_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="brenda_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.brenda_functionality.brenda_select_enzyme_kinetic_data_for_model" class="md-nav__link">
    <span class="md-ellipsis">
      brenda_select_enzyme_kinetic_data_for_model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.cobrapy_model_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      cobrapy_model_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cobrapy_model_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.cobrapy_model_functionality.create_irreversible_cobrapy_model_from_stoichiometries" class="md-nav__link">
    <span class="md-ellipsis">
      create_irreversible_cobrapy_model_from_stoichiometries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.cobrapy_model_functionality.get_fullsplit_cobra_model" class="md-nav__link">
    <span class="md-ellipsis">
      get_fullsplit_cobra_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.cobrapy_model_functionality.get_fullsplit_cobra_model_from_sbml" class="md-nav__link">
    <span class="md-ellipsis">
      get_fullsplit_cobra_model_from_sbml
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.constants" class="md-nav__link">
    <span class="md-ellipsis">
      constants
    </span>
  </a>
  
    <nav class="md-nav" aria-label="constants">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ALL_OK_KEY" class="md-nav__link">
    <span class="md-ellipsis">
      ALL_OK_KEY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ALPHA_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ALPHA_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.BIG_M" class="md-nav__link">
    <span class="md-ellipsis">
      BIG_M
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.DF_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      DF_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.DG0_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      DG0_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.EC_INNER_TO_OUTER_COMPARTMENTS" class="md-nav__link">
    <span class="md-ellipsis">
      EC_INNER_TO_OUTER_COMPARTMENTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.EC_IONIC_STRENGTHS" class="md-nav__link">
    <span class="md-ellipsis">
      EC_IONIC_STRENGTHS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.EC_PHS" class="md-nav__link">
    <span class="md-ellipsis">
      EC_PHS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.EC_PMGS" class="md-nav__link">
    <span class="md-ellipsis">
      EC_PMGS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.EC_POTENTIAL_DIFFERENCES" class="md-nav__link">
    <span class="md-ellipsis">
      EC_POTENTIAL_DIFFERENCES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ENZYME_VAR_INFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ENZYME_VAR_INFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ENZYME_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ENZYME_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ERROR_BOUND_LOWER_CHANGE_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR_BOUND_LOWER_CHANGE_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ERROR_BOUND_UPPER_CHANGE_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR_BOUND_UPPER_CHANGE_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ERROR_CONSTRAINT_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR_CONSTRAINT_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ERROR_SUM_VAR_ID" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR_SUM_VAR_ID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ERROR_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.FLUX_SUM_VAR_ID" class="md-nav__link">
    <span class="md-ellipsis">
      FLUX_SUM_VAR_ID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.GAMMA_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      GAMMA_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.IOTA_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      IOTA_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.KAPPA_PRODUCTS_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      KAPPA_PRODUCTS_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.KAPPA_SUBSTRATES_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      KAPPA_SUBSTRATES_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.KAPPA_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      KAPPA_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.LNCONC_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      LNCONC_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.MDF_VAR_ID" class="md-nav__link">
    <span class="md-ellipsis">
      MDF_VAR_ID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.OBJECTIVE_CONSTRAINT_NAME" class="md-nav__link">
    <span class="md-ellipsis">
      OBJECTIVE_CONSTRAINT_NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.OBJECTIVE_VAR_NAME" class="md-nav__link">
    <span class="md-ellipsis">
      OBJECTIVE_VAR_NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.PROT_POOL_MET_NAME" class="md-nav__link">
    <span class="md-ellipsis">
      PROT_POOL_MET_NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.PROT_POOL_REAC_NAME" class="md-nav__link">
    <span class="md-ellipsis">
      PROT_POOL_REAC_NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.QUASI_INF" class="md-nav__link">
    <span class="md-ellipsis">
      QUASI_INF
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.REAC_ENZ_SEPARATOR" class="md-nav__link">
    <span class="md-ellipsis">
      REAC_ENZ_SEPARATOR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.REAC_FWD_SUFFIX" class="md-nav__link">
    <span class="md-ellipsis">
      REAC_FWD_SUFFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.REAC_REV_SUFFIX" class="md-nav__link">
    <span class="md-ellipsis">
      REAC_REV_SUFFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.SOLVER_STATUS_KEY" class="md-nav__link">
    <span class="md-ellipsis">
      SOLVER_STATUS_KEY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.STANDARD_MIN_MDF" class="md-nav__link">
    <span class="md-ellipsis">
      STANDARD_MIN_MDF
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.STANDARD_R" class="md-nav__link">
    <span class="md-ellipsis">
      STANDARD_R
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.STANDARD_T" class="md-nav__link">
    <span class="md-ellipsis">
      STANDARD_T
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.TERMINATION_CONDITION_KEY" class="md-nav__link">
    <span class="md-ellipsis">
      TERMINATION_CONDITION_KEY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.USED_IDENTIFIERS_FOR_EQUILIBRATOR" class="md-nav__link">
    <span class="md-ellipsis">
      USED_IDENTIFIERS_FOR_EQUILIBRATOR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ZB_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ZB_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.Z_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      Z_VAR_PREFIX
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.dataclasses" class="md-nav__link">
    <span class="md-ellipsis">
      dataclasses
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dataclasses">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ErrorScenario" class="md-nav__link">
    <span class="md-ellipsis">
      ErrorScenario
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.OptResult" class="md-nav__link">
    <span class="md-ellipsis">
      OptResult
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.VarResult" class="md-nav__link">
    <span class="md-ellipsis">
      VarResult
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig" class="md-nav__link">
    <span class="md-ellipsis">
      CorrectionConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CorrectionConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_dG0_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_dG0_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_enzyme_conc_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_enzyme_conc_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_error_sum_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_error_sum_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_flux_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_flux_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_ka_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_ka_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_kcat_times_e_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_kcat_times_e_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_ki_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_ki_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_km_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_km_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_met_logconc_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_met_logconc_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.dG0_error_cutoff" class="md-nav__link">
    <span class="md-ellipsis">
      dG0_error_cutoff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.error_scenario" class="md-nav__link">
    <span class="md-ellipsis">
      error_scenario
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.error_sum_as_qp" class="md-nav__link">
    <span class="md-ellipsis">
      error_sum_as_qp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.extra_weights" class="md-nav__link">
    <span class="md-ellipsis">
      extra_weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.ka_error_cutoff" class="md-nav__link">
    <span class="md-ellipsis">
      ka_error_cutoff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.kcat_times_e_error_cutoff" class="md-nav__link">
    <span class="md-ellipsis">
      kcat_times_e_error_cutoff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.ki_error_cutoff" class="md-nav__link">
    <span class="md-ellipsis">
      ki_error_cutoff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.km_error_cutoff" class="md-nav__link">
    <span class="md-ellipsis">
      km_error_cutoff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.max_abs_dG0_correction" class="md-nav__link">
    <span class="md-ellipsis">
      max_abs_dG0_correction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.max_rel_ka_correction" class="md-nav__link">
    <span class="md-ellipsis">
      max_rel_ka_correction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.max_rel_kcat_times_e_correction" class="md-nav__link">
    <span class="md-ellipsis">
      max_rel_kcat_times_e_correction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.max_rel_ki_correction" class="md-nav__link">
    <span class="md-ellipsis">
      max_rel_ki_correction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.max_rel_km_correction" class="md-nav__link">
    <span class="md-ellipsis">
      max_rel_km_correction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.use_weights" class="md-nav__link">
    <span class="md-ellipsis">
      use_weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.var_lb_ub_application" class="md-nav__link">
    <span class="md-ellipsis">
      var_lb_ub_application
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.weight_percentile" class="md-nav__link">
    <span class="md-ellipsis">
      weight_percentile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Enzyme" class="md-nav__link">
    <span class="md-ellipsis">
      Enzyme
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Enzyme">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Enzyme.annotation" class="md-nav__link">
    <span class="md-ellipsis">
      annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Enzyme.max_conc" class="md-nav__link">
    <span class="md-ellipsis">
      max_conc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Enzyme.min_conc" class="md-nav__link">
    <span class="md-ellipsis">
      min_conc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Enzyme.molecular_weight" class="md-nav__link">
    <span class="md-ellipsis">
      molecular_weight
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Enzyme.name" class="md-nav__link">
    <span class="md-ellipsis">
      name
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData" class="md-nav__link">
    <span class="md-ellipsis">
      EnzymeReactionData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EnzymeReactionData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.hill_coefficient_references" class="md-nav__link">
    <span class="md-ellipsis">
      hill_coefficient_references
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.hill_coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      hill_coefficients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      identifiers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_a_references" class="md-nav__link">
    <span class="md-ellipsis">
      k_a_references
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_as" class="md-nav__link">
    <span class="md-ellipsis">
      k_as
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_cat" class="md-nav__link">
    <span class="md-ellipsis">
      k_cat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_cat_references" class="md-nav__link">
    <span class="md-ellipsis">
      k_cat_references
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_i_references" class="md-nav__link">
    <span class="md-ellipsis">
      k_i_references
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_is" class="md-nav__link">
    <span class="md-ellipsis">
      k_is
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_m_references" class="md-nav__link">
    <span class="md-ellipsis">
      k_m_references
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_ms" class="md-nav__link">
    <span class="md-ellipsis">
      k_ms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.special_stoichiometries" class="md-nav__link">
    <span class="md-ellipsis">
      special_stoichiometries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraLinearConstraint" class="md-nav__link">
    <span class="md-ellipsis">
      ExtraLinearConstraint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExtraLinearConstraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraLinearConstraint.lower_value" class="md-nav__link">
    <span class="md-ellipsis">
      lower_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraLinearConstraint.stoichiometries" class="md-nav__link">
    <span class="md-ellipsis">
      stoichiometries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraLinearConstraint.upper_value" class="md-nav__link">
    <span class="md-ellipsis">
      upper_value
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraLinearWatch" class="md-nav__link">
    <span class="md-ellipsis">
      ExtraLinearWatch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraNonlinearConstraint" class="md-nav__link">
    <span class="md-ellipsis">
      ExtraNonlinearConstraint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExtraNonlinearConstraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraNonlinearConstraint.full_application" class="md-nav__link">
    <span class="md-ellipsis">
      full_application
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraNonlinearConstraint.lower_value" class="md-nav__link">
    <span class="md-ellipsis">
      lower_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraNonlinearConstraint.stoichiometries" class="md-nav__link">
    <span class="md-ellipsis">
      stoichiometries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraNonlinearConstraint.upper_value" class="md-nav__link">
    <span class="md-ellipsis">
      upper_value
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraNonlinearWatch" class="md-nav__link">
    <span class="md-ellipsis">
      ExtraNonlinearWatch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillCoefficients" class="md-nav__link">
    <span class="md-ellipsis">
      HillCoefficients
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HillCoefficients">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillCoefficients.alpha" class="md-nav__link">
    <span class="md-ellipsis">
      alpha
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillCoefficients.iota" class="md-nav__link">
    <span class="md-ellipsis">
      iota
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillCoefficients.kappa" class="md-nav__link">
    <span class="md-ellipsis">
      kappa
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillParameterReferences" class="md-nav__link">
    <span class="md-ellipsis">
      HillParameterReferences
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HillParameterReferences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillParameterReferences.alpha" class="md-nav__link">
    <span class="md-ellipsis">
      alpha
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillParameterReferences.iota" class="md-nav__link">
    <span class="md-ellipsis">
      iota
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillParameterReferences.kappa" class="md-nav__link">
    <span class="md-ellipsis">
      kappa
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Metabolite" class="md-nav__link">
    <span class="md-ellipsis">
      Metabolite
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metabolite">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Metabolite.annotation" class="md-nav__link">
    <span class="md-ellipsis">
      annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Metabolite.charge" class="md-nav__link">
    <span class="md-ellipsis">
      charge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Metabolite.formula" class="md-nav__link">
    <span class="md-ellipsis">
      formula
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Metabolite.log_max_conc" class="md-nav__link">
    <span class="md-ellipsis">
      log_max_conc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Metabolite.log_min_conc" class="md-nav__link">
    <span class="md-ellipsis">
      log_min_conc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Metabolite.name" class="md-nav__link">
    <span class="md-ellipsis">
      name
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model" class="md-nav__link">
    <span class="md-ellipsis">
      Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.R" class="md-nav__link">
    <span class="md-ellipsis">
      R
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.T" class="md-nav__link">
    <span class="md-ellipsis">
      T
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.annotation" class="md-nav__link">
    <span class="md-ellipsis">
      annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.conc_sum_ignore_prefixes" class="md-nav__link">
    <span class="md-ellipsis">
      conc_sum_ignore_prefixes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.conc_sum_include_suffixes" class="md-nav__link">
    <span class="md-ellipsis">
      conc_sum_include_suffixes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.conc_sum_max_rel_error" class="md-nav__link">
    <span class="md-ellipsis">
      conc_sum_max_rel_error
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.conc_sum_min_abs_error" class="md-nav__link">
    <span class="md-ellipsis">
      conc_sum_min_abs_error
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.enzymes" class="md-nav__link">
    <span class="md-ellipsis">
      enzymes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.extra_linear_constraints" class="md-nav__link">
    <span class="md-ellipsis">
      extra_linear_constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.extra_linear_watches" class="md-nav__link">
    <span class="md-ellipsis">
      extra_linear_watches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.extra_nonlinear_constraints" class="md-nav__link">
    <span class="md-ellipsis">
      extra_nonlinear_constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.extra_nonlinear_watches" class="md-nav__link">
    <span class="md-ellipsis">
      extra_nonlinear_watches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.fwd_suffix" class="md-nav__link">
    <span class="md-ellipsis">
      fwd_suffix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.kinetic_ignored_metabolites" class="md-nav__link">
    <span class="md-ellipsis">
      kinetic_ignored_metabolites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.max_conc_sum" class="md-nav__link">
    <span class="md-ellipsis">
      max_conc_sum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.max_prot_pool" class="md-nav__link">
    <span class="md-ellipsis">
      max_prot_pool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.metabolites" class="md-nav__link">
    <span class="md-ellipsis">
      metabolites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.reac_enz_separator" class="md-nav__link">
    <span class="md-ellipsis">
      reac_enz_separator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.reactions" class="md-nav__link">
    <span class="md-ellipsis">
      reactions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.rev_suffix" class="md-nav__link">
    <span class="md-ellipsis">
      rev_suffix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.__enter__" class="md-nav__link">
    <span class="md-ellipsis">
      __enter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.__exit__" class="md-nav__link">
    <span class="md-ellipsis">
      __exit__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ParameterReference" class="md-nav__link">
    <span class="md-ellipsis">
      ParameterReference
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParameterReference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ParameterReference.comment" class="md-nav__link">
    <span class="md-ellipsis">
      comment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ParameterReference.database" class="md-nav__link">
    <span class="md-ellipsis">
      database
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ParameterReference.pubs" class="md-nav__link">
    <span class="md-ellipsis">
      pubs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ParameterReference.species" class="md-nav__link">
    <span class="md-ellipsis">
      species
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ParameterReference.substrate" class="md-nav__link">
    <span class="md-ellipsis">
      substrate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction" class="md-nav__link">
    <span class="md-ellipsis">
      Reaction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reaction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.annotation" class="md-nav__link">
    <span class="md-ellipsis">
      annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.dG0" class="md-nav__link">
    <span class="md-ellipsis">
      dG0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.dG0_uncertainty" class="md-nav__link">
    <span class="md-ellipsis">
      dG0_uncertainty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.enzyme_reaction_data" class="md-nav__link">
    <span class="md-ellipsis">
      enzyme_reaction_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.max_flux" class="md-nav__link">
    <span class="md-ellipsis">
      max_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.min_flux" class="md-nav__link">
    <span class="md-ellipsis">
      min_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.name" class="md-nav__link">
    <span class="md-ellipsis">
      name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.stoichiometries" class="md-nav__link">
    <span class="md-ellipsis">
      stoichiometries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Solver" class="md-nav__link">
    <span class="md-ellipsis">
      Solver
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Solver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Solver.name" class="md-nav__link">
    <span class="md-ellipsis">
      name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Solver.solve_extra_options" class="md-nav__link">
    <span class="md-ellipsis">
      solve_extra_options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Solver.solver_attrs" class="md-nav__link">
    <span class="md-ellipsis">
      solver_attrs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Solver.solver_options" class="md-nav__link">
    <span class="md-ellipsis">
      solver_options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.equilibrator_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      equilibrator_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="equilibrator_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.equilibrator_functionality.equilibrator_get_model_dG0_and_uncertainty_values" class="md-nav__link">
    <span class="md-ellipsis">
      equilibrator_get_model_dG0_and_uncertainty_values
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.evolution" class="md-nav__link">
    <span class="md-ellipsis">
      evolution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="evolution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.evolution.COBRAKProblem" class="md-nav__link">
    <span class="md-ellipsis">
      COBRAKProblem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="COBRAKProblem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.evolution.COBRAKProblem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.evolution.COBRAKProblem.fitness" class="md-nav__link">
    <span class="md-ellipsis">
      fitness
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.evolution.COBRAKProblem.optimize" class="md-nav__link">
    <span class="md-ellipsis">
      optimize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.evolution.perform_nlp_evolutionary_optimization" class="md-nav__link">
    <span class="md-ellipsis">
      perform_nlp_evolutionary_optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.evolution.postprocess" class="md-nav__link">
    <span class="md-ellipsis">
      postprocess
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.example_models" class="md-nav__link">
    <span class="md-ellipsis">
      example_models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="example_models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.example_models.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      __getattr__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.expasy_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      expasy_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="expasy_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.expasy_functionality.get_ec_number_transfers" class="md-nav__link">
    <span class="md-ellipsis">
      get_ec_number_transfers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.genetic" class="md-nav__link">
    <span class="md-ellipsis">
      genetic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="genetic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.genetic.COBRAKGENETIC" class="md-nav__link">
    <span class="md-ellipsis">
      COBRAKGENETIC
    </span>
  </a>
  
    <nav class="md-nav" aria-label="COBRAKGENETIC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.genetic.COBRAKGENETIC.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.genetic.COBRAKGENETIC.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.genetic.COBRAKGENETIC.update_particle" class="md-nav__link">
    <span class="md-ellipsis">
      update_particle
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.io" class="md-nav__link">
    <span class="md-ellipsis">
      io
    </span>
  </a>
  
    <nav class="md-nav" aria-label="io">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.convert_cobrak_model_to_annotated_cobrapy_model" class="md-nav__link">
    <span class="md-ellipsis">
      convert_cobrak_model_to_annotated_cobrapy_model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="convert_cobrak_model_to_annotated_cobrapy_model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.convert_cobrak_model_to_annotated_cobrapy_model--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.convert_cobrak_model_to_annotated_cobrapy_model--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.convert_cobrak_model_to_annotated_cobrapy_model--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.ensure_folder_existence" class="md-nav__link">
    <span class="md-ellipsis">
      ensure_folder_existence
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ensure_folder_existence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.ensure_folder_existence--argument" class="md-nav__link">
    <span class="md-ellipsis">
      Argument
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.ensure_json_existence" class="md-nav__link">
    <span class="md-ellipsis">
      ensure_json_existence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.get_base_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_base_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.get_files" class="md-nav__link">
    <span class="md-ellipsis">
      get_files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.get_files--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.get_folders" class="md-nav__link">
    <span class="md-ellipsis">
      get_folders
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_folders">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.get_folders--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_load" class="md-nav__link">
    <span class="md-ellipsis">
      json_load
    </span>
  </a>
  
    <nav class="md-nav" aria-label="json_load">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_load--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_load--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_load--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_load--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_write" class="md-nav__link">
    <span class="md-ellipsis">
      json_write
    </span>
  </a>
  
    <nav class="md-nav" aria-label="json_write">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_write--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_zip_load" class="md-nav__link">
    <span class="md-ellipsis">
      json_zip_load
    </span>
  </a>
  
    <nav class="md-nav" aria-label="json_zip_load">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_zip_load--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_zip_load--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_zip_write" class="md-nav__link">
    <span class="md-ellipsis">
      json_zip_write
    </span>
  </a>
  
    <nav class="md-nav" aria-label="json_zip_write">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_zip_write--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.load_annotated_cobrapy_model_as_cobrak_model" class="md-nav__link">
    <span class="md-ellipsis">
      load_annotated_cobrapy_model_as_cobrak_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.load_annotated_sbml_model_as_cobrak_model" class="md-nav__link">
    <span class="md-ellipsis">
      load_annotated_sbml_model_as_cobrak_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.load_unannotated_sbml_as_cobrapy_model" class="md-nav__link">
    <span class="md-ellipsis">
      load_unannotated_sbml_as_cobrapy_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.pickle_load" class="md-nav__link">
    <span class="md-ellipsis">
      pickle_load
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pickle_load">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.pickle_load--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.pickle_write" class="md-nav__link">
    <span class="md-ellipsis">
      pickle_write
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pickle_write">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.pickle_write--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.save_cobrak_model_as_annotated_sbml_model" class="md-nav__link">
    <span class="md-ellipsis">
      save_cobrak_model_as_annotated_sbml_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.standardize_folder" class="md-nav__link">
    <span class="md-ellipsis">
      standardize_folder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="standardize_folder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.standardize_folder--argument" class="md-nav__link">
    <span class="md-ellipsis">
      Argument
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.lps" class="md-nav__link">
    <span class="md-ellipsis">
      lps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="lps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.add_flux_sum_var" class="md-nav__link">
    <span class="md-ellipsis">
      add_flux_sum_var
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.add_loop_constraints_to_lp" class="md-nav__link">
    <span class="md-ellipsis">
      add_loop_constraints_to_lp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.get_lp_from_cobrak_model" class="md-nav__link">
    <span class="md-ellipsis">
      get_lp_from_cobrak_model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_lp_from_cobrak_model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.get_lp_from_cobrak_model--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.get_lp_from_cobrak_model--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.perform_lp_min_active_reactions_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      perform_lp_min_active_reactions_analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="perform_lp_min_active_reactions_analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.perform_lp_min_active_reactions_analysis--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.perform_lp_min_active_reactions_analysis--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.perform_lp_optimization" class="md-nav__link">
    <span class="md-ellipsis">
      perform_lp_optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.perform_lp_thermodynamic_bottleneck_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      perform_lp_thermodynamic_bottleneck_analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.perform_lp_variability_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      perform_lp_variability_analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.model_instantiation" class="md-nav__link">
    <span class="md-ellipsis">
      model_instantiation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="model_instantiation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.model_instantiation.delete_enzymatically_suboptimal_reactions_in_cobrak_model" class="md-nav__link">
    <span class="md-ellipsis">
      delete_enzymatically_suboptimal_reactions_in_cobrak_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.model_instantiation.delete_enzymatically_suboptimal_reactions_in_fullsplit_cobrapy_model" class="md-nav__link">
    <span class="md-ellipsis">
      delete_enzymatically_suboptimal_reactions_in_fullsplit_cobrapy_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.model_instantiation.get_cobrak_model_from_sbml_and_thermokinetic_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_cobrak_model_from_sbml_and_thermokinetic_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.model_instantiation.get_cobrak_model_with_kinetic_data_from_sbml_model_alone" class="md-nav__link">
    <span class="md-ellipsis">
      get_cobrak_model_with_kinetic_data_from_sbml_model_alone
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.ncbi_taxonomy_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      ncbi_taxonomy_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncbi_taxonomy_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.ncbi_taxonomy_functionality.get_taxonomy_dict_from_nbci_taxonomy" class="md-nav__link">
    <span class="md-ellipsis">
      get_taxonomy_dict_from_nbci_taxonomy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.ncbi_taxonomy_functionality.get_taxonomy_scores" class="md-nav__link">
    <span class="md-ellipsis">
      get_taxonomy_scores
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_taxonomy_scores">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.ncbi_taxonomy_functionality.get_taxonomy_scores--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.ncbi_taxonomy_functionality.most_taxonomic_similar" class="md-nav__link">
    <span class="md-ellipsis">
      most_taxonomic_similar
    </span>
  </a>
  
    <nav class="md-nav" aria-label="most_taxonomic_similar">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.ncbi_taxonomy_functionality.most_taxonomic_similar--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.ncbi_taxonomy_functionality.parse_ncbi_taxonomy" class="md-nav__link">
    <span class="md-ellipsis">
      parse_ncbi_taxonomy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.nlps" class="md-nav__link">
    <span class="md-ellipsis">
      nlps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="nlps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.add_loop_constraints_to_nlp" class="md-nav__link">
    <span class="md-ellipsis">
      add_loop_constraints_to_nlp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.get_nlp_from_cobrak_model" class="md-nav__link">
    <span class="md-ellipsis">
      get_nlp_from_cobrak_model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_nlp_from_cobrak_model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.get_nlp_from_cobrak_model--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.get_nlp_from_cobrak_model--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_optimization" class="md-nav__link">
    <span class="md-ellipsis">
      perform_nlp_irreversible_optimization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="perform_nlp_irreversible_optimization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_optimization--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_optimization--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_optimization_with_active_reacs_only" class="md-nav__link">
    <span class="md-ellipsis">
      perform_nlp_irreversible_optimization_with_active_reacs_only
    </span>
  </a>
  
    <nav class="md-nav" aria-label="perform_nlp_irreversible_optimization_with_active_reacs_only">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_optimization_with_active_reacs_only--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_optimization_with_active_reacs_only--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_variability_analysis_with_active_reacs_only" class="md-nav__link">
    <span class="md-ellipsis">
      perform_nlp_irreversible_variability_analysis_with_active_reacs_only
    </span>
  </a>
  
    <nav class="md-nav" aria-label="perform_nlp_irreversible_variability_analysis_with_active_reacs_only">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_variability_analysis_with_active_reacs_only--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_variability_analysis_with_active_reacs_only--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_reversible_optimization" class="md-nav__link">
    <span class="md-ellipsis">
      perform_nlp_reversible_optimization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="perform_nlp_reversible_optimization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_reversible_optimization--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_reversible_optimization--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.plotting" class="md-nav__link">
    <span class="md-ellipsis">
      plotting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plotting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.dual_axis_plot" class="md-nav__link">
    <span class="md-ellipsis">
      dual_axis_plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.plot_combinations" class="md-nav__link">
    <span class="md-ellipsis">
      plot_combinations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.plot_objvalue_evolution" class="md-nav__link">
    <span class="md-ellipsis">
      plot_objvalue_evolution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.plot_variabilities" class="md-nav__link">
    <span class="md-ellipsis">
      plot_variabilities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_variabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.plot_variabilities--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.plot_variabilities--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.plot_variabilities--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.scatterplot_with_labels" class="md-nav__link">
    <span class="md-ellipsis">
      scatterplot_with_labels
    </span>
  </a>
  
    <nav class="md-nav" aria-label="scatterplot_with_labels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.scatterplot_with_labels--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.scatterplot_with_labels--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.printing" class="md-nav__link">
    <span class="md-ellipsis">
      printing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="printing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.printing.print_dict" class="md-nav__link">
    <span class="md-ellipsis">
      print_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.printing.print_model" class="md-nav__link">
    <span class="md-ellipsis">
      print_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.printing.print_optimization_result" class="md-nav__link">
    <span class="md-ellipsis">
      print_optimization_result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.printing.print_strkey_dict_as_table" class="md-nav__link">
    <span class="md-ellipsis">
      print_strkey_dict_as_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.printing.print_variability_result" class="md-nav__link">
    <span class="md-ellipsis">
      print_variability_result
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      pyomo_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pyomo_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality.ApproximationPoint" class="md-nav__link">
    <span class="md-ellipsis">
      ApproximationPoint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality.add_linear_approximation_to_pyomo_model" class="md-nav__link">
    <span class="md-ellipsis">
      add_linear_approximation_to_pyomo_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality.add_objective_to_model" class="md-nav__link">
    <span class="md-ellipsis">
      add_objective_to_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality.get_model_var_names" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_var_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality.get_objective" class="md-nav__link">
    <span class="md-ellipsis">
      get_objective
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality.get_solver" class="md-nav__link">
    <span class="md-ellipsis">
      get_solver
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality.set_target_as_var_and_value" class="md-nav__link">
    <span class="md-ellipsis">
      set_target_as_var_and_value
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      sabio_rk_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sabio_rk_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioDict" class="md-nav__link">
    <span class="md-ellipsis">
      SabioDict
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SabioDict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioDict.hill_entries" class="md-nav__link">
    <span class="md-ellipsis">
      hill_entries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioDict.ka_entries" class="md-nav__link">
    <span class="md-ellipsis">
      ka_entries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioDict.kcat_entries" class="md-nav__link">
    <span class="md-ellipsis">
      kcat_entries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioDict.ki_entries" class="md-nav__link">
    <span class="md-ellipsis">
      ki_entries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioDict.km_entries" class="md-nav__link">
    <span class="md-ellipsis">
      km_entries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry" class="md-nav__link">
    <span class="md-ellipsis">
      SabioEntry
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SabioEntry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.chebi_ids" class="md-nav__link">
    <span class="md-ellipsis">
      chebi_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.entry_id" class="md-nav__link">
    <span class="md-ellipsis">
      entry_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.is_recombinant" class="md-nav__link">
    <span class="md-ellipsis">
      is_recombinant
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.kinetics_mechanism_type" class="md-nav__link">
    <span class="md-ellipsis">
      kinetics_mechanism_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.organism" class="md-nav__link">
    <span class="md-ellipsis">
      organism
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.parameter_associated_species" class="md-nav__link">
    <span class="md-ellipsis">
      parameter_associated_species
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.parameter_unit" class="md-nav__link">
    <span class="md-ellipsis">
      parameter_unit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.parameter_value" class="md-nav__link">
    <span class="md-ellipsis">
      parameter_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.ph" class="md-nav__link">
    <span class="md-ellipsis">
      ph
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.products" class="md-nav__link">
    <span class="md-ellipsis">
      products
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.substrates" class="md-nav__link">
    <span class="md-ellipsis">
      substrates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.temperature" class="md-nav__link">
    <span class="md-ellipsis">
      temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioThread" class="md-nav__link">
    <span class="md-ellipsis">
      SabioThread
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SabioThread">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioThread.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioThread.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.get_full_sabio_dict" class="md-nav__link">
    <span class="md-ellipsis">
      get_full_sabio_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.sabio_select_enzyme_kinetic_data_for_model" class="md-nav__link">
    <span class="md-ellipsis">
      sabio_select_enzyme_kinetic_data_for_model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      spreadsheet_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="spreadsheet_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.ABS_EPSILON" class="md-nav__link">
    <span class="md-ellipsis">
      ABS_EPSILON
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.EMPTY_CELL" class="md-nav__link">
    <span class="md-ellipsis">
      EMPTY_CELL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.FONT_BOLD" class="md-nav__link">
    <span class="md-ellipsis">
      FONT_BOLD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.FONT_BOLD_AND_UNDERLINED" class="md-nav__link">
    <span class="md-ellipsis">
      FONT_BOLD_AND_UNDERLINED
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.FONT_DEFAULT" class="md-nav__link">
    <span class="md-ellipsis">
      FONT_DEFAULT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.WIDTH_DEFAULT" class="md-nav__link">
    <span class="md-ellipsis">
      WIDTH_DEFAULT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset" class="md-nav__link">
    <span class="md-ellipsis">
      OptimizationDataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OptimizationDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.data" class="md-nav__link">
    <span class="md-ellipsis">
      data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_alpha" class="md-nav__link">
    <span class="md-ellipsis">
      with_alpha
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_df" class="md-nav__link">
    <span class="md-ellipsis">
      with_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_error_corrections" class="md-nav__link">
    <span class="md-ellipsis">
      with_error_corrections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_gamma" class="md-nav__link">
    <span class="md-ellipsis">
      with_gamma
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_iota" class="md-nav__link">
    <span class="md-ellipsis">
      with_iota
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_kappa" class="md-nav__link">
    <span class="md-ellipsis">
      with_kappa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_kinetic_differences" class="md-nav__link">
    <span class="md-ellipsis">
      with_kinetic_differences
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_vplus" class="md-nav__link">
    <span class="md-ellipsis">
      with_vplus
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.SpreadsheetCell" class="md-nav__link">
    <span class="md-ellipsis">
      SpreadsheetCell
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SpreadsheetCell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.SpreadsheetCell.bg_color" class="md-nav__link">
    <span class="md-ellipsis">
      bg_color
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.SpreadsheetCell.border" class="md-nav__link">
    <span class="md-ellipsis">
      border
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.SpreadsheetCell.font" class="md-nav__link">
    <span class="md-ellipsis">
      font
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.SpreadsheetCell.value" class="md-nav__link">
    <span class="md-ellipsis">
      value
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.Title" class="md-nav__link">
    <span class="md-ellipsis">
      Title
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Title">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.Title.is_metatitle" class="md-nav__link">
    <span class="md-ellipsis">
      is_metatitle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.Title.text" class="md-nav__link">
    <span class="md-ellipsis">
      text
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.Title.width" class="md-nav__link">
    <span class="md-ellipsis">
      width
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.VariabilityDataset" class="md-nav__link">
    <span class="md-ellipsis">
      VariabilityDataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="VariabilityDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.VariabilityDataset.data" class="md-nav__link">
    <span class="md-ellipsis">
      data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.VariabilityDataset.with_df" class="md-nav__link">
    <span class="md-ellipsis">
      with_df
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.create_cobrak_spreadsheet" class="md-nav__link">
    <span class="md-ellipsis">
      create_cobrak_spreadsheet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.standard_solvers" class="md-nav__link">
    <span class="md-ellipsis">
      standard_solvers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.tellurium_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      tellurium_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="tellurium_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.tellurium_functionality.get_tellurium_string_from_cobrak_model_and_solution" class="md-nav__link">
    <span class="md-ellipsis">
      get_tellurium_string_from_cobrak_model_and_solution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_tellurium_string_from_cobrak_model_and_solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.tellurium_functionality.get_tellurium_string_from_cobrak_model_and_solution--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.tellurium_functionality.get_tellurium_string_from_cobrak_model_and_solution--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.tellurium_functionality.write_kinetic_sbml_model_from_cobrak_model_and_solution" class="md-nav__link">
    <span class="md-ellipsis">
      write_kinetic_sbml_model_from_cobrak_model_and_solution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="write_kinetic_sbml_model_from_cobrak_model_and_solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.tellurium_functionality.write_kinetic_sbml_model_from_cobrak_model_and_solution--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.tellurium_functionality.write_kinetic_sbml_model_from_cobrak_model_and_solution--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.uniprot_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      uniprot_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="uniprot_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.uniprot_functionality.uniprot_get_enzyme_molecular_weights" class="md-nav__link">
    <span class="md-ellipsis">
      uniprot_get_enzyme_molecular_weights
    </span>
  </a>
  
    <nav class="md-nav" aria-label="uniprot_get_enzyme_molecular_weights">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.uniprot_functionality.uniprot_get_enzyme_molecular_weights--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.uniprot_functionality.uniprot_get_enzyme_molecular_weights--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.utilities" class="md-nav__link">
    <span class="md-ellipsis">
      utilities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.add_objective_value_as_extra_linear_constraint" class="md-nav__link">
    <span class="md-ellipsis">
      add_objective_value_as_extra_linear_constraint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.add_statuses_to_optimziation_dict" class="md-nav__link">
    <span class="md-ellipsis">
      add_statuses_to_optimziation_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.apply_error_correction_on_model" class="md-nav__link">
    <span class="md-ellipsis">
      apply_error_correction_on_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.apply_variability_dict" class="md-nav__link">
    <span class="md-ellipsis">
      apply_variability_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.combine_enzyme_reaction_datasets" class="md-nav__link">
    <span class="md-ellipsis">
      combine_enzyme_reaction_datasets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.compare_multiple_results_to_best" class="md-nav__link">
    <span class="md-ellipsis">
      compare_multiple_results_to_best
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.compare_optimization_result_fluxes" class="md-nav__link">
    <span class="md-ellipsis">
      compare_optimization_result_fluxes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.compare_optimization_result_reaction_uses" class="md-nav__link">
    <span class="md-ellipsis">
      compare_optimization_result_reaction_uses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.count_last_equal_elements" class="md-nav__link">
    <span class="md-ellipsis">
      count_last_equal_elements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.create_cnapy_scenario_out_of_optimization_dict" class="md-nav__link">
    <span class="md-ellipsis">
      create_cnapy_scenario_out_of_optimization_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.create_cnapy_scenario_out_of_variability_dict" class="md-nav__link">
    <span class="md-ellipsis">
      create_cnapy_scenario_out_of_variability_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.delete_orphaned_metabolites_and_enzymes" class="md-nav__link">
    <span class="md-ellipsis">
      delete_orphaned_metabolites_and_enzymes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.delete_unused_reactions_in_optimization_dict" class="md-nav__link">
    <span class="md-ellipsis">
      delete_unused_reactions_in_optimization_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.delete_unused_reactions_in_variability_dict" class="md-nav__link">
    <span class="md-ellipsis">
      delete_unused_reactions_in_variability_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_active_reacs_from_optimization_dict" class="md-nav__link">
    <span class="md-ellipsis">
      get_active_reacs_from_optimization_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_base_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_base_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_base_id_optimzation_result" class="md-nav__link">
    <span class="md-ellipsis">
      get_base_id_optimzation_result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_cobrak_enzyme_reactions_string" class="md-nav__link">
    <span class="md-ellipsis">
      get_cobrak_enzyme_reactions_string
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_df_and_efficiency_factors_sorted_lists" class="md-nav__link">
    <span class="md-ellipsis">
      get_df_and_efficiency_factors_sorted_lists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_elementary_conservation_relations" class="md-nav__link">
    <span class="md-ellipsis">
      get_elementary_conservation_relations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_enzyme_usage_by_protein_pool_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      get_enzyme_usage_by_protein_pool_fraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_extra_linear_constraint_string" class="md-nav__link">
    <span class="md-ellipsis">
      get_extra_linear_constraint_string
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_full_enzyme_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_full_enzyme_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_full_enzyme_mw" class="md-nav__link">
    <span class="md-ellipsis">
      get_full_enzyme_mw
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_fwd_rev_corrected_flux" class="md-nav__link">
    <span class="md-ellipsis">
      get_fwd_rev_corrected_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_metabolite_consumption_and_production" class="md-nav__link">
    <span class="md-ellipsis">
      get_metabolite_consumption_and_production
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_metabolites_in_elementary_conservation_relations" class="md-nav__link">
    <span class="md-ellipsis">
      get_metabolites_in_elementary_conservation_relations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_dG0s" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_dG0s
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_hill_coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_hill_coefficients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_kas" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_kas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_kcats" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_kcats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_kis" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_kis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_kms" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_kms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_kms_by_usage" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_kms_by_usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_max_kcat_times_e_values" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_max_kcat_times_e_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_mws" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_mws
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_with_filled_missing_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_with_filled_missing_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_with_varied_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_with_varied_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_potentially_active_reactions_in_variability_dict" class="md-nav__link">
    <span class="md-ellipsis">
      get_potentially_active_reactions_in_variability_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_pyomo_solution_as_dict" class="md-nav__link">
    <span class="md-ellipsis">
      get_pyomo_solution_as_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_reaction_enzyme_var_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_reaction_enzyme_var_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_reaction_string" class="md-nav__link">
    <span class="md-ellipsis">
      get_reaction_string
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_reverse_reac_id_if_existing" class="md-nav__link">
    <span class="md-ellipsis">
      get_reverse_reac_id_if_existing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_solver_status_from_pyomo_results" class="md-nav__link">
    <span class="md-ellipsis">
      get_solver_status_from_pyomo_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_stoichiometric_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      get_stoichiometric_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_stoichiometrically_coupled_reactions" class="md-nav__link">
    <span class="md-ellipsis">
      get_stoichiometrically_coupled_reactions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_substrate_and_product_exchanges" class="md-nav__link">
    <span class="md-ellipsis">
      get_substrate_and_product_exchanges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_termination_condition_from_pyomo_results" class="md-nav__link">
    <span class="md-ellipsis">
      get_termination_condition_from_pyomo_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_unoptimized_reactions_in_nlp_solution" class="md-nav__link">
    <span class="md-ellipsis">
      get_unoptimized_reactions_in_nlp_solution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.have_all_unignored_km" class="md-nav__link">
    <span class="md-ellipsis">
      have_all_unignored_km
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.is_any_error_term_active" class="md-nav__link">
    <span class="md-ellipsis">
      is_any_error_term_active
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.is_objsense_maximization" class="md-nav__link">
    <span class="md-ellipsis">
      is_objsense_maximization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.last_n_elements_equal" class="md-nav__link">
    <span class="md-ellipsis">
      last_n_elements_equal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.make_kms_better_by_factor" class="md-nav__link">
    <span class="md-ellipsis">
      make_kms_better_by_factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.parse_external_resources" class="md-nav__link">
    <span class="md-ellipsis">
      parse_external_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.print_model_parameter_statistics" class="md-nav__link">
    <span class="md-ellipsis">
      print_model_parameter_statistics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.sort_dict_keys" class="md-nav__link">
    <span class="md-ellipsis">
      sort_dict_keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.split_list" class="md-nav__link">
    <span class="md-ellipsis">
      split_list
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cobrak" class="md-nav__link">
    <span class="md-ellipsis">
      cobrak
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.exit_signal_handler" class="md-nav__link">
    <span class="md-ellipsis">
      exit_signal_handler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.set_logging_handler" class="md-nav__link">
    <span class="md-ellipsis">
      set_logging_handler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.set_logging_level" class="md-nav__link">
    <span class="md-ellipsis">
      set_logging_level
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.setup_rich_tracebacks" class="md-nav__link">
    <span class="md-ellipsis">
      setup_rich_tracebacks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.bigg_metabolites_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      bigg_metabolites_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bigg_metabolites_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.bigg_metabolites_functionality.bigg_parse_metabolites_file" class="md-nav__link">
    <span class="md-ellipsis">
      bigg_parse_metabolites_file
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bigg_parse_metabolites_file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.bigg_metabolites_functionality.bigg_parse_metabolites_file--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.bigg_metabolites_functionality.bigg_parse_metabolites_file--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.brenda_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      brenda_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="brenda_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.brenda_functionality.brenda_select_enzyme_kinetic_data_for_model" class="md-nav__link">
    <span class="md-ellipsis">
      brenda_select_enzyme_kinetic_data_for_model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.cobrapy_model_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      cobrapy_model_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cobrapy_model_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.cobrapy_model_functionality.create_irreversible_cobrapy_model_from_stoichiometries" class="md-nav__link">
    <span class="md-ellipsis">
      create_irreversible_cobrapy_model_from_stoichiometries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.cobrapy_model_functionality.get_fullsplit_cobra_model" class="md-nav__link">
    <span class="md-ellipsis">
      get_fullsplit_cobra_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.cobrapy_model_functionality.get_fullsplit_cobra_model_from_sbml" class="md-nav__link">
    <span class="md-ellipsis">
      get_fullsplit_cobra_model_from_sbml
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.constants" class="md-nav__link">
    <span class="md-ellipsis">
      constants
    </span>
  </a>
  
    <nav class="md-nav" aria-label="constants">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ALL_OK_KEY" class="md-nav__link">
    <span class="md-ellipsis">
      ALL_OK_KEY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ALPHA_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ALPHA_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.BIG_M" class="md-nav__link">
    <span class="md-ellipsis">
      BIG_M
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.DF_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      DF_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.DG0_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      DG0_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.EC_INNER_TO_OUTER_COMPARTMENTS" class="md-nav__link">
    <span class="md-ellipsis">
      EC_INNER_TO_OUTER_COMPARTMENTS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.EC_IONIC_STRENGTHS" class="md-nav__link">
    <span class="md-ellipsis">
      EC_IONIC_STRENGTHS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.EC_PHS" class="md-nav__link">
    <span class="md-ellipsis">
      EC_PHS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.EC_PMGS" class="md-nav__link">
    <span class="md-ellipsis">
      EC_PMGS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.EC_POTENTIAL_DIFFERENCES" class="md-nav__link">
    <span class="md-ellipsis">
      EC_POTENTIAL_DIFFERENCES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ENZYME_VAR_INFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ENZYME_VAR_INFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ENZYME_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ENZYME_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ERROR_BOUND_LOWER_CHANGE_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR_BOUND_LOWER_CHANGE_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ERROR_BOUND_UPPER_CHANGE_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR_BOUND_UPPER_CHANGE_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ERROR_CONSTRAINT_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR_CONSTRAINT_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ERROR_SUM_VAR_ID" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR_SUM_VAR_ID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ERROR_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ERROR_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.FLUX_SUM_VAR_ID" class="md-nav__link">
    <span class="md-ellipsis">
      FLUX_SUM_VAR_ID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.GAMMA_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      GAMMA_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.IOTA_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      IOTA_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.KAPPA_PRODUCTS_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      KAPPA_PRODUCTS_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.KAPPA_SUBSTRATES_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      KAPPA_SUBSTRATES_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.KAPPA_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      KAPPA_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.LNCONC_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      LNCONC_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.MDF_VAR_ID" class="md-nav__link">
    <span class="md-ellipsis">
      MDF_VAR_ID
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.OBJECTIVE_CONSTRAINT_NAME" class="md-nav__link">
    <span class="md-ellipsis">
      OBJECTIVE_CONSTRAINT_NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.OBJECTIVE_VAR_NAME" class="md-nav__link">
    <span class="md-ellipsis">
      OBJECTIVE_VAR_NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.PROT_POOL_MET_NAME" class="md-nav__link">
    <span class="md-ellipsis">
      PROT_POOL_MET_NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.PROT_POOL_REAC_NAME" class="md-nav__link">
    <span class="md-ellipsis">
      PROT_POOL_REAC_NAME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.QUASI_INF" class="md-nav__link">
    <span class="md-ellipsis">
      QUASI_INF
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.REAC_ENZ_SEPARATOR" class="md-nav__link">
    <span class="md-ellipsis">
      REAC_ENZ_SEPARATOR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.REAC_FWD_SUFFIX" class="md-nav__link">
    <span class="md-ellipsis">
      REAC_FWD_SUFFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.REAC_REV_SUFFIX" class="md-nav__link">
    <span class="md-ellipsis">
      REAC_REV_SUFFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.SOLVER_STATUS_KEY" class="md-nav__link">
    <span class="md-ellipsis">
      SOLVER_STATUS_KEY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.STANDARD_MIN_MDF" class="md-nav__link">
    <span class="md-ellipsis">
      STANDARD_MIN_MDF
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.STANDARD_R" class="md-nav__link">
    <span class="md-ellipsis">
      STANDARD_R
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.STANDARD_T" class="md-nav__link">
    <span class="md-ellipsis">
      STANDARD_T
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.TERMINATION_CONDITION_KEY" class="md-nav__link">
    <span class="md-ellipsis">
      TERMINATION_CONDITION_KEY
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.USED_IDENTIFIERS_FOR_EQUILIBRATOR" class="md-nav__link">
    <span class="md-ellipsis">
      USED_IDENTIFIERS_FOR_EQUILIBRATOR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.ZB_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      ZB_VAR_PREFIX
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.constants.Z_VAR_PREFIX" class="md-nav__link">
    <span class="md-ellipsis">
      Z_VAR_PREFIX
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.dataclasses" class="md-nav__link">
    <span class="md-ellipsis">
      dataclasses
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dataclasses">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ErrorScenario" class="md-nav__link">
    <span class="md-ellipsis">
      ErrorScenario
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.OptResult" class="md-nav__link">
    <span class="md-ellipsis">
      OptResult
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.VarResult" class="md-nav__link">
    <span class="md-ellipsis">
      VarResult
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig" class="md-nav__link">
    <span class="md-ellipsis">
      CorrectionConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CorrectionConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_dG0_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_dG0_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_enzyme_conc_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_enzyme_conc_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_error_sum_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_error_sum_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_flux_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_flux_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_ka_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_ka_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_kcat_times_e_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_kcat_times_e_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_ki_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_ki_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_km_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_km_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.add_met_logconc_error_term" class="md-nav__link">
    <span class="md-ellipsis">
      add_met_logconc_error_term
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.dG0_error_cutoff" class="md-nav__link">
    <span class="md-ellipsis">
      dG0_error_cutoff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.error_scenario" class="md-nav__link">
    <span class="md-ellipsis">
      error_scenario
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.error_sum_as_qp" class="md-nav__link">
    <span class="md-ellipsis">
      error_sum_as_qp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.extra_weights" class="md-nav__link">
    <span class="md-ellipsis">
      extra_weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.ka_error_cutoff" class="md-nav__link">
    <span class="md-ellipsis">
      ka_error_cutoff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.kcat_times_e_error_cutoff" class="md-nav__link">
    <span class="md-ellipsis">
      kcat_times_e_error_cutoff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.ki_error_cutoff" class="md-nav__link">
    <span class="md-ellipsis">
      ki_error_cutoff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.km_error_cutoff" class="md-nav__link">
    <span class="md-ellipsis">
      km_error_cutoff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.max_abs_dG0_correction" class="md-nav__link">
    <span class="md-ellipsis">
      max_abs_dG0_correction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.max_rel_ka_correction" class="md-nav__link">
    <span class="md-ellipsis">
      max_rel_ka_correction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.max_rel_kcat_times_e_correction" class="md-nav__link">
    <span class="md-ellipsis">
      max_rel_kcat_times_e_correction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.max_rel_ki_correction" class="md-nav__link">
    <span class="md-ellipsis">
      max_rel_ki_correction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.max_rel_km_correction" class="md-nav__link">
    <span class="md-ellipsis">
      max_rel_km_correction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.use_weights" class="md-nav__link">
    <span class="md-ellipsis">
      use_weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.var_lb_ub_application" class="md-nav__link">
    <span class="md-ellipsis">
      var_lb_ub_application
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.CorrectionConfig.weight_percentile" class="md-nav__link">
    <span class="md-ellipsis">
      weight_percentile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Enzyme" class="md-nav__link">
    <span class="md-ellipsis">
      Enzyme
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Enzyme">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Enzyme.annotation" class="md-nav__link">
    <span class="md-ellipsis">
      annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Enzyme.max_conc" class="md-nav__link">
    <span class="md-ellipsis">
      max_conc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Enzyme.min_conc" class="md-nav__link">
    <span class="md-ellipsis">
      min_conc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Enzyme.molecular_weight" class="md-nav__link">
    <span class="md-ellipsis">
      molecular_weight
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Enzyme.name" class="md-nav__link">
    <span class="md-ellipsis">
      name
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData" class="md-nav__link">
    <span class="md-ellipsis">
      EnzymeReactionData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EnzymeReactionData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.hill_coefficient_references" class="md-nav__link">
    <span class="md-ellipsis">
      hill_coefficient_references
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.hill_coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      hill_coefficients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      identifiers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_a_references" class="md-nav__link">
    <span class="md-ellipsis">
      k_a_references
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_as" class="md-nav__link">
    <span class="md-ellipsis">
      k_as
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_cat" class="md-nav__link">
    <span class="md-ellipsis">
      k_cat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_cat_references" class="md-nav__link">
    <span class="md-ellipsis">
      k_cat_references
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_i_references" class="md-nav__link">
    <span class="md-ellipsis">
      k_i_references
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_is" class="md-nav__link">
    <span class="md-ellipsis">
      k_is
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_m_references" class="md-nav__link">
    <span class="md-ellipsis">
      k_m_references
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.k_ms" class="md-nav__link">
    <span class="md-ellipsis">
      k_ms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.EnzymeReactionData.special_stoichiometries" class="md-nav__link">
    <span class="md-ellipsis">
      special_stoichiometries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraLinearConstraint" class="md-nav__link">
    <span class="md-ellipsis">
      ExtraLinearConstraint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExtraLinearConstraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraLinearConstraint.lower_value" class="md-nav__link">
    <span class="md-ellipsis">
      lower_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraLinearConstraint.stoichiometries" class="md-nav__link">
    <span class="md-ellipsis">
      stoichiometries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraLinearConstraint.upper_value" class="md-nav__link">
    <span class="md-ellipsis">
      upper_value
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraLinearWatch" class="md-nav__link">
    <span class="md-ellipsis">
      ExtraLinearWatch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraNonlinearConstraint" class="md-nav__link">
    <span class="md-ellipsis">
      ExtraNonlinearConstraint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExtraNonlinearConstraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraNonlinearConstraint.full_application" class="md-nav__link">
    <span class="md-ellipsis">
      full_application
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraNonlinearConstraint.lower_value" class="md-nav__link">
    <span class="md-ellipsis">
      lower_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraNonlinearConstraint.stoichiometries" class="md-nav__link">
    <span class="md-ellipsis">
      stoichiometries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraNonlinearConstraint.upper_value" class="md-nav__link">
    <span class="md-ellipsis">
      upper_value
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ExtraNonlinearWatch" class="md-nav__link">
    <span class="md-ellipsis">
      ExtraNonlinearWatch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillCoefficients" class="md-nav__link">
    <span class="md-ellipsis">
      HillCoefficients
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HillCoefficients">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillCoefficients.alpha" class="md-nav__link">
    <span class="md-ellipsis">
      alpha
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillCoefficients.iota" class="md-nav__link">
    <span class="md-ellipsis">
      iota
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillCoefficients.kappa" class="md-nav__link">
    <span class="md-ellipsis">
      kappa
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillParameterReferences" class="md-nav__link">
    <span class="md-ellipsis">
      HillParameterReferences
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HillParameterReferences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillParameterReferences.alpha" class="md-nav__link">
    <span class="md-ellipsis">
      alpha
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillParameterReferences.iota" class="md-nav__link">
    <span class="md-ellipsis">
      iota
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.HillParameterReferences.kappa" class="md-nav__link">
    <span class="md-ellipsis">
      kappa
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Metabolite" class="md-nav__link">
    <span class="md-ellipsis">
      Metabolite
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metabolite">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Metabolite.annotation" class="md-nav__link">
    <span class="md-ellipsis">
      annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Metabolite.charge" class="md-nav__link">
    <span class="md-ellipsis">
      charge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Metabolite.formula" class="md-nav__link">
    <span class="md-ellipsis">
      formula
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Metabolite.log_max_conc" class="md-nav__link">
    <span class="md-ellipsis">
      log_max_conc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Metabolite.log_min_conc" class="md-nav__link">
    <span class="md-ellipsis">
      log_min_conc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Metabolite.name" class="md-nav__link">
    <span class="md-ellipsis">
      name
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model" class="md-nav__link">
    <span class="md-ellipsis">
      Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.R" class="md-nav__link">
    <span class="md-ellipsis">
      R
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.T" class="md-nav__link">
    <span class="md-ellipsis">
      T
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.annotation" class="md-nav__link">
    <span class="md-ellipsis">
      annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.conc_sum_ignore_prefixes" class="md-nav__link">
    <span class="md-ellipsis">
      conc_sum_ignore_prefixes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.conc_sum_include_suffixes" class="md-nav__link">
    <span class="md-ellipsis">
      conc_sum_include_suffixes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.conc_sum_max_rel_error" class="md-nav__link">
    <span class="md-ellipsis">
      conc_sum_max_rel_error
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.conc_sum_min_abs_error" class="md-nav__link">
    <span class="md-ellipsis">
      conc_sum_min_abs_error
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.enzymes" class="md-nav__link">
    <span class="md-ellipsis">
      enzymes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.extra_linear_constraints" class="md-nav__link">
    <span class="md-ellipsis">
      extra_linear_constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.extra_linear_watches" class="md-nav__link">
    <span class="md-ellipsis">
      extra_linear_watches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.extra_nonlinear_constraints" class="md-nav__link">
    <span class="md-ellipsis">
      extra_nonlinear_constraints
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.extra_nonlinear_watches" class="md-nav__link">
    <span class="md-ellipsis">
      extra_nonlinear_watches
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.fwd_suffix" class="md-nav__link">
    <span class="md-ellipsis">
      fwd_suffix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.kinetic_ignored_metabolites" class="md-nav__link">
    <span class="md-ellipsis">
      kinetic_ignored_metabolites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.max_conc_sum" class="md-nav__link">
    <span class="md-ellipsis">
      max_conc_sum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.max_prot_pool" class="md-nav__link">
    <span class="md-ellipsis">
      max_prot_pool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.metabolites" class="md-nav__link">
    <span class="md-ellipsis">
      metabolites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.reac_enz_separator" class="md-nav__link">
    <span class="md-ellipsis">
      reac_enz_separator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.reactions" class="md-nav__link">
    <span class="md-ellipsis">
      reactions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.rev_suffix" class="md-nav__link">
    <span class="md-ellipsis">
      rev_suffix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.__enter__" class="md-nav__link">
    <span class="md-ellipsis">
      __enter__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Model.__exit__" class="md-nav__link">
    <span class="md-ellipsis">
      __exit__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ParameterReference" class="md-nav__link">
    <span class="md-ellipsis">
      ParameterReference
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParameterReference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ParameterReference.comment" class="md-nav__link">
    <span class="md-ellipsis">
      comment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ParameterReference.database" class="md-nav__link">
    <span class="md-ellipsis">
      database
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ParameterReference.pubs" class="md-nav__link">
    <span class="md-ellipsis">
      pubs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ParameterReference.species" class="md-nav__link">
    <span class="md-ellipsis">
      species
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.ParameterReference.substrate" class="md-nav__link">
    <span class="md-ellipsis">
      substrate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction" class="md-nav__link">
    <span class="md-ellipsis">
      Reaction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reaction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.annotation" class="md-nav__link">
    <span class="md-ellipsis">
      annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.dG0" class="md-nav__link">
    <span class="md-ellipsis">
      dG0
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.dG0_uncertainty" class="md-nav__link">
    <span class="md-ellipsis">
      dG0_uncertainty
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.enzyme_reaction_data" class="md-nav__link">
    <span class="md-ellipsis">
      enzyme_reaction_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.max_flux" class="md-nav__link">
    <span class="md-ellipsis">
      max_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.min_flux" class="md-nav__link">
    <span class="md-ellipsis">
      min_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.name" class="md-nav__link">
    <span class="md-ellipsis">
      name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Reaction.stoichiometries" class="md-nav__link">
    <span class="md-ellipsis">
      stoichiometries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Solver" class="md-nav__link">
    <span class="md-ellipsis">
      Solver
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Solver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Solver.name" class="md-nav__link">
    <span class="md-ellipsis">
      name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Solver.solve_extra_options" class="md-nav__link">
    <span class="md-ellipsis">
      solve_extra_options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Solver.solver_attrs" class="md-nav__link">
    <span class="md-ellipsis">
      solver_attrs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.dataclasses.Solver.solver_options" class="md-nav__link">
    <span class="md-ellipsis">
      solver_options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.equilibrator_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      equilibrator_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="equilibrator_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.equilibrator_functionality.equilibrator_get_model_dG0_and_uncertainty_values" class="md-nav__link">
    <span class="md-ellipsis">
      equilibrator_get_model_dG0_and_uncertainty_values
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.evolution" class="md-nav__link">
    <span class="md-ellipsis">
      evolution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="evolution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.evolution.COBRAKProblem" class="md-nav__link">
    <span class="md-ellipsis">
      COBRAKProblem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="COBRAKProblem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.evolution.COBRAKProblem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.evolution.COBRAKProblem.fitness" class="md-nav__link">
    <span class="md-ellipsis">
      fitness
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.evolution.COBRAKProblem.optimize" class="md-nav__link">
    <span class="md-ellipsis">
      optimize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.evolution.perform_nlp_evolutionary_optimization" class="md-nav__link">
    <span class="md-ellipsis">
      perform_nlp_evolutionary_optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.evolution.postprocess" class="md-nav__link">
    <span class="md-ellipsis">
      postprocess
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.example_models" class="md-nav__link">
    <span class="md-ellipsis">
      example_models
    </span>
  </a>
  
    <nav class="md-nav" aria-label="example_models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.example_models.__getattr__" class="md-nav__link">
    <span class="md-ellipsis">
      __getattr__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.expasy_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      expasy_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="expasy_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.expasy_functionality.get_ec_number_transfers" class="md-nav__link">
    <span class="md-ellipsis">
      get_ec_number_transfers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.genetic" class="md-nav__link">
    <span class="md-ellipsis">
      genetic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="genetic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.genetic.COBRAKGENETIC" class="md-nav__link">
    <span class="md-ellipsis">
      COBRAKGENETIC
    </span>
  </a>
  
    <nav class="md-nav" aria-label="COBRAKGENETIC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.genetic.COBRAKGENETIC.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.genetic.COBRAKGENETIC.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.genetic.COBRAKGENETIC.update_particle" class="md-nav__link">
    <span class="md-ellipsis">
      update_particle
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.io" class="md-nav__link">
    <span class="md-ellipsis">
      io
    </span>
  </a>
  
    <nav class="md-nav" aria-label="io">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.convert_cobrak_model_to_annotated_cobrapy_model" class="md-nav__link">
    <span class="md-ellipsis">
      convert_cobrak_model_to_annotated_cobrapy_model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="convert_cobrak_model_to_annotated_cobrapy_model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.convert_cobrak_model_to_annotated_cobrapy_model--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.convert_cobrak_model_to_annotated_cobrapy_model--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.convert_cobrak_model_to_annotated_cobrapy_model--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.ensure_folder_existence" class="md-nav__link">
    <span class="md-ellipsis">
      ensure_folder_existence
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ensure_folder_existence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.ensure_folder_existence--argument" class="md-nav__link">
    <span class="md-ellipsis">
      Argument
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.ensure_json_existence" class="md-nav__link">
    <span class="md-ellipsis">
      ensure_json_existence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.get_base_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_base_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.get_files" class="md-nav__link">
    <span class="md-ellipsis">
      get_files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.get_files--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.get_folders" class="md-nav__link">
    <span class="md-ellipsis">
      get_folders
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_folders">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.get_folders--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_load" class="md-nav__link">
    <span class="md-ellipsis">
      json_load
    </span>
  </a>
  
    <nav class="md-nav" aria-label="json_load">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_load--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_load--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_load--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_load--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_write" class="md-nav__link">
    <span class="md-ellipsis">
      json_write
    </span>
  </a>
  
    <nav class="md-nav" aria-label="json_write">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_write--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_zip_load" class="md-nav__link">
    <span class="md-ellipsis">
      json_zip_load
    </span>
  </a>
  
    <nav class="md-nav" aria-label="json_zip_load">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_zip_load--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_zip_load--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_zip_write" class="md-nav__link">
    <span class="md-ellipsis">
      json_zip_write
    </span>
  </a>
  
    <nav class="md-nav" aria-label="json_zip_write">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.json_zip_write--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.load_annotated_cobrapy_model_as_cobrak_model" class="md-nav__link">
    <span class="md-ellipsis">
      load_annotated_cobrapy_model_as_cobrak_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.load_annotated_sbml_model_as_cobrak_model" class="md-nav__link">
    <span class="md-ellipsis">
      load_annotated_sbml_model_as_cobrak_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.load_unannotated_sbml_as_cobrapy_model" class="md-nav__link">
    <span class="md-ellipsis">
      load_unannotated_sbml_as_cobrapy_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.pickle_load" class="md-nav__link">
    <span class="md-ellipsis">
      pickle_load
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pickle_load">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.pickle_load--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.pickle_write" class="md-nav__link">
    <span class="md-ellipsis">
      pickle_write
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pickle_write">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.pickle_write--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.save_cobrak_model_as_annotated_sbml_model" class="md-nav__link">
    <span class="md-ellipsis">
      save_cobrak_model_as_annotated_sbml_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.io.standardize_folder" class="md-nav__link">
    <span class="md-ellipsis">
      standardize_folder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="standardize_folder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.io.standardize_folder--argument" class="md-nav__link">
    <span class="md-ellipsis">
      Argument
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.lps" class="md-nav__link">
    <span class="md-ellipsis">
      lps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="lps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.add_flux_sum_var" class="md-nav__link">
    <span class="md-ellipsis">
      add_flux_sum_var
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.add_loop_constraints_to_lp" class="md-nav__link">
    <span class="md-ellipsis">
      add_loop_constraints_to_lp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.get_lp_from_cobrak_model" class="md-nav__link">
    <span class="md-ellipsis">
      get_lp_from_cobrak_model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_lp_from_cobrak_model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.get_lp_from_cobrak_model--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.get_lp_from_cobrak_model--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.perform_lp_min_active_reactions_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      perform_lp_min_active_reactions_analysis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="perform_lp_min_active_reactions_analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.perform_lp_min_active_reactions_analysis--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.perform_lp_min_active_reactions_analysis--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.perform_lp_optimization" class="md-nav__link">
    <span class="md-ellipsis">
      perform_lp_optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.perform_lp_thermodynamic_bottleneck_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      perform_lp_thermodynamic_bottleneck_analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.lps.perform_lp_variability_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      perform_lp_variability_analysis
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.model_instantiation" class="md-nav__link">
    <span class="md-ellipsis">
      model_instantiation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="model_instantiation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.model_instantiation.delete_enzymatically_suboptimal_reactions_in_cobrak_model" class="md-nav__link">
    <span class="md-ellipsis">
      delete_enzymatically_suboptimal_reactions_in_cobrak_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.model_instantiation.delete_enzymatically_suboptimal_reactions_in_fullsplit_cobrapy_model" class="md-nav__link">
    <span class="md-ellipsis">
      delete_enzymatically_suboptimal_reactions_in_fullsplit_cobrapy_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.model_instantiation.get_cobrak_model_from_sbml_and_thermokinetic_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_cobrak_model_from_sbml_and_thermokinetic_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.model_instantiation.get_cobrak_model_with_kinetic_data_from_sbml_model_alone" class="md-nav__link">
    <span class="md-ellipsis">
      get_cobrak_model_with_kinetic_data_from_sbml_model_alone
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.ncbi_taxonomy_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      ncbi_taxonomy_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ncbi_taxonomy_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.ncbi_taxonomy_functionality.get_taxonomy_dict_from_nbci_taxonomy" class="md-nav__link">
    <span class="md-ellipsis">
      get_taxonomy_dict_from_nbci_taxonomy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.ncbi_taxonomy_functionality.get_taxonomy_scores" class="md-nav__link">
    <span class="md-ellipsis">
      get_taxonomy_scores
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_taxonomy_scores">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.ncbi_taxonomy_functionality.get_taxonomy_scores--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.ncbi_taxonomy_functionality.most_taxonomic_similar" class="md-nav__link">
    <span class="md-ellipsis">
      most_taxonomic_similar
    </span>
  </a>
  
    <nav class="md-nav" aria-label="most_taxonomic_similar">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.ncbi_taxonomy_functionality.most_taxonomic_similar--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.ncbi_taxonomy_functionality.parse_ncbi_taxonomy" class="md-nav__link">
    <span class="md-ellipsis">
      parse_ncbi_taxonomy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.nlps" class="md-nav__link">
    <span class="md-ellipsis">
      nlps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="nlps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.add_loop_constraints_to_nlp" class="md-nav__link">
    <span class="md-ellipsis">
      add_loop_constraints_to_nlp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.get_nlp_from_cobrak_model" class="md-nav__link">
    <span class="md-ellipsis">
      get_nlp_from_cobrak_model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_nlp_from_cobrak_model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.get_nlp_from_cobrak_model--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.get_nlp_from_cobrak_model--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_optimization" class="md-nav__link">
    <span class="md-ellipsis">
      perform_nlp_irreversible_optimization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="perform_nlp_irreversible_optimization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_optimization--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_optimization--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_optimization_with_active_reacs_only" class="md-nav__link">
    <span class="md-ellipsis">
      perform_nlp_irreversible_optimization_with_active_reacs_only
    </span>
  </a>
  
    <nav class="md-nav" aria-label="perform_nlp_irreversible_optimization_with_active_reacs_only">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_optimization_with_active_reacs_only--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_optimization_with_active_reacs_only--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_variability_analysis_with_active_reacs_only" class="md-nav__link">
    <span class="md-ellipsis">
      perform_nlp_irreversible_variability_analysis_with_active_reacs_only
    </span>
  </a>
  
    <nav class="md-nav" aria-label="perform_nlp_irreversible_variability_analysis_with_active_reacs_only">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_variability_analysis_with_active_reacs_only--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_irreversible_variability_analysis_with_active_reacs_only--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_reversible_optimization" class="md-nav__link">
    <span class="md-ellipsis">
      perform_nlp_reversible_optimization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="perform_nlp_reversible_optimization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_reversible_optimization--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.nlps.perform_nlp_reversible_optimization--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.plotting" class="md-nav__link">
    <span class="md-ellipsis">
      plotting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plotting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.dual_axis_plot" class="md-nav__link">
    <span class="md-ellipsis">
      dual_axis_plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.plot_combinations" class="md-nav__link">
    <span class="md-ellipsis">
      plot_combinations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.plot_objvalue_evolution" class="md-nav__link">
    <span class="md-ellipsis">
      plot_objvalue_evolution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.plot_variabilities" class="md-nav__link">
    <span class="md-ellipsis">
      plot_variabilities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot_variabilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.plot_variabilities--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.plot_variabilities--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.plot_variabilities--example" class="md-nav__link">
    <span class="md-ellipsis">
      Example:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.scatterplot_with_labels" class="md-nav__link">
    <span class="md-ellipsis">
      scatterplot_with_labels
    </span>
  </a>
  
    <nav class="md-nav" aria-label="scatterplot_with_labels">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.scatterplot_with_labels--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.plotting.scatterplot_with_labels--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.printing" class="md-nav__link">
    <span class="md-ellipsis">
      printing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="printing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.printing.print_dict" class="md-nav__link">
    <span class="md-ellipsis">
      print_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.printing.print_model" class="md-nav__link">
    <span class="md-ellipsis">
      print_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.printing.print_optimization_result" class="md-nav__link">
    <span class="md-ellipsis">
      print_optimization_result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.printing.print_strkey_dict_as_table" class="md-nav__link">
    <span class="md-ellipsis">
      print_strkey_dict_as_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.printing.print_variability_result" class="md-nav__link">
    <span class="md-ellipsis">
      print_variability_result
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      pyomo_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="pyomo_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality.ApproximationPoint" class="md-nav__link">
    <span class="md-ellipsis">
      ApproximationPoint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality.add_linear_approximation_to_pyomo_model" class="md-nav__link">
    <span class="md-ellipsis">
      add_linear_approximation_to_pyomo_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality.add_objective_to_model" class="md-nav__link">
    <span class="md-ellipsis">
      add_objective_to_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality.get_model_var_names" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_var_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality.get_objective" class="md-nav__link">
    <span class="md-ellipsis">
      get_objective
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality.get_solver" class="md-nav__link">
    <span class="md-ellipsis">
      get_solver
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.pyomo_functionality.set_target_as_var_and_value" class="md-nav__link">
    <span class="md-ellipsis">
      set_target_as_var_and_value
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      sabio_rk_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sabio_rk_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioDict" class="md-nav__link">
    <span class="md-ellipsis">
      SabioDict
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SabioDict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioDict.hill_entries" class="md-nav__link">
    <span class="md-ellipsis">
      hill_entries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioDict.ka_entries" class="md-nav__link">
    <span class="md-ellipsis">
      ka_entries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioDict.kcat_entries" class="md-nav__link">
    <span class="md-ellipsis">
      kcat_entries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioDict.ki_entries" class="md-nav__link">
    <span class="md-ellipsis">
      ki_entries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioDict.km_entries" class="md-nav__link">
    <span class="md-ellipsis">
      km_entries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry" class="md-nav__link">
    <span class="md-ellipsis">
      SabioEntry
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SabioEntry">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.chebi_ids" class="md-nav__link">
    <span class="md-ellipsis">
      chebi_ids
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.entry_id" class="md-nav__link">
    <span class="md-ellipsis">
      entry_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.is_recombinant" class="md-nav__link">
    <span class="md-ellipsis">
      is_recombinant
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.kinetics_mechanism_type" class="md-nav__link">
    <span class="md-ellipsis">
      kinetics_mechanism_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.organism" class="md-nav__link">
    <span class="md-ellipsis">
      organism
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.parameter_associated_species" class="md-nav__link">
    <span class="md-ellipsis">
      parameter_associated_species
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.parameter_unit" class="md-nav__link">
    <span class="md-ellipsis">
      parameter_unit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.parameter_value" class="md-nav__link">
    <span class="md-ellipsis">
      parameter_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.ph" class="md-nav__link">
    <span class="md-ellipsis">
      ph
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.products" class="md-nav__link">
    <span class="md-ellipsis">
      products
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.substrates" class="md-nav__link">
    <span class="md-ellipsis">
      substrates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioEntry.temperature" class="md-nav__link">
    <span class="md-ellipsis">
      temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioThread" class="md-nav__link">
    <span class="md-ellipsis">
      SabioThread
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SabioThread">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioThread.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.SabioThread.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.get_full_sabio_dict" class="md-nav__link">
    <span class="md-ellipsis">
      get_full_sabio_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.sabio_rk_functionality.sabio_select_enzyme_kinetic_data_for_model" class="md-nav__link">
    <span class="md-ellipsis">
      sabio_select_enzyme_kinetic_data_for_model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      spreadsheet_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="spreadsheet_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.ABS_EPSILON" class="md-nav__link">
    <span class="md-ellipsis">
      ABS_EPSILON
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.EMPTY_CELL" class="md-nav__link">
    <span class="md-ellipsis">
      EMPTY_CELL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.FONT_BOLD" class="md-nav__link">
    <span class="md-ellipsis">
      FONT_BOLD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.FONT_BOLD_AND_UNDERLINED" class="md-nav__link">
    <span class="md-ellipsis">
      FONT_BOLD_AND_UNDERLINED
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.FONT_DEFAULT" class="md-nav__link">
    <span class="md-ellipsis">
      FONT_DEFAULT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.WIDTH_DEFAULT" class="md-nav__link">
    <span class="md-ellipsis">
      WIDTH_DEFAULT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset" class="md-nav__link">
    <span class="md-ellipsis">
      OptimizationDataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OptimizationDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.data" class="md-nav__link">
    <span class="md-ellipsis">
      data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_alpha" class="md-nav__link">
    <span class="md-ellipsis">
      with_alpha
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_df" class="md-nav__link">
    <span class="md-ellipsis">
      with_df
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_error_corrections" class="md-nav__link">
    <span class="md-ellipsis">
      with_error_corrections
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_gamma" class="md-nav__link">
    <span class="md-ellipsis">
      with_gamma
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_iota" class="md-nav__link">
    <span class="md-ellipsis">
      with_iota
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_kappa" class="md-nav__link">
    <span class="md-ellipsis">
      with_kappa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_kinetic_differences" class="md-nav__link">
    <span class="md-ellipsis">
      with_kinetic_differences
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.OptimizationDataset.with_vplus" class="md-nav__link">
    <span class="md-ellipsis">
      with_vplus
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.SpreadsheetCell" class="md-nav__link">
    <span class="md-ellipsis">
      SpreadsheetCell
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SpreadsheetCell">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.SpreadsheetCell.bg_color" class="md-nav__link">
    <span class="md-ellipsis">
      bg_color
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.SpreadsheetCell.border" class="md-nav__link">
    <span class="md-ellipsis">
      border
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.SpreadsheetCell.font" class="md-nav__link">
    <span class="md-ellipsis">
      font
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.SpreadsheetCell.value" class="md-nav__link">
    <span class="md-ellipsis">
      value
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.Title" class="md-nav__link">
    <span class="md-ellipsis">
      Title
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Title">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.Title.is_metatitle" class="md-nav__link">
    <span class="md-ellipsis">
      is_metatitle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.Title.text" class="md-nav__link">
    <span class="md-ellipsis">
      text
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.Title.width" class="md-nav__link">
    <span class="md-ellipsis">
      width
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.VariabilityDataset" class="md-nav__link">
    <span class="md-ellipsis">
      VariabilityDataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="VariabilityDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.VariabilityDataset.data" class="md-nav__link">
    <span class="md-ellipsis">
      data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.VariabilityDataset.with_df" class="md-nav__link">
    <span class="md-ellipsis">
      with_df
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.spreadsheet_functionality.create_cobrak_spreadsheet" class="md-nav__link">
    <span class="md-ellipsis">
      create_cobrak_spreadsheet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.standard_solvers" class="md-nav__link">
    <span class="md-ellipsis">
      standard_solvers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.tellurium_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      tellurium_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="tellurium_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.tellurium_functionality.get_tellurium_string_from_cobrak_model_and_solution" class="md-nav__link">
    <span class="md-ellipsis">
      get_tellurium_string_from_cobrak_model_and_solution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_tellurium_string_from_cobrak_model_and_solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.tellurium_functionality.get_tellurium_string_from_cobrak_model_and_solution--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.tellurium_functionality.get_tellurium_string_from_cobrak_model_and_solution--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.tellurium_functionality.write_kinetic_sbml_model_from_cobrak_model_and_solution" class="md-nav__link">
    <span class="md-ellipsis">
      write_kinetic_sbml_model_from_cobrak_model_and_solution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="write_kinetic_sbml_model_from_cobrak_model_and_solution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.tellurium_functionality.write_kinetic_sbml_model_from_cobrak_model_and_solution--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.tellurium_functionality.write_kinetic_sbml_model_from_cobrak_model_and_solution--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.uniprot_functionality" class="md-nav__link">
    <span class="md-ellipsis">
      uniprot_functionality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="uniprot_functionality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.uniprot_functionality.uniprot_get_enzyme_molecular_weights" class="md-nav__link">
    <span class="md-ellipsis">
      uniprot_get_enzyme_molecular_weights
    </span>
  </a>
  
    <nav class="md-nav" aria-label="uniprot_get_enzyme_molecular_weights">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.uniprot_functionality.uniprot_get_enzyme_molecular_weights--arguments" class="md-nav__link">
    <span class="md-ellipsis">
      Arguments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.uniprot_functionality.uniprot_get_enzyme_molecular_weights--output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cobrak.utilities" class="md-nav__link">
    <span class="md-ellipsis">
      utilities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utilities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.add_objective_value_as_extra_linear_constraint" class="md-nav__link">
    <span class="md-ellipsis">
      add_objective_value_as_extra_linear_constraint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.add_statuses_to_optimziation_dict" class="md-nav__link">
    <span class="md-ellipsis">
      add_statuses_to_optimziation_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.apply_error_correction_on_model" class="md-nav__link">
    <span class="md-ellipsis">
      apply_error_correction_on_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.apply_variability_dict" class="md-nav__link">
    <span class="md-ellipsis">
      apply_variability_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.combine_enzyme_reaction_datasets" class="md-nav__link">
    <span class="md-ellipsis">
      combine_enzyme_reaction_datasets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.compare_multiple_results_to_best" class="md-nav__link">
    <span class="md-ellipsis">
      compare_multiple_results_to_best
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.compare_optimization_result_fluxes" class="md-nav__link">
    <span class="md-ellipsis">
      compare_optimization_result_fluxes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.compare_optimization_result_reaction_uses" class="md-nav__link">
    <span class="md-ellipsis">
      compare_optimization_result_reaction_uses
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.count_last_equal_elements" class="md-nav__link">
    <span class="md-ellipsis">
      count_last_equal_elements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.create_cnapy_scenario_out_of_optimization_dict" class="md-nav__link">
    <span class="md-ellipsis">
      create_cnapy_scenario_out_of_optimization_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.create_cnapy_scenario_out_of_variability_dict" class="md-nav__link">
    <span class="md-ellipsis">
      create_cnapy_scenario_out_of_variability_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.delete_orphaned_metabolites_and_enzymes" class="md-nav__link">
    <span class="md-ellipsis">
      delete_orphaned_metabolites_and_enzymes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.delete_unused_reactions_in_optimization_dict" class="md-nav__link">
    <span class="md-ellipsis">
      delete_unused_reactions_in_optimization_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.delete_unused_reactions_in_variability_dict" class="md-nav__link">
    <span class="md-ellipsis">
      delete_unused_reactions_in_variability_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_active_reacs_from_optimization_dict" class="md-nav__link">
    <span class="md-ellipsis">
      get_active_reacs_from_optimization_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_base_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_base_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_base_id_optimzation_result" class="md-nav__link">
    <span class="md-ellipsis">
      get_base_id_optimzation_result
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_cobrak_enzyme_reactions_string" class="md-nav__link">
    <span class="md-ellipsis">
      get_cobrak_enzyme_reactions_string
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_df_and_efficiency_factors_sorted_lists" class="md-nav__link">
    <span class="md-ellipsis">
      get_df_and_efficiency_factors_sorted_lists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_elementary_conservation_relations" class="md-nav__link">
    <span class="md-ellipsis">
      get_elementary_conservation_relations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_enzyme_usage_by_protein_pool_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      get_enzyme_usage_by_protein_pool_fraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_extra_linear_constraint_string" class="md-nav__link">
    <span class="md-ellipsis">
      get_extra_linear_constraint_string
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_full_enzyme_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_full_enzyme_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_full_enzyme_mw" class="md-nav__link">
    <span class="md-ellipsis">
      get_full_enzyme_mw
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_fwd_rev_corrected_flux" class="md-nav__link">
    <span class="md-ellipsis">
      get_fwd_rev_corrected_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_metabolite_consumption_and_production" class="md-nav__link">
    <span class="md-ellipsis">
      get_metabolite_consumption_and_production
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_metabolites_in_elementary_conservation_relations" class="md-nav__link">
    <span class="md-ellipsis">
      get_metabolites_in_elementary_conservation_relations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_dG0s" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_dG0s
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_hill_coefficients" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_hill_coefficients
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_kas" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_kas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_kcats" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_kcats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_kis" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_kis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_kms" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_kms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_kms_by_usage" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_kms_by_usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_max_kcat_times_e_values" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_max_kcat_times_e_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_mws" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_mws
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_with_filled_missing_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_with_filled_missing_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_model_with_varied_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_model_with_varied_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_potentially_active_reactions_in_variability_dict" class="md-nav__link">
    <span class="md-ellipsis">
      get_potentially_active_reactions_in_variability_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_pyomo_solution_as_dict" class="md-nav__link">
    <span class="md-ellipsis">
      get_pyomo_solution_as_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_reaction_enzyme_var_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_reaction_enzyme_var_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_reaction_string" class="md-nav__link">
    <span class="md-ellipsis">
      get_reaction_string
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_reverse_reac_id_if_existing" class="md-nav__link">
    <span class="md-ellipsis">
      get_reverse_reac_id_if_existing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_solver_status_from_pyomo_results" class="md-nav__link">
    <span class="md-ellipsis">
      get_solver_status_from_pyomo_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_stoichiometric_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      get_stoichiometric_matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_stoichiometrically_coupled_reactions" class="md-nav__link">
    <span class="md-ellipsis">
      get_stoichiometrically_coupled_reactions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_substrate_and_product_exchanges" class="md-nav__link">
    <span class="md-ellipsis">
      get_substrate_and_product_exchanges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_termination_condition_from_pyomo_results" class="md-nav__link">
    <span class="md-ellipsis">
      get_termination_condition_from_pyomo_results
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.get_unoptimized_reactions_in_nlp_solution" class="md-nav__link">
    <span class="md-ellipsis">
      get_unoptimized_reactions_in_nlp_solution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.have_all_unignored_km" class="md-nav__link">
    <span class="md-ellipsis">
      have_all_unignored_km
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.is_any_error_term_active" class="md-nav__link">
    <span class="md-ellipsis">
      is_any_error_term_active
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.is_objsense_maximization" class="md-nav__link">
    <span class="md-ellipsis">
      is_objsense_maximization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.last_n_elements_equal" class="md-nav__link">
    <span class="md-ellipsis">
      last_n_elements_equal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.make_kms_better_by_factor" class="md-nav__link">
    <span class="md-ellipsis">
      make_kms_better_by_factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.parse_external_resources" class="md-nav__link">
    <span class="md-ellipsis">
      parse_external_resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.print_model_parameter_statistics" class="md-nav__link">
    <span class="md-ellipsis">
      print_model_parameter_statistics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.sort_dict_keys" class="md-nav__link">
    <span class="md-ellipsis">
      sort_dict_keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cobrak.utilities.split_list" class="md-nav__link">
    <span class="md-ellipsis">
      split_list
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="cobra-k-api-reference">COBRA-k API reference</h1>


<div class="doc doc-object doc-module">



<a id="cobrak"></a>
    <div class="doc doc-contents first">

        <p>COBRAk is a general COBRA/COBRA-k suite written as Python package. For more about it, visit its repository:
https://github.com/klamt-lab/COBRAk</p>
<p>The <strong>init</strong> file of COBRAk initializes the rich text output &amp; tracebacks as well as its logger. Furthermore, graceful
shutdown of user-induced shutdowns is enabled.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="cobrak.exit_signal_handler" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">exit_signal_handler</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Handles the exit signal by printing a shutdown message and exiting the program.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sig</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The signal number.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>frame</code>
            </td>
            <td>
                  <code><span title="Optional">Optional</span>[<span title="types.FrameType">FrameType</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current frame.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">exit_signal_handler</span><span class="p">(</span>
    <span class="n">sig</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">frame</span><span class="p">:</span> <span class="n">FrameType</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handles the exit signal by printing a shutdown message and exiting the program.</span>

<span class="sd">    Args:</span>
<span class="sd">        sig (int): The signal number.</span>
<span class="sd">        frame (Optional[FrameType]): The current frame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;COBRAk received user signal to terminate (this message may appear multiple times in parallelized contexts). Shutting down...&quot;</span>
    <span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cobrak.set_logging_handler" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_logging_handler</span><span class="p">(</span><span class="n">show_path</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_time</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_level</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;warning&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;critical&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Sets up the logging handler with the given options.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>show_path</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show the path. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_time</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show the time. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_level</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show the level. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>keywords</code>
            </td>
            <td>
                  <code><span title="Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The keywords to highlight. Defaults to ["info", "warning", "error", "critical"]</p>
              </div>
            </td>
            <td>
                  <code>[&#39;info&#39;, &#39;warning&#39;, &#39;error&#39;, &#39;critical&#39;]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**args</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional Rich handler arguments.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_logging_handler</span><span class="p">(</span>
    <span class="n">show_path</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_time</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_level</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">keywords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;info&quot;</span><span class="p">,</span>
        <span class="s2">&quot;warning&quot;</span><span class="p">,</span>
        <span class="s2">&quot;error&quot;</span><span class="p">,</span>
        <span class="s2">&quot;critical&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="o">**</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>  <span class="c1"># noqa: ANN401</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RichHandler</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets up the logging handler with the given options.</span>

<span class="sd">    Args:</span>
<span class="sd">        show_path (bool, optional): Whether to show the path. Defaults to False.</span>
<span class="sd">        show_time (bool, optional): Whether to show the time. Defaults to False.</span>
<span class="sd">        show_level (bool, optional): Whether to show the level. Defaults to True.</span>
<span class="sd">        keywords (Dict[str, str], optional): The keywords to highlight. Defaults to [&quot;info&quot;, &quot;warning&quot;, &quot;error&quot;, &quot;critical&quot;]</span>
<span class="sd">        **args (Any, optional): Additional Rich handler arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">RichHandler</span><span class="p">(</span>
        <span class="n">show_path</span><span class="o">=</span><span class="n">show_path</span><span class="p">,</span>
        <span class="n">show_time</span><span class="o">=</span><span class="n">show_time</span><span class="p">,</span>
        <span class="n">show_level</span><span class="o">=</span><span class="n">show_level</span><span class="p">,</span>
        <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
        <span class="o">**</span><span class="n">args</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cobrak.set_logging_level" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_logging_level</span><span class="p">(</span><span class="n">level</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Sets the logging level.</p>
<p>E.g. INFO, ERROR, WARNING and CRITICAL from Python's logging module.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>level</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The logging level.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_logging_level</span><span class="p">(</span><span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the logging level.</span>

<span class="sd">    E.g. INFO, ERROR, WARNING and CRITICAL from Python&#39;s logging module.</span>

<span class="sd">    Args:</span>
<span class="sd">        level (int): The logging level.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="cobrak.setup_rich_tracebacks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">setup_rich_tracebacks</span><span class="p">(</span><span class="n">show_locals</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Sets up rich tracebacks with the given options.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>show_locals</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show local variables in the traceback.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">setup_rich_tracebacks</span><span class="p">(</span><span class="n">show_locals</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets up rich tracebacks with the given options.</span>

<span class="sd">    Args:</span>
<span class="sd">        show_locals (bool): Whether to show local variables in the traceback.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">install</span><span class="p">(</span><span class="n">show_locals</span><span class="o">=</span><span class="n">show_locals</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>


<div class="doc doc-object doc-module">



<h2 id="cobrak.bigg_metabolites_functionality" class="doc doc-heading">
            <code>bigg_metabolites_functionality</code>


</h2>

    <div class="doc doc-contents ">

        <p>bigg_parse_metabolites_file.py</p>
<p>This module contains a function which transforms a BIGG metabolites .txt list
into an machine-readable JSON.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.bigg_metabolites_functionality.bigg_parse_metabolites_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bigg_parse_metabolites_file</span><span class="p">(</span><span class="n">bigg_metabolites_txt_path</span><span class="p">,</span> <span class="n">bigg_metabolites_json_path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parses a BIGG metabolites text file and returns a dictionary for this file.</p>
<p>As of Sep 14 2024, a BIGG metabolites list of all BIGG-included metabolites
is retrievable under http://bigg.ucsd.edu/data_access</p>
<h5 id="cobrak.bigg_metabolites_functionality.bigg_parse_metabolites_file--arguments">Arguments</h5>
<ul>
<li>bigg_metabolites_file_path: str ~ The file path to the BIGG metabolites file.
  The usual file name (which has to be included too in this argument) is
  bigg_models_metabolites.txt</li>
<li>output_folder: str ~ The folder in which the JSON including the parsed BIGG
  metabolites file data is stored with the name 'bigg_id_name_mapping.json'</li>
</ul>
<h5 id="cobrak.bigg_metabolites_functionality.bigg_parse_metabolites_file--output">Output</h5>
<ul>
<li>A JSON file with the name 'bigg_id_name_mapping.json' in the given output folder,
  with the following structure:</li>
</ul>
<pre>
 {
     "$BIGG_ID": "$CHEMICAL_OR_USUAL_NAME",
     (...),
     "$BIGG_ID": "$BIGG_ID",
     (...),
 }
</pre>
<p>The BIGG ID &lt;-&gt; BIGG ID mapping is done for models which already use the BIGG IDs.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/bigg_metabolites_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">bigg_parse_metabolites_file</span><span class="p">(</span>
    <span class="n">bigg_metabolites_txt_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">bigg_metabolites_json_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses a BIGG metabolites text file and returns a dictionary for this file.</span>

<span class="sd">    As of Sep 14 2024, a BIGG metabolites list of all BIGG-included metabolites</span>
<span class="sd">    is retrievable under http://bigg.ucsd.edu/data_access</span>

<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">    * bigg_metabolites_file_path: str ~ The file path to the BIGG metabolites file.</span>
<span class="sd">      The usual file name (which has to be included too in this argument) is</span>
<span class="sd">      bigg_models_metabolites.txt</span>
<span class="sd">    * output_folder: str ~ The folder in which the JSON including the parsed BIGG</span>
<span class="sd">      metabolites file data is stored with the name &#39;bigg_id_name_mapping.json&#39;</span>

<span class="sd">    Output</span>
<span class="sd">    ----------</span>
<span class="sd">    * A JSON file with the name &#39;bigg_id_name_mapping.json&#39; in the given output folder,</span>
<span class="sd">      with the following structure:</span>
<span class="sd">    &lt;pre&gt;</span>
<span class="sd">     {</span>
<span class="sd">         &quot;$BIGG_ID&quot;: &quot;$CHEMICAL_OR_USUAL_NAME&quot;,</span>
<span class="sd">         (...),</span>
<span class="sd">         &quot;$BIGG_ID&quot;: &quot;$BIGG_ID&quot;,</span>
<span class="sd">         (...),</span>
<span class="sd">     }</span>
<span class="sd">    &lt;/pre&gt;</span>
<span class="sd">    The BIGG ID &lt;-&gt; BIGG ID mapping is done for models which already use the BIGG IDs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Open the BIGG metabolites file as string list, and remove all newlines</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">bigg_metabolites_txt_path</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lines</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Mapping variable which will store the BIGG ID&lt;-&gt;</span>
    <span class="n">bigg_id_name_mapping</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># Go through each BIGG metabolites file line (which is a tab-separated file)</span>
    <span class="c1"># and retrieve the BIGG ID and the name (if there is a name for the given BIGG</span>
    <span class="c1"># ID)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">bigg_id</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">bigg_id_name_mapping</span><span class="p">[</span><span class="n">bigg_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">bigg_id</span>

        <span class="c1"># Exception to check if there is no name :O</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">bigg_id_name_mapping</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">bigg_id</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">database_links</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">database_link_part</span> <span class="ow">in</span> <span class="n">database_links</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;: &quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;CHEBI:&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">database_link_part</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">subpart</span> <span class="o">=</span> <span class="n">database_link_part</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;CHEBI:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">chebi_id</span> <span class="o">=</span> <span class="n">subpart</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;; &quot;</span> <span class="ow">in</span> <span class="n">subpart</span> <span class="k">else</span> <span class="n">subpart</span>
            <span class="n">bigg_id_name_mapping</span><span class="p">[</span><span class="n">chebi_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">bigg_id</span>

    <span class="c1"># Write the JSON in the given folder :D</span>
    <span class="n">json_write</span><span class="p">(</span><span class="n">bigg_metabolites_json_path</span><span class="p">,</span> <span class="n">bigg_id_name_mapping</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.brenda_functionality" class="doc doc-heading">
            <code>brenda_functionality</code>


</h2>

    <div class="doc doc-contents ">

        <p>Contains functions which allow one to create a model-specific and BRENDA-depending kinetic data database.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.brenda_functionality.brenda_select_enzyme_kinetic_data_for_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">brenda_select_enzyme_kinetic_data_for_model</span><span class="p">(</span><span class="n">cobra_model</span><span class="p">,</span> <span class="n">brenda_json_targz_file_path</span><span class="p">,</span> <span class="n">bigg_metabolites_json_path</span><span class="p">,</span> <span class="n">brenda_version</span><span class="p">,</span> <span class="n">base_species</span><span class="p">,</span> <span class="n">ncbi_parsed_json_path</span><span class="p">,</span> <span class="n">kinetic_ignored_metabolites</span><span class="o">=</span><span class="p">[],</span> <span class="n">kinetic_ignored_enzyme_ids</span><span class="o">=</span><span class="p">[],</span> <span class="n">custom_enzyme_kinetic_data</span><span class="o">=</span><span class="p">{},</span> <span class="n">min_ph</span><span class="o">=-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">max_ph</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">accept_nan_ph</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_temperature</span><span class="o">=-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">max_temperature</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">accept_nan_temperature</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kcat_overwrite</span><span class="o">=</span><span class="p">{},</span> <span class="n">transfered_ec_number_json</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">max_taxonomy_level</span><span class="o">=</span><span class="mf">1000000000.0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Select and assign enzyme kinetic data for each reaction in a COBRApy model based on BRENDA
database entries and taxonomic similarity.</p>
<p>This function retrieves enzyme kinetic data from a compressed BRENDA JSON file, merges it
with BiGG metabolite translation data and taxonomy information from NCBI. It then iterates
over the reactions in the provided COBRApy model to:</p>
<ul>
<li>Filter reactions that have EC code annotations.</li>
<li>Identify eligible EC codes (ignoring those with hyphens).</li>
<li>Collect kinetic entries (e.g., turnover numbers, KM values, KI values) for each metabolite
    involved in the reaction.</li>
<li>Choose the best kinetic parameters (k_cat, k_ms, k_is) based on taxonomic similarity to
    a base species.</li>
<li>Apply conversion factors (e.g., s to h for k_cat, mM to M for KM and KI).</li>
<li>Respect ignore lists for metabolites and enzymes.</li>
<li>Override computed k_cat values if provided in the kcat_overwrite dictionary.</li>
<li>Merge with any custom enzyme kinetic data provided.</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobra_model</code>
            </td>
            <td>
                  <code><span title="cobra.Model">Model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A COBRApy model object representing the metabolic network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>brenda_json_targz_file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the compressed JSON file containing
BRENDA enzyme kinetic data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bigg_metabolites_json_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the JSON file mapping metabolite IDs to
BiGG identifiers.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>brenda_version</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String identifier for the BRENDA database version.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_species</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Species identifier used as the reference for taxonomic similarity.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ncbi_parsed_json_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the parsed JSON file containing NCBI taxonomy data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kinetic_ignored_metabolites</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of metabolite IDs to exclude
from kinetic parameter selection. Defaults to an empty list.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kinetic_ignored_enzyme_ids</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of enzyme identifiers to ignore
when considering a reaction. Defaults to an empty list.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>custom_enzyme_kinetic_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="EnzymeReactionData (cobrak.dataclasses.EnzymeReactionData)" href="#cobrak.dataclasses.EnzymeReactionData">EnzymeReactionData</a> | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of custom enzyme kinetic data to override or supplement computed data.
The keys are reaction IDs and the values are EnzymeReactionData instances or None.
Defaults to an empty dictionary.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_ph</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum pH value for kinetic data inclusion. Defaults
to negative infinity.</p>
              </div>
            </td>
            <td>
                  <code>-<span title="float">float</span>(&#39;inf&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_ph</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum pH value for kinetic data inclusion. Defaults
to positive infinity.</p>
              </div>
            </td>
            <td>
                  <code><span title="float">float</span>(&#39;inf&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>accept_nan_ph</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, kinetic entries with NaN pH values are accepted.
Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_temperature</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum temperature value (e.g., in Kelvin) for
kinetic data inclusion. Defaults to negative infinity.</p>
              </div>
            </td>
            <td>
                  <code>-<span title="float">float</span>(&#39;inf&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_temperature</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum temperature value for kinetic data inclusion.
Defaults to positive infinity.</p>
              </div>
            </td>
            <td>
                  <code><span title="float">float</span>(&#39;inf&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>accept_nan_temperature</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, kinetic entries with NaN temperature values
are accepted. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kcat_overwrite</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping reaction IDs to k_cat values
that should override computed values. Defaults to an empty dictionary.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="EnzymeReactionData (cobrak.dataclasses.EnzymeReactionData)" href="#cobrak.dataclasses.EnzymeReactionData">EnzymeReactionData</a> | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, EnzymeReactionData | None]:
A dictionary mapping reaction IDs (str) from the COBRApy model to their corresponding
EnzymeReactionData instances. If no suitable kinetic data are found (or if the enzyme
is in the ignore list), the value will be None for that reaction.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Kinetic values are converted to standardized units:<ul>
<li>k_cat values are converted from s to h.</li>
<li>KM and KI values are converted from mM to M.</li>
</ul>
</li>
<li>The function leverages taxonomic similarity (using NCBI TAXONOMY data)
  to select the most relevant kinetic values.</li>
<li>Custom enzyme kinetic data and k_cat overrides will replace any computed values.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>cobrak/brenda_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">brenda_select_enzyme_kinetic_data_for_model</span><span class="p">(</span>
    <span class="n">cobra_model</span><span class="p">:</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span>
    <span class="n">brenda_json_targz_file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">bigg_metabolites_json_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">brenda_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">base_species</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">ncbi_parsed_json_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">kinetic_ignored_metabolites</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">kinetic_ignored_enzyme_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">custom_enzyme_kinetic_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EnzymeReactionData</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">min_ph</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
    <span class="n">max_ph</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
    <span class="n">accept_nan_ph</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">min_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
    <span class="n">max_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
    <span class="n">accept_nan_temperature</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kcat_overwrite</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">transfered_ec_number_json</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">max_taxonomy_level</span><span class="p">:</span> <span class="n">NonNegativeInt</span> <span class="o">=</span> <span class="mf">1e9</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EnzymeReactionData</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Select and assign enzyme kinetic data for each reaction in a COBRApy model based on BRENDA</span>
<span class="sd">    database entries and taxonomic similarity.</span>

<span class="sd">    This function retrieves enzyme kinetic data from a compressed BRENDA JSON file, merges it</span>
<span class="sd">    with BiGG metabolite translation data and taxonomy information from NCBI. It then iterates</span>
<span class="sd">    over the reactions in the provided COBRApy model to:</span>

<span class="sd">      - Filter reactions that have EC code annotations.</span>
<span class="sd">      - Identify eligible EC codes (ignoring those with hyphens).</span>
<span class="sd">      - Collect kinetic entries (e.g., turnover numbers, KM values, KI values) for each metabolite</span>
<span class="sd">        involved in the reaction.</span>
<span class="sd">      - Choose the best kinetic parameters (k_cat, k_ms, k_is) based on taxonomic similarity to</span>
<span class="sd">        a base species.</span>
<span class="sd">      - Apply conversion factors (e.g., s to h for k_cat, mM to M for KM and KI).</span>
<span class="sd">      - Respect ignore lists for metabolites and enzymes.</span>
<span class="sd">      - Override computed k_cat values if provided in the kcat_overwrite dictionary.</span>
<span class="sd">      - Merge with any custom enzyme kinetic data provided.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        cobra_model (cobra.Model): A COBRApy model object representing the metabolic network.</span>
<span class="sd">        brenda_json_targz_file_path (str): Path to the compressed JSON file containing</span>
<span class="sd">            BRENDA enzyme kinetic data.</span>
<span class="sd">        bigg_metabolites_json_path (str): Path to the JSON file mapping metabolite IDs to</span>
<span class="sd">            BiGG identifiers.</span>
<span class="sd">        brenda_version (str): String identifier for the BRENDA database version.</span>
<span class="sd">        base_species (str): Species identifier used as the reference for taxonomic similarity.</span>
<span class="sd">        ncbi_parsed_json_path (str): Path to the parsed JSON file containing NCBI taxonomy data.</span>
<span class="sd">        kinetic_ignored_metabolites (list[str], optional): List of metabolite IDs to exclude</span>
<span class="sd">            from kinetic parameter selection. Defaults to an empty list.</span>
<span class="sd">        kinetic_ignored_enzyme_ids (list[str], optional): List of enzyme identifiers to ignore</span>
<span class="sd">            when considering a reaction. Defaults to an empty list.</span>
<span class="sd">        custom_enzyme_kinetic_data (dict[str, EnzymeReactionData | None], optional):</span>
<span class="sd">            Dictionary of custom enzyme kinetic data to override or supplement computed data.</span>
<span class="sd">            The keys are reaction IDs and the values are EnzymeReactionData instances or None.</span>
<span class="sd">            Defaults to an empty dictionary.</span>
<span class="sd">        min_ph (float, optional): The minimum pH value for kinetic data inclusion. Defaults</span>
<span class="sd">            to negative infinity.</span>
<span class="sd">        max_ph (float, optional): The maximum pH value for kinetic data inclusion. Defaults</span>
<span class="sd">            to positive infinity.</span>
<span class="sd">        accept_nan_ph (bool, optional): If True, kinetic entries with NaN pH values are accepted.</span>
<span class="sd">            Defaults to True.</span>
<span class="sd">        min_temperature (float, optional): The minimum temperature value (e.g., in Kelvin) for</span>
<span class="sd">            kinetic data inclusion. Defaults to negative infinity.</span>
<span class="sd">        max_temperature (float, optional): The maximum temperature value for kinetic data inclusion.</span>
<span class="sd">            Defaults to positive infinity.</span>
<span class="sd">        accept_nan_temperature (bool, optional): If True, kinetic entries with NaN temperature values</span>
<span class="sd">            are accepted. Defaults to True.</span>
<span class="sd">        kcat_overwrite (dict[str, float], optional): Dictionary mapping reaction IDs to k_cat values</span>
<span class="sd">            that should override computed values. Defaults to an empty dictionary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, EnzymeReactionData | None]:</span>
<span class="sd">            A dictionary mapping reaction IDs (str) from the COBRApy model to their corresponding</span>
<span class="sd">            EnzymeReactionData instances. If no suitable kinetic data are found (or if the enzyme</span>
<span class="sd">            is in the ignore list), the value will be None for that reaction.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Kinetic values are converted to standardized units:</span>
<span class="sd">            - k_cat values are converted from s to h.</span>
<span class="sd">            - KM and KI values are converted from mM to M.</span>
<span class="sd">        - The function leverages taxonomic similarity (using NCBI TAXONOMY data)</span>
<span class="sd">          to select the most relevant kinetic values.</span>
<span class="sd">        - Custom enzyme kinetic data and k_cat overrides will replace any computed values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">transfered_ec_codes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">json_load</span><span class="p">(</span><span class="n">transfered_ec_number_json</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">transfered_ec_number_json</span>
        <span class="k">else</span> <span class="p">{}</span>
    <span class="p">)</span>
    <span class="n">brenda_database_for_model</span> <span class="o">=</span> <span class="n">_brenda_get_all_enzyme_kinetic_data_for_model</span><span class="p">(</span>
        <span class="n">cobra_model</span><span class="p">,</span>
        <span class="n">brenda_json_targz_file_path</span><span class="p">,</span>
        <span class="n">bigg_metabolites_json_path</span><span class="p">,</span>
        <span class="n">brenda_version</span><span class="p">,</span>
        <span class="n">min_ph</span><span class="p">,</span>
        <span class="n">max_ph</span><span class="p">,</span>
        <span class="n">accept_nan_ph</span><span class="p">,</span>
        <span class="n">min_temperature</span><span class="p">,</span>
        <span class="n">max_temperature</span><span class="p">,</span>
        <span class="n">accept_nan_temperature</span><span class="p">,</span>
        <span class="n">transfered_ec_codes</span><span class="o">=</span><span class="n">transfered_ec_codes</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ncbi_parsed_json_data</span> <span class="o">=</span> <span class="n">json_zip_load</span><span class="p">(</span><span class="n">ncbi_parsed_json_path</span><span class="p">)</span>

    <span class="n">bigg_metabolites_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">json_load</span><span class="p">(</span>
        <span class="n">bigg_metabolites_json_path</span><span class="p">,</span>
        <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="c1"># Get reaction&lt;-&gt;enzyme reaction data mapping</span>
    <span class="n">enzyme_reaction_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EnzymeReactionData</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;ec-code&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">substrate_names_and_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">metabolite</span><span class="p">,</span> <span class="n">stoichiometry</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">stoichiometry</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">substrate_names_and_ids</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()))</span>
                <span class="k">for</span> <span class="n">checked_string</span> <span class="ow">in</span> <span class="p">(</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
                    <span class="n">bigg_id</span> <span class="o">=</span> <span class="n">_search_metname_in_bigg_ids</span><span class="p">(</span>
                        <span class="n">checked_string</span><span class="p">,</span>
                        <span class="n">bigg_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">entry</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">name_to_bigg_id_dict</span><span class="o">=</span><span class="n">bigg_metabolites_data</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">bigg_id</span><span class="p">:</span>
                        <span class="n">substrate_names_and_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bigg_id</span><span class="p">)</span>
        <span class="n">substrate_names_and_ids_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">substrate_names_and_ids</span><span class="p">)</span>

        <span class="n">reaction_ec_codes</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;ec-code&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reaction_ec_codes</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">reaction_ec_codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">reaction_ec_codes</span><span class="p">]</span>
        <span class="n">eligible_reaction_ec_codes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ec_code</span>
            <span class="k">for</span> <span class="n">ec_code</span> <span class="ow">in</span> <span class="n">reaction_ec_codes</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ec_code</span> <span class="ow">in</span> <span class="n">brenda_database_for_model</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ec_code</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">reaction_transfered_ec_codes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ec_code</span> <span class="ow">in</span> <span class="n">eligible_reaction_ec_codes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ec_code</span> <span class="ow">in</span> <span class="n">transfered_ec_codes</span><span class="p">:</span>
                <span class="n">single_transfered_ec_code</span> <span class="o">=</span> <span class="n">transfered_ec_codes</span><span class="p">[</span><span class="n">ec_code</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">single_transfered_ec_code</span> <span class="ow">in</span> <span class="n">brenda_database_for_model</span><span class="p">:</span>
                    <span class="n">reaction_transfered_ec_codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">single_transfered_ec_code</span><span class="p">)</span>
        <span class="n">eligible_reaction_ec_codes</span> <span class="o">+=</span> <span class="n">reaction_transfered_ec_codes</span>

        <span class="n">metabolite_entries</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">ec_code</span> <span class="ow">in</span> <span class="n">eligible_reaction_ec_codes</span><span class="p">:</span>
            <span class="n">ec_code_entry</span> <span class="o">=</span> <span class="n">brenda_database_for_model</span><span class="p">[</span><span class="n">ec_code</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">ec_code_entry</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">met_id</span> <span class="o">==</span> <span class="s2">&quot;WILDCARD&quot;</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">metabolite_entries</span><span class="p">:</span>
                    <span class="n">metabolite_entries</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">organism</span> <span class="ow">in</span> <span class="n">ec_code_entry</span><span class="p">[</span><span class="n">met_id</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">organism</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">metabolite_entries</span><span class="p">[</span><span class="n">met_id</span><span class="p">]:</span>
                        <span class="n">metabolite_entries</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="n">organism</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">metabolite_entries</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="n">organism</span><span class="p">]</span> <span class="o">+=</span> <span class="n">ec_code_entry</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span>
                        <span class="n">organism</span>
                    <span class="p">]</span>

        <span class="c1"># Choose kcats and kms taxonomically</span>
        <span class="n">best_kcat_taxonomy_level</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
        <span class="n">best_km_taxonomy_levels</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">metabolite</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">metabolites</span>
        <span class="p">}</span>
        <span class="n">best_ki_taxonomy_levels</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">metabolite</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">metabolites</span>
        <span class="p">}</span>
        <span class="n">taxonomically_best_kcats</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">taxonomically_best_kms</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">taxonomically_best_kis</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">k_cat_references</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">k_m_references</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">k_i_references</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">metabolite</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">:</span>
            <span class="n">idx_last_underscore</span> <span class="o">=</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="n">met_id</span> <span class="o">=</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">[:</span><span class="n">idx_last_underscore</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">kinetic_ignored_metabolites</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">metabolite_entries</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">organisms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">metabolite_entries</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">base_species</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">organisms</span><span class="p">:</span>
                <span class="n">organisms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">base_species</span><span class="p">)</span>
            <span class="n">taxonomy_dict</span> <span class="o">=</span> <span class="n">get_taxonomy_dict_from_nbci_taxonomy</span><span class="p">(</span>
                <span class="n">organisms</span><span class="p">,</span> <span class="n">ncbi_parsed_json_data</span>
            <span class="p">)</span>
            <span class="n">taxonomy_similarities</span> <span class="o">=</span> <span class="n">most_taxonomic_similar</span><span class="p">(</span><span class="n">base_species</span><span class="p">,</span> <span class="n">taxonomy_dict</span><span class="p">)</span>
            <span class="n">highest_taxonomy_level</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">taxonomy_similarities</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">taxonomy_level</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">highest_taxonomy_level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">taxonomy_level</span> <span class="o">&gt;</span> <span class="n">max_taxonomy_level</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">level_organisms</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">organism</span>
                    <span class="k">for</span> <span class="n">organism</span> <span class="ow">in</span> <span class="n">organisms</span>
                    <span class="k">if</span> <span class="n">taxonomy_similarities</span><span class="p">[</span><span class="n">organism</span><span class="p">]</span> <span class="o">==</span> <span class="n">taxonomy_level</span>
                <span class="p">]</span>
                <span class="k">for</span> <span class="n">level_organism</span> <span class="ow">in</span> <span class="n">level_organisms</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">level_organism</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">metabolite_entries</span><span class="p">[</span><span class="n">met_id</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span>
                        <span class="n">level_organism</span> <span class="o">==</span> <span class="n">base_species</span>
                    <span class="p">):</span>  <span class="c1"># I.e., if it is the base species</span>
                        <span class="k">continue</span>
                    <span class="n">kinetic_entries</span> <span class="o">=</span> <span class="n">metabolite_entries</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="n">level_organism</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">taxonomy_level</span> <span class="o">&lt;=</span> <span class="n">best_kcat_taxonomy_level</span><span class="p">:</span>
                        <span class="n">kcat_entries</span> <span class="o">=</span> <span class="p">[</span>
                            <span class="n">km_kcat_entry</span>
                            <span class="k">for</span> <span class="n">km_kcat_entry</span> <span class="ow">in</span> <span class="n">kinetic_entries</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">km_kcat_entry</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;turnover_number&quot;</span><span class="p">)</span>
                            <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
                                <span class="n">substrate_names_and_ids_set</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="n">km_kcat_entry</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
                            <span class="p">)</span>
                        <span class="p">]</span>

                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kcat_entries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">if</span> <span class="p">(</span>
                                <span class="n">best_kcat_taxonomy_level</span> <span class="o">&gt;</span> <span class="n">taxonomy_level</span>
                            <span class="p">):</span>  <span class="c1"># &quot;Erase&quot; if we find a better level</span>
                                <span class="n">taxonomically_best_kcats</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="n">best_kcat_taxonomy_level</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                                <span class="n">taxonomy_level</span><span class="p">,</span> <span class="n">best_kcat_taxonomy_level</span>
                            <span class="p">)</span>
                            <span class="k">if</span> <span class="n">taxonomy_level</span> <span class="o">&lt;=</span> <span class="n">best_kcat_taxonomy_level</span><span class="p">:</span>
                                <span class="k">for</span> <span class="n">kcat_entry</span> <span class="ow">in</span> <span class="n">kcat_entries</span><span class="p">:</span>
                                    <span class="n">taxonomically_best_kcats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">kcat_entry</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3_600</span>
                                    <span class="p">)</span>  <span class="c1"># convert from s to h</span>
                                    <span class="n">k_cat_references</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">ParameterReference</span><span class="p">(</span>
                                            <span class="n">database</span><span class="o">=</span><span class="s2">&quot;BRENDA&quot;</span><span class="p">,</span>
                                            <span class="n">comment</span><span class="o">=</span><span class="n">kcat_entry</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                                            <span class="n">species</span><span class="o">=</span><span class="n">level_organism</span><span class="p">,</span>
                                            <span class="n">pubs</span><span class="o">=</span><span class="n">kcat_entry</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                            <span class="n">substrate</span><span class="o">=</span><span class="n">kcat_entry</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                                            <span class="n">tax_distance</span><span class="o">=</span><span class="n">taxonomy_level</span><span class="p">,</span>
                                            <span class="n">value</span><span class="o">=</span><span class="n">kcat_entry</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3_600</span><span class="p">,</span>
                                        <span class="p">)</span>
                                    <span class="p">)</span>

                    <span class="k">if</span> <span class="n">taxonomy_level</span> <span class="o">&lt;=</span> <span class="n">best_km_taxonomy_levels</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]:</span>
                        <span class="n">km_entries</span> <span class="o">=</span> <span class="p">[</span>
                            <span class="n">km_kcat_entry</span>
                            <span class="k">for</span> <span class="n">km_kcat_entry</span> <span class="ow">in</span> <span class="n">kinetic_entries</span>
                            <span class="k">if</span> <span class="n">km_kcat_entry</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;km_value&quot;</span>
                            <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
                                <span class="n">substrate_names_and_ids_set</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="n">km_kcat_entry</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
                            <span class="p">)</span>
                        <span class="p">]</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">km_entries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">taxonomically_best_kms</span><span class="p">:</span>
                                <span class="n">taxonomically_best_kms</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                                <span class="n">k_m_references</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">if</span> <span class="p">(</span>
                                <span class="n">best_km_taxonomy_levels</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">taxonomy_level</span>
                            <span class="p">):</span>  <span class="c1"># &quot;Erase&quot; if we find a better level</span>
                                <span class="n">taxonomically_best_kms</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="n">best_km_taxonomy_levels</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                                <span class="n">taxonomy_level</span><span class="p">,</span> <span class="n">best_km_taxonomy_levels</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>
                            <span class="p">)</span>
                            <span class="k">if</span> <span class="n">taxonomy_level</span> <span class="o">&lt;=</span> <span class="n">best_km_taxonomy_levels</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]:</span>
                                <span class="k">for</span> <span class="n">km_entry</span> <span class="ow">in</span> <span class="n">km_entries</span><span class="p">:</span>
                                    <span class="n">taxonomically_best_kms</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">km_entry</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1_000</span>
                                    <span class="p">)</span>  <span class="c1"># convert from mM to M</span>
                                    <span class="n">k_m_references</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">ParameterReference</span><span class="p">(</span>
                                            <span class="n">database</span><span class="o">=</span><span class="s2">&quot;BRENDA&quot;</span><span class="p">,</span>
                                            <span class="n">comment</span><span class="o">=</span><span class="n">km_entry</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                                            <span class="n">species</span><span class="o">=</span><span class="n">level_organism</span><span class="p">,</span>
                                            <span class="n">pubs</span><span class="o">=</span><span class="n">km_entry</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                            <span class="n">substrate</span><span class="o">=</span><span class="n">km_entry</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                                            <span class="n">tax_distance</span><span class="o">=</span><span class="n">taxonomy_level</span><span class="p">,</span>
                                            <span class="n">value</span><span class="o">=</span><span class="n">km_entry</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1_000</span><span class="p">,</span>
                                        <span class="p">)</span>
                                    <span class="p">)</span>

                    <span class="k">if</span> <span class="n">taxonomy_level</span> <span class="o">&lt;=</span> <span class="n">best_ki_taxonomy_levels</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]:</span>
                        <span class="n">ki_entries</span> <span class="o">=</span> <span class="p">[</span>
                            <span class="n">kinetic_entry</span>
                            <span class="k">for</span> <span class="n">kinetic_entry</span> <span class="ow">in</span> <span class="n">kinetic_entries</span>
                            <span class="k">if</span> <span class="n">kinetic_entry</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;ki_value&quot;</span>
                            <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
                                <span class="n">substrate_names_and_ids_set</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="n">kinetic_entry</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
                            <span class="p">)</span>
                        <span class="p">]</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ki_entries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">taxonomically_best_kis</span><span class="p">:</span>
                                <span class="n">taxonomically_best_kis</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                                <span class="n">k_i_references</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="k">if</span> <span class="p">(</span>
                                <span class="n">best_ki_taxonomy_levels</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">taxonomy_level</span>
                            <span class="p">):</span>  <span class="c1"># &quot;Erase&quot; if we find a better level</span>
                                <span class="n">taxonomically_best_kis</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="n">best_ki_taxonomy_levels</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                                <span class="n">taxonomy_level</span><span class="p">,</span> <span class="n">best_ki_taxonomy_levels</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>
                            <span class="p">)</span>
                            <span class="k">if</span> <span class="n">taxonomy_level</span> <span class="o">&lt;=</span> <span class="n">best_ki_taxonomy_levels</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]:</span>
                                <span class="k">for</span> <span class="n">ki_entry</span> <span class="ow">in</span> <span class="n">ki_entries</span><span class="p">:</span>
                                    <span class="n">taxonomically_best_kis</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">ki_entry</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1_000</span>
                                    <span class="p">)</span>  <span class="c1"># convert from mM to M</span>
                                    <span class="n">k_i_references</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                        <span class="n">ParameterReference</span><span class="p">(</span>
                                            <span class="n">database</span><span class="o">=</span><span class="s2">&quot;BRENDA&quot;</span><span class="p">,</span>
                                            <span class="n">comment</span><span class="o">=</span><span class="n">ki_entry</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                                            <span class="n">species</span><span class="o">=</span><span class="n">level_organism</span><span class="p">,</span>
                                            <span class="n">pubs</span><span class="o">=</span><span class="n">ki_entry</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                            <span class="n">substrate</span><span class="o">=</span><span class="n">ki_entry</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                                            <span class="n">value</span><span class="o">=</span><span class="n">ki_entry</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1_000</span><span class="p">,</span>
                                            <span class="n">tax_distance</span><span class="o">=</span><span class="n">taxonomy_level</span><span class="p">,</span>
                                        <span class="p">)</span>
                                    <span class="p">)</span>

        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">kcat_overwrite</span><span class="p">:</span>
            <span class="n">taxonomically_best_kcats</span> <span class="o">=</span> <span class="p">[</span><span class="n">kcat_overwrite</span><span class="p">[</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">]]</span>
            <span class="n">k_cat_references</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">ParameterReference</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s2">&quot;OVERWRITE&quot;</span><span class="p">,</span> <span class="n">tax_distance</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">taxonomically_best_kcats</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">reaction_kms</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">taxonomically_best_kms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">metabolites</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="n">reaction_kms</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

        <span class="n">reaction_kis</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">taxonomically_best_kis</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">taxonomically_best_kis</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">reaction_kis</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span><span class="n">taxonomically_best_kis</span><span class="p">[</span><span class="n">met_id</span><span class="p">])</span>

        <span class="n">enzyme_identifiers</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">gene_reaction_rule</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; and &quot;</span><span class="p">)</span>
        <span class="n">has_found_ignored_enzyme</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">enzyme_identifier</span> <span class="ow">in</span> <span class="n">enzyme_identifiers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">enzyme_identifier</span> <span class="ow">in</span> <span class="n">kinetic_ignored_enzyme_ids</span><span class="p">:</span>
                <span class="n">has_found_ignored_enzyme</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">taxonomically_best_kcats</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">has_found_ignored_enzyme</span><span class="p">):</span>
            <span class="n">reaction_kcat</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span><span class="n">taxonomically_best_kcats</span><span class="p">)</span>  <span class="c1"># or max(), min(), ...</span>
            <span class="n">enzyme_reaction_data</span><span class="p">[</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnzymeReactionData</span><span class="p">(</span>
                <span class="n">identifiers</span><span class="o">=</span><span class="n">enzyme_identifiers</span><span class="p">,</span>
                <span class="n">k_cat</span><span class="o">=</span><span class="n">reaction_kcat</span><span class="p">,</span>
                <span class="n">k_cat_references</span><span class="o">=</span><span class="n">k_cat_references</span><span class="p">,</span>
                <span class="n">k_ms</span><span class="o">=</span><span class="n">reaction_kms</span><span class="p">,</span>
                <span class="n">k_m_references</span><span class="o">=</span><span class="n">k_m_references</span><span class="p">,</span>
                <span class="n">k_is</span><span class="o">=</span><span class="n">reaction_kis</span><span class="p">,</span>
                <span class="n">k_i_references</span><span class="o">=</span><span class="n">k_i_references</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">enzyme_reaction_data</span><span class="p">[</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">enzyme_reaction_data</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">enzyme_reaction_data</span><span class="p">,</span> <span class="o">**</span><span class="n">custom_enzyme_kinetic_data</span><span class="p">}</span>

    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">kcat_overwrite</span><span class="p">:</span>  <span class="c1"># noqa: PLC0206</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">enzyme_reaction_data</span><span class="p">:</span>
            <span class="n">reaction</span> <span class="o">=</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>
            <span class="n">enzyme_identifiers</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">gene_reaction_rule</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; and &quot;</span><span class="p">)</span>
            <span class="n">enzyme_reaction_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnzymeReactionData</span><span class="p">(</span>
                <span class="n">identifiers</span><span class="o">=</span><span class="n">enzyme_identifiers</span><span class="p">,</span>
                <span class="n">k_cat</span><span class="o">=</span><span class="n">kcat_overwrite</span><span class="p">[</span><span class="n">reac_id</span><span class="p">],</span>
                <span class="n">k_cat_references</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">ParameterReference</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s2">&quot;OVERWRITE&quot;</span><span class="p">,</span> <span class="n">tax_distance</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
                <span class="p">],</span>
                <span class="n">k_ms</span><span class="o">=</span><span class="p">{},</span>
                <span class="n">k_is</span><span class="o">=</span><span class="p">{},</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">enzyme_reaction_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.cobrapy_model_functionality" class="doc doc-heading">
            <code>cobrapy_model_functionality</code>


</h2>

    <div class="doc doc-contents ">

        <p>Contains methods that directly apply on COBRApy models.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.cobrapy_model_functionality.create_irreversible_cobrapy_model_from_stoichiometries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_irreversible_cobrapy_model_from_stoichiometries</span><span class="p">(</span><span class="n">stoichiometries</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create an irreversible COBRApy model out of the given dictionary.</p>
<p>E.g., if the following dict is the argument:
{
    "EX_A": { "A": +1 },
    "R1": { "A": -1, "B": +1 },
    "EX_B": { "B": -1 },
}
...then, the following three irreversible (i.e, flux from 0 to 1_000) reactions
are created and returned as a single COBRApy model:
EX_A: -&gt; A
R1: A -&gt; B
EX_B: B -&gt;</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>stoichiometries</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model-describing dictionary</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="cobra.Model">Model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>cobra.Model: The resulting COBRApy model with the given reactions and metabolites</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/cobrapy_model_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_irreversible_cobrapy_model_from_stoichiometries</span><span class="p">(</span>
    <span class="n">stoichiometries</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an irreversible COBRApy model out of the given dictionary.</span>

<span class="sd">    E.g., if the following dict is the argument:</span>
<span class="sd">    {</span>
<span class="sd">        &quot;EX_A&quot;: { &quot;A&quot;: +1 },</span>
<span class="sd">        &quot;R1&quot;: { &quot;A&quot;: -1, &quot;B&quot;: +1 },</span>
<span class="sd">        &quot;EX_B&quot;: { &quot;B&quot;: -1 },</span>
<span class="sd">    }</span>
<span class="sd">    ...then, the following three irreversible (i.e, flux from 0 to 1_000) reactions</span>
<span class="sd">    are created and returned as a single COBRApy model:</span>
<span class="sd">    EX_A: -&gt; A</span>
<span class="sd">    R1: A -&gt; B</span>
<span class="sd">    EX_B: B -&gt;</span>

<span class="sd">    Args:</span>
<span class="sd">        stoichiometries (dict[str, dict[str, float]]): The model-describing dictionary</span>

<span class="sd">    Returns:</span>
<span class="sd">        cobra.Model: The resulting COBRApy model with the given reactions and metabolites</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cobra_model</span><span class="p">:</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>
    <span class="n">reac_ids</span> <span class="o">=</span> <span class="n">stoichiometries</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">metabolite_ids_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">stoichiometry_entry</span> <span class="ow">in</span> <span class="n">stoichiometries</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">metabolite_ids_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">stoichiometry_entry</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="n">metabolite_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">metabolite_ids_list</span><span class="p">)</span>
    <span class="n">cobra_model</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">(</span>
        <span class="p">[</span><span class="n">cobra</span><span class="o">.</span><span class="n">Metabolite</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">met_id</span><span class="p">,</span> <span class="n">compartment</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">metabolite_ids</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">cobra_model</span><span class="o">.</span><span class="n">add_reactions</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="n">reac_id</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">reac_id</span><span class="p">,</span>
                <span class="n">lower_bound</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="n">upper_bound</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">reac_ids</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">reac_ids</span><span class="p">:</span>
        <span class="n">reaction</span><span class="p">:</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span> <span class="o">=</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>
        <span class="n">reaction</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="n">cobra_model</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">met_id</span><span class="p">):</span> <span class="n">stoichiometry</span>
                <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">stoichiometry</span> <span class="ow">in</span> <span class="n">stoichiometries</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">cobra_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.cobrapy_model_functionality.get_fullsplit_cobra_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_fullsplit_cobra_model</span><span class="p">(</span><span class="n">cobra_model</span><span class="p">,</span> <span class="n">fwd_suffix</span><span class="o">=</span><span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span> <span class="n">rev_suffix</span><span class="o">=</span><span class="n">REAC_REV_SUFFIX</span><span class="p">,</span> <span class="n">add_cobrak_sbml_annotation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cobrak_default_min_conc</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span> <span class="n">cobrak_default_max_conc</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">cobrak_extra_linear_constraints</span><span class="o">=</span><span class="p">[],</span> <span class="n">cobrak_kinetic_ignored_metabolites</span><span class="o">=</span><span class="p">[],</span> <span class="n">cobrak_no_extra_versions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reac_lb_ub_cap</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a COBRApy model where reactions are split according to reversibility and enzymes.</p>
<p>"Reversibility" means that, if a reaction i can run in both directions (_i&lt;0), then it is split as follows:
Ri: A&lt;-&gt;B [-50;100]=&gt; Ri_FWD: A-&gt;B [0;100]; Ri_REV: B-&gt;A [0;50]
where the ending "FWD" and "REV" are set in COBRAk's constants REAC_FWD_SUFFIX and REAC_REV_SUFFIX.</p>
<p>"enzymes" means that, if a reaction i can be catalyzed by multiple enzymes (i.e., at least one OR block in the
reaction's gene-protein rule), then it is split for each reaction. Say, for example,
Rj: A-&gt;B [0;100]
has the following gene-protein rule:
(E1 OR E2)
...then, Rj is split into:
Rj_ENZ_E1: A-&gt;B [0;100]
Rj_ENZ_E2: A-&gt;B [0;100]
where the infix "<em>ENZ</em>" is set in COBRAk's constants REAC_ENZ_SEPARATOR.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobra_model</code>
            </td>
            <td>
                  <code><span title="cobra.Model">Model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRApy model that shall be 'fullsplit'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="cobra.Model">Model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>cobra.Model: The 'fullsplit' COBRApy model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/cobrapy_model_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_fullsplit_cobra_model</span><span class="p">(</span>
    <span class="n">cobra_model</span><span class="p">:</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span>
    <span class="n">fwd_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span>
    <span class="n">rev_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_REV_SUFFIX</span><span class="p">,</span>
    <span class="n">add_cobrak_sbml_annotation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">cobrak_default_min_conc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span>
    <span class="n">cobrak_default_max_conc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">cobrak_extra_linear_constraints</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ExtraLinearConstraint</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">cobrak_kinetic_ignored_metabolites</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">cobrak_no_extra_versions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">reac_lb_ub_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a COBRApy model where reactions are split according to reversibility and enzymes.</span>

<span class="sd">    &quot;Reversibility&quot; means that, if a reaction i can run in both directions (_i&lt;0), then it is split as follows:</span>
<span class="sd">    Ri: A&lt;-&gt;B [-50;100]=&gt; Ri_FWD: A-&gt;B [0;100]; Ri_REV: B-&gt;A [0;50]</span>
<span class="sd">    where the ending &quot;FWD&quot; and &quot;REV&quot; are set in COBRAk&#39;s constants REAC_FWD_SUFFIX and REAC_REV_SUFFIX.</span>

<span class="sd">    &quot;enzymes&quot; means that, if a reaction i can be catalyzed by multiple enzymes (i.e., at least one OR block in the</span>
<span class="sd">    reaction&#39;s gene-protein rule), then it is split for each reaction. Say, for example,</span>
<span class="sd">    Rj: A-&gt;B [0;100]</span>
<span class="sd">    has the following gene-protein rule:</span>
<span class="sd">    (E1 OR E2)</span>
<span class="sd">    ...then, Rj is split into:</span>
<span class="sd">    Rj_ENZ_E1: A-&gt;B [0;100]</span>
<span class="sd">    Rj_ENZ_E2: A-&gt;B [0;100]</span>
<span class="sd">    where the infix &quot;_ENZ_&quot; is set in COBRAk&#39;s constants REAC_ENZ_SEPARATOR.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobra_model (cobra.Model): The COBRApy model that shall be &#39;fullsplit&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        cobra.Model: The &#39;fullsplit&#39; COBRApy model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fullsplit_cobra_model</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">cobra_model</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">add_cobrak_sbml_annotation</span><span class="p">:</span>
        <span class="n">settings_reac</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;cobrak_global_settings&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Global COBRA-k settings&quot;</span><span class="p">,</span>
            <span class="n">lower_bound</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">upper_bound</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_max_prot_pool&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1000.0</span>
        <span class="n">settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_R&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">STANDARD_R</span>
        <span class="n">settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_T&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">STANDARD_T</span>
        <span class="n">settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_kinetic_ignored_metabolites&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_reac_rev_suffix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">rev_suffix</span>  <span class="c1"># A &quot;special&quot; suffix to show that this is added</span>
        <span class="p">)</span>
        <span class="n">settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_reac_fwd_suffix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fwd_suffix</span>
        <span class="n">settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_reac_enz_separator&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">REAC_ENZ_SEPARATOR</span>
        <span class="n">settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_extra_linear_constraints&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
            <span class="p">[</span><span class="n">asdict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cobrak_extra_linear_constraints</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_kinetic_ignored_metabolites&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
            <span class="n">cobrak_kinetic_ignored_metabolites</span>
        <span class="p">)</span>

        <span class="n">fullsplit_cobra_model</span><span class="o">.</span><span class="n">add_reactions</span><span class="p">([</span><span class="n">settings_reac</span><span class="p">])</span>

    <span class="n">fullsplit_cobra_model</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">(</span><span class="n">cobra_model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">genes</span><span class="p">:</span>
        <span class="n">fullsplit_cobra_model</span><span class="o">.</span><span class="n">genes</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">gene</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">reaction_x</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="n">reaction</span><span class="p">:</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span> <span class="o">=</span> <span class="n">reaction_x</span>

        <span class="k">if</span> <span class="n">add_cobrak_sbml_annotation</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;dG0&quot;</span><span class="p">,</span> <span class="s2">&quot;cobrak_dG0&quot;</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;dG0_uncertainty&quot;</span><span class="p">,</span> <span class="s2">&quot;cobrak_dG0_uncertainty&quot;</span><span class="p">),</span>
            <span class="p">):</span>
                <span class="k">if</span> <span class="n">old_name</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                    <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="n">new_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="n">old_name</span><span class="p">]</span>

            <span class="n">fwd_dG0</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_dG0&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="s2">&quot;cobrak_dG0&quot;</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span>
                <span class="k">else</span> <span class="kc">None</span>
            <span class="p">)</span>
            <span class="n">dG0_uncertainty</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">abs</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_dG0_uncertainty&quot;</span><span class="p">]))</span>
                <span class="k">if</span> <span class="s2">&quot;cobrak_dG0_uncertainty&quot;</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span>
                <span class="k">else</span> <span class="kc">None</span>
            <span class="p">)</span>

        <span class="n">is_reversible</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">lower_bound</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">is_reversible</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">single_enzyme_blocks</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">reaction</span><span class="o">.</span><span class="n">gene_reaction_rule</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; or &quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">current_reac_version</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">single_enzyme_block</span> <span class="ow">in</span> <span class="n">single_enzyme_blocks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">single_enzyme_block</span><span class="p">:</span>
                <span class="n">new_reac_base_id</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">reaction</span><span class="o">.</span><span class="n">id</span>
                    <span class="o">+</span> <span class="n">REAC_ENZ_SEPARATOR</span>
                    <span class="o">+</span> <span class="n">single_enzyme_block</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_reac_base_id</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">id</span>
            <span class="n">new_reaction_1</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="n">new_reac_base_id</span><span class="p">,</span>
                <span class="n">lower_bound</span><span class="o">=</span><span class="n">reaction</span><span class="o">.</span><span class="n">lower_bound</span><span class="p">,</span>
                <span class="n">upper_bound</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">reac_lb_ub_cap</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">upper_bound</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">new_reaction_1</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">add_cobrak_sbml_annotation</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fwd_dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">new_reaction_1</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;cobrak_dG0_V</span><span class="si">{</span><span class="n">current_reac_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">fwd_dG0</span>
                    <span class="p">)</span>
                <span class="k">if</span> <span class="n">dG0_uncertainty</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">new_reaction_1</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span>
                        <span class="sa">f</span><span class="s2">&quot;cobrak_dG0_uncertainty_V</span><span class="si">{</span><span class="n">current_reac_version</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="n">dG0_uncertainty</span>
                <span class="n">new_reaction_1</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;cobrak_id_V</span><span class="si">{</span><span class="n">current_reac_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">new_reaction_1</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="p">(</span><span class="n">fwd_suffix</span> <span class="k">if</span> <span class="n">is_reversible</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">single_enzyme_block</span><span class="p">:</span>
                <span class="n">new_reaction_1</span><span class="o">.</span><span class="n">gene_reaction_rule</span> <span class="o">=</span> <span class="n">single_enzyme_block</span>
            <span class="n">new_reaction_1_met_addition</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">met</span><span class="p">,</span> <span class="n">stoichiometry</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new_reaction_1_met_addition</span><span class="p">[</span><span class="n">met</span><span class="p">]</span> <span class="o">=</span> <span class="n">stoichiometry</span>
            <span class="n">new_reaction_1</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">(</span><span class="n">new_reaction_1_met_addition</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">is_reversible</span><span class="p">:</span>
                <span class="n">current_reac_version</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">original_lb</span> <span class="o">=</span> <span class="n">new_reaction_1</span><span class="o">.</span><span class="n">lower_bound</span>
                <span class="n">new_reaction_2</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
                    <span class="nb">id</span><span class="o">=</span><span class="n">new_reac_base_id</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">new_reaction_2</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">add_cobrak_sbml_annotation</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">fwd_dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">new_reaction_2</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span>
                            <span class="sa">f</span><span class="s2">&quot;cobrak_dG0_V</span><span class="si">{</span><span class="n">current_reac_version</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">fwd_dG0</span>
                    <span class="k">if</span> <span class="n">dG0_uncertainty</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">new_reaction_2</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span>
                            <span class="sa">f</span><span class="s2">&quot;cobrak_dG0_uncertainty_V</span><span class="si">{</span><span class="n">current_reac_version</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="p">]</span> <span class="o">=</span> <span class="n">dG0_uncertainty</span>
                    <span class="n">new_reaction_2</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;cobrak_id_V</span><span class="si">{</span><span class="n">current_reac_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">new_reaction_2</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="n">rev_suffix</span>
                    <span class="p">)</span>
                <span class="k">if</span> <span class="n">single_enzyme_block</span><span class="p">:</span>
                    <span class="n">new_reaction_2</span><span class="o">.</span><span class="n">gene_reaction_rule</span> <span class="o">=</span> <span class="n">single_enzyme_block</span>
                <span class="n">new_reaction_1</span><span class="o">.</span><span class="n">id</span> <span class="o">+=</span> <span class="n">fwd_suffix</span>
                <span class="n">new_reaction_1</span><span class="o">.</span><span class="n">lower_bound</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">new_reaction_2</span><span class="o">.</span><span class="n">id</span> <span class="o">+=</span> <span class="n">rev_suffix</span>
                <span class="n">new_reaction_2</span><span class="o">.</span><span class="n">lower_bound</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">new_reaction_2</span><span class="o">.</span><span class="n">upper_bound</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">reac_lb_ub_cap</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">original_lb</span><span class="p">))</span>

                <span class="n">new_reaction_2_met_addition</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">met</span><span class="p">,</span> <span class="n">stoichiometry</span> <span class="ow">in</span> <span class="n">new_reaction_1</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">new_reaction_2_met_addition</span><span class="p">[</span><span class="n">met</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">stoichiometry</span>
                <span class="n">new_reaction_2</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">(</span><span class="n">new_reaction_2_met_addition</span><span class="p">)</span>

                <span class="n">fullsplit_cobra_model</span><span class="o">.</span><span class="n">add_reactions</span><span class="p">([</span><span class="n">new_reaction_2</span><span class="p">])</span>
            <span class="n">fullsplit_cobra_model</span><span class="o">.</span><span class="n">add_reactions</span><span class="p">([</span><span class="n">new_reaction_1</span><span class="p">])</span>
            <span class="n">current_reac_version</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">cobrak_no_extra_versions</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;cobrak_k_cat_V0&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">)</span>
                <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;cobrak_k_cat&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="k">break</span>

    <span class="k">for</span> <span class="n">metabolite</span> <span class="ow">in</span> <span class="n">fullsplit_cobra_model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span> <span class="ow">in</span> <span class="p">((</span><span class="s2">&quot;Cmin&quot;</span><span class="p">,</span> <span class="s2">&quot;cobrak_Cmin&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Cmax&quot;</span><span class="p">,</span> <span class="s2">&quot;cobrak_Cmax&quot;</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">old_name</span> <span class="ow">in</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                <span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="n">new_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="n">old_name</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;cobrak_Cmin&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
            <span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_Cmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cobrak_default_min_conc</span>
        <span class="k">if</span> <span class="s2">&quot;cobrak_Cmax&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
            <span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_Cmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cobrak_default_max_conc</span>

    <span class="k">return</span> <span class="n">fullsplit_cobra_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.cobrapy_model_functionality.get_fullsplit_cobra_model_from_sbml" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_fullsplit_cobra_model_from_sbml</span><span class="p">(</span><span class="n">sbml_path</span><span class="p">,</span> <span class="n">fwd_suffix</span><span class="o">=</span><span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span> <span class="n">rev_suffix</span><span class="o">=</span><span class="n">REAC_REV_SUFFIX</span><span class="p">,</span> <span class="n">add_cobrak_sbml_annotation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cobrak_default_min_conc</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span> <span class="n">cobrak_default_max_conc</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">cobrak_extra_linear_constraints</span><span class="o">=</span><span class="p">[],</span> <span class="n">cobrak_kinetic_ignored_metabolites</span><span class="o">=</span><span class="p">[],</span> <span class="n">cobrak_no_extra_versions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reac_lb_ub_cap</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return a COBRApy model (loaded from the SBML) where reactions are split according to reversibility and enzymes.</p>
<p>"Reversibility" means that, if a reaction i can run in both directions (_i&lt;0), then it is split as follows:
Ri: A&lt;-&gt;B [-50;100]=&gt; Ri_FWD: A-&gt;B [0;100]; Ri_REV: B-&gt;A [0;50]
where the ending "FWD" and "REV" are set in COBRAk's constants REAC_FWD_SUFFIX and REAC_REV_SUFFIX.</p>
<p>"enzymes" means that, if a reaction i can be catalyzed by multiple enzymes (i.e., at least one OR block in the
reaction's gene-protein rule), then it is split for each reaction. Say, for example,
Rj: A-&gt;B [0;100]
has the following gene-protein rule:
(E1 OR E2)
...then, Rj is split into:
Rj_ENZ_E1: A-&gt;B [0;100]
Rj_ENZ_E2: A-&gt;B [0;100]
where the infix "<em>ENZ</em>" is set in COBRAk's constants REAC_ENZ_SEPARATOR.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobra_model</code>
            </td>
            <td>
                  <code><span title="cobra.Model">Model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRApy model that shall be 'fullsplit'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="cobra.Model">Model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>cobra.Model: The 'fullsplit' COBRApy model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/cobrapy_model_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_fullsplit_cobra_model_from_sbml</span><span class="p">(</span>
    <span class="n">sbml_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">fwd_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span>
    <span class="n">rev_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_REV_SUFFIX</span><span class="p">,</span>
    <span class="n">add_cobrak_sbml_annotation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">cobrak_default_min_conc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span>
    <span class="n">cobrak_default_max_conc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="n">cobrak_extra_linear_constraints</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ExtraLinearConstraint</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">cobrak_kinetic_ignored_metabolites</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">cobrak_no_extra_versions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">reac_lb_ub_cap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a COBRApy model (loaded from the SBML) where reactions are split according to reversibility and enzymes.</span>

<span class="sd">    &quot;Reversibility&quot; means that, if a reaction i can run in both directions (_i&lt;0), then it is split as follows:</span>
<span class="sd">    Ri: A&lt;-&gt;B [-50;100]=&gt; Ri_FWD: A-&gt;B [0;100]; Ri_REV: B-&gt;A [0;50]</span>
<span class="sd">    where the ending &quot;FWD&quot; and &quot;REV&quot; are set in COBRAk&#39;s constants REAC_FWD_SUFFIX and REAC_REV_SUFFIX.</span>

<span class="sd">    &quot;enzymes&quot; means that, if a reaction i can be catalyzed by multiple enzymes (i.e., at least one OR block in the</span>
<span class="sd">    reaction&#39;s gene-protein rule), then it is split for each reaction. Say, for example,</span>
<span class="sd">    Rj: A-&gt;B [0;100]</span>
<span class="sd">    has the following gene-protein rule:</span>
<span class="sd">    (E1 OR E2)</span>
<span class="sd">    ...then, Rj is split into:</span>
<span class="sd">    Rj_ENZ_E1: A-&gt;B [0;100]</span>
<span class="sd">    Rj_ENZ_E2: A-&gt;B [0;100]</span>
<span class="sd">    where the infix &quot;_ENZ_&quot; is set in COBRAk&#39;s constants REAC_ENZ_SEPARATOR.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobra_model (cobra.Model): The COBRApy model that shall be &#39;fullsplit&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        cobra.Model: The &#39;fullsplit&#39; COBRApy model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">get_fullsplit_cobra_model</span><span class="p">(</span>
        <span class="n">cobra</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_sbml_model</span><span class="p">(</span><span class="n">sbml_path</span><span class="p">),</span>
        <span class="n">fwd_suffix</span><span class="o">=</span><span class="n">fwd_suffix</span><span class="p">,</span>
        <span class="n">rev_suffix</span><span class="o">=</span><span class="n">rev_suffix</span><span class="p">,</span>
        <span class="n">add_cobrak_sbml_annotation</span><span class="o">=</span><span class="n">add_cobrak_sbml_annotation</span><span class="p">,</span>
        <span class="n">cobrak_default_min_conc</span><span class="o">=</span><span class="n">cobrak_default_min_conc</span><span class="p">,</span>
        <span class="n">cobrak_default_max_conc</span><span class="o">=</span><span class="n">cobrak_default_max_conc</span><span class="p">,</span>
        <span class="n">cobrak_extra_linear_constraints</span><span class="o">=</span><span class="n">cobrak_extra_linear_constraints</span><span class="p">,</span>
        <span class="n">cobrak_kinetic_ignored_metabolites</span><span class="o">=</span><span class="n">cobrak_kinetic_ignored_metabolites</span><span class="p">,</span>
        <span class="n">cobrak_no_extra_versions</span><span class="o">=</span><span class="n">cobrak_no_extra_versions</span><span class="p">,</span>
        <span class="n">reac_lb_ub_cap</span><span class="o">=</span><span class="n">reac_lb_ub_cap</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.constants" class="doc doc-heading">
            <code>constants</code>


</h2>

    <div class="doc doc-contents ">

        <p>This module contains all COBRAk constants that are used throughout its packages.</p>
<p>These constants are especially used for problem constructions (to determine prefixes,
suffixes, names, ... for pyomo variables) as well as thermodynamic standard values.</p>









  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.ALL_OK_KEY" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ALL_OK_KEY</span> <span class="o">=</span> <span class="s1">&#39;ALL_OK&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Shows that the result is optimal and the termination condition is ok</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.ALPHA_VAR_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ALPHA_VAR_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;alpha_var_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prefix for variables representing the activation of a reaction (used in non-linear programs)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.BIG_M" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">BIG_M</span> <span class="o">=</span> <span class="mi">10000</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Big M value for MILPs</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.DF_VAR_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">DF_VAR_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;f_var_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prefix for driving force problem variables</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.DG0_VAR_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">DG0_VAR_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;dG0_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prefix for Gibb's free energy problem variables</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.EC_INNER_TO_OUTER_COMPARTMENTS" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">EC_INNER_TO_OUTER_COMPARTMENTS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Inner to outer compartments in this order for E. coli models used here</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.EC_IONIC_STRENGTHS" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">EC_IONIC_STRENGTHS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">250</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">250</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mi">250</span><span class="p">}</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Ionic strenghts (in mM) for E. coli model compartments used here</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.EC_PHS" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">EC_PHS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">7.5</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mf">7.5</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mf">7.5</span><span class="p">}</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>pH values (unitless) for E. coli model compartments used here</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.EC_PMGS" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">EC_PMGS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">}</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>pMg values (unitless) for E. coli model compartments used here</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.EC_POTENTIAL_DIFFERENCES" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">EC_POTENTIAL_DIFFERENCES</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">):</span> <span class="mf">0.15</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">):</span> <span class="mf">0.15</span><span class="p">}</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Potential differences (in V) for E. coli model compartments used here</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.ENZYME_VAR_INFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ENZYME_VAR_INFIX</span> <span class="o">=</span> <span class="s1">&#39;_of_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Infix for separation of enzyme name and reaction name</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.ENZYME_VAR_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ENZYME_VAR_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;enzyme_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prefix of problem variables which stand for enzyme concentrations</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.ERROR_BOUND_LOWER_CHANGE_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ERROR_BOUND_LOWER_CHANGE_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;bound_error_change_lower_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prefix for fixed variables that show how much affected lower variable bounds have to be changed</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.ERROR_BOUND_UPPER_CHANGE_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ERROR_BOUND_UPPER_CHANGE_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;bound_error_change_upper_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prefix for fixed variables that show how much affected lower variable bounds have to be changed</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.ERROR_CONSTRAINT_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ERROR_CONSTRAINT_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;flux_error_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prefix for the constraint that defines a scenario flux constraint</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.ERROR_SUM_VAR_ID" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ERROR_SUM_VAR_ID</span> <span class="o">=</span> <span class="s1">&#39;error_sum&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Name for the variable that holds the sum of all error term variables</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.ERROR_VAR_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ERROR_VAR_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;error_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prefix for error term variables for feasibility-making optimizations</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.FLUX_SUM_VAR_ID" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FLUX_SUM_VAR_ID</span> <span class="o">=</span> <span class="s1">&#39;FLUX_SUM_VAR&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Name of optional variable that holds the sum of all reaction fluxes</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.GAMMA_VAR_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">GAMMA_VAR_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;gamma_var_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prefix for variables representing the thermodynamic restriction of a reaction (used in non-linear programs)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.IOTA_VAR_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">IOTA_VAR_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;iota_var_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prefix for variables representing the inhibition of a reaction (used in non-linear programs)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.KAPPA_PRODUCTS_VAR_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">KAPPA_PRODUCTS_VAR_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;kappa_products_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prefix for variables representing the sum of logairthmized product concentration minus the logarithmized sum of km values</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.KAPPA_SUBSTRATES_VAR_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">KAPPA_SUBSTRATES_VAR_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;kappa_substrates_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prefix for variables representing the sum of logairthmized substrate concentration minus the logarithmized sum of km values</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.KAPPA_VAR_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">KAPPA_VAR_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;kappa_var_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prefix for variables representing the thermodynamic restriction of a reaction (used in non-linear programs)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.LNCONC_VAR_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">LNCONC_VAR_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;x_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prefix for logarithmized concentration problem variables</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.MDF_VAR_ID" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">MDF_VAR_ID</span> <span class="o">=</span> <span class="s1">&#39;var_B&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Name for minimally occuring driving force variable</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.OBJECTIVE_CONSTRAINT_NAME" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">OBJECTIVE_CONSTRAINT_NAME</span> <span class="o">=</span> <span class="s1">&#39;objective_constraint&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Name for constraint that defines the objective function's term</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.OBJECTIVE_VAR_NAME" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">OBJECTIVE_VAR_NAME</span> <span class="o">=</span> <span class="s1">&#39;OBJECTIVE_VAR&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Name for variable that holds the objective value</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.PROT_POOL_MET_NAME" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">PROT_POOL_MET_NAME</span> <span class="o">=</span> <span class="s1">&#39;prot_pool&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Identifier of the protein pool representing pseudo-metabolite</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.PROT_POOL_REAC_NAME" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">PROT_POOL_REAC_NAME</span> <span class="o">=</span> <span class="n">PROT_POOL_MET_NAME</span> <span class="o">+</span> <span class="s1">&#39;_delivery&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Identifier of the pseudo-reaction which created the protein pool pseudo-metabolite</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.QUASI_INF" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">QUASI_INF</span> <span class="o">=</span> <span class="mi">100000</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Big number (larger than big M) for values that would reach inf (thereby potentially causing solver problems)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.REAC_ENZ_SEPARATOR" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">REAC_ENZ_SEPARATOR</span> <span class="o">=</span> <span class="s1">&#39;_ENZ_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Separator between enzyme-constrained reaction ID and attached enzyme name</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.REAC_FWD_SUFFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">REAC_FWD_SUFFIX</span> <span class="o">=</span> <span class="s1">&#39;_FWD&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Standard suffix for reaction IDs that represent forward directions of originally irreversible reactions</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.REAC_REV_SUFFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">REAC_REV_SUFFIX</span> <span class="o">=</span> <span class="s1">&#39;_REV&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Standard suffix for reaction IDs that represent reverse directions of originally irreversible reactions</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.SOLVER_STATUS_KEY" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">SOLVER_STATUS_KEY</span> <span class="o">=</span> <span class="s1">&#39;SOLVER_STATUS&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Solver status optimization dict key</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.STANDARD_MIN_MDF" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">STANDARD_MIN_MDF</span> <span class="o">=</span> <span class="mf">0.001</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Standard minimally ocurring driving force for active reactions in kJmol</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.STANDARD_R" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">STANDARD_R</span> <span class="o">=</span> <span class="mf">0.008314</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Standard gas constant in kJK1mol1 (Attention: Standard value is often given in JK1mol1, but we need in kJK1mol1)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.STANDARD_T" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">STANDARD_T</span> <span class="o">=</span> <span class="mf">298.15</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Standard temperature in Kelvin</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.TERMINATION_CONDITION_KEY" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">TERMINATION_CONDITION_KEY</span> <span class="o">=</span> <span class="s1">&#39;TERMINATION_CONDITION&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Solver termination condition key in optimization dict</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.USED_IDENTIFIERS_FOR_EQUILIBRATOR" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">USED_IDENTIFIERS_FOR_EQUILIBRATOR</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;inchi&#39;</span><span class="p">,</span> <span class="s1">&#39;inchi_key&#39;</span><span class="p">,</span> <span class="s1">&#39;metanetx.chemical&#39;</span><span class="p">,</span> <span class="s1">&#39;bigg.metabolite&#39;</span><span class="p">,</span> <span class="s1">&#39;kegg.compound&#39;</span><span class="p">,</span> <span class="s1">&#39;chebi&#39;</span><span class="p">,</span> <span class="s1">&#39;sabiork.compound&#39;</span><span class="p">,</span> <span class="s1">&#39;metacyc.compound&#39;</span><span class="p">,</span> <span class="s1">&#39;hmdb&#39;</span><span class="p">,</span> <span class="s1">&#39;swisslipid&#39;</span><span class="p">,</span> <span class="s1">&#39;reactome&#39;</span><span class="p">,</span> <span class="s1">&#39;lipidmaps&#39;</span><span class="p">,</span> <span class="s1">&#39;seed.compound&#39;</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Standard bunch of reaction identifier annotation names for E. coli models used here</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.ZB_VAR_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ZB_VAR_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;zb_var_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Extra zb variable prefix for thermodynamic bottleneck analyses</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.constants.Z_VAR_PREFIX" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Z_VAR_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;z_var_&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Prefix of z variables (used with thermodynamic constraints in MI(N)LPs)</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.dataclasses" class="doc doc-heading">
            <code>dataclasses</code>


</h2>

    <div class="doc doc-contents ">

        <p>Contains all dataclasses (and enums) used by COBRAk to define a metabolic model and its extra constraints and optimization objective.</p>
<p>Dataclasses are similar to structs in C: They are not intended to have member functions, only other types of member variables.
The main dataclass used by COBRAk is Model, which contains the full information about the metabolic model. As member variables,
a Model contains further dataclasses (such as Reaction, Metabolite, ...).
As dataclass_json is also invoked, it is possible to store and load the COBRAk dataclasses as JSON.</p>









  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="cobrak.dataclasses.ErrorScenario" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ErrorScenario</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>A COBRAk error scenario type alias for a ConfigurationConfig; Is dict[str, tuple[float, float]]</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.dataclasses.OptResult" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">OptResult</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>A COBRAk variability optimization result type alias; Is dict[str, float]</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.dataclasses.VarResult" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">VarResult</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>A COBRAk variability result type alias; Is dict[str, tuple[float | None, float | None]]</p>

    </div>

</div>


<div class="doc doc-object doc-class">



<h3 id="cobrak.dataclasses.CorrectionConfig" class="doc doc-heading">
            <code>CorrectionConfig</code>


</h3>


    <div class="doc doc-contents ">


        <p>Stores the configuration for corrections in a model (see parameter corrections chapter in documentation).</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CorrectionConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stores the configuration for corrections in a model (see parameter corrections chapter in documentation).&quot;&quot;&quot;</span>

    <span class="n">error_scenario</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A dictionary where keys are error scenarios and values are tuples representing the lower and upper bounds of the error. Defaults to {}.&quot;&quot;&quot;</span>
    <span class="n">add_flux_error_term</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Indicates whether to add flux error terms. Defaults to False.&quot;&quot;&quot;</span>
    <span class="n">add_met_logconc_error_term</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Indicates whether to add metabolite log concentration error terms. Defaults to False.&quot;&quot;&quot;</span>
    <span class="n">add_enzyme_conc_error_term</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Indicates whether to add enzyme concentration error terms. Defaults to False.&quot;&quot;&quot;</span>
    <span class="n">add_kcat_times_e_error_term</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Indicates whether to add k_cat  [E] error terms. Defaults to False.&quot;&quot;&quot;</span>
    <span class="n">kcat_times_e_error_cutoff</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The cutoff value for the k_cat  [E] error term. Defaults to 1.0.&quot;&quot;&quot;</span>
    <span class="n">max_rel_kcat_times_e_correction</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="n">QUASI_INF</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Maximal relative correction for the k_cat  [E] error error term. Defaults to QUASI_INF.&quot;&quot;&quot;</span>
    <span class="n">add_dG0_error_term</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Indicates whether to add G&#39; error terms. Defaults to False.&quot;&quot;&quot;</span>
    <span class="n">dG0_error_cutoff</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The cutoff value for the G&#39; error terms. Defaults to 1.0.&quot;&quot;&quot;</span>
    <span class="n">max_abs_dG0_correction</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="n">QUASI_INF</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Maximal absolute correction for the dG0 error term. Defaults to QUASI_INF.&quot;&quot;&quot;</span>
    <span class="n">add_km_error_term</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Indicates whether to add a kappa error term. Defaults to False.&quot;&quot;&quot;</span>
    <span class="n">km_error_cutoff</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cutoff value for the  error term. Defaults to 1.0.&quot;&quot;&quot;</span>
    <span class="n">max_rel_km_correction</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="mf">0.999</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Maximal relative correction for the  error term. Defaults to 0.999.&quot;&quot;&quot;</span>
    <span class="n">add_ki_error_term</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Indicates whether to add a  error term. Defaults to False.&quot;&quot;&quot;</span>
    <span class="n">ki_error_cutoff</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cutoff value for the  error term. Defaults to 1.0.&quot;&quot;&quot;</span>
    <span class="n">max_rel_ki_correction</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="mf">0.999</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Maximal relative correction for the  error term. Defaults to 0.999.&quot;&quot;&quot;</span>
    <span class="n">add_ka_error_term</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Indicates whether to add an  error term. Defaults to False.&quot;&quot;&quot;</span>
    <span class="n">ka_error_cutoff</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cutoff value for the  error term. Defaults to 1.0.&quot;&quot;&quot;</span>
    <span class="n">max_rel_ka_correction</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="mf">0.999</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Maximal relative correction for the  error term. Defaults to 0.999.&quot;&quot;&quot;</span>
    <span class="n">error_sum_as_qp</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Indicates whether to use a quadratic programming approach for the error sum. Defaults to False.&quot;&quot;&quot;</span>
    <span class="n">add_error_sum_term</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Whether to add an error sum term. Defaults to True.&quot;&quot;&quot;</span>
    <span class="n">use_weights</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Indicates whether to use weights for the corrections (otherwise, the weight is 1.0). Defaults to False.&quot;&quot;&quot;</span>
    <span class="n">weight_percentile</span><span class="p">:</span> <span class="n">NonNegativeInt</span> <span class="o">=</span> <span class="mi">90</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Percentile to use for weight calculation. Defaults to 90.&quot;&quot;&quot;</span>
    <span class="n">extra_weights</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dictionary to store extra weights for specific corrections. Defaults to {}.&quot;&quot;&quot;</span>
    <span class="n">var_lb_ub_application</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;exp&quot;</span><span class="p">,</span> <span class="s2">&quot;log&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The application method for variable lower and upper bounds. Either &#39;&#39; (x=x), &#39;exp&#39; or &#39;log&#39;. Defaults to &#39;&#39;.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.add_dG0_error_term" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_dG0_error_term</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Indicates whether to add G' error terms. Defaults to False.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.add_enzyme_conc_error_term" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_enzyme_conc_error_term</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Indicates whether to add enzyme concentration error terms. Defaults to False.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.add_error_sum_term" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_error_sum_term</span> <span class="o">=</span> <span class="kc">True</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Whether to add an error sum term. Defaults to True.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.add_flux_error_term" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_flux_error_term</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Indicates whether to add flux error terms. Defaults to False.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.add_ka_error_term" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_ka_error_term</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Indicates whether to add an  error term. Defaults to False.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.add_kcat_times_e_error_term" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_kcat_times_e_error_term</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Indicates whether to add k_cat  [E] error terms. Defaults to False.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.add_ki_error_term" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_ki_error_term</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Indicates whether to add a  error term. Defaults to False.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.add_km_error_term" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_km_error_term</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Indicates whether to add a kappa error term. Defaults to False.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.add_met_logconc_error_term" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_met_logconc_error_term</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Indicates whether to add metabolite log concentration error terms. Defaults to False.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.dG0_error_cutoff" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dG0_error_cutoff</span> <span class="o">=</span> <span class="mf">1.0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The cutoff value for the G' error terms. Defaults to 1.0.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.error_scenario" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">error_scenario</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A dictionary where keys are error scenarios and values are tuples representing the lower and upper bounds of the error. Defaults to {}.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.error_sum_as_qp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">error_sum_as_qp</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Indicates whether to use a quadratic programming approach for the error sum. Defaults to False.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.extra_weights" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extra_weights</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Dictionary to store extra weights for specific corrections. Defaults to {}.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.ka_error_cutoff" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ka_error_cutoff</span> <span class="o">=</span> <span class="mf">1.0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Cutoff value for the  error term. Defaults to 1.0.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.kcat_times_e_error_cutoff" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">kcat_times_e_error_cutoff</span> <span class="o">=</span> <span class="mf">1.0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The cutoff value for the k_cat  [E] error term. Defaults to 1.0.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.ki_error_cutoff" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ki_error_cutoff</span> <span class="o">=</span> <span class="mf">1.0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Cutoff value for the  error term. Defaults to 1.0.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.km_error_cutoff" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">km_error_cutoff</span> <span class="o">=</span> <span class="mf">1.0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Cutoff value for the  error term. Defaults to 1.0.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.max_abs_dG0_correction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_abs_dG0_correction</span> <span class="o">=</span> <span class="n">QUASI_INF</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Maximal absolute correction for the dG0 error term. Defaults to QUASI_INF.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.max_rel_ka_correction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_rel_ka_correction</span> <span class="o">=</span> <span class="mf">0.999</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Maximal relative correction for the  error term. Defaults to 0.999.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.max_rel_kcat_times_e_correction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_rel_kcat_times_e_correction</span> <span class="o">=</span> <span class="n">QUASI_INF</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Maximal relative correction for the k_cat  [E] error error term. Defaults to QUASI_INF.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.max_rel_ki_correction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_rel_ki_correction</span> <span class="o">=</span> <span class="mf">0.999</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Maximal relative correction for the  error term. Defaults to 0.999.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.max_rel_km_correction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_rel_km_correction</span> <span class="o">=</span> <span class="mf">0.999</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Maximal relative correction for the  error term. Defaults to 0.999.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.use_weights" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">use_weights</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Indicates whether to use weights for the corrections (otherwise, the weight is 1.0). Defaults to False.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.var_lb_ub_application" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">var_lb_ub_application</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The application method for variable lower and upper bounds. Either '' (x=x), 'exp' or 'log'. Defaults to ''.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.CorrectionConfig.weight_percentile" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">weight_percentile</span> <span class="o">=</span> <span class="mi">90</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Percentile to use for weight calculation. Defaults to 90.</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.dataclasses.Enzyme" class="doc doc-heading">
            <code>Enzyme</code>


</h3>


    <div class="doc doc-contents ">


        <p>Represents an enzyme in a metabolic model.</p>


<details class="members" open>
  <summary>Members</summary>
  <p>molecular_weight (float):
    The enzyme's molecular weight in kDa.
min_conc (float | None):
    [Optional] If wanted, one can set a special minimal concentration
    for the enzyme.
    Defaults to None, i.e., no given concentration value (i.e., only the total
    enzyme pool is the limit).
max_conc (float | None):
    [Optional] If wanted, one can set a special maximal concentration
    for the enzyme.
    Defaults to None, i.e., no given concentration value (i.e., only the total
    enzyme pool is the limit).
annotation (dict[str, str | list[str]]):
    [Optional] Dictionary containing additional enzyme annotation,
    e.g., {"UNIPROT_ID": "b12345"}.
    Defaults to '{}'.
name: str:
    [Optional] Colloquial name of enzyme</p>
</details>






              <details class="quote">
                <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Enzyme</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents an enzyme in a metabolic model.</span>

<span class="sd">    Members:</span>
<span class="sd">        molecular_weight (float):</span>
<span class="sd">            The enzyme&#39;s molecular weight in kDa.</span>
<span class="sd">        min_conc (float | None):</span>
<span class="sd">            [Optional] If wanted, one can set a special minimal concentration</span>
<span class="sd">            for the enzyme.</span>
<span class="sd">            Defaults to None, i.e., no given concentration value (i.e., only the total</span>
<span class="sd">            enzyme pool is the limit).</span>
<span class="sd">        max_conc (float | None):</span>
<span class="sd">            [Optional] If wanted, one can set a special maximal concentration</span>
<span class="sd">            for the enzyme.</span>
<span class="sd">            Defaults to None, i.e., no given concentration value (i.e., only the total</span>
<span class="sd">            enzyme pool is the limit).</span>
<span class="sd">        annotation (dict[str, str | list[str]]):</span>
<span class="sd">            [Optional] Dictionary containing additional enzyme annotation,</span>
<span class="sd">            e.g., {&quot;UNIPROT_ID&quot;: &quot;b12345&quot;}.</span>
<span class="sd">            Defaults to &#39;{}&#39;.</span>
<span class="sd">        name: str:</span>
<span class="sd">            [Optional] Colloquial name of enzyme</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">molecular_weight</span><span class="p">:</span> <span class="n">FiniteFloat</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The enzyme&#39;s molecular weight in kDa&quot;&quot;&quot;</span>
    <span class="n">min_conc</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] The enzyme&#39;s minimal concentration in mmolgDW&quot;&quot;&quot;</span>
    <span class="n">max_conc</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] The enzyme&#39;s minimal concentration in mmolgDW&quot;&quot;&quot;</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] Any annotation data for the enzyme (e.g., references). Has no effect on calculations&quot;&quot;&quot;</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Colloquial name of enzyme&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Enzyme.annotation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">annotation</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] Any annotation data for the enzyme (e.g., references). Has no effect on calculations</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Enzyme.max_conc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_conc</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] The enzyme's minimal concentration in mmolgDW</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Enzyme.min_conc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">min_conc</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] The enzyme's minimal concentration in mmolgDW</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Enzyme.molecular_weight" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">molecular_weight</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The enzyme's molecular weight in kDa</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Enzyme.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Colloquial name of enzyme</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.dataclasses.EnzymeReactionData" class="doc doc-heading">
            <code>EnzymeReactionData</code>


</h3>


    <div class="doc doc-contents ">


        <p>Represents the enzymes used by a reaction.</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EnzymeReactionData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents the enzymes used by a reaction.&quot;&quot;&quot;</span>

    <span class="n">identifiers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The identifiers (must be given in the associated Model enzymes instance) of the reaction&#39;s enzyme(s)&quot;&quot;&quot;</span>
    <span class="n">k_cat</span><span class="p">:</span> <span class="n">PositiveFloat</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The reaction&#39;s k_cat (turnover numbers) in h&quot;&quot;&quot;</span>
    <span class="n">k_cat_references</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] List of references showing the source(s) of the k_cat value&quot;&quot;&quot;</span>
    <span class="n">k_ms</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PositiveFloat</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] The reaction&#39;s k_ms (Michaelis-Menten constants) in M=moll. Metabolite IDs are keys, k_ms the values. Default is {}&quot;&quot;&quot;</span>
    <span class="n">k_m_references</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] References showing the source(s) of the k_m values. Metabolite IDs are keys, the source lists values. Default is {}&quot;&quot;&quot;</span>
    <span class="n">k_is</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PositiveFloat</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] The reaction&#39;s k_is (Inhibition constants) in M=moll. Metabolite IDs are keys, k_is the values. Default is {}&quot;&quot;&quot;</span>
    <span class="n">k_i_references</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] References showing the source(s) of the k_i values. Metabolite IDs are keys, the source lists values. Default is {}&quot;&quot;&quot;</span>
    <span class="n">k_as</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PositiveFloat</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] The reaction&#39;s k_as (Activation constants) in M=moll. Metabolite IDs are keys, k_as the values. Default is {}&quot;&quot;&quot;</span>
    <span class="n">k_a_references</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] References showing the source(s) of the k_a values. Metabolite IDs are keys, the source lists values. Default is {}&quot;&quot;&quot;</span>
    <span class="n">hill_coefficients</span><span class="p">:</span> <span class="n">HillCoefficients</span> <span class="o">=</span> <span class="n">HillCoefficients</span><span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] If given, the reaction&#39;s Hill coefficients. Metabolite IDs are keys, coefficients the  in form of HillCoefficients instances. Default is empty HillCoefficients().&quot;&quot;&quot;</span>
    <span class="n">hill_coefficient_references</span><span class="p">:</span> <span class="n">HillParameterReferences</span> <span class="o">=</span> <span class="n">HillParameterReferences</span><span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] References showing the source(s) of the Hill coefficients. Metabolite IDs are keys, the source lists values. Default is {}&quot;&quot;&quot;</span>
    <span class="n">special_stoichiometries</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PositiveFloat</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] Special (non-1) stoichiometries of polypeptides/enzymes in the reaction&#39;s enzyme. Default is {}&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.EnzymeReactionData.hill_coefficient_references" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hill_coefficient_references</span> <span class="o">=</span> <span class="n">HillParameterReferences</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] References showing the source(s) of the Hill coefficients. Metabolite IDs are keys, the source lists values. Default is {}</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.EnzymeReactionData.hill_coefficients" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hill_coefficients</span> <span class="o">=</span> <span class="n">HillCoefficients</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] If given, the reaction's Hill coefficients. Metabolite IDs are keys, coefficients the  in form of HillCoefficients instances. Default is empty HillCoefficients().</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.EnzymeReactionData.identifiers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">identifiers</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The identifiers (must be given in the associated Model enzymes instance) of the reaction's enzyme(s)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.EnzymeReactionData.k_a_references" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">k_a_references</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] References showing the source(s) of the k_a values. Metabolite IDs are keys, the source lists values. Default is {}</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.EnzymeReactionData.k_as" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">k_as</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] The reaction's k_as (Activation constants) in M=moll. Metabolite IDs are keys, k_as the values. Default is {}</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.EnzymeReactionData.k_cat" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">k_cat</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The reaction's k_cat (turnover numbers) in h</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.EnzymeReactionData.k_cat_references" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">k_cat_references</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] List of references showing the source(s) of the k_cat value</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.EnzymeReactionData.k_i_references" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">k_i_references</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] References showing the source(s) of the k_i values. Metabolite IDs are keys, the source lists values. Default is {}</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.EnzymeReactionData.k_is" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">k_is</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] The reaction's k_is (Inhibition constants) in M=moll. Metabolite IDs are keys, k_is the values. Default is {}</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.EnzymeReactionData.k_m_references" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">k_m_references</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] References showing the source(s) of the k_m values. Metabolite IDs are keys, the source lists values. Default is {}</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.EnzymeReactionData.k_ms" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">k_ms</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] The reaction's k_ms (Michaelis-Menten constants) in M=moll. Metabolite IDs are keys, k_ms the values. Default is {}</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.EnzymeReactionData.special_stoichiometries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">special_stoichiometries</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] Special (non-1) stoichiometries of polypeptides/enzymes in the reaction's enzyme. Default is {}</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.dataclasses.ExtraLinearConstraint" class="doc doc-heading">
            <code>ExtraLinearConstraint</code>


</h3>


    <div class="doc doc-contents ">


        <p>Represents a general linear Model constraint.</p>
<p>This can affect not only reactions, but also all other
variables (including watches) set in a COBRAk model. E.g., if one wants (for whatever
reason) the following constraint:
0.5 &lt;= [A] - 2 * r_R1 &lt;= 2.1
the corresponding ExtraLinearConstraint instance would be:
ExtraLinearConstraint(
    stoichiometries = {
        "x_A": 1.0,
        "R1": -2,
    },
    lower_value = 0.5,
    upper_value = 2.1,
)
lower_value or upper_value can be None if no such limit is desired.</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExtraLinearConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a general linear Model constraint.</span>

<span class="sd">    This can affect not only reactions, but also all other</span>
<span class="sd">    variables (including watches) set in a COBRAk model. E.g., if one wants (for whatever</span>
<span class="sd">    reason) the following constraint:</span>
<span class="sd">    0.5 &lt;= [A] - 2 * r_R1 &lt;= 2.1</span>
<span class="sd">    the corresponding ExtraLinearConstraint instance would be:</span>
<span class="sd">    ExtraLinearConstraint(</span>
<span class="sd">        stoichiometries = {</span>
<span class="sd">            &quot;x_A&quot;: 1.0,</span>
<span class="sd">            &quot;R1&quot;: -2,</span>
<span class="sd">        },</span>
<span class="sd">        lower_value = 0.5,</span>
<span class="sd">        upper_value = 2.1,</span>
<span class="sd">    )</span>
<span class="sd">    lower_value or upper_value can be None if no such limit is desired.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">stoichiometries</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Keys: Model variable names; Children: Multipliers of constraint&quot;&quot;&quot;</span>
    <span class="n">lower_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Minimal numeric constraint value. Either this and/or upper_value must be not None. Defaults to None.&quot;&quot;&quot;</span>
    <span class="n">upper_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Maximal numeric constraint value. Either this and/or lower_value must be not None. Defaults to None.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.ExtraLinearConstraint.lower_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lower_value</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Minimal numeric constraint value. Either this and/or upper_value must be not None. Defaults to None.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.ExtraLinearConstraint.stoichiometries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stoichiometries</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Keys: Model variable names; Children: Multipliers of constraint</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.ExtraLinearConstraint.upper_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">upper_value</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Maximal numeric constraint value. Either this and/or lower_value must be not None. Defaults to None.</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.dataclasses.ExtraLinearWatch" class="doc doc-heading">
            <code>ExtraLinearWatch</code>


</h3>


    <div class="doc doc-contents ">


        <p>Represents a linear 'watch', i.e. a variable that shows the linear sum of other variables.</p>
<p>A watch can be not only about reactions, but also all other
variables (except of watches that are defined <em>after</em> this one in the Model's extra_linear_watches
member variable) set in a COBRAk model. E.g., if one wants (for whatever
reason) a variable for the following constraint:
[A] - 2 * r_R1, we set
ExtraLinearWatch(
    stoichiometries = {
        "x_A": 1.0,
        "R1": -2,
    },
)</p>
<p>The name of the watch is set in as dictionary key for the model's extra_linear_watches
member variable.</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExtraLinearWatch</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a linear &#39;watch&#39;, i.e. a variable that shows the linear sum of other variables.</span>

<span class="sd">    A watch can be not only about reactions, but also all other</span>
<span class="sd">    variables (except of watches that are defined *after* this one in the Model&#39;s extra_linear_watches</span>
<span class="sd">    member variable) set in a COBRAk model. E.g., if one wants (for whatever</span>
<span class="sd">    reason) a variable for the following constraint:</span>
<span class="sd">    [A] - 2 * r_R1, we set</span>
<span class="sd">    ExtraLinearWatch(</span>
<span class="sd">        stoichiometries = {</span>
<span class="sd">            &quot;x_A&quot;: 1.0,</span>
<span class="sd">            &quot;R1&quot;: -2,</span>
<span class="sd">        },</span>
<span class="sd">    )</span>

<span class="sd">    The name of the watch is set in as dictionary key for the model&#39;s extra_linear_watches</span>
<span class="sd">    member variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">stoichiometries</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.dataclasses.ExtraNonlinearConstraint" class="doc doc-heading">
            <code>ExtraNonlinearConstraint</code>


</h3>


    <div class="doc doc-contents ">


        <p>Represents a general non-linear Model constraint.</p>
<p>Important note: Setting such a non-linear watch makes any optimization non-linear and thus incompatible
with linear solvers and computationally much more expensive!</p>
<p>This can affect not only reactions, but also all other
variables (including watches) set in a COBRA-k model. E.g., if one wants (for whatever
reason) the following constraint:
0.5 &lt;= log([A]^2 - 2 * exp(r_R1)) &lt;= 2.1
the corresponding ExtraNonlinearConstraint instance would be:
ExtraNonlinearConstraint(
    stoichiometries = {
        "x_A": (1.0, "power2"),
        "R1": (-2, "exp"),
    },
    full_application = "log",
    lower_value = 0.5,
    upper_value = 2.1,
)
Allowed non-linear functions are currently 'powerX' (with X as float-readable exponent), 'exp' and 'log'. If you just want
the normal value, 'same' can be used (i.e. multiply with 1).
lower_value or upper_value can be None if no such limit is desired.
Also, full_application is by default 'same', which is to be set if no function on the full term is wished.</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExtraNonlinearConstraint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a general non-linear Model constraint.</span>

<span class="sd">    Important note: Setting such a non-linear watch makes any optimization non-linear and thus incompatible</span>
<span class="sd">    with linear solvers and computationally much more expensive!</span>

<span class="sd">    This can affect not only reactions, but also all other</span>
<span class="sd">    variables (including watches) set in a COBRA-k model. E.g., if one wants (for whatever</span>
<span class="sd">    reason) the following constraint:</span>
<span class="sd">    0.5 &lt;= log([A]^2 - 2 * exp(r_R1)) &lt;= 2.1</span>
<span class="sd">    the corresponding ExtraNonlinearConstraint instance would be:</span>
<span class="sd">    ExtraNonlinearConstraint(</span>
<span class="sd">        stoichiometries = {</span>
<span class="sd">            &quot;x_A&quot;: (1.0, &quot;power2&quot;),</span>
<span class="sd">            &quot;R1&quot;: (-2, &quot;exp&quot;),</span>
<span class="sd">        },</span>
<span class="sd">        full_application = &quot;log&quot;,</span>
<span class="sd">        lower_value = 0.5,</span>
<span class="sd">        upper_value = 2.1,</span>
<span class="sd">    )</span>
<span class="sd">    Allowed non-linear functions are currently &#39;powerX&#39; (with X as float-readable exponent), &#39;exp&#39; and &#39;log&#39;. If you just want</span>
<span class="sd">    the normal value, &#39;same&#39; can be used (i.e. multiply with 1).</span>
<span class="sd">    lower_value or upper_value can be None if no such limit is desired.</span>
<span class="sd">    Also, full_application is by default &#39;same&#39;, which is to be set if no function on the full term is wished.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">stoichiometries</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Keys: Model variable names; Children: (Multipliers of constraint, function name &#39;same&#39; (multiply with 1), &#39;powerX&#39; (with X as float-readable exponent), &#39;exp&#39; or &#39;log&#39;)&quot;&quot;&quot;</span>
    <span class="n">full_application</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;same&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Either function name &#39;same&#39; (multiply with 1), &#39;powerX&#39; (with X as float-readable exponent), &#39;exp&#39; or &#39;log&#39;). Defaults to &#39;same&#39;.&quot;&quot;&quot;</span>
    <span class="n">lower_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Minimal numeric constraint value. Either this and/or upper_value must be not None. Defaults to None.&quot;&quot;&quot;</span>
    <span class="n">upper_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Maximal numeric constraint value. Either this and/or lower_value must be not None. Defaults to None.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.ExtraNonlinearConstraint.full_application" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">full_application</span> <span class="o">=</span> <span class="s1">&#39;same&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Either function name 'same' (multiply with 1), 'powerX' (with X as float-readable exponent), 'exp' or 'log'). Defaults to 'same'.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.ExtraNonlinearConstraint.lower_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lower_value</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Minimal numeric constraint value. Either this and/or upper_value must be not None. Defaults to None.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.ExtraNonlinearConstraint.stoichiometries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stoichiometries</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Keys: Model variable names; Children: (Multipliers of constraint, function name 'same' (multiply with 1), 'powerX' (with X as float-readable exponent), 'exp' or 'log')</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.ExtraNonlinearConstraint.upper_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">upper_value</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Maximal numeric constraint value. Either this and/or lower_value must be not None. Defaults to None.</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.dataclasses.ExtraNonlinearWatch" class="doc doc-heading">
            <code>ExtraNonlinearWatch</code>


</h3>


    <div class="doc doc-contents ">


        <p>Represents a non-linear 'watch', i.e. a variable that shows the linear sum of other variables.</p>
<p>Important note: Setting such a non-linear watch makes any optimization non-linear and thus incompatible
with linear solvers and computationally much more expensive!</p>
<p>A watch can be not only about reactions, but also all other
variables (except of watches that are defined <em>after</em> this one in the Model's extra_linear_watches
member variable) set in a COBRAk model. E.g., if one wants (for whatever
reason) a variable for the following constraint:
exp([A]) - 2 * r_R1^3, we set
ExtraLinearWatch(
    stoichiometries = {
        "x_A": (1.0, "exp"),
        "R1": (-2, "power3"),
    },
)</p>
<p>Allowed non-linear functions are currently 'powerX' (with X as float-readable exponent), 'exp' and 'log'. If you just want
the normal value, 'same' can be used (i.e. multiply with 1).
The name of the watch is set in as dictionary key for the model's extra_linear_watches
member variable.</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExtraNonlinearWatch</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a non-linear &#39;watch&#39;, i.e. a variable that shows the linear sum of other variables.</span>

<span class="sd">    Important note: Setting such a non-linear watch makes any optimization non-linear and thus incompatible</span>
<span class="sd">    with linear solvers and computationally much more expensive!</span>

<span class="sd">    A watch can be not only about reactions, but also all other</span>
<span class="sd">    variables (except of watches that are defined *after* this one in the Model&#39;s extra_linear_watches</span>
<span class="sd">    member variable) set in a COBRAk model. E.g., if one wants (for whatever</span>
<span class="sd">    reason) a variable for the following constraint:</span>
<span class="sd">    exp([A]) - 2 * r_R1^3, we set</span>
<span class="sd">    ExtraLinearWatch(</span>
<span class="sd">        stoichiometries = {</span>
<span class="sd">            &quot;x_A&quot;: (1.0, &quot;exp&quot;),</span>
<span class="sd">            &quot;R1&quot;: (-2, &quot;power3&quot;),</span>
<span class="sd">        },</span>
<span class="sd">    )</span>

<span class="sd">    Allowed non-linear functions are currently &#39;powerX&#39; (with X as float-readable exponent), &#39;exp&#39; and &#39;log&#39;. If you just want</span>
<span class="sd">    the normal value, &#39;same&#39; can be used (i.e. multiply with 1).</span>
<span class="sd">    The name of the watch is set in as dictionary key for the model&#39;s extra_linear_watches</span>
<span class="sd">    member variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">stoichiometries</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.dataclasses.HillCoefficients" class="doc doc-heading">
            <code>HillCoefficients</code>


</h3>


    <div class="doc doc-contents ">


        <p>Represents the Hill coefficients of a reactions, seperated according to efficiency terms</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">HillCoefficients</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents the Hill coefficients of a reactions, seperated according to efficiency terms&quot;&quot;&quot;</span>

    <span class="n">kappa</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PositiveFloat</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Hill coefficients affecting the  saturation term. Metabolite IDs are keys, coefficients values. Defaults to {}.&quot;&quot;&quot;</span>
    <span class="n">iota</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PositiveFloat</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Hill coefficients affecting the  inhibition term. Metabolite IDs are keys, coefficients values. Defaults to {}.&quot;&quot;&quot;</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PositiveFloat</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Hill coefficients affecting the  activation term. Metabolite IDs are keys, coefficients values. Defaults to {}.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.HillCoefficients.alpha" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">alpha</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Hill coefficients affecting the  activation term. Metabolite IDs are keys, coefficients values. Defaults to {}.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.HillCoefficients.iota" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">iota</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Hill coefficients affecting the  inhibition term. Metabolite IDs are keys, coefficients values. Defaults to {}.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.HillCoefficients.kappa" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">kappa</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Hill coefficients affecting the  saturation term. Metabolite IDs are keys, coefficients values. Defaults to {}.</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.dataclasses.HillParameterReferences" class="doc doc-heading">
            <code>HillParameterReferences</code>


</h3>


    <div class="doc doc-contents ">


        <p>Represents the database reference for the ,  and  Hill coefficients.</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">HillParameterReferences</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents the database reference for the ,  and  Hill coefficients.&quot;&quot;&quot;</span>

    <span class="n">kappa</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;References for  Hill coefficients.&quot;&quot;&quot;</span>
    <span class="n">iota</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;References for  Hill coefficients.&quot;&quot;&quot;</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;References for  Hill coefficients.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.HillParameterReferences.alpha" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">alpha</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>References for  Hill coefficients.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.HillParameterReferences.iota" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">iota</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>References for  Hill coefficients.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.HillParameterReferences.kappa" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">kappa</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>References for  Hill coefficients.</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.dataclasses.Metabolite" class="doc doc-heading">
            <code>Metabolite</code>


</h3>


    <div class="doc doc-contents ">


        <p>Represents a Model's metabolite.</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Metabolite</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a Model&#39;s metabolite.&quot;&quot;&quot;</span>

    <span class="n">log_min_conc</span><span class="p">:</span> <span class="n">FiniteFloat</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Maximal logarithmic concentration (only relevant for thermodynamic constraints); Default is log(1e-6 M)&quot;&quot;&quot;</span>
    <span class="n">log_max_conc</span><span class="p">:</span> <span class="n">FiniteFloat</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Maximal logarithmic concentration (only relevant for thermodynamic constraints); Default is log(0.02 M)&quot;&quot;&quot;</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Optional annotation (e.g., CHEBI numbers, ...); Default is {}&quot;&quot;&quot;</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Colloquial name of metabolite&quot;&quot;&quot;</span>
    <span class="n">formula</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Chemical formula of metabolite&quot;&quot;&quot;</span>
    <span class="n">charge</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Electron charge of metabolite&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Metabolite.annotation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">annotation</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Optional annotation (e.g., CHEBI numbers, ...); Default is {}</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Metabolite.charge" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Electron charge of metabolite</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Metabolite.formula" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Chemical formula of metabolite</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Metabolite.log_max_conc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_max_conc</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Maximal logarithmic concentration (only relevant for thermodynamic constraints); Default is log(0.02 M)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Metabolite.log_min_conc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_min_conc</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="mf">1e-06</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Maximal logarithmic concentration (only relevant for thermodynamic constraints); Default is log(1e-6 M)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Metabolite.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Colloquial name of metabolite</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.dataclasses.Model" class="doc doc-heading">
            <code>Model</code>


</h3>


    <div class="doc doc-contents ">


        <p>Represents a metabolic model in COBRAk.</p>
<p>This includes its Reaction instances (which define the reaction stoichiometries),
its Metabolite instances (which are referenced in the mentioned stoichiometries),
as well as optional enzymatic and thermodynamic data.</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a metabolic model in COBRAk.</span>

<span class="sd">    This includes its Reaction instances (which define the reaction stoichiometries),</span>
<span class="sd">    its Metabolite instances (which are referenced in the mentioned stoichiometries),</span>
<span class="sd">    as well as optional enzymatic and thermodynamic data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">metabolites</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Metabolite</span><span class="p">]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Keys: Metabolite IDs; Children: Metabolite instances&quot;&quot;&quot;</span>
    <span class="n">reactions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Reaction</span><span class="p">]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Keys: Reaction IDs; Children: Reaction instances&quot;&quot;&quot;</span>
    <span class="n">enzymes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enzyme</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Only neccessary with enzymatic constraints] Keys: Enzyme IDs; Children: Enzyme instances; default is {}&quot;&quot;&quot;</span>
    <span class="n">max_prot_pool</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1e9</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Only neccessary with enzymatic constraints] Maximal usable protein pool in g/gDW; default is 1e9, i.e. basically unrestricted&quot;&quot;&quot;</span>
    <span class="n">extra_linear_watches</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ExtraLinearWatch</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] Extra non-linear watches. Keys are watch names, children the watch definition.&quot;&quot;&quot;</span>
    <span class="n">extra_nonlinear_watches</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ExtraNonlinearWatch</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span>
    <span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] Extra non-linear watches. Keys are watch names, children the watch definition.&quot;&quot;&quot;</span>
    <span class="n">extra_linear_constraints</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ExtraLinearConstraint</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] Extra linear constraints&quot;&quot;&quot;</span>
    <span class="n">extra_nonlinear_constraints</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ExtraNonlinearConstraint</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span>
    <span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] Extra non-linear constraints&quot;&quot;&quot;</span>
    <span class="n">kinetic_ignored_metabolites</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional and only works with saturation term constraints] Metabolite IDs for which no k_m is neccessary&quot;&quot;&quot;</span>
    <span class="n">R</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">STANDARD_R</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional and only works with thermodynamic constraints] Gas constant reference for dG&#39; in kJKmol; default is STANDARD_R&quot;&quot;&quot;</span>
    <span class="n">T</span><span class="p">:</span> <span class="n">PositiveFloat</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">STANDARD_T</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional and only works with thermodynamic constraints] Temperature reference for dG&#39; in K; default is STANDARD_T&quot;&quot;&quot;</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] Any annotation for the model itself (e.g., its name or references). Has no effect on calculations.&quot;&quot;&quot;</span>
    <span class="n">reac_enz_separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_ENZ_SEPARATOR</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] String infix that separated reaction IDs of reaction with multiple enzyme variants from their enzyme ID. Defaults to &#39;_ENZ_&#39;&quot;&quot;&quot;</span>
    <span class="n">fwd_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_FWD_SUFFIX</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] Reaction ID suffix of forward reaction variants (e.g. in a reversible reaction AB, for the direction AB). Default is &#39;_FWD&#39;&quot;&quot;&quot;</span>
    <span class="n">rev_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_REV_SUFFIX</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] Reaction ID suffix of reverse reaction variants (e.g. in a reversible reaction AB, for the direction BA). Default is &#39;_REV&#39;&quot;&quot;&quot;</span>
    <span class="n">max_conc_sum</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional and only works with thermodynamic constraints] Maximal allowed sum of concentrations (for MILPs: linear approximation; for NLPs: Exact value). Inactive if set to default value of float(&#39;inf&#39;)&quot;&quot;&quot;</span>
    <span class="n">conc_sum_ignore_prefixes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional and only works with thermodynamic constraints] &quot;&quot;&quot;</span>
    <span class="n">conc_sum_include_suffixes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional and only works with thermodynamic constraints] &quot;&quot;&quot;</span>
    <span class="n">conc_sum_max_rel_error</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional and only works with MILPs with thermodynamic constraints] Maximal relative concentration sum approximation error&quot;&quot;&quot;</span>
    <span class="n">conc_sum_min_abs_error</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional and only works with MILPs with thermodynamic constraints] Maximal absolute concentration sum approximation error&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># noqa: ANN204</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method called when entering &#39;with&#39; blocks&quot;&quot;&quot;</span>
        <span class="c1"># Return a deep copy of self</span>
        <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>  <span class="c1"># noqa: ANN001, ANN204</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method called when leaving a &#39;with&#39; block&quot;&quot;&quot;</span>
        <span class="k">return</span>  <span class="c1"># Return None to propagate any exceptions</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.R" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">R</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">STANDARD_R</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional and only works with thermodynamic constraints] Gas constant reference for dG' in kJKmol; default is STANDARD_R</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.T" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">T</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">STANDARD_T</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional and only works with thermodynamic constraints] Temperature reference for dG' in K; default is STANDARD_T</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.annotation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">annotation</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] Any annotation for the model itself (e.g., its name or references). Has no effect on calculations.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.conc_sum_ignore_prefixes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">conc_sum_ignore_prefixes</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional and only works with thermodynamic constraints]</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.conc_sum_include_suffixes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">conc_sum_include_suffixes</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional and only works with thermodynamic constraints]</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.conc_sum_max_rel_error" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">conc_sum_max_rel_error</span> <span class="o">=</span> <span class="mf">0.05</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional and only works with MILPs with thermodynamic constraints] Maximal relative concentration sum approximation error</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.conc_sum_min_abs_error" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">conc_sum_min_abs_error</span> <span class="o">=</span> <span class="mf">1e-06</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional and only works with MILPs with thermodynamic constraints] Maximal absolute concentration sum approximation error</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.enzymes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">enzymes</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Only neccessary with enzymatic constraints] Keys: Enzyme IDs; Children: Enzyme instances; default is {}</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.extra_linear_constraints" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extra_linear_constraints</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] Extra linear constraints</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.extra_linear_watches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extra_linear_watches</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] Extra non-linear watches. Keys are watch names, children the watch definition.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.extra_nonlinear_constraints" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extra_nonlinear_constraints</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] Extra non-linear constraints</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.extra_nonlinear_watches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extra_nonlinear_watches</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] Extra non-linear watches. Keys are watch names, children the watch definition.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.fwd_suffix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fwd_suffix</span> <span class="o">=</span> <span class="n">REAC_FWD_SUFFIX</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] Reaction ID suffix of forward reaction variants (e.g. in a reversible reaction AB, for the direction AB). Default is '_FWD'</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.kinetic_ignored_metabolites" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">kinetic_ignored_metabolites</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional and only works with saturation term constraints] Metabolite IDs for which no k_m is neccessary</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.max_conc_sum" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_conc_sum</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional and only works with thermodynamic constraints] Maximal allowed sum of concentrations (for MILPs: linear approximation; for NLPs: Exact value). Inactive if set to default value of float('inf')</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.max_prot_pool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_prot_pool</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1000000000.0</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Only neccessary with enzymatic constraints] Maximal usable protein pool in g/gDW; default is 1e9, i.e. basically unrestricted</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.metabolites" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">metabolites</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Keys: Metabolite IDs; Children: Metabolite instances</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.reac_enz_separator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reac_enz_separator</span> <span class="o">=</span> <span class="n">REAC_ENZ_SEPARATOR</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] String infix that separated reaction IDs of reaction with multiple enzyme variants from their enzyme ID. Defaults to '<em>ENZ</em>'</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.reactions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reactions</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Keys: Reaction IDs; Children: Reaction instances</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Model.rev_suffix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rev_suffix</span> <span class="o">=</span> <span class="n">REAC_REV_SUFFIX</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] Reaction ID suffix of reverse reaction variants (e.g. in a reversible reaction AB, for the direction BA). Default is '_REV'</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="cobrak.dataclasses.Model.__enter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__enter__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Method called when entering 'with' blocks</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># noqa: ANN204</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Method called when entering &#39;with&#39; blocks&quot;&quot;&quot;</span>
    <span class="c1"># Return a deep copy of self</span>
    <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cobrak.dataclasses.Model.__exit__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__exit__</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Method called when leaving a 'with' block</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>  <span class="c1"># noqa: ANN001, ANN204</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Method called when leaving a &#39;with&#39; block&quot;&quot;&quot;</span>
    <span class="k">return</span>  <span class="c1"># Return None to propagate any exceptions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.dataclasses.ParameterReference" class="doc doc-heading">
            <code>ParameterReference</code>


</h3>


    <div class="doc doc-contents ">


        <p>Represents the database reference for a kinetic parameter.</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ParameterReference</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents the database reference for a kinetic parameter.&quot;&quot;&quot;</span>

    <span class="n">database</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;(If given) The database from which this parameter was read. Defaults to &#39;&#39;.&quot;&quot;&quot;</span>
    <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;(no refs)&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Any comment given for this value (e.g. literature)? Defaults to &#39;(no refs)&#39;.&quot;&quot;&quot;</span>
    <span class="n">species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scientific name of the species where this value was measured. Defaults to &#39;&#39;.&quot;&quot;&quot;</span>
    <span class="n">substrate</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The metabolite (or reaction substrate) for which this value was measured. Defaults to &#39;&#39;.&quot;&quot;&quot;</span>
    <span class="n">pubs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>
    <span class="n">tax_distance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.ParameterReference.comment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;(no refs)&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Any comment given for this value (e.g. literature)? Defaults to '(no refs)'.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.ParameterReference.database" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">database</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>(If given) The database from which this parameter was read. Defaults to ''.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.ParameterReference.pubs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pubs</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.ParameterReference.species" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">species</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Scientific name of the species where this value was measured. Defaults to ''.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.ParameterReference.substrate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">substrate</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The metabolite (or reaction substrate) for which this value was measured. Defaults to ''.</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.dataclasses.Reaction" class="doc doc-heading">
            <code>Reaction</code>


</h3>


    <div class="doc doc-contents ">


        <p>Represents a Model's reaction.</p>
<p>E.g., a reaction
A -&gt; B [0; 1000], G'=12.1 kJmol, catalyzed by E1 with k_cat=1000 h
would be
Reaction(
    stoichiometries: {
        "A": -1,
        "B": +1,
    },
    min_flux: 0,
    max_flux: 1000,
    dG0=12.1,
    dG0_uncertainty=None,
    enzyme_reaction_data=EnzymeReactionData(
        identifiers=["E1"],
        k_cat=1000,
        k_ms=None,
        k_is=None,
        k_as=None,
        hill_coefficients=None,
    ),
    annotation={}, # Can be also ignored
)</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Reaction</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a Model&#39;s reaction.</span>

<span class="sd">    E.g., a reaction</span>
<span class="sd">    A -&gt; B [0; 1000], G&#39;=12.1 kJmol, catalyzed by E1 with k_cat=1000 h</span>
<span class="sd">    would be</span>
<span class="sd">    Reaction(</span>
<span class="sd">        stoichiometries: {</span>
<span class="sd">            &quot;A&quot;: -1,</span>
<span class="sd">            &quot;B&quot;: +1,</span>
<span class="sd">        },</span>
<span class="sd">        min_flux: 0,</span>
<span class="sd">        max_flux: 1000,</span>
<span class="sd">        dG0=12.1,</span>
<span class="sd">        dG0_uncertainty=None,</span>
<span class="sd">        enzyme_reaction_data=EnzymeReactionData(</span>
<span class="sd">            identifiers=[&quot;E1&quot;],</span>
<span class="sd">            k_cat=1000,</span>
<span class="sd">            k_ms=None,</span>
<span class="sd">            k_is=None,</span>
<span class="sd">            k_as=None,</span>
<span class="sd">            hill_coefficients=None,</span>
<span class="sd">        ),</span>
<span class="sd">        annotation={}, # Can be also ignored</span>
<span class="sd">    )</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">stoichiometries</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Metabolite stoichiometries&quot;&quot;&quot;</span>
    <span class="n">min_flux</span><span class="p">:</span> <span class="nb">float</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Minimal flux (for COBRAk, this must be  0)&quot;&quot;&quot;</span>
    <span class="n">max_flux</span><span class="p">:</span> <span class="nb">float</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Maximal flux (must be &gt;= min_flux)&quot;&quot;&quot;</span>
    <span class="n">dG0</span><span class="p">:</span> <span class="n">FiniteFloat</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;If given, the Gibb&#39;s free energy of the reaction (only relevant for thermodynamic constraints); Default is None&quot;&quot;&quot;</span>
    <span class="n">dG0_uncertainty</span><span class="p">:</span> <span class="n">FiniteFloat</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;If given, the Gibb&#39;s free energy&#39;s uncertainty (only relevant for thermodynamic constraints); Default is None&quot;&quot;&quot;</span>
    <span class="n">enzyme_reaction_data</span><span class="p">:</span> <span class="n">EnzymeReactionData</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;If given, enzymatic data (only relevant for enzymatic constraints); Default is None&quot;&quot;&quot;</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Optional annotation (e.g., KEGG identifiers, ...)&quot;&quot;&quot;</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Colloquial name of reaction&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Reaction.annotation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">annotation</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Optional annotation (e.g., KEGG identifiers, ...)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Reaction.dG0" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dG0</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>If given, the Gibb's free energy of the reaction (only relevant for thermodynamic constraints); Default is None</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Reaction.dG0_uncertainty" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dG0_uncertainty</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>If given, the Gibb's free energy's uncertainty (only relevant for thermodynamic constraints); Default is None</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Reaction.enzyme_reaction_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">enzyme_reaction_data</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>If given, enzymatic data (only relevant for enzymatic constraints); Default is None</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Reaction.max_flux" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_flux</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Maximal flux (must be &gt;= min_flux)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Reaction.min_flux" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">min_flux</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Minimal flux (for COBRAk, this must be  0)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Reaction.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Colloquial name of reaction</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Reaction.stoichiometries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stoichiometries</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Metabolite stoichiometries</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.dataclasses.Solver" class="doc doc-heading">
            <code>Solver</code>


</h3>


    <div class="doc doc-contents ">


        <p>Represents options for a pyomo-compatible solver</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/dataclasses.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Solver</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents options for a pyomo-compatible solver&quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The solver&#39;s name. E.g. &#39;scip&#39; for SCIP and &#39;cplex_direct&#39; for CPLEX.&quot;&quot;&quot;</span>
    <span class="n">solver_options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] Options transmitted to the solver itself.&quot;&quot;&quot;</span>
    <span class="n">solver_attrs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] Options set on the solver object in pyomo.&quot;&quot;&quot;</span>
    <span class="n">solve_extra_options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[Optional] Options set on pyomo&#39;s solve function.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Solver.name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">name</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The solver's name. E.g. 'scip' for SCIP and 'cplex_direct' for CPLEX.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Solver.solve_extra_options" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solve_extra_options</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] Options set on pyomo's solve function.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Solver.solver_attrs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solver_attrs</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] Options set on the solver object in pyomo.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.dataclasses.Solver.solver_options" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solver_options</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[Optional] Options transmitted to the solver itself.</p>

    </div>

</div>





  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.equilibrator_functionality" class="doc doc-heading">
            <code>equilibrator_functionality</code>


</h2>

    <div class="doc doc-contents ">

        <p>This script is a wrapper for the G' determination with the eQuilibrator API.</p>
<p>This wrapper intends to work with BiGG-styled cobrapy metabolic models.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.equilibrator_functionality.equilibrator_get_model_dG0_and_uncertainty_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">equilibrator_get_model_dG0_and_uncertainty_values</span><span class="p">(</span><span class="n">sbml_path</span><span class="p">,</span> <span class="n">inner_to_outer_compartments</span><span class="p">,</span> <span class="n">phs</span><span class="p">,</span> <span class="n">pmgs</span><span class="p">,</span> <span class="n">ionic_strengths</span><span class="p">,</span> <span class="n">potential_differences</span><span class="p">,</span> <span class="n">exclusion_prefixes</span><span class="o">=</span><span class="p">[],</span> <span class="n">exclusion_inner_parts</span><span class="o">=</span><span class="p">[],</span> <span class="n">ignore_uncertainty</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_uncertainty</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Cobrapy model wrapper for the G' determination of reactions using the eQuilibrator-API.</p>
<p>Reactions are identified according to all annotation (in the cobrapy reaction's annotation member variable)
given in this modules global USED_IDENTIFIERS list.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sbml_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the SBML-encoded constraint-based metabolic model for which G' values are determined.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>inner_to_outer_compartments</code>
            </td>
            <td>
                  <code><span title="List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list with compartment IDs going from inner (e.g., in E. coli,
the cytosol or 'c' in iML1515) to outer (e.g., the extracellular component or 'e' in iML1515). Used
for the G' calculation in multi-compartmental reactions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>phs</code>
            </td>
            <td>
                  <code><span title="Dict">Dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with compartment IDs as keys and the compartment pHs as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pmgs</code>
            </td>
            <td>
                  <code><span title="Dict">Dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with compartment IDs as keys and the compartment pMgs as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ionic_strengths</code>
            </td>
            <td>
                  <code><span title="Dict">Dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary with compartment IDs as keys and the ionic strengths as values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>potential_differences</code>
            </td>
            <td>
                  <code><span title="Dict">Dict</span>[<span title="Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>], <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing tuples with 2 elements describing
the ID of an innter and outer compartment, and the potential difference between them.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_uncertainty</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximal accepted uncertainty value (defaults to 1000 kJmol). If a calculated uncertainty
is higher than this value, the associated G' is <em>not</em> used (i.e., the specific reaction gets no G').</p>
              </div>
            </td>
            <td>
                  <code>1000.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>], <span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict[str, Dict[str, float]]: A dictionary with the reaction IDs as keys, and dictionaries as values which,
in turn, contain the G' of a reaction under the key 'dG0' and the calculated uncertainty as 'uncertainty'.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/equilibrator_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">equilibrator_get_model_dG0_and_uncertainty_values</span><span class="p">(</span>
    <span class="n">sbml_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">inner_to_outer_compartments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">phs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">pmgs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">ionic_strengths</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">potential_differences</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">exclusion_prefixes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">exclusion_inner_parts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">ignore_uncertainty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">max_uncertainty</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1_000.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cobrapy model wrapper for the G&#39; determination of reactions using the eQuilibrator-API.</span>

<span class="sd">    Reactions are identified according to all annotation (in the cobrapy reaction&#39;s annotation member variable)</span>
<span class="sd">    given in this modules global USED_IDENTIFIERS list.</span>

<span class="sd">    Args:</span>
<span class="sd">        sbml_path (str): The path to the SBML-encoded constraint-based metabolic model for which G&#39; values are determined.</span>
<span class="sd">        inner_to_outer_compartments (List[str]): A list with compartment IDs going from inner (e.g., in E. coli,</span>
<span class="sd">            the cytosol or &#39;c&#39; in iML1515) to outer (e.g., the extracellular component or &#39;e&#39; in iML1515). Used</span>
<span class="sd">            for the G&#39; calculation in multi-compartmental reactions.</span>
<span class="sd">        phs (Dict[str, float]): A dictionary with compartment IDs as keys and the compartment pHs as values.</span>
<span class="sd">        pmgs (Dict[str, float]): A dictionary with compartment IDs as keys and the compartment pMgs as values.</span>
<span class="sd">        ionic_strengths (Dict[str, float]): A dictionary with compartment IDs as keys and the ionic strengths as values.</span>
<span class="sd">        potential_differences (Dict[Tuple[str, str], float]): A dictionary containing tuples with 2 elements describing</span>
<span class="sd">            the ID of an innter and outer compartment, and the potential difference between them.</span>
<span class="sd">        max_uncertainty (float): The maximal accepted uncertainty value (defaults to 1000 kJmol). If a calculated uncertainty</span>
<span class="sd">            is higher than this value, the associated G&#39; is *not* used (i.e., the specific reaction gets no G&#39;).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict[str, Dict[str, float]]: A dictionary with the reaction IDs as keys, and dictionaries as values which,</span>
<span class="sd">            in turn, contain the G&#39; of a reaction under the key &#39;dG0&#39; and the calculated uncertainty as &#39;uncertainty&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cobra_model</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_sbml_model</span><span class="p">(</span><span class="n">sbml_path</span><span class="p">)</span>

    <span class="n">reaction_dG0s</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">reaction_dG0_uncertainties</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">cc</span> <span class="o">=</span> <span class="n">ComponentContribution</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">reaction_x</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="n">reaction</span><span class="p">:</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span> <span class="o">=</span> <span class="n">reaction_x</span>

        <span class="n">stop</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">exclusion_prefix</span> <span class="ow">in</span> <span class="n">exclusion_prefixes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">exclusion_prefix</span><span class="p">):</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">exclusion_inner_part</span> <span class="ow">in</span> <span class="n">exclusion_inner_parts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">exclusion_inner_part</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">stop</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">stoichiometries</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">compartments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">identifiers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">identifier_keys</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">metabolite_x</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">metabolites</span><span class="p">:</span>
            <span class="n">metabolite</span><span class="p">:</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Metabolite</span> <span class="o">=</span> <span class="n">metabolite_x</span>
            <span class="n">stoichiometries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">metabolites</span><span class="p">[</span><span class="n">metabolite</span><span class="p">])</span>
            <span class="n">compartments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metabolite</span><span class="o">.</span><span class="n">compartment</span><span class="p">)</span>
            <span class="n">identifier</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">used_identifier</span> <span class="ow">in</span> <span class="n">USED_IDENTIFIERS_FOR_EQUILIBRATOR</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">used_identifier</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">metabolite_identifiers</span> <span class="o">=</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="n">used_identifier</span><span class="p">]</span>
                <span class="n">identifier_temp</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metabolite_identifiers</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">identifier_temp</span> <span class="o">=</span> <span class="n">metabolite_identifiers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metabolite_identifiers</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">identifier_temp</span> <span class="o">=</span> <span class="n">metabolite_identifiers</span>
                <span class="k">if</span> <span class="n">used_identifier</span> <span class="o">==</span> <span class="s2">&quot;inchi&quot;</span><span class="p">:</span>
                    <span class="n">compound</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">get_compound_by_inchi</span><span class="p">(</span><span class="n">identifier_temp</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">used_identifier</span> <span class="o">==</span> <span class="s2">&quot;inchi_key&quot;</span><span class="p">:</span>
                    <span class="n">compound_list</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">search_compound_by_inchi_key</span><span class="p">(</span><span class="n">identifier_temp</span><span class="p">)</span>
                    <span class="n">compound</span> <span class="o">=</span> <span class="n">compound_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">compound_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">identifier_temp</span> <span class="o">=</span> <span class="n">used_identifier</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">identifier_temp</span>
                    <span class="n">compound</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">get_compound</span><span class="p">(</span><span class="n">identifier_temp</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">compound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">identifier_key</span> <span class="o">=</span> <span class="n">used_identifier</span>
                    <span class="n">identifier</span> <span class="o">=</span> <span class="n">identifier_temp</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">identifier</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">identifier_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">identifier_key</span><span class="p">)</span>
            <span class="n">identifiers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">identifier</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">identifier</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;ERROR: Metabolite </span><span class="si">{</span><span class="n">metabolite_x</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> has no identifier of the given types!&quot;</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">metabolite_x</span><span class="o">.</span><span class="n">annotation</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="c1"># Check for three cases:</span>
        <span class="c1"># 1: Single-compartment reaction</span>
        <span class="c1"># 2: Double-compartment reaction</span>
        <span class="c1"># 3: Multi-compartment reaction (not possible)</span>
        <span class="n">unique_reaction_compartments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">compartments</span><span class="p">))</span>
        <span class="n">num_compartments</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_reaction_compartments</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_compartments</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Set compartment conditions</span>
            <span class="n">compartment</span> <span class="o">=</span> <span class="n">unique_reaction_compartments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">cc</span><span class="o">.</span><span class="n">p_h</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">phs</span><span class="p">[</span><span class="n">compartment</span><span class="p">])</span>
            <span class="n">cc</span><span class="o">.</span><span class="n">p_mg</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">pmgs</span><span class="p">[</span><span class="n">compartment</span><span class="p">])</span>
            <span class="n">cc</span><span class="o">.</span><span class="n">ionic_strength</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ionic_strengths</span><span class="p">[</span><span class="n">compartment</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;mM&quot;</span><span class="p">)</span>

            <span class="c1"># Build together reaction</span>
            <span class="n">reaction_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stoichiometries</span><span class="p">)):</span>
                <span class="n">identifier_string</span> <span class="o">=</span> <span class="n">identifiers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">identifier_key</span> <span class="o">=</span> <span class="n">identifier_keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">stoichiometry</span> <span class="o">=</span> <span class="n">stoichiometries</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">identifier_key</span> <span class="o">==</span> <span class="s2">&quot;inchi&quot;</span><span class="p">:</span>
                    <span class="n">compound</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">get_compound_by_inchi</span><span class="p">(</span><span class="n">identifier_string</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">identifier_key</span> <span class="o">==</span> <span class="s2">&quot;inchi_key&quot;</span><span class="p">:</span>
                    <span class="n">compound</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">search_compound_by_inchi_key</span><span class="p">(</span><span class="n">identifier_string</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">compound</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">get_compound</span><span class="p">(</span><span class="n">identifier_string</span><span class="p">)</span>
                <span class="n">reaction_dict</span><span class="p">[</span><span class="n">compound</span><span class="p">]</span> <span class="o">=</span> <span class="n">stoichiometry</span>
            <span class="n">cc_reaction</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="n">reaction_dict</span><span class="p">)</span>

            <span class="c1"># Check whether or not the reaction is balanced and...</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">cc_reaction</span><span class="o">.</span><span class="n">is_balanced</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;INFO: Reaction </span><span class="si">{</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> is not balanced&quot;</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="n">standard_dg_prime</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">standard_dg_prime</span><span class="p">(</span><span class="n">cc_reaction</span><span class="p">)</span>
            <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">standard_dg_prime</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s2">&quot;kJmol&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">uncertainty</span> <span class="o">&lt;</span> <span class="n">max_uncertainty</span><span class="p">:</span>
                <span class="n">dG0</span> <span class="o">=</span> <span class="n">standard_dg_prime</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s2">&quot;kJmol&quot;</span><span class="p">)</span>
                <span class="n">reaction_dG0s</span><span class="p">[</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">dG0</span>
                <span class="k">if</span> <span class="n">ignore_uncertainty</span><span class="p">:</span>
                    <span class="n">reaction_dG0_uncertainties</span><span class="p">[</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reaction_dG0_uncertainties</span><span class="p">[</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">uncertainty</span><span class="p">)</span>

                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;No error with reaction </span><span class="si">{</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">, G&#39; succesfully calculated!&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;INFO: Reaction </span><span class="si">{</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> uncertainty is too high with </span><span class="si">{</span><span class="n">uncertainty</span><span class="si">}</span><span class="s2"> kJmol; G&#39; not assigned for this reaction&quot;</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">num_compartments</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">index_zero</span> <span class="o">=</span> <span class="n">inner_to_outer_compartments</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
                <span class="n">unique_reaction_compartments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">index_one</span> <span class="o">=</span> <span class="n">inner_to_outer_compartments</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
                <span class="n">unique_reaction_compartments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">index_one</span> <span class="o">&gt;</span> <span class="n">index_zero</span><span class="p">:</span>
                <span class="n">outer_compartment</span> <span class="o">=</span> <span class="n">unique_reaction_compartments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">inner_compartment</span> <span class="o">=</span> <span class="n">unique_reaction_compartments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">outer_compartment</span> <span class="o">=</span> <span class="n">unique_reaction_compartments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">inner_compartment</span> <span class="o">=</span> <span class="n">unique_reaction_compartments</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">ph_inner</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">phs</span><span class="p">[</span><span class="n">inner_compartment</span><span class="p">])</span>
            <span class="n">ph_outer</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">phs</span><span class="p">[</span><span class="n">outer_compartment</span><span class="p">])</span>
            <span class="n">ionic_strength_inner</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ionic_strengths</span><span class="p">[</span><span class="n">inner_compartment</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; mM&quot;</span><span class="p">)</span>
            <span class="n">ionic_strength_outer</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ionic_strengths</span><span class="p">[</span><span class="n">outer_compartment</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; mM&quot;</span><span class="p">)</span>
            <span class="n">pmg_inner</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">pmgs</span><span class="p">[</span><span class="n">inner_compartment</span><span class="p">])</span>
            <span class="n">pmg_outer</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">pmgs</span><span class="p">[</span><span class="n">outer_compartment</span><span class="p">])</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">inner_compartment</span><span class="p">,</span> <span class="n">outer_compartment</span><span class="p">)</span> <span class="ow">in</span> <span class="n">potential_differences</span><span class="p">:</span>
                <span class="n">potential_difference</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">potential_differences</span><span class="p">[(</span><span class="n">inner_compartment</span><span class="p">,</span> <span class="n">outer_compartment</span><span class="p">)])</span>
                    <span class="o">+</span> <span class="s2">&quot; V&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">outer_compartment</span><span class="p">,</span> <span class="n">inner_compartment</span><span class="p">)</span> <span class="ow">in</span> <span class="n">potential_differences</span><span class="p">:</span>
                <span class="n">potential_difference</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">potential_differences</span><span class="p">[(</span><span class="n">outer_compartment</span><span class="p">,</span> <span class="n">inner_compartment</span><span class="p">)])</span>
                    <span class="o">+</span> <span class="s2">&quot; V&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR&quot;</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="n">inner_reaction_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">outer_reaction_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stoichiometries</span><span class="p">)):</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">identifiers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">stoichiometry</span> <span class="o">=</span> <span class="n">stoichiometries</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">compound_key</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">get_compound</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>  <span class="c1"># sqlalchemy.orm.exc.MultipleResultsFound</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="n">compound_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NONE in compound&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="n">compartments</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">inner_compartment</span><span class="p">:</span>
                    <span class="n">inner_reaction_dict</span><span class="p">[</span><span class="n">compound_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">stoichiometry</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">outer_reaction_dict</span><span class="p">[</span><span class="n">compound_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">stoichiometry</span>

            <span class="n">cc_inner_reaction</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="n">inner_reaction_dict</span><span class="p">)</span>
            <span class="n">cc_outer_reaction</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="n">outer_reaction_dict</span><span class="p">)</span>

            <span class="n">cc</span><span class="o">.</span><span class="n">p_h</span> <span class="o">=</span> <span class="n">ph_inner</span>
            <span class="n">cc</span><span class="o">.</span><span class="n">ionic_strength</span> <span class="o">=</span> <span class="n">ionic_strength_inner</span>
            <span class="n">cc</span><span class="o">.</span><span class="n">p_mg</span> <span class="o">=</span> <span class="n">pmg_inner</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">standard_dg_prime</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">multicompartmental_standard_dg_prime</span><span class="p">(</span>
                    <span class="n">cc_inner_reaction</span><span class="p">,</span>
                    <span class="n">cc_outer_reaction</span><span class="p">,</span>
                    <span class="n">e_potential_difference</span><span class="o">=</span><span class="n">potential_difference</span><span class="p">,</span>
                    <span class="n">p_h_outer</span><span class="o">=</span><span class="n">ph_outer</span><span class="p">,</span>
                    <span class="n">p_mg_outer</span><span class="o">=</span><span class="n">pmg_outer</span><span class="p">,</span>
                    <span class="n">ionic_strength_outer</span><span class="o">=</span><span class="n">ionic_strength_outer</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">standard_dg_prime</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s2">&quot;kJmol&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">uncertainty</span> <span class="o">&lt;</span> <span class="n">max_uncertainty</span><span class="p">:</span>
                    <span class="n">dG0</span> <span class="o">=</span> <span class="n">standard_dg_prime</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s2">&quot;kJmol&quot;</span><span class="p">)</span>
                    <span class="n">reaction_dG0s</span><span class="p">[</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">dG0</span>
                    <span class="k">if</span> <span class="n">ignore_uncertainty</span><span class="p">:</span>
                        <span class="n">reaction_dG0_uncertainties</span><span class="p">[</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">reaction_dG0_uncertainties</span><span class="p">[</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">uncertainty</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: Multi-compartmental reaction is not balanced&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: More than two compartments are not possible&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

    <span class="k">return</span> <span class="n">reaction_dG0s</span><span class="p">,</span> <span class="n">reaction_dG0_uncertainties</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.evolution" class="doc doc-heading">
            <code>evolution</code>


</h2>

    <div class="doc doc-contents ">

        <p>Includes functions for calling COBRA-k's genetic algorithm for global NLP-based optimization.</p>
<p>The actual genetic algorithm can be found in the module 'genetic'.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="cobrak.evolution.COBRAKProblem" class="doc doc-heading">
            <code>COBRAKProblem</code>


</h3>


    <div class="doc doc-contents ">


        <p>Represents a problem to be solved using evolutionary optimization techniques.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The original COBRA-k model to optimize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_target</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target values for the objectives.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sense of the objective function (1 for maximization, -1 for minimization).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variability_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The variability data for each reaction.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlp_dict_list</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of initial NLP solutions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>best_value</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The best value found so far.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_kappa</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use kappa parameter. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_gamma</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use gamma parameter. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_iota</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use iota parameter. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_alpha</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use alpha parameter. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_gens</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of generations in the evolutionary algorithm. Defaults to 5.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>algorithm</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;genetic&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of optimization algorithm to use. Defaults to "genetic", the only available algorithm right now.</p>
              </div>
            </td>
            <td>
                  <code>&#39;genetic&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lp_solver</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Solver (cobrak.dataclasses.Solver)" href="#cobrak.dataclasses.Solver">Solver</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The linear programming solver to use. Defaults to SCIP.</p>
              </div>
            </td>
            <td>
                  <code><span title="cobrak.standard_solvers.SCIP">SCIP</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlp_solver</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Solver (cobrak.dataclasses.Solver)" href="#cobrak.dataclasses.Solver">Solver</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The nonlinear programming solver to use. Defaults to IPOPT.</p>
              </div>
            </td>
            <td>
                  <code><span title="cobrak.standard_solvers.IPOPT">IPOPT</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objvalue_json_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the JSON file for storing objective values. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_rounds_same_objvalue</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of rounds with the same objective value before stopping. Defaults to float("inf").</p>
              </div>
            </td>
            <td>
                  <code><span title="float">float</span>(&#39;inf&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>correction_config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CorrectionConfig (cobrak.dataclasses.CorrectionConfig)" href="#cobrak.dataclasses.CorrectionConfig">CorrectionConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for corrections during optimization. Defaults to CorrectionConfig().</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CorrectionConfig (cobrak.dataclasses.CorrectionConfig)" href="#cobrak.dataclasses.CorrectionConfig">CorrectionConfig</a>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_abs_objvalue</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum absolute value of the objective function to consider as valid. Defaults to 1e-6.</p>
              </div>
            </td>
            <td>
                  <code>1e-06</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pop_size</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The population size for the evolutionary algorithm. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ignore_nonlinear_extra_terms_in_ectfbas</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(bool, optional): Whether or not non-linear watches/constraints shall be ignored in ecTFBAs. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.evolution.COBRAKProblem.original_cobrak_model">original_cobrak_model</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A deep copy of the original COBRA-k model.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.evolution.COBRAKProblem.blocked_reacs">blocked_reacs</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of blocked reactions.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.evolution.COBRAKProblem.initial_xs_list">initial_xs_list</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<span title="int">int</span> | <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial list of solutions for each NLP.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.evolution.COBRAKProblem.minimal_xs_dict">minimal_xs_dict</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="float">float</span>, <span title="list">list</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary to store minimal solutions.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.evolution.COBRAKProblem.variability_data">variability_data</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A deep copy of the variability data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.evolution.COBRAKProblem.idx_to_reac_ids">idx_to_reac_ids</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="int">int</span>, <span title="tuple">tuple</span>[<span title="str">str</span>, ...]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping from index to reaction IDs.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.evolution.COBRAKProblem.dim">dim</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dimension of the problem.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.evolution.COBRAKProblem.lp_solver">lp_solver</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Solver (cobrak.dataclasses.Solver)" href="#cobrak.dataclasses.Solver">Solver</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The linear programming solver.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.evolution.COBRAKProblem.nlp_solver">nlp_solver</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Solver (cobrak.dataclasses.Solver)" href="#cobrak.dataclasses.Solver">Solver</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The nonlinear programming solver.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.evolution.COBRAKProblem.temp_directory_name">temp_directory_name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the temporary directory for storing results.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.evolution.COBRAKProblem.best_value">best_value</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The best value found so far.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.evolution.COBRAKProblem.objvalue_json_path">objvalue_json_path</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the JSON file for objective values.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.evolution.COBRAKProblem.max_rounds_same_objvalue">max_rounds_same_objvalue</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of rounds with same objective value.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.evolution.COBRAKProblem.correction_config">correction_config</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CorrectionConfig (cobrak.dataclasses.CorrectionConfig)" href="#cobrak.dataclasses.CorrectionConfig">CorrectionConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for corrections.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.evolution.COBRAKProblem.min_abs_objvalue">min_abs_objvalue</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum absolute value of objective function to consider valid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>cobrak/evolution.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">COBRAKProblem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a problem to be solved using evolutionary optimization techniques.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The original COBRA-k model to optimize.</span>
<span class="sd">        objective_target (dict[str, float]): The target values for the objectives.</span>
<span class="sd">        objective_sense (int): The sense of the objective function (1 for maximization, -1 for minimization).</span>
<span class="sd">        variability_dict (dict[str, tuple[float, float]]): The variability data for each reaction.</span>
<span class="sd">        nlp_dict_list (list[dict[str, float]]): A list of initial NLP solutions.</span>
<span class="sd">        best_value (float): The best value found so far.</span>
<span class="sd">        with_kappa (bool, optional): Whether to use kappa parameter. Defaults to True.</span>
<span class="sd">        with_gamma (bool, optional): Whether to use gamma parameter. Defaults to True.</span>
<span class="sd">        with_iota (bool, optional): Whether to use iota parameter. Defaults to True.</span>
<span class="sd">        with_alpha (bool, optional): Whether to use alpha parameter. Defaults to True.</span>
<span class="sd">        num_gens (int, optional): The number of generations in the evolutionary algorithm. Defaults to 5.</span>
<span class="sd">        algorithm (Literal[&quot;genetic&quot;], optional): The type of optimization algorithm to use. Defaults to &quot;genetic&quot;, the only available algorithm right now.</span>
<span class="sd">        lp_solver (Solver, optional): The linear programming solver to use. Defaults to SCIP.</span>
<span class="sd">        nlp_solver (Solver, optional): The nonlinear programming solver to use. Defaults to IPOPT.</span>
<span class="sd">        objvalue_json_path (str, optional): The path to the JSON file for storing objective values. Defaults to &quot;&quot;.</span>
<span class="sd">        max_rounds_same_objvalue (float, optional): The maximum number of rounds with the same objective value before stopping. Defaults to float(&quot;inf&quot;).</span>
<span class="sd">        correction_config (CorrectionConfig, optional): Configuration for corrections during optimization. Defaults to CorrectionConfig().</span>
<span class="sd">        min_abs_objvalue (float, optional): The minimum absolute value of the objective function to consider as valid. Defaults to 1e-6.</span>
<span class="sd">        pop_size (int | None, optional): The population size for the evolutionary algorithm. Defaults to None.</span>
<span class="sd">        ignore_nonlinear_extra_terms_in_ectfbas: (bool, optional): Whether or not non-linear watches/constraints shall be ignored in ecTFBAs. Defaults to True.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        original_cobrak_model (Model): A deep copy of the original COBRA-k model.</span>
<span class="sd">        blocked_reacs (list[str]): List of blocked reactions.</span>
<span class="sd">        initial_xs_list (list[list[int | float]]): Initial list of solutions for each NLP.</span>
<span class="sd">        minimal_xs_dict (dict[float, list[float]]): Dictionary to store minimal solutions.</span>
<span class="sd">        variability_data (dict[str, tuple[float, float]]): A deep copy of the variability data.</span>
<span class="sd">        idx_to_reac_ids (dict[int, tuple[str, ...]]): Mapping from index to reaction IDs.</span>
<span class="sd">        dim (int): The dimension of the problem.</span>
<span class="sd">        lp_solver (Solver): The linear programming solver.</span>
<span class="sd">        nlp_solver (Solver): The nonlinear programming solver.</span>
<span class="sd">        temp_directory_name (str): Name of the temporary directory for storing results.</span>
<span class="sd">        best_value (float): The best value found so far.</span>
<span class="sd">        objvalue_json_path (str): Path to the JSON file for objective values.</span>
<span class="sd">        max_rounds_same_objvalue (float): Maximum number of rounds with same objective value.</span>
<span class="sd">        correction_config (CorrectionConfig): Configuration for corrections.</span>
<span class="sd">        min_abs_objvalue (float): Minimum absolute value of objective function to consider valid.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
        <span class="n">objective_target</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
        <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
        <span class="n">nlp_dict_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
        <span class="n">best_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">with_kappa</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">with_gamma</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">with_iota</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">with_alpha</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">num_gens</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">algorithm</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;genetic&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;genetic&quot;</span><span class="p">,</span>
        <span class="n">lp_solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">SCIP</span><span class="p">,</span>
        <span class="n">nlp_solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">IPOPT</span><span class="p">,</span>
        <span class="n">nlp_strict_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">nlp_single_strict_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">objvalue_json_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">max_rounds_same_objvalue</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
        <span class="n">correction_config</span><span class="p">:</span> <span class="n">CorrectionConfig</span> <span class="o">=</span> <span class="n">CorrectionConfig</span><span class="p">(),</span>
        <span class="n">min_abs_objvalue</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span>
        <span class="n">pop_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes a COBRAKProblem object.</span>

<span class="sd">        Args:</span>
<span class="sd">            cobrak_model (Model): The original COBRA-k model to optimize.</span>
<span class="sd">            objective_target (dict[str, float]): The target values for the objectives.</span>
<span class="sd">            objective_sense (int): The sense of the objective function (1 for maximization, -1 for minimization).</span>
<span class="sd">            variability_dict (dict[str, tuple[float, float]]): The variability data for each reaction.</span>
<span class="sd">            nlp_dict_list (list[dict[str, float]]): A list of initial NLP solutions.</span>
<span class="sd">            best_value (float): The best value found so far.</span>
<span class="sd">            with_kappa (bool, optional): Whether to use kappa parameter. Defaults to True.</span>
<span class="sd">            with_gamma (bool, optional): Whether to use gamma parameter. Defaults to True.</span>
<span class="sd">            with_iota (bool, optional): Whether to use iota parameter. Defaults to True.</span>
<span class="sd">            with_alpha (bool, optional): Whether to use alpha parameter. Defaults to True.</span>
<span class="sd">            num_gens (int, optional): The number of generations in the evolutionary algorithm. Defaults to 5.</span>
<span class="sd">            algorithm (Literal[&quot;genetic&quot;], optional): The type of optimization algorithm to use. Defaults to &quot;genetic&quot;, the only algorithm currently available.</span>
<span class="sd">            lp_solver (Solver, optional): The linear programming solver to use. Defaults to SCIP.</span>
<span class="sd">            nlp_solver (Solver, optional): The nonlinear programming solver to use. Defaults to IPOPT.</span>
<span class="sd">            nlp_strict_mode (bool, optional): Whether or not the &lt;= heuristic (True) or not (False; i.e. setting all equations to ==) shall be used. Defaults to False.</span>
<span class="sd">            nlp_single_strict_reacs (list[str], optional): List of single reactions that shall be in strict mode (see ```nlp_strict_mode```argument above).</span>
<span class="sd">                If ```nlp_strict_mode=True```, this has no effect. Defaults to [].</span>
<span class="sd">            objvalue_json_path (str, optional): The path to the JSON file for storing objective values. Defaults to &quot;&quot;.</span>
<span class="sd">            max_rounds_same_objvalue (float, optional): The maximum number of rounds with the same objective value before stopping. Defaults to float(&quot;inf&quot;).</span>
<span class="sd">            correction_config (CorrectionConfig, optional): Configuration for corrections during optimization. Defaults to CorrectionConfig().</span>
<span class="sd">            min_abs_objvalue (float, optional): The minimum absolute value of the objective function to consider as valid. Defaults to 1e-6.</span>
<span class="sd">            pop_size (int | None, optional): The population size for the evolutionary algorithm. Defaults to None.</span>
<span class="sd">            ignore_nonlinear_extra_terms_in_ectfbas: (bool, optional): Whether or not non-linear watches/constraints shall be ignored in ecTFBAs. Defaults to True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="p">:</span> <span class="n">Model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objective_target</span> <span class="o">=</span> <span class="n">objective_target</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objective_sense</span> <span class="o">=</span> <span class="n">objective_sense</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blocked_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_xs_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nlp_dict_list</span><span class="p">))</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minimal_xs_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">variability_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span> <span class="o">=</span> <span class="n">algorithm</span>

        <span class="n">reac_couples</span> <span class="o">=</span> <span class="n">get_stoichiometrically_coupled_reactions</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span>
        <span class="p">)</span>

        <span class="n">objective_target_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">objective_target</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">filtered_reac_couples</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">reac_couple</span> <span class="ow">in</span> <span class="n">reac_couples</span><span class="p">:</span>
            <span class="n">filtered_reac_couple</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">reac_id</span>
                <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">reac_couple</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">)</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
                    <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="p">)</span>
            <span class="p">]</span>

            <span class="n">found_invalid_id</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">objective_target_id</span> <span class="ow">in</span> <span class="n">objective_target_ids</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">objective_target_id</span> <span class="ow">in</span> <span class="n">filtered_reac_couple</span><span class="p">:</span>
                    <span class="n">found_invalid_id</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">correction_config</span><span class="o">.</span><span class="n">error_scenario</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">filtered_reac_couple</span><span class="p">:</span>
                    <span class="n">found_invalid_id</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">found_invalid_id</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_reac_couple</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">filtered_reac_couples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">filtered_reac_couple</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">idx_to_reac_ids</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">couple_idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">filtered_reac_couplex</span> <span class="ow">in</span> <span class="n">filtered_reac_couples</span><span class="p">:</span>
            <span class="n">nlp_idx</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">nlp_dict</span> <span class="ow">in</span> <span class="n">nlp_dict_list</span><span class="p">:</span>
                <span class="n">first_reac_id</span> <span class="o">=</span> <span class="n">filtered_reac_couplex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">first_reac_id</span> <span class="ow">in</span> <span class="n">nlp_dict</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nlp_dict</span><span class="p">[</span><span class="n">first_reac_id</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">initial_xs_list</span><span class="p">[</span><span class="n">nlp_idx</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="mf">1.0</span> <span class="k">if</span> <span class="n">algorithm</span> <span class="o">!=</span> <span class="s2">&quot;genetic&quot;</span> <span class="k">else</span> <span class="mi">1</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">initial_xs_list</span><span class="p">[</span><span class="n">nlp_idx</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="mf">0.0</span> <span class="k">if</span> <span class="n">algorithm</span> <span class="o">!=</span> <span class="s2">&quot;genetic&quot;</span> <span class="k">else</span> <span class="mi">0</span>
                    <span class="p">)</span>

                <span class="n">nlp_idx</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># noqa: SIM113</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">idx_to_reac_ids</span><span class="p">[</span><span class="n">couple_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_reac_couplex</span>
            <span class="n">couple_idx</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">with_kappa</span> <span class="o">=</span> <span class="n">with_kappa</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">with_gamma</span> <span class="o">=</span> <span class="n">with_gamma</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">with_iota</span> <span class="o">=</span> <span class="n">with_iota</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">with_alpha</span> <span class="o">=</span> <span class="n">with_alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">couple_idx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_gens</span> <span class="o">=</span> <span class="n">num_gens</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lp_solver</span> <span class="o">=</span> <span class="n">lp_solver</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlp_solver</span> <span class="o">=</span> <span class="n">nlp_solver</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlp_strict_mode</span> <span class="o">=</span> <span class="n">nlp_strict_mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlp_single_strict_reacs</span> <span class="o">=</span> <span class="n">nlp_single_strict_reacs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_directory_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">best_value</span> <span class="o">=</span> <span class="n">best_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_path</span> <span class="o">=</span> <span class="n">objvalue_json_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_rounds_same_objvalue</span> <span class="o">=</span> <span class="n">max_rounds_same_objvalue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">correction_config</span> <span class="o">=</span> <span class="n">correction_config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_abs_objvalue</span> <span class="o">=</span> <span class="n">min_abs_objvalue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pop_size</span> <span class="o">=</span> <span class="n">pop_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fitness</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the fitness of a given solution.</span>

<span class="sd">        Args:</span>
<span class="sd">            x (list[float | int]): The solution to evaluate.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[tuple[float, list[float | int]]]: A list of tuples, where each tuple contains the fitness value and the corresponding solution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Preliminary TFBA :3</span>
        <span class="n">deactivated_reactions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">couple_idx</span><span class="p">,</span> <span class="n">reac_ids</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_to_reac_ids</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">couple_idx</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.02</span><span class="p">:</span>
                <span class="n">deactivated_reactions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">reac_ids</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">first_ectfba_dict</span> <span class="o">=</span> <span class="n">perform_lp_optimization</span><span class="p">(</span>
                <span class="n">cobrak_model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="p">,</span>
                <span class="n">objective_target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_target</span><span class="p">,</span>
                <span class="n">objective_sense</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_sense</span><span class="p">,</span>
                <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">with_loop_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">variability_dict</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">),</span>
                <span class="n">ignored_reacs</span><span class="o">=</span><span class="n">deactivated_reactions</span><span class="p">,</span>
                <span class="n">solver</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lp_solver</span><span class="p">,</span>
                <span class="n">correction_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_config</span><span class="p">,</span>
                <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">ApplicationError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="n">first_ectfba_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">ALL_OK_KEY</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">first_ectfba_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]:</span>
            <span class="k">return</span> <span class="p">[(</span><span class="mf">1_000_000.0</span><span class="p">,</span> <span class="p">[])]</span>

        <span class="n">nlp_results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">is_objsense_maximization</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_sense</span><span class="p">):</span>
            <span class="n">lower_value</span> <span class="o">=</span> <span class="n">first_ectfba_dict</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1e-12</span>
            <span class="n">upper_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lower_value</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">upper_value</span> <span class="o">=</span> <span class="n">first_ectfba_dict</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1e-12</span>

        <span class="n">maxz_model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="p">)</span>
        <span class="n">maxz_model</span><span class="o">.</span><span class="n">extra_linear_constraints</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ExtraLinearConstraint</span><span class="p">(</span>
                <span class="n">stoichiometries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_target</span><span class="p">,</span>
                <span class="n">lower_value</span><span class="o">=</span><span class="n">lower_value</span><span class="p">,</span>
                <span class="n">upper_value</span><span class="o">=</span><span class="n">upper_value</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">]</span>
        <span class="n">maxz_model</span><span class="o">.</span><span class="n">extra_linear_constraints</span> <span class="o">+=</span> <span class="p">[</span>
            <span class="n">ExtraLinearConstraint</span><span class="p">(</span>
                <span class="n">stoichiometries</span><span class="o">=</span><span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Z_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">},</span>
                <span class="n">upper_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reac_data</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">reac_data</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">in</span> <span class="n">deactivated_reactions</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">eligible_z_sum_objective</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Z_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="mf">1.0</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reac_data</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">reac_data</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
            <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="ow">and</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deactivated_reactions</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">maxz_ectfba_dict</span> <span class="o">=</span> <span class="n">perform_lp_optimization</span><span class="p">(</span>
                <span class="n">cobrak_model</span><span class="o">=</span><span class="n">maxz_model</span><span class="p">,</span>
                <span class="n">objective_target</span><span class="o">=</span><span class="n">eligible_z_sum_objective</span><span class="p">,</span>
                <span class="n">objective_sense</span><span class="o">=+</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">with_loop_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">variability_dict</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">),</span>
                <span class="n">ignored_reacs</span><span class="o">=</span><span class="n">deactivated_reactions</span><span class="p">,</span>
                <span class="n">solver</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lp_solver</span><span class="p">,</span>
                <span class="n">correction_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_config</span><span class="p">,</span>
                <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">ApplicationError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="n">maxz_ectfba_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">ALL_OK_KEY</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">maxz_ectfba_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]:</span>
            <span class="n">used_maxz_tfba_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">maxz_ectfba_dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">reaction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deactivated_reactions</span><span class="p">)</span>
                <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                    <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="n">maxz_ectfba_dict</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Z_VAR_PREFIX</span><span class="si">}{</span><span class="n">var_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="n">used_maxz_tfba_dict</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">used_maxz_tfba_dict</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="n">used_maxz_tfba_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">used_maxz_tfba_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">second_nlp_dict</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">perform_nlp_irreversible_optimization_with_active_reacs_only</span><span class="p">(</span>
                            <span class="n">cobrak_model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="p">,</span>
                            <span class="n">objective_target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_target</span><span class="p">,</span>
                            <span class="n">objective_sense</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_sense</span><span class="p">,</span>
                            <span class="n">optimization_dict</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">used_maxz_tfba_dict</span><span class="p">),</span>
                            <span class="n">variability_dict</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">),</span>
                            <span class="n">with_kappa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_kappa</span><span class="p">,</span>
                            <span class="n">with_gamma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_gamma</span><span class="p">,</span>
                            <span class="n">with_iota</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_iota</span><span class="p">,</span>
                            <span class="n">with_alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_alpha</span><span class="p">,</span>
                            <span class="n">solver</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp_solver</span><span class="p">,</span>
                            <span class="n">correction_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_config</span><span class="p">,</span>
                            <span class="n">strict_mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp_strict_mode</span><span class="p">,</span>
                            <span class="n">single_strict_reacs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp_single_strict_reacs</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">second_nlp_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span>
                        <span class="nb">abs</span><span class="p">(</span><span class="n">second_nlp_dict</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">])</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_abs_objvalue</span>
                    <span class="p">):</span>
                        <span class="n">nlp_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">second_nlp_dict</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="n">ApplicationError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                    <span class="k">pass</span>

        <span class="c1">####</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">minz_ectfba_dict</span> <span class="o">=</span> <span class="n">perform_lp_optimization</span><span class="p">(</span>
                <span class="n">cobrak_model</span><span class="o">=</span><span class="n">maxz_model</span><span class="p">,</span>
                <span class="n">objective_target</span><span class="o">=</span><span class="n">eligible_z_sum_objective</span><span class="p">,</span>
                <span class="n">objective_sense</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">with_loop_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">variability_dict</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">),</span>
                <span class="n">ignored_reacs</span><span class="o">=</span><span class="n">deactivated_reactions</span><span class="p">,</span>
                <span class="n">solver</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lp_solver</span><span class="p">,</span>
                <span class="n">correction_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_config</span><span class="p">,</span>
                <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">ApplicationError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="n">minz_ectfba_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">ALL_OK_KEY</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">minz_ectfba_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]:</span>
            <span class="n">used_minz_tfba_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">minz_ectfba_dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">reaction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deactivated_reactions</span><span class="p">)</span>
                <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                    <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="n">minz_ectfba_dict</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Z_VAR_PREFIX</span><span class="si">}{</span><span class="n">var_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="n">used_minz_tfba_dict</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">used_minz_tfba_dict</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="n">used_minz_tfba_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">used_minz_tfba_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">third_nlp_dict</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">perform_nlp_irreversible_optimization_with_active_reacs_only</span><span class="p">(</span>
                            <span class="n">cobrak_model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="p">,</span>
                            <span class="n">objective_target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_target</span><span class="p">,</span>
                            <span class="n">objective_sense</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_sense</span><span class="p">,</span>
                            <span class="n">optimization_dict</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">used_minz_tfba_dict</span><span class="p">),</span>
                            <span class="n">variability_dict</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">),</span>
                            <span class="n">with_kappa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_kappa</span><span class="p">,</span>
                            <span class="n">with_gamma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_gamma</span><span class="p">,</span>
                            <span class="n">with_iota</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_iota</span><span class="p">,</span>
                            <span class="n">with_alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_alpha</span><span class="p">,</span>
                            <span class="n">solver</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp_solver</span><span class="p">,</span>
                            <span class="n">correction_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_config</span><span class="p">,</span>
                            <span class="n">strict_mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp_strict_mode</span><span class="p">,</span>
                            <span class="n">single_strict_reacs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp_single_strict_reacs</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">third_nlp_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span>
                        <span class="nb">abs</span><span class="p">(</span><span class="n">third_nlp_dict</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">])</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_abs_objvalue</span>
                    <span class="p">):</span>
                        <span class="n">nlp_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">third_nlp_dict</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="n">ApplicationError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                    <span class="k">pass</span>
        <span class="c1">####</span>

        <span class="n">output</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1_000_000</span><span class="p">,</span> <span class="p">[])]</span>
        <span class="k">for</span> <span class="n">nlp_result</span> <span class="ow">in</span> <span class="n">nlp_results</span><span class="p">:</span>
            <span class="n">objvalues</span> <span class="o">=</span> <span class="p">[</span><span class="n">nlp_result</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]</span> <span class="k">for</span> <span class="n">nlp_result</span> <span class="ow">in</span> <span class="n">nlp_results</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">is_objsense_maximization</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_sense</span><span class="p">):</span>
                <span class="n">opt_idx</span> <span class="o">=</span> <span class="n">objvalues</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">objvalues</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">opt_idx</span> <span class="o">=</span> <span class="n">objvalues</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">objvalues</span><span class="p">))</span>
            <span class="n">opt_nlp_dict</span> <span class="o">=</span> <span class="n">nlp_results</span><span class="p">[</span><span class="n">opt_idx</span><span class="p">]</span>

            <span class="n">objective_value</span> <span class="o">=</span> <span class="n">opt_nlp_dict</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_directory_name</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_directory_name</span><span class="si">}{</span><span class="n">objective_value</span><span class="si">}{</span><span class="n">time</span><span class="p">()</span><span class="si">}{</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1_000_000_000</span><span class="p">)</span><span class="si">}</span><span class="s2">.json&quot;</span>  <span class="c1"># noqa: NPY002</span>
                <span class="n">json_write</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">opt_nlp_dict</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">is_objsense_maximization</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_sense</span><span class="p">):</span>
                <span class="n">objective_value</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No error, objective value is:&quot;</span><span class="p">,</span> <span class="n">objective_value</span><span class="p">)</span>

            <span class="n">active_nlp_x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_to_reac_ids</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">couple_idx</span><span class="p">,</span> <span class="n">reac_ids</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_to_reac_ids</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">reac_id</span> <span class="o">=</span> <span class="n">reac_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">opt_nlp_dict</span> <span class="ow">or</span> <span class="n">opt_nlp_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">1e-11</span><span class="p">:</span>
                    <span class="n">set_value</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">set_value</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">active_nlp_x</span><span class="p">[</span><span class="n">couple_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">set_value</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">objective_value</span><span class="p">,</span> <span class="n">active_nlp_x</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">optimize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs the optimization process.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict[float, list[dict[str, float]]]: A dictionary containing the optimization results.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temp_directory</span> <span class="o">=</span> <span class="n">TemporaryDirectory</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_directory_name</span> <span class="o">=</span> <span class="n">standardize_folder</span><span class="p">(</span><span class="n">temp_directory</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">:</span>
            <span class="k">case</span> <span class="s2">&quot;genetic&quot;</span><span class="p">:</span>
                <span class="n">evolution</span> <span class="o">=</span> <span class="n">COBRAKGENETIC</span><span class="p">(</span>
                    <span class="n">fitness_function</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fitness</span><span class="p">,</span>
                    <span class="n">xs_dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span>
                    <span class="n">extra_xs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_xs_list</span><span class="p">,</span>
                    <span class="n">gen</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_gens</span><span class="p">,</span>
                    <span class="n">objvalue_json_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_path</span><span class="p">,</span>
                    <span class="n">max_rounds_same_objvalue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_rounds_same_objvalue</span><span class="p">,</span>
                    <span class="n">pop_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pop_size</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;ERROR: Evolution algorithm </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="si">}</span><span class="s2"> does not exist! Use &#39;genetic&#39;.&quot;</span>
                <span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>
        <span class="n">evolution</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="n">result_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">json_filename</span> <span class="ow">in</span> <span class="n">get_files</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_directory_name</span><span class="p">):</span>
            <span class="n">json_data</span> <span class="o">=</span> <span class="n">json_load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_directory_name</span><span class="si">}{</span><span class="n">json_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">Any</span><span class="p">)</span>
            <span class="n">objective_value</span> <span class="o">=</span> <span class="n">json_data</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">objective_value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result_dict</span><span class="p">:</span>
                <span class="n">result_dict</span><span class="p">[</span><span class="n">objective_value</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">result_dict</span><span class="p">[</span><span class="n">objective_value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">json_data</span><span class="p">))</span>

        <span class="n">temp_directory</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="n">result_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="cobrak.evolution.COBRAKProblem.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">objective_target</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">,</span> <span class="n">nlp_dict_list</span><span class="p">,</span> <span class="n">best_value</span><span class="p">,</span> <span class="n">with_kappa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_gamma</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_iota</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_alpha</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_gens</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;genetic&#39;</span><span class="p">,</span> <span class="n">lp_solver</span><span class="o">=</span><span class="n">SCIP</span><span class="p">,</span> <span class="n">nlp_solver</span><span class="o">=</span><span class="n">IPOPT</span><span class="p">,</span> <span class="n">nlp_strict_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nlp_single_strict_reacs</span><span class="o">=</span><span class="p">[],</span> <span class="n">objvalue_json_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">max_rounds_same_objvalue</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">correction_config</span><span class="o">=</span><span class="n">CorrectionConfig</span><span class="p">(),</span> <span class="n">min_abs_objvalue</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span> <span class="n">pop_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Initializes a COBRAKProblem object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The original COBRA-k model to optimize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_target</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target values for the objectives.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sense of the objective function (1 for maximization, -1 for minimization).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variability_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The variability data for each reaction.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlp_dict_list</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of initial NLP solutions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>best_value</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The best value found so far.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_kappa</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use kappa parameter. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_gamma</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use gamma parameter. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_iota</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use iota parameter. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_alpha</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use alpha parameter. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_gens</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of generations in the evolutionary algorithm. Defaults to 5.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>algorithm</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;genetic&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of optimization algorithm to use. Defaults to "genetic", the only algorithm currently available.</p>
              </div>
            </td>
            <td>
                  <code>&#39;genetic&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lp_solver</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Solver (cobrak.dataclasses.Solver)" href="#cobrak.dataclasses.Solver">Solver</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The linear programming solver to use. Defaults to SCIP.</p>
              </div>
            </td>
            <td>
                  <code><span title="cobrak.standard_solvers.SCIP">SCIP</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlp_solver</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Solver (cobrak.dataclasses.Solver)" href="#cobrak.dataclasses.Solver">Solver</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The nonlinear programming solver to use. Defaults to IPOPT.</p>
              </div>
            </td>
            <td>
                  <code><span title="cobrak.standard_solvers.IPOPT">IPOPT</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlp_strict_mode</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not the &lt;= heuristic (True) or not (False; i.e. setting all equations to ==) shall be used. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlp_single_strict_reacs</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of single reactions that shall be in strict mode (see <code>nlp_strict_mode</code>argument above).
If <code>nlp_strict_mode=True</code>, this has no effect. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objvalue_json_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the JSON file for storing objective values. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_rounds_same_objvalue</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of rounds with the same objective value before stopping. Defaults to float("inf").</p>
              </div>
            </td>
            <td>
                  <code><span title="float">float</span>(&#39;inf&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>correction_config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CorrectionConfig (cobrak.dataclasses.CorrectionConfig)" href="#cobrak.dataclasses.CorrectionConfig">CorrectionConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for corrections during optimization. Defaults to CorrectionConfig().</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CorrectionConfig (cobrak.dataclasses.CorrectionConfig)" href="#cobrak.dataclasses.CorrectionConfig">CorrectionConfig</a>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_abs_objvalue</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum absolute value of the objective function to consider as valid. Defaults to 1e-6.</p>
              </div>
            </td>
            <td>
                  <code>1e-06</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pop_size</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The population size for the evolutionary algorithm. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ignore_nonlinear_extra_terms_in_ectfbas</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(bool, optional): Whether or not non-linear watches/constraints shall be ignored in ecTFBAs. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/evolution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">objective_target</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">nlp_dict_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">best_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">with_kappa</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_gamma</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_iota</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_alpha</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">num_gens</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;genetic&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;genetic&quot;</span><span class="p">,</span>
    <span class="n">lp_solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">SCIP</span><span class="p">,</span>
    <span class="n">nlp_solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">IPOPT</span><span class="p">,</span>
    <span class="n">nlp_strict_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">nlp_single_strict_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">objvalue_json_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">max_rounds_same_objvalue</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
    <span class="n">correction_config</span><span class="p">:</span> <span class="n">CorrectionConfig</span> <span class="o">=</span> <span class="n">CorrectionConfig</span><span class="p">(),</span>
    <span class="n">min_abs_objvalue</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span>
    <span class="n">pop_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes a COBRAKProblem object.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The original COBRA-k model to optimize.</span>
<span class="sd">        objective_target (dict[str, float]): The target values for the objectives.</span>
<span class="sd">        objective_sense (int): The sense of the objective function (1 for maximization, -1 for minimization).</span>
<span class="sd">        variability_dict (dict[str, tuple[float, float]]): The variability data for each reaction.</span>
<span class="sd">        nlp_dict_list (list[dict[str, float]]): A list of initial NLP solutions.</span>
<span class="sd">        best_value (float): The best value found so far.</span>
<span class="sd">        with_kappa (bool, optional): Whether to use kappa parameter. Defaults to True.</span>
<span class="sd">        with_gamma (bool, optional): Whether to use gamma parameter. Defaults to True.</span>
<span class="sd">        with_iota (bool, optional): Whether to use iota parameter. Defaults to True.</span>
<span class="sd">        with_alpha (bool, optional): Whether to use alpha parameter. Defaults to True.</span>
<span class="sd">        num_gens (int, optional): The number of generations in the evolutionary algorithm. Defaults to 5.</span>
<span class="sd">        algorithm (Literal[&quot;genetic&quot;], optional): The type of optimization algorithm to use. Defaults to &quot;genetic&quot;, the only algorithm currently available.</span>
<span class="sd">        lp_solver (Solver, optional): The linear programming solver to use. Defaults to SCIP.</span>
<span class="sd">        nlp_solver (Solver, optional): The nonlinear programming solver to use. Defaults to IPOPT.</span>
<span class="sd">        nlp_strict_mode (bool, optional): Whether or not the &lt;= heuristic (True) or not (False; i.e. setting all equations to ==) shall be used. Defaults to False.</span>
<span class="sd">        nlp_single_strict_reacs (list[str], optional): List of single reactions that shall be in strict mode (see ```nlp_strict_mode```argument above).</span>
<span class="sd">            If ```nlp_strict_mode=True```, this has no effect. Defaults to [].</span>
<span class="sd">        objvalue_json_path (str, optional): The path to the JSON file for storing objective values. Defaults to &quot;&quot;.</span>
<span class="sd">        max_rounds_same_objvalue (float, optional): The maximum number of rounds with the same objective value before stopping. Defaults to float(&quot;inf&quot;).</span>
<span class="sd">        correction_config (CorrectionConfig, optional): Configuration for corrections during optimization. Defaults to CorrectionConfig().</span>
<span class="sd">        min_abs_objvalue (float, optional): The minimum absolute value of the objective function to consider as valid. Defaults to 1e-6.</span>
<span class="sd">        pop_size (int | None, optional): The population size for the evolutionary algorithm. Defaults to None.</span>
<span class="sd">        ignore_nonlinear_extra_terms_in_ectfbas: (bool, optional): Whether or not non-linear watches/constraints shall be ignored in ecTFBAs. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="p">:</span> <span class="n">Model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">objective_target</span> <span class="o">=</span> <span class="n">objective_target</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">objective_sense</span> <span class="o">=</span> <span class="n">objective_sense</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">blocked_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">initial_xs_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nlp_dict_list</span><span class="p">))</span>
    <span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">minimal_xs_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">variability_dict</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span> <span class="o">=</span> <span class="n">algorithm</span>

    <span class="n">reac_couples</span> <span class="o">=</span> <span class="n">get_stoichiometrically_coupled_reactions</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span>
    <span class="p">)</span>

    <span class="n">objective_target_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">objective_target</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">filtered_reac_couples</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reac_couple</span> <span class="ow">in</span> <span class="n">reac_couples</span><span class="p">:</span>
        <span class="n">filtered_reac_couple</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">reac_id</span>
            <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">reac_couple</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="ow">and</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="p">)</span>
        <span class="p">]</span>

        <span class="n">found_invalid_id</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">objective_target_id</span> <span class="ow">in</span> <span class="n">objective_target_ids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">objective_target_id</span> <span class="ow">in</span> <span class="n">filtered_reac_couple</span><span class="p">:</span>
                <span class="n">found_invalid_id</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">correction_config</span><span class="o">.</span><span class="n">error_scenario</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">filtered_reac_couple</span><span class="p">:</span>
                <span class="n">found_invalid_id</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">found_invalid_id</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_reac_couple</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">filtered_reac_couples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">filtered_reac_couple</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">idx_to_reac_ids</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">couple_idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">filtered_reac_couplex</span> <span class="ow">in</span> <span class="n">filtered_reac_couples</span><span class="p">:</span>
        <span class="n">nlp_idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">nlp_dict</span> <span class="ow">in</span> <span class="n">nlp_dict_list</span><span class="p">:</span>
            <span class="n">first_reac_id</span> <span class="o">=</span> <span class="n">filtered_reac_couplex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">first_reac_id</span> <span class="ow">in</span> <span class="n">nlp_dict</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nlp_dict</span><span class="p">[</span><span class="n">first_reac_id</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initial_xs_list</span><span class="p">[</span><span class="n">nlp_idx</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="mf">1.0</span> <span class="k">if</span> <span class="n">algorithm</span> <span class="o">!=</span> <span class="s2">&quot;genetic&quot;</span> <span class="k">else</span> <span class="mi">1</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initial_xs_list</span><span class="p">[</span><span class="n">nlp_idx</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="mf">0.0</span> <span class="k">if</span> <span class="n">algorithm</span> <span class="o">!=</span> <span class="s2">&quot;genetic&quot;</span> <span class="k">else</span> <span class="mi">0</span>
                <span class="p">)</span>

            <span class="n">nlp_idx</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># noqa: SIM113</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">idx_to_reac_ids</span><span class="p">[</span><span class="n">couple_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_reac_couplex</span>
        <span class="n">couple_idx</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">with_kappa</span> <span class="o">=</span> <span class="n">with_kappa</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">with_gamma</span> <span class="o">=</span> <span class="n">with_gamma</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">with_iota</span> <span class="o">=</span> <span class="n">with_iota</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">with_alpha</span> <span class="o">=</span> <span class="n">with_alpha</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">couple_idx</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_gens</span> <span class="o">=</span> <span class="n">num_gens</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lp_solver</span> <span class="o">=</span> <span class="n">lp_solver</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nlp_solver</span> <span class="o">=</span> <span class="n">nlp_solver</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nlp_strict_mode</span> <span class="o">=</span> <span class="n">nlp_strict_mode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nlp_single_strict_reacs</span> <span class="o">=</span> <span class="n">nlp_single_strict_reacs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">temp_directory_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">best_value</span> <span class="o">=</span> <span class="n">best_value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_path</span> <span class="o">=</span> <span class="n">objvalue_json_path</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_rounds_same_objvalue</span> <span class="o">=</span> <span class="n">max_rounds_same_objvalue</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">correction_config</span> <span class="o">=</span> <span class="n">correction_config</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">min_abs_objvalue</span> <span class="o">=</span> <span class="n">min_abs_objvalue</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pop_size</span> <span class="o">=</span> <span class="n">pop_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cobrak.evolution.COBRAKProblem.fitness" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fitness</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculates the fitness of a given solution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The solution to evaluate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="float">float</span>, <span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[tuple[float, list[float | int]]]: A list of tuples, where each tuple contains the fitness value and the corresponding solution.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/evolution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fitness</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the fitness of a given solution.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (list[float | int]): The solution to evaluate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[tuple[float, list[float | int]]]: A list of tuples, where each tuple contains the fitness value and the corresponding solution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Preliminary TFBA :3</span>
    <span class="n">deactivated_reactions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">couple_idx</span><span class="p">,</span> <span class="n">reac_ids</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_to_reac_ids</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">couple_idx</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.02</span><span class="p">:</span>
            <span class="n">deactivated_reactions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">reac_ids</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">first_ectfba_dict</span> <span class="o">=</span> <span class="n">perform_lp_optimization</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="p">,</span>
            <span class="n">objective_target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_target</span><span class="p">,</span>
            <span class="n">objective_sense</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_sense</span><span class="p">,</span>
            <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">with_loop_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">variability_dict</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">),</span>
            <span class="n">ignored_reacs</span><span class="o">=</span><span class="n">deactivated_reactions</span><span class="p">,</span>
            <span class="n">solver</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lp_solver</span><span class="p">,</span>
            <span class="n">correction_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_config</span><span class="p">,</span>
            <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">ApplicationError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">first_ectfba_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">ALL_OK_KEY</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">first_ectfba_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[(</span><span class="mf">1_000_000.0</span><span class="p">,</span> <span class="p">[])]</span>

    <span class="n">nlp_results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">is_objsense_maximization</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_sense</span><span class="p">):</span>
        <span class="n">lower_value</span> <span class="o">=</span> <span class="n">first_ectfba_dict</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1e-12</span>
        <span class="n">upper_value</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lower_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">upper_value</span> <span class="o">=</span> <span class="n">first_ectfba_dict</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1e-12</span>

    <span class="n">maxz_model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="p">)</span>
    <span class="n">maxz_model</span><span class="o">.</span><span class="n">extra_linear_constraints</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">ExtraLinearConstraint</span><span class="p">(</span>
            <span class="n">stoichiometries</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_target</span><span class="p">,</span>
            <span class="n">lower_value</span><span class="o">=</span><span class="n">lower_value</span><span class="p">,</span>
            <span class="n">upper_value</span><span class="o">=</span><span class="n">upper_value</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">]</span>
    <span class="n">maxz_model</span><span class="o">.</span><span class="n">extra_linear_constraints</span> <span class="o">+=</span> <span class="p">[</span>
        <span class="n">ExtraLinearConstraint</span><span class="p">(</span>
            <span class="n">stoichiometries</span><span class="o">=</span><span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Z_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">},</span>
            <span class="n">upper_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reac_data</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">reac_data</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">in</span> <span class="n">deactivated_reactions</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">eligible_z_sum_objective</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Z_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="mf">1.0</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reac_data</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">reac_data</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deactivated_reactions</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">maxz_ectfba_dict</span> <span class="o">=</span> <span class="n">perform_lp_optimization</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="o">=</span><span class="n">maxz_model</span><span class="p">,</span>
            <span class="n">objective_target</span><span class="o">=</span><span class="n">eligible_z_sum_objective</span><span class="p">,</span>
            <span class="n">objective_sense</span><span class="o">=+</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">with_loop_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">variability_dict</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">),</span>
            <span class="n">ignored_reacs</span><span class="o">=</span><span class="n">deactivated_reactions</span><span class="p">,</span>
            <span class="n">solver</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lp_solver</span><span class="p">,</span>
            <span class="n">correction_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_config</span><span class="p">,</span>
            <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">ApplicationError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">maxz_ectfba_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">ALL_OK_KEY</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">maxz_ectfba_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]:</span>
        <span class="n">used_maxz_tfba_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">maxz_ectfba_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">reaction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deactivated_reactions</span><span class="p">)</span>
            <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span><span class="n">maxz_ectfba_dict</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Z_VAR_PREFIX</span><span class="si">}{</span><span class="n">var_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">used_maxz_tfba_dict</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">used_maxz_tfba_dict</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="n">used_maxz_tfba_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">used_maxz_tfba_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">second_nlp_dict</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">perform_nlp_irreversible_optimization_with_active_reacs_only</span><span class="p">(</span>
                        <span class="n">cobrak_model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="p">,</span>
                        <span class="n">objective_target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_target</span><span class="p">,</span>
                        <span class="n">objective_sense</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_sense</span><span class="p">,</span>
                        <span class="n">optimization_dict</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">used_maxz_tfba_dict</span><span class="p">),</span>
                        <span class="n">variability_dict</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">),</span>
                        <span class="n">with_kappa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_kappa</span><span class="p">,</span>
                        <span class="n">with_gamma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_gamma</span><span class="p">,</span>
                        <span class="n">with_iota</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_iota</span><span class="p">,</span>
                        <span class="n">with_alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_alpha</span><span class="p">,</span>
                        <span class="n">solver</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp_solver</span><span class="p">,</span>
                        <span class="n">correction_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_config</span><span class="p">,</span>
                        <span class="n">strict_mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp_strict_mode</span><span class="p">,</span>
                        <span class="n">single_strict_reacs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp_single_strict_reacs</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">second_nlp_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="nb">abs</span><span class="p">(</span><span class="n">second_nlp_dict</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">])</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_abs_objvalue</span>
                <span class="p">):</span>
                    <span class="n">nlp_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">second_nlp_dict</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">ApplicationError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                <span class="k">pass</span>

    <span class="c1">####</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">minz_ectfba_dict</span> <span class="o">=</span> <span class="n">perform_lp_optimization</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="o">=</span><span class="n">maxz_model</span><span class="p">,</span>
            <span class="n">objective_target</span><span class="o">=</span><span class="n">eligible_z_sum_objective</span><span class="p">,</span>
            <span class="n">objective_sense</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">with_loop_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">variability_dict</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">),</span>
            <span class="n">ignored_reacs</span><span class="o">=</span><span class="n">deactivated_reactions</span><span class="p">,</span>
            <span class="n">solver</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lp_solver</span><span class="p">,</span>
            <span class="n">correction_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_config</span><span class="p">,</span>
            <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">ApplicationError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">minz_ectfba_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">ALL_OK_KEY</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">minz_ectfba_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]:</span>
        <span class="n">used_minz_tfba_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">minz_ectfba_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">reaction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deactivated_reactions</span><span class="p">)</span>
            <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span><span class="n">minz_ectfba_dict</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Z_VAR_PREFIX</span><span class="si">}{</span><span class="n">var_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">used_minz_tfba_dict</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">used_minz_tfba_dict</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="n">used_minz_tfba_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">used_minz_tfba_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">third_nlp_dict</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">perform_nlp_irreversible_optimization_with_active_reacs_only</span><span class="p">(</span>
                        <span class="n">cobrak_model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">original_cobrak_model</span><span class="p">,</span>
                        <span class="n">objective_target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_target</span><span class="p">,</span>
                        <span class="n">objective_sense</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_sense</span><span class="p">,</span>
                        <span class="n">optimization_dict</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">used_minz_tfba_dict</span><span class="p">),</span>
                        <span class="n">variability_dict</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variability_data</span><span class="p">),</span>
                        <span class="n">with_kappa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_kappa</span><span class="p">,</span>
                        <span class="n">with_gamma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_gamma</span><span class="p">,</span>
                        <span class="n">with_iota</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_iota</span><span class="p">,</span>
                        <span class="n">with_alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">with_alpha</span><span class="p">,</span>
                        <span class="n">solver</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp_solver</span><span class="p">,</span>
                        <span class="n">correction_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_config</span><span class="p">,</span>
                        <span class="n">strict_mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp_strict_mode</span><span class="p">,</span>
                        <span class="n">single_strict_reacs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp_single_strict_reacs</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">third_nlp_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="nb">abs</span><span class="p">(</span><span class="n">third_nlp_dict</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">])</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_abs_objvalue</span>
                <span class="p">):</span>
                    <span class="n">nlp_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">third_nlp_dict</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">ApplicationError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                <span class="k">pass</span>
    <span class="c1">####</span>

    <span class="n">output</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1_000_000</span><span class="p">,</span> <span class="p">[])]</span>
    <span class="k">for</span> <span class="n">nlp_result</span> <span class="ow">in</span> <span class="n">nlp_results</span><span class="p">:</span>
        <span class="n">objvalues</span> <span class="o">=</span> <span class="p">[</span><span class="n">nlp_result</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]</span> <span class="k">for</span> <span class="n">nlp_result</span> <span class="ow">in</span> <span class="n">nlp_results</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">is_objsense_maximization</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_sense</span><span class="p">):</span>
            <span class="n">opt_idx</span> <span class="o">=</span> <span class="n">objvalues</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">objvalues</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">opt_idx</span> <span class="o">=</span> <span class="n">objvalues</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">objvalues</span><span class="p">))</span>
        <span class="n">opt_nlp_dict</span> <span class="o">=</span> <span class="n">nlp_results</span><span class="p">[</span><span class="n">opt_idx</span><span class="p">]</span>

        <span class="n">objective_value</span> <span class="o">=</span> <span class="n">opt_nlp_dict</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_directory_name</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_directory_name</span><span class="si">}{</span><span class="n">objective_value</span><span class="si">}{</span><span class="n">time</span><span class="p">()</span><span class="si">}{</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1_000_000_000</span><span class="p">)</span><span class="si">}</span><span class="s2">.json&quot;</span>  <span class="c1"># noqa: NPY002</span>
            <span class="n">json_write</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">opt_nlp_dict</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_objsense_maximization</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_sense</span><span class="p">):</span>
            <span class="n">objective_value</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No error, objective value is:&quot;</span><span class="p">,</span> <span class="n">objective_value</span><span class="p">)</span>

        <span class="n">active_nlp_x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_to_reac_ids</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">couple_idx</span><span class="p">,</span> <span class="n">reac_ids</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_to_reac_ids</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">reac_id</span> <span class="o">=</span> <span class="n">reac_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">opt_nlp_dict</span> <span class="ow">or</span> <span class="n">opt_nlp_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">1e-11</span><span class="p">:</span>
                <span class="n">set_value</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">set_value</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">active_nlp_x</span><span class="p">[</span><span class="n">couple_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">set_value</span>
        <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">objective_value</span><span class="p">,</span> <span class="n">active_nlp_x</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cobrak.evolution.COBRAKProblem.optimize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">optimize</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Performs the optimization process.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="float">float</span>, <span title="list">list</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[float, list[dict[str, float]]]: A dictionary containing the optimization results.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/evolution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">optimize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs the optimization process.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[float, list[dict[str, float]]]: A dictionary containing the optimization results.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">temp_directory</span> <span class="o">=</span> <span class="n">TemporaryDirectory</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">temp_directory_name</span> <span class="o">=</span> <span class="n">standardize_folder</span><span class="p">(</span><span class="n">temp_directory</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;genetic&quot;</span><span class="p">:</span>
            <span class="n">evolution</span> <span class="o">=</span> <span class="n">COBRAKGENETIC</span><span class="p">(</span>
                <span class="n">fitness_function</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fitness</span><span class="p">,</span>
                <span class="n">xs_dim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span>
                <span class="n">extra_xs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_xs_list</span><span class="p">,</span>
                <span class="n">gen</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_gens</span><span class="p">,</span>
                <span class="n">objvalue_json_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_path</span><span class="p">,</span>
                <span class="n">max_rounds_same_objvalue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_rounds_same_objvalue</span><span class="p">,</span>
                <span class="n">pop_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pop_size</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;ERROR: Evolution algorithm </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="si">}</span><span class="s2"> does not exist! Use &#39;genetic&#39;.&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="n">evolution</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="n">result_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">json_filename</span> <span class="ow">in</span> <span class="n">get_files</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_directory_name</span><span class="p">):</span>
        <span class="n">json_data</span> <span class="o">=</span> <span class="n">json_load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_directory_name</span><span class="si">}{</span><span class="n">json_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">Any</span><span class="p">)</span>
        <span class="n">objective_value</span> <span class="o">=</span> <span class="n">json_data</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">objective_value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result_dict</span><span class="p">:</span>
            <span class="n">result_dict</span><span class="p">[</span><span class="n">objective_value</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">result_dict</span><span class="p">[</span><span class="n">objective_value</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">json_data</span><span class="p">))</span>

    <span class="n">temp_directory</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">result_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="cobrak.evolution.perform_nlp_evolutionary_optimization" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">perform_nlp_evolutionary_optimization</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">objective_target</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">variability_dict</span><span class="o">=</span><span class="p">{},</span> <span class="n">with_kappa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_gamma</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_iota</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_alpha</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sampling_wished_num_feasible_starts</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sampling_max_metarounds</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sampling_rounds_per_metaround</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sampling_max_deactivated_reactions</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sampling_always_deactivated_reactions</span><span class="o">=</span><span class="p">[],</span> <span class="n">evolution_num_gens</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;genetic&#39;</span><span class="p">,</span> <span class="n">lp_solver</span><span class="o">=</span><span class="n">SCIP</span><span class="p">,</span> <span class="n">nlp_solver</span><span class="o">=</span><span class="n">IPOPT</span><span class="p">,</span> <span class="n">nlp_strict_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nlp_single_strict_reacs</span><span class="o">=</span><span class="p">[],</span> <span class="n">objvalue_json_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">max_rounds_same_objvalue</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">correction_config</span><span class="o">=</span><span class="n">CorrectionConfig</span><span class="p">(),</span> <span class="n">min_abs_objvalue</span><span class="o">=</span><span class="mf">1e-13</span><span class="p">,</span> <span class="n">pop_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">working_results</span><span class="o">=</span><span class="p">[],</span> <span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Performs NLP evolutionary optimization on the given COBRA-k model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRA-k model to optimize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_target</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target value(s) for the objective function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sense of the objective function (1 for maximization, -1 for minimization).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variability_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Variability data for each reaction. Defaults to {}.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_kappa</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use kappa parameter. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_gamma</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use gamma parameter. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_iota</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use iota parameter. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_alpha</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use alpha parameter. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sampling_wished_num_feasible_starts</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of wished feasible start solutions. Defaults to 3.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sampling_max_metarounds</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of meta rounds for sampling. Defaults to 3.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sampling_rounds_per_metaround</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of rounds per meta round for sampling. Defaults to 2.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sampling_max_deactivated_reactions</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of deactivated reactions allowed. Defaults to 5.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sampling_always_deactivated_reactions</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of reactions that should always be deactivated. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>evolution_num_gens</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of generations for the evolutionary algorithm. Defaults to 5.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>algorithm</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;genetic&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of optimization algorithm to use. Defaults to "genetic", which is also the only algorithm currently available.</p>
              </div>
            </td>
            <td>
                  <code>&#39;genetic&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lp_solver</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Solver (cobrak.dataclasses.Solver)" href="#cobrak.dataclasses.Solver">Solver</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The linear programming solver to use. Defaults to SCIP.</p>
              </div>
            </td>
            <td>
                  <code><span title="cobrak.standard_solvers.SCIP">SCIP</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlp_solver</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Solver (cobrak.dataclasses.Solver)" href="#cobrak.dataclasses.Solver">Solver</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The nonlinear programming solver to use. Defaults to IPOPT.</p>
              </div>
            </td>
            <td>
                  <code><span title="cobrak.standard_solvers.IPOPT">IPOPT</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlp_strict_mode</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not the &lt;= heuristic (True) or not (False; i.e. setting all equations to ==) shall be used. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlp_single_strict_reacs</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of single reactions that shall be in strict mode (see <code>nlp_strict_mode</code>argument above).
If <code>nlp_strict_mode=True</code>, this has no effect. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objvalue_json_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the JSON file for objective values. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_rounds_same_objvalue</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of rounds with same objective value before stopping. Defaults to float("inf").</p>
              </div>
            </td>
            <td>
                  <code><span title="float">float</span>(&#39;inf&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>correction_config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CorrectionConfig (cobrak.dataclasses.CorrectionConfig)" href="#cobrak.dataclasses.CorrectionConfig">CorrectionConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for corrections during optimization. Defaults to CorrectionConfig().</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CorrectionConfig (cobrak.dataclasses.CorrectionConfig)" href="#cobrak.dataclasses.CorrectionConfig">CorrectionConfig</a>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_abs_objvalue</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum absolute value of objective function to consider valid. Defaults to 1e-13.</p>
              </div>
            </td>
            <td>
                  <code>1e-13</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pop_size</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Population size for the evolutionary algorithm. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>working_results</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of initial feasible results. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ignore_nonlinear_extra_terms_in_ectfbas</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(bool, optional): Whether or not non-linear watches/constraints shall be ignored in ecTFBAs. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="float">float</span>, <span title="list">list</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[float, list[dict[str, float]]]: Dictionary of objective values and corresponding solutions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/evolution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">perform_nlp_evolutionary_optimization</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">objective_target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">with_kappa</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_gamma</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_iota</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">with_alpha</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sampling_wished_num_feasible_starts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">sampling_max_metarounds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">sampling_rounds_per_metaround</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">sampling_max_deactivated_reactions</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">sampling_always_deactivated_reactions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">evolution_num_gens</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;genetic&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;genetic&quot;</span><span class="p">,</span>
    <span class="n">lp_solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">SCIP</span><span class="p">,</span>
    <span class="n">nlp_solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">IPOPT</span><span class="p">,</span>
    <span class="n">nlp_strict_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">nlp_single_strict_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">objvalue_json_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">max_rounds_same_objvalue</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
    <span class="n">correction_config</span><span class="p">:</span> <span class="n">CorrectionConfig</span> <span class="o">=</span> <span class="n">CorrectionConfig</span><span class="p">(),</span>
    <span class="n">min_abs_objvalue</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-13</span><span class="p">,</span>
    <span class="n">pop_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">working_results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs NLP evolutionary optimization on the given COBRA-k model.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRA-k model to optimize.</span>
<span class="sd">        objective_target (str | dict[str, float]): Target value(s) for the objective function.</span>
<span class="sd">        objective_sense (int): Sense of the objective function (1 for maximization, -1 for minimization).</span>
<span class="sd">        variability_dict (dict[str, tuple[float, float]], optional): Variability data for each reaction. Defaults to {}.</span>
<span class="sd">        with_kappa (bool, optional): Whether to use kappa parameter. Defaults to True.</span>
<span class="sd">        with_gamma (bool, optional): Whether to use gamma parameter. Defaults to True.</span>
<span class="sd">        with_iota (bool, optional): Whether to use iota parameter. Defaults to False.</span>
<span class="sd">        with_alpha (bool, optional): Whether to use alpha parameter. Defaults to False.</span>
<span class="sd">        sampling_wished_num_feasible_starts (int, optional): The number of wished feasible start solutions. Defaults to 3.</span>
<span class="sd">        sampling_max_metarounds (int, optional): Maximum number of meta rounds for sampling. Defaults to 3.</span>
<span class="sd">        sampling_rounds_per_metaround (int, optional): Number of rounds per meta round for sampling. Defaults to 2.</span>
<span class="sd">        sampling_max_deactivated_reactions (int, optional): Maximum number of deactivated reactions allowed. Defaults to 5.</span>
<span class="sd">        sampling_always_deactivated_reactions (list[str], optional): List of reactions that should always be deactivated. Defaults to [].</span>
<span class="sd">        evolution_num_gens (int, optional): Number of generations for the evolutionary algorithm. Defaults to 5.</span>
<span class="sd">        algorithm (Literal[&quot;genetic&quot;], optional): Type of optimization algorithm to use. Defaults to &quot;genetic&quot;, which is also the only algorithm currently available.</span>
<span class="sd">        lp_solver (Solver, optional): The linear programming solver to use. Defaults to SCIP.</span>
<span class="sd">        nlp_solver (Solver, optional): The nonlinear programming solver to use. Defaults to IPOPT.</span>
<span class="sd">        nlp_strict_mode (bool, optional): Whether or not the &lt;= heuristic (True) or not (False; i.e. setting all equations to ==) shall be used. Defaults to False.</span>
<span class="sd">        nlp_single_strict_reacs (list[str], optional): List of single reactions that shall be in strict mode (see ```nlp_strict_mode```argument above).</span>
<span class="sd">            If ```nlp_strict_mode=True```, this has no effect. Defaults to [].</span>
<span class="sd">        objvalue_json_path (str, optional): Path to the JSON file for objective values. Defaults to &quot;&quot;.</span>
<span class="sd">        max_rounds_same_objvalue (float, optional): Maximum number of rounds with same objective value before stopping. Defaults to float(&quot;inf&quot;).</span>
<span class="sd">        correction_config (CorrectionConfig, optional): Configuration for corrections during optimization. Defaults to CorrectionConfig().</span>
<span class="sd">        min_abs_objvalue (float, optional): Minimum absolute value of objective function to consider valid. Defaults to 1e-13.</span>
<span class="sd">        pop_size (int | None, optional): Population size for the evolutionary algorithm. Defaults to None.</span>
<span class="sd">        working_results (list[dict[str, float]], optional): List of initial feasible results. Defaults to [].</span>
<span class="sd">        ignore_nonlinear_extra_terms_in_ectfbas: (bool, optional): Whether or not non-linear watches/constraints shall be ignored in ecTFBAs. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[float, list[dict[str, float]]]: Dictionary of objective values and corresponding solutions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">variability_dict</span> <span class="o">==</span> <span class="p">{}:</span>
        <span class="n">variability_dict</span> <span class="o">=</span> <span class="n">perform_lp_variability_analysis</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="o">=</span><span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">active_reactions</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">solver</span><span class="o">=</span><span class="n">lp_solver</span><span class="p">,</span>
            <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">variability_dict</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">variability_dict</span><span class="p">)</span>

    <span class="c1"># Initial sampling</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objective_target</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">objective_target</span> <span class="o">=</span> <span class="p">{</span><span class="n">objective_target</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
    <span class="n">objective_target_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">objective_target</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>  <span class="c1"># type: ignore</span>

    <span class="n">deactivatable_reactions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">var_id</span>
        <span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">variability_dict</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">var_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">variability_dict</span><span class="p">[</span><span class="n">var_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">objective_target_ids</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sampling_always_deactivated_reactions</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">correction_config</span><span class="o">.</span><span class="n">error_scenario</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">distinct_feasible_start_solutions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">current_round</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sampling_max_metarounds</span><span class="p">):</span>
        <span class="c1"># Get deactivated reaction lists</span>
        <span class="n">all_deactivated_reaction_lists</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="n">sample</span><span class="p">(</span>
                    <span class="n">deactivatable_reactions</span><span class="p">,</span>
                    <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">sampling_max_deactivated_reactions</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># noqa: NPY002</span>
                <span class="p">)</span>
                <span class="o">+</span> <span class="n">sampling_always_deactivated_reactions</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sampling_rounds_per_metaround</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cpu_count</span><span class="p">())</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">current_round</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">all_deactivated_reaction_lists</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
                <span class="n">sampling_always_deactivated_reactions</span>
            <span class="p">)</span>

        <span class="c1"># run sampling</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">10</span><span class="p">)(</span>
            <span class="n">delayed</span><span class="p">(</span><span class="n">_sampling_routine</span><span class="p">)(</span>
                <span class="n">cobrak_model</span><span class="p">,</span>
                <span class="n">objective_target</span><span class="p">,</span>
                <span class="n">objective_sense</span><span class="p">,</span>
                <span class="n">variability_dict</span><span class="p">,</span>
                <span class="n">with_kappa</span><span class="p">,</span>
                <span class="n">with_gamma</span><span class="p">,</span>
                <span class="n">with_iota</span><span class="p">,</span>
                <span class="n">with_alpha</span><span class="p">,</span>
                <span class="n">deactivated_reaction_lists</span><span class="p">,</span>
                <span class="n">lp_solver</span><span class="p">,</span>
                <span class="n">nlp_solver</span><span class="p">,</span>
                <span class="n">nlp_strict_mode</span><span class="p">,</span>
                <span class="n">nlp_single_strict_reacs</span><span class="p">,</span>
                <span class="n">correction_config</span><span class="p">,</span>
                <span class="n">min_abs_objvalue</span><span class="p">,</span>
                <span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">deactivated_reaction_lists</span> <span class="ow">in</span> <span class="n">all_deactivated_reaction_lists</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">working_results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">working_results</span><span class="p">)</span>
        <span class="n">best_result</span> <span class="o">=</span> <span class="p">(</span>
            <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_objsense_maximization</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">)</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">nlp_dict</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                <span class="n">active_reacs_tuple</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                    <span class="nb">sorted</span><span class="p">(</span>
                        <span class="n">get_active_reacs_from_optimization_dict</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">nlp_dict</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="n">distinct_feasible_start_solutions</span><span class="p">[</span><span class="n">active_reacs_tuple</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
                    <span class="n">nlp_dict</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">is_objsense_maximization</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">):</span>
                    <span class="n">best_result</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">nlp_dict</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">],</span> <span class="n">best_result</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">best_result</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">nlp_dict</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">],</span> <span class="n">best_result</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">distinct_feasible_start_solutions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="o">&gt;=</span> <span class="n">sampling_wished_num_feasible_starts</span>
        <span class="p">):</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">distinct_feasible_start_solutions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;ERROR in initial sampling: No feasible sampling solution found! Check feasibility of problem and/or adjust sampling settings.&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">distinct_feasible_start_solutions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="o">&lt;</span> <span class="n">sampling_wished_num_feasible_starts</span>
    <span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;INFO: Fewer feasible sampling solutions found than wished.&quot;</span><span class="p">)</span>

    <span class="c1"># Evolutionary algorithm</span>
    <span class="n">problem</span> <span class="o">=</span> <span class="n">COBRAKProblem</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="o">=</span><span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">objective_target</span><span class="o">=</span><span class="n">objective_target</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="n">objective_sense</span><span class="o">=</span><span class="n">objective_sense</span><span class="p">,</span>
        <span class="n">variability_dict</span><span class="o">=</span><span class="n">variability_dict</span><span class="p">,</span>
        <span class="n">nlp_dict_list</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">distinct_feasible_start_solutions</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
        <span class="n">best_value</span><span class="o">=</span><span class="n">best_result</span><span class="p">,</span>
        <span class="n">with_kappa</span><span class="o">=</span><span class="n">with_kappa</span><span class="p">,</span>
        <span class="n">with_gamma</span><span class="o">=</span><span class="n">with_gamma</span><span class="p">,</span>
        <span class="n">with_iota</span><span class="o">=</span><span class="n">with_iota</span><span class="p">,</span>
        <span class="n">with_alpha</span><span class="o">=</span><span class="n">with_alpha</span><span class="p">,</span>
        <span class="n">num_gens</span><span class="o">=</span><span class="n">evolution_num_gens</span><span class="p">,</span>
        <span class="n">algorithm</span><span class="o">=</span><span class="n">algorithm</span><span class="p">,</span>
        <span class="n">lp_solver</span><span class="o">=</span><span class="n">lp_solver</span><span class="p">,</span>
        <span class="n">nlp_solver</span><span class="o">=</span><span class="n">nlp_solver</span><span class="p">,</span>
        <span class="n">objvalue_json_path</span><span class="o">=</span><span class="n">objvalue_json_path</span><span class="p">,</span>
        <span class="n">max_rounds_same_objvalue</span><span class="o">=</span><span class="n">max_rounds_same_objvalue</span><span class="p">,</span>
        <span class="n">correction_config</span><span class="o">=</span><span class="n">correction_config</span><span class="p">,</span>
        <span class="n">min_abs_objvalue</span><span class="o">=</span><span class="n">min_abs_objvalue</span><span class="p">,</span>
        <span class="n">pop_size</span><span class="o">=</span><span class="n">pop_size</span><span class="p">,</span>
        <span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="o">=</span><span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="p">,</span>
        <span class="n">nlp_strict_mode</span><span class="o">=</span><span class="n">nlp_strict_mode</span><span class="p">,</span>
        <span class="n">nlp_single_strict_reacs</span><span class="o">=</span><span class="n">nlp_single_strict_reacs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">problem</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.evolution.postprocess" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">postprocess</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">opt_dict</span><span class="p">,</span> <span class="n">objective_target</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">variability_data</span><span class="p">,</span> <span class="n">with_kappa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_gamma</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_iota</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_alpha</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lp_solver</span><span class="o">=</span><span class="n">SCIP</span><span class="p">,</span> <span class="n">nlp_solver</span><span class="o">=</span><span class="n">IPOPT</span><span class="p">,</span> <span class="n">nlp_strict_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nlp_single_strict_reacs</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">correction_config</span><span class="o">=</span><span class="n">CorrectionConfig</span><span class="p">(),</span> <span class="n">onlytested</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Postprocesses the optimization results to find feasible switches.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRA-k model to optimize.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>opt_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optimization result dictionary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_target</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target value(s) for the objective function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sense of the objective function (1 for maximization, -1 for minimization).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variability_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Variability data for each reaction.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_kappa</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use kappa parameter. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_gamma</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use gamma parameter. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_iota</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use iota parameter. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_alpha</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use alpha parameter. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lp_solver</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Solver (cobrak.dataclasses.Solver)" href="#cobrak.dataclasses.Solver">Solver</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The linear programming solver to use. Defaults to SCIP.</p>
              </div>
            </td>
            <td>
                  <code><span title="cobrak.standard_solvers.SCIP">SCIP</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlp_solver</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Solver (cobrak.dataclasses.Solver)" href="#cobrak.dataclasses.Solver">Solver</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The nonlinear programming solver to use. Defaults to IPOPT.</p>
              </div>
            </td>
            <td>
                  <code><span title="cobrak.standard_solvers.IPOPT">IPOPT</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlp_strict_mode</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not the &lt;= heuristic (True) or not (False; i.e. setting all equations to ==) shall be used. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nlp_single_strict_reacs</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of single reactions that shall be in strict mode (see <code>nlp_strict_mode</code>argument above).
If <code>nlp_strict_mode=True</code>, this has no effect. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to enable verbose output. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>correction_config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CorrectionConfig (cobrak.dataclasses.CorrectionConfig)" href="#cobrak.dataclasses.CorrectionConfig">CorrectionConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for corrections during optimization. Defaults to CorrectionConfig().</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CorrectionConfig (cobrak.dataclasses.CorrectionConfig)" href="#cobrak.dataclasses.CorrectionConfig">CorrectionConfig</a>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>onlytested</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specific reactions to test during postprocessing. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ignore_nonlinear_extra_terms_in_ectfbas</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(bool, optional): Whether or not non-linear watches/constraints shall be ignored in ecTFBAs.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="list">list</span>[<span title="float">float</span> | <span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[float, list[float | int]]: Best result and a list of feasible switches.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/evolution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">postprocess</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">opt_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">objective_target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">variability_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">with_kappa</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_gamma</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_iota</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">with_alpha</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">lp_solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">SCIP</span><span class="p">,</span>
    <span class="n">nlp_solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">IPOPT</span><span class="p">,</span>
    <span class="n">nlp_strict_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">nlp_single_strict_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">correction_config</span><span class="p">:</span> <span class="n">CorrectionConfig</span> <span class="o">=</span> <span class="n">CorrectionConfig</span><span class="p">(),</span>
    <span class="n">onlytested</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Postprocesses the optimization results to find feasible switches.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRA-k model to optimize.</span>
<span class="sd">        opt_dict (dict[str, float]): Optimization result dictionary.</span>
<span class="sd">        objective_target (str | dict[str, float]): Target value(s) for the objective function.</span>
<span class="sd">        objective_sense (int): Sense of the objective function (1 for maximization, -1 for minimization).</span>
<span class="sd">        variability_data (dict[str, tuple[float, float]]): Variability data for each reaction.</span>
<span class="sd">        with_kappa (bool, optional): Whether to use kappa parameter. Defaults to True.</span>
<span class="sd">        with_gamma (bool, optional): Whether to use gamma parameter. Defaults to True.</span>
<span class="sd">        with_iota (bool, optional): Whether to use iota parameter. Defaults to False.</span>
<span class="sd">        with_alpha (bool, optional): Whether to use alpha parameter. Defaults to False.</span>
<span class="sd">        lp_solver (Solver, optional): The linear programming solver to use. Defaults to SCIP.</span>
<span class="sd">        nlp_solver (Solver, optional): The nonlinear programming solver to use. Defaults to IPOPT.</span>
<span class="sd">        nlp_strict_mode (bool, optional): Whether or not the &lt;= heuristic (True) or not (False; i.e. setting all equations to ==) shall be used. Defaults to False.</span>
<span class="sd">        nlp_single_strict_reacs (list[str], optional): List of single reactions that shall be in strict mode (see ```nlp_strict_mode```argument above).</span>
<span class="sd">            If ```nlp_strict_mode=True```, this has no effect. Defaults to [].</span>
<span class="sd">        verbose (bool, optional): Whether to enable verbose output. Defaults to False.</span>
<span class="sd">        correction_config (CorrectionConfig, optional): Configuration for corrections during optimization. Defaults to CorrectionConfig().</span>
<span class="sd">        onlytested (str, optional): Specific reactions to test during postprocessing. Defaults to &quot;&quot;.</span>
<span class="sd">        ignore_nonlinear_extra_terms_in_ectfbas: (bool, optional): Whether or not non-linear watches/constraints shall be ignored in ecTFBAs.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[float, list[float | int]]: Best result and a list of feasible switches.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">variability_data</span> <span class="o">==</span> <span class="p">{}:</span>
        <span class="n">variability_data</span> <span class="o">=</span> <span class="n">perform_lp_variability_analysis</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="o">=</span><span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">active_reactions</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">solver</span><span class="o">=</span><span class="n">lp_solver</span><span class="p">,</span>
            <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">variability_data</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">variability_data</span><span class="p">)</span>

    <span class="n">pyomo_lp_solver</span> <span class="o">=</span> <span class="n">get_solver</span><span class="p">(</span>
        <span class="n">lp_solver</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">lp_solver</span><span class="o">.</span><span class="n">solver_options</span><span class="p">,</span>
        <span class="n">lp_solver</span><span class="o">.</span><span class="n">solver_attrs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cobrak_model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">objective_target</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">objective_target</span> <span class="o">=</span> <span class="p">{</span><span class="n">objective_target</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
    <span class="n">obj_value</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">obj_target_id</span><span class="p">,</span> <span class="n">obj_target_multiplier</span> <span class="ow">in</span> <span class="n">objective_target</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">obj_value</span> <span class="o">+=</span> <span class="n">opt_dict</span><span class="p">[</span><span class="n">obj_target_id</span><span class="p">]</span> <span class="o">*</span> <span class="n">obj_target_multiplier</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-6</span> <span class="k">if</span> <span class="n">is_objsense_maximization</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">)</span> <span class="k">else</span> <span class="o">-</span><span class="mf">1e-6</span>
    <span class="n">cobrak_model</span> <span class="o">=</span> <span class="n">add_objective_value_as_extra_linear_constraint</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">obj_value</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">,</span>
        <span class="n">objective_target</span><span class="p">,</span>
        <span class="n">objective_sense</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">reac_couples</span> <span class="o">=</span> <span class="n">get_stoichiometrically_coupled_reactions</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
    <span class="n">active_reacs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">active_reac</span>
        <span class="k">for</span> <span class="n">active_reac</span> <span class="ow">in</span> <span class="n">get_active_reacs_from_optimization_dict</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="p">,</span> <span class="n">opt_dict</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">active_reac</span> <span class="ow">in</span> <span class="p">[</span><span class="n">reac_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">reac_ids</span> <span class="ow">in</span> <span class="n">reac_couples</span><span class="p">])</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">active_reac</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">objective_target</span><span class="p">)</span>  <span class="c1"># and opt_dict[active_reac] &gt; 1e-8</span>
    <span class="p">]</span>
    <span class="n">active_reac_couples</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">reac_couple</span>
        <span class="k">for</span> <span class="n">reac_couple</span> <span class="ow">in</span> <span class="n">reac_couples</span>
        <span class="k">if</span> <span class="n">reac_couple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">active_reacs</span> <span class="ow">and</span> <span class="n">variability_data</span><span class="p">[</span><span class="n">reac_couple</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span>
    <span class="p">]</span>
    <span class="n">inactive_reac_couples</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">reac_couple</span>
        <span class="k">for</span> <span class="n">reac_couple</span> <span class="ow">in</span> <span class="n">reac_couples</span>
        <span class="k">if</span> <span class="n">reac_couple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">active_reacs</span>
        <span class="ow">and</span> <span class="n">variability_data</span><span class="p">[</span><span class="n">reac_couple</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span>
    <span class="p">]</span>
    <span class="n">targets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">max_target_num</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
        <span class="n">targets</span> <span class="o">+=</span> <span class="p">[(</span><span class="s2">&quot;deac&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">max_target_num</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">active_reac_couples</span><span class="p">]</span>
        <span class="n">targets</span> <span class="o">+=</span> <span class="p">[(</span><span class="s2">&quot;ac&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">max_target_num</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inactive_reac_couples</span><span class="p">]</span>
    <span class="n">all_feasible_switches_metalist</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">10</span><span class="p">)(</span>
        <span class="n">delayed</span><span class="p">(</span><span class="n">_postprocess_batch</span><span class="p">)(</span>
            <span class="n">reac_couples</span><span class="p">,</span>
            <span class="n">targets_batch</span><span class="p">,</span>
            <span class="n">active_reacs</span><span class="p">,</span>
            <span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">objective_target</span><span class="p">,</span>
            <span class="n">objective_sense</span><span class="p">,</span>
            <span class="n">variability_data</span><span class="p">,</span>
            <span class="n">pyomo_lp_solver</span><span class="p">,</span>
            <span class="n">with_kappa</span><span class="p">,</span>
            <span class="n">with_gamma</span><span class="p">,</span>
            <span class="n">with_iota</span><span class="p">,</span>
            <span class="n">with_alpha</span><span class="p">,</span>
            <span class="n">lp_solver</span><span class="p">,</span>
            <span class="n">nlp_solver</span><span class="p">,</span>
            <span class="n">nlp_strict_mode</span><span class="p">,</span>
            <span class="n">nlp_single_strict_reacs</span><span class="p">,</span>
            <span class="n">verbose</span><span class="p">,</span>
            <span class="n">correction_config</span><span class="p">,</span>
            <span class="n">onlytested</span><span class="p">,</span>
            <span class="n">ignore_nonlinear_extra_terms_in_ectfbas</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">targets_batch</span> <span class="ow">in</span> <span class="n">split_list</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">cpu_count</span><span class="p">())</span>
    <span class="p">)</span>
    <span class="n">all_feasible_switches</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">all_feasible_switches_metalist</span><span class="p">:</span>
        <span class="n">all_feasible_switches</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sublist</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_feasible_switches</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">best_result</span> <span class="o">=</span> <span class="n">all_feasible_switches</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_feasible_switches</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]:</span>
            <span class="k">if</span> <span class="n">is_objsense_maximization</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">best_result</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]:</span>
                    <span class="n">best_result</span> <span class="o">=</span> <span class="n">result</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">best_result</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]:</span>
                    <span class="n">best_result</span> <span class="o">=</span> <span class="n">result</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">best_result</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">return</span> <span class="n">all_feasible_switches</span><span class="p">,</span> <span class="n">best_result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.example_models" class="doc doc-heading">
            <code>example_models</code>


</h2>

    <div class="doc doc-contents ">

        <p>Contains the toy model from COBRAk's documentation and publication as example model as well as iCH360_cobrak.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.example_models.__getattr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getattr__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Called by Python when an attribute that does not yet exist in the
module namespace is requested.</p>
<p>We use it to load the JSON the first time <code>iCH360_cobrak</code> is asked
for, then store the result in <code>globals()</code> so the load happens only
once.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/example_models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>  <span class="c1"># called only for missing attrs  # noqa: ANN401</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Called by Python when an attribute that does not yet exist in the</span>
<span class="sd">    module namespace is requested.</span>

<span class="sd">    We use it to load the JSON the first time ``iCH360_cobrak`` is asked</span>
<span class="sd">    for, then store the result in ``globals()`` so the load happens only</span>
<span class="sd">    once.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;iCH360_cobrak&quot;</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json_load</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">files</span><span class="p">(</span><span class="s2">&quot;cobrak&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;data/iCH360_cobrak.json&quot;</span><span class="p">))</span>
        <span class="p">)</span>  <span class="c1"># &lt;-load the file now</span>
        <span class="nb">globals</span><span class="p">()[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>  <span class="c1"># cache for future accesses</span>
        <span class="k">return</span> <span class="n">data</span>
    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.expasy_functionality" class="doc doc-heading">
            <code>expasy_functionality</code>


</h2>

    <div class="doc doc-contents ">

        <p>This module provides functionality to parse Expasy enzyme RDF files and extract EC number transfers.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.expasy_functionality.get_ec_number_transfers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_ec_number_transfers</span><span class="p">(</span><span class="n">expasy_enzyme_rdf_path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parses an Expasy enzyme RDF file to extract enzyme EC number transfers.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>expasy_enzyme_rdf_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the Expasy enzyme RDF file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, str]: A dictionary where each key is an EC number, and its corresponding value is the EC number it is transferred to.
            The dictionary includes both directions of the transfer (old to new and new to old).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/expasy_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_ec_number_transfers</span><span class="p">(</span><span class="n">expasy_enzyme_rdf_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses an Expasy enzyme RDF file to extract enzyme EC number transfers.</span>

<span class="sd">    Args:</span>
<span class="sd">        expasy_enzyme_rdf_path (str): Path to the Expasy enzyme RDF file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, str]: A dictionary where each key is an EC number, and its corresponding value is the EC number it is transferred to.</span>
<span class="sd">                        The dictionary includes both directions of the transfer (old to new and new to old).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">expasy_enzyme_rdf_path</span><span class="p">)</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>

    <span class="n">ec_number_transfers</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">root</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">subchild</span> <span class="ow">in</span> <span class="n">child</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;replaces&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">subchild</span><span class="o">.</span><span class="n">tag</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">new_ec_numbers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">old_ec_numbers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">subchild</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">new_ec_number</span> <span class="ow">in</span> <span class="n">new_ec_numbers</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">old_ec_number</span> <span class="ow">in</span> <span class="n">old_ec_numbers</span><span class="p">:</span>
                    <span class="n">ec_number_transfers</span><span class="p">[</span><span class="n">old_ec_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_ec_number</span>
                    <span class="n">ec_number_transfers</span><span class="p">[</span><span class="n">new_ec_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_ec_number</span>
    <span class="k">return</span> <span class="n">ec_number_transfers</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.genetic" class="doc doc-heading">
            <code>genetic</code>


</h2>

    <div class="doc doc-contents ">

        <p>Methods for COBRA-k's genetic algorithm used in the COBRA-k evolutionary algorithm</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="cobrak.genetic.COBRAKGENETIC" class="doc doc-heading">
            <code>COBRAKGENETIC</code>


</h3>


    <div class="doc doc-contents ">


        <p>A class for performing genetic algorithm optimization.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.genetic.COBRAKGENETIC.fitness_function">fitness_function</span></code></td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A function that takes a list of integers/floats
and returns a tuple containing the fitness score and a list of integers/floats.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.genetic.COBRAKGENETIC.xs_dim">xs_dim</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dimensionality of the search space.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.genetic.COBRAKGENETIC.gen">gen</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of generations to run the algorithm for.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.genetic.COBRAKGENETIC.seed">seed</span></code></td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The seed for the random number generator.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.genetic.COBRAKGENETIC.objvalue_json_path">objvalue_json_path</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to a JSON file to store objective values.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.genetic.COBRAKGENETIC.max_rounds_same_objvalue">max_rounds_same_objvalue</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of rounds with the same
objective value before stopping the algorithm.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cobrak.genetic.COBRAKGENETIC.pop_size">pop_size</span></code></td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of the population. If None, defaults to the
number of CPUs.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>cobrak/genetic.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">COBRAKGENETIC</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class for performing genetic algorithm optimization.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        fitness_function (Callable): A function that takes a list of integers/floats</span>
<span class="sd">            and returns a tuple containing the fitness score and a list of integers/floats.</span>
<span class="sd">        xs_dim (int): The dimensionality of the search space.</span>
<span class="sd">        gen (int): The number of generations to run the algorithm for.</span>
<span class="sd">        seed (int | None): The seed for the random number generator.</span>
<span class="sd">        objvalue_json_path (str): The path to a JSON file to store objective values.</span>
<span class="sd">        max_rounds_same_objvalue (float): The maximum number of rounds with the same</span>
<span class="sd">            objective value before stopping the algorithm.</span>
<span class="sd">        pop_size (int | None): The size of the population. If None, defaults to the</span>
<span class="sd">            number of CPUs.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fitness_function</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span>
            <span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span>
        <span class="p">],</span>
        <span class="n">xs_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">gen</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">extra_xs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">objvalue_json_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">max_rounds_same_objvalue</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
        <span class="n">pop_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the COBRAKGENETIC object.</span>

<span class="sd">        Args:</span>
<span class="sd">            fitness_function (Callable): The fitness function to evaluate solutions.</span>
<span class="sd">            xs_dim (int): The dimensionality of the search space.</span>
<span class="sd">            gen (int): The number of generations to run.</span>
<span class="sd">            extra_xs (list[list[int]], optional): Extra particles to initialize the population.</span>
<span class="sd">                Defaults to [].</span>
<span class="sd">            seed (int | None, optional): Seed for the random number generator. Defaults to None.</span>
<span class="sd">            objvalue_json_path (str, optional): Path to a JSON file to store objective values.</span>
<span class="sd">                Defaults to &quot;&quot;.</span>
<span class="sd">            max_rounds_same_objvalue (float, optional): Maximum rounds with the same objective</span>
<span class="sd">                value before stopping. Defaults to infinity.</span>
<span class="sd">            pop_size (int | None, optional): Population size. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fitness_function</span> <span class="o">=</span> <span class="n">fitness_function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xs_dim</span> <span class="o">=</span> <span class="n">xs_dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gen</span> <span class="o">=</span> <span class="n">gen</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>  <span class="c1"># noqa: NPY002</span>

        <span class="c1"># Initialization of random particles</span>
        <span class="n">cpu_count_value</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="k">if</span> <span class="n">pop_size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pop_size</span>
        <span class="k">if</span> <span class="n">cpu_count_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">=</span> <span class="n">cpu_count_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_xs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xs_dim</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">extra_xs</span><span class="p">))</span>
        <span class="p">]</span>

        <span class="c1"># Addition of user-defined extra particles</span>
        <span class="k">if</span> <span class="n">extra_xs</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_xs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extra_xs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tested_xs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_xs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_path</span> <span class="o">=</span> <span class="n">objvalue_json_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_rounds_same_objvalue</span> <span class="o">=</span> <span class="n">max_rounds_same_objvalue</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_sorted_list_from_tested_xs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a sorted list of tuples containing fitness scores and solutions.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[tuple[float, tuple[int, ...]]]: A sorted list of (fitness, solution) tuples.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="p">[(</span><span class="n">fitness</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fitness</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tested_xs</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span>
            <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Runs the genetic algorithm optimization.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[float, tuple[int, ...]]: A tuple containing the best fitness score and the</span>
<span class="sd">            corresponding solution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">init_fitnesses</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)(</span>
            <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fitness_function</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_xs</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">init_fitnesses</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tested_xs</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">init_fitness</span> <span class="ow">in</span> <span class="n">init_fitnesses</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">xs</span> <span class="ow">in</span> <span class="n">init_fitness</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tested_xs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">xs</span><span class="p">)]</span> <span class="o">=</span> <span class="n">fitness</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: Something went wrong during initialization&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_path</span><span class="p">:</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_data</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tested_xs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">json_write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_data</span><span class="p">)</span>

        <span class="c1"># Actual algorithm</span>
        <span class="n">max_objvalues</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">):</span>
            <span class="n">max_objvalues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tested_xs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="k">if</span> <span class="n">last_n_elements_equal</span><span class="p">(</span><span class="n">max_objvalues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_rounds_same_objvalue</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
                <span class="k">break</span>

            <span class="n">xs_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sorted_list_from_tested_xs</span><span class="p">()</span>
            <span class="n">xs_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">xs</span> <span class="k">for</span> <span class="n">xs</span> <span class="ow">in</span> <span class="n">xs_list</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

            <span class="n">chosen_xs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Choose some of the top 3</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">//</span> <span class="mi">4</span><span class="p">):</span>
                <span class="n">chosen_xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">choice</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs_list</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">][:</span><span class="mi">3</span><span class="p">]))</span>

            <span class="c1"># Choose some of the 25% best</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">chosen_xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">choice</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs_list</span><span class="p">][:</span> <span class="nb">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs_list</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span><span class="p">)])</span>
                <span class="p">)</span>

            <span class="c1"># Choose some other 75% worst</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">//</span> <span class="mi">4</span><span class="p">):</span>
                <span class="n">addlength</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">while</span> <span class="ow">not</span> <span class="n">addlength</span><span class="p">:</span>
                    <span class="n">added_xs</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
                        <span class="n">choice</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs_list</span><span class="p">][</span><span class="nb">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs_list</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span><span class="p">)</span> <span class="p">:])</span>
                    <span class="p">)</span>
                    <span class="n">addlength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">added_xs</span><span class="p">)</span>
                <span class="n">chosen_xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">added_xs</span><span class="p">)</span>

            <span class="c1"># Random crossovers</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chosen_xs</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)):</span>
                <span class="n">target</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_xs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">source</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_xs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">cut</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xs_dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">chosen_xs</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">chosen_xs</span><span class="p">[</span><span class="n">target</span><span class="p">][:</span><span class="n">cut</span><span class="p">])</span> <span class="o">+</span> <span class="n">deepcopy</span><span class="p">(</span>
                    <span class="n">chosen_xs</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="n">cut</span><span class="p">:]</span>
                <span class="p">)</span>

            <span class="c1"># Test Xs in parallel</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">10</span><span class="p">)(</span>
                <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_particle</span><span class="p">)(</span>
                    <span class="n">chosen_x</span><span class="p">,</span>
                    <span class="n">count_last_equal_elements</span><span class="p">(</span><span class="n">max_objvalues</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">chosen_x</span> <span class="ow">in</span> <span class="n">chosen_xs</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">results</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: Something went wrong during fitness calculations&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span>

            <span class="c1"># Unpack results</span>
            <span class="k">for</span> <span class="n">fitnesses_and_active_xs</span><span class="p">,</span> <span class="n">mutated_x</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">active_x</span> <span class="ow">in</span> <span class="n">fitnesses_and_active_xs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">active_x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">active_x</span> <span class="o">==</span> <span class="p">[]:</span>
                        <span class="k">continue</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tested_xs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">active_x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">fitness</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">all_xs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">active_x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">fitness</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">all_xs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">mutated_x</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                    <span class="n">fitness</span> <span class="k">for</span> <span class="p">(</span><span class="n">fitness</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">fitnesses_and_active_xs</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_path</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_data</span><span class="p">[</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tested_xs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="p">)</span>
                <span class="n">json_write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_data</span><span class="p">)</span>

        <span class="n">best_f_and_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sorted_list_from_tested_xs</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">best_f_and_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">best_f_and_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_particle</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">chosen_x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
        <span class="n">num_rounds_without_best_change</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Updates a single particle by introducing mutations.</span>

<span class="sd">        Args:</span>
<span class="sd">            chosen_x (list[int]): The current solution represented as a list of integers.</span>
<span class="sd">            num_rounds_without_best_change (int): The number of rounds without a change in the</span>
<span class="sd">                best fitness score.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple[list[list[float]], list[int]]: A tuple containing a list of fitness scores</span>
<span class="sd">            and the mutated solution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_x</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[[</span><span class="mi">1_000_000</span><span class="p">,</span> <span class="p">[]]],</span> <span class="p">[]</span>

        <span class="n">min_change_p</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="mf">0.95</span><span class="o">**</span><span class="n">num_rounds_without_best_change</span>
        <span class="n">max_change_p</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="mf">1.05</span><span class="o">**</span><span class="n">num_rounds_without_best_change</span>
        <span class="n">change_p</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">min_change_p</span><span class="p">,</span> <span class="n">max_change_p</span><span class="p">)</span>
        <span class="n">change_p</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">change_p</span><span class="p">)</span>
        <span class="n">change_p</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">0.999</span><span class="p">,</span> <span class="n">change_p</span><span class="p">)</span>

        <span class="n">mutation_tries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">mutated_x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">match</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
                <span class="k">case</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Extend</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">chosen_x</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                            <span class="k">continue</span>
                        <span class="k">if</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">change_p</span><span class="p">:</span>
                            <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Decrease</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">chosen_x</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                            <span class="k">continue</span>
                        <span class="k">if</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">change_p</span><span class="p">:</span>
                            <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Extend and decrease</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">chosen_x</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">change_p</span><span class="p">:</span>
                                <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">change_p</span><span class="p">:</span>
                                <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="c1"># case 3:  # Random</span>
                <span class="c1">#    mutated_x = [randint(0, 1) for _ in range(len(chosen_x))]</span>

            <span class="k">if</span> <span class="n">mutation_tries</span> <span class="o">&gt;</span> <span class="mi">250</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[[</span><span class="mi">1_000_000</span><span class="p">,</span> <span class="p">[]]],</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">mutated_x</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_xs</span><span class="p">:</span>
                <span class="n">mutation_tries</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="c1"># Evaluate new position</span>
        <span class="n">fitnesses_and_active_xs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitness_function</span><span class="p">(</span><span class="n">mutated_x</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fitnesses_and_active_xs</span><span class="p">,</span> <span class="n">mutated_x</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="cobrak.genetic.COBRAKGENETIC.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">fitness_function</span><span class="p">,</span> <span class="n">xs_dim</span><span class="p">,</span> <span class="n">gen</span><span class="p">,</span> <span class="n">extra_xs</span><span class="o">=</span><span class="p">[],</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">objvalue_json_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">max_rounds_same_objvalue</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">pop_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Initializes the COBRAKGENETIC object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fitness_function</code>
            </td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The fitness function to evaluate solutions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xs_dim</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dimensionality of the search space.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gen</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of generations to run.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>extra_xs</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Extra particles to initialize the population.
Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Seed for the random number generator. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objvalue_json_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to a JSON file to store objective values.
Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_rounds_same_objvalue</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum rounds with the same objective
value before stopping. Defaults to infinity.</p>
              </div>
            </td>
            <td>
                  <code><span title="float">float</span>(&#39;inf&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pop_size</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Population size. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/genetic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fitness_function</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span>
        <span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">]]</span>
    <span class="p">],</span>
    <span class="n">xs_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">gen</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">extra_xs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">objvalue_json_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">max_rounds_same_objvalue</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
    <span class="n">pop_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the COBRAKGENETIC object.</span>

<span class="sd">    Args:</span>
<span class="sd">        fitness_function (Callable): The fitness function to evaluate solutions.</span>
<span class="sd">        xs_dim (int): The dimensionality of the search space.</span>
<span class="sd">        gen (int): The number of generations to run.</span>
<span class="sd">        extra_xs (list[list[int]], optional): Extra particles to initialize the population.</span>
<span class="sd">            Defaults to [].</span>
<span class="sd">        seed (int | None, optional): Seed for the random number generator. Defaults to None.</span>
<span class="sd">        objvalue_json_path (str, optional): Path to a JSON file to store objective values.</span>
<span class="sd">            Defaults to &quot;&quot;.</span>
<span class="sd">        max_rounds_same_objvalue (float, optional): Maximum rounds with the same objective</span>
<span class="sd">            value before stopping. Defaults to infinity.</span>
<span class="sd">        pop_size (int | None, optional): Population size. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Parameters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fitness_function</span> <span class="o">=</span> <span class="n">fitness_function</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">xs_dim</span> <span class="o">=</span> <span class="n">xs_dim</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">gen</span> <span class="o">=</span> <span class="n">gen</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>  <span class="c1"># noqa: NPY002</span>

    <span class="c1"># Initialization of random particles</span>
    <span class="n">cpu_count_value</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="k">if</span> <span class="n">pop_size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pop_size</span>
    <span class="k">if</span> <span class="n">cpu_count_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">=</span> <span class="n">cpu_count_value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">init_xs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xs_dim</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">extra_xs</span><span class="p">))</span>
    <span class="p">]</span>

    <span class="c1"># Addition of user-defined extra particles</span>
    <span class="k">if</span> <span class="n">extra_xs</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_xs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">extra_xs</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">tested_xs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">all_xs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_path</span> <span class="o">=</span> <span class="n">objvalue_json_path</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_rounds_same_objvalue</span> <span class="o">=</span> <span class="n">max_rounds_same_objvalue</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cobrak.genetic.COBRAKGENETIC.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Runs the genetic algorithm optimization.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[float, tuple[int, ...]]: A tuple containing the best fitness score and the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>corresponding solution.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/genetic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Runs the genetic algorithm optimization.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[float, tuple[int, ...]]: A tuple containing the best fitness score and the</span>
<span class="sd">        corresponding solution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">init_fitnesses</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)(</span>
        <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fitness_function</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_xs</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">init_fitnesses</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tested_xs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">init_fitness</span> <span class="ow">in</span> <span class="n">init_fitnesses</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">xs</span> <span class="ow">in</span> <span class="n">init_fitness</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tested_xs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">xs</span><span class="p">)]</span> <span class="o">=</span> <span class="n">fitness</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: Something went wrong during initialization&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_path</span><span class="p">:</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_data</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tested_xs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">json_write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_data</span><span class="p">)</span>

    <span class="c1"># Actual algorithm</span>
    <span class="n">max_objvalues</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">):</span>
        <span class="n">max_objvalues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tested_xs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">last_n_elements_equal</span><span class="p">(</span><span class="n">max_objvalues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_rounds_same_objvalue</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
            <span class="k">break</span>

        <span class="n">xs_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sorted_list_from_tested_xs</span><span class="p">()</span>
        <span class="n">xs_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">xs</span> <span class="k">for</span> <span class="n">xs</span> <span class="ow">in</span> <span class="n">xs_list</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

        <span class="n">chosen_xs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Choose some of the top 3</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">//</span> <span class="mi">4</span><span class="p">):</span>
            <span class="n">chosen_xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">choice</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs_list</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">][:</span><span class="mi">3</span><span class="p">]))</span>

        <span class="c1"># Choose some of the 25% best</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">chosen_xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">choice</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs_list</span><span class="p">][:</span> <span class="nb">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs_list</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span><span class="p">)])</span>
            <span class="p">)</span>

        <span class="c1"># Choose some other 75% worst</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cpu_count</span> <span class="o">//</span> <span class="mi">4</span><span class="p">):</span>
            <span class="n">addlength</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">addlength</span><span class="p">:</span>
                <span class="n">added_xs</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
                    <span class="n">choice</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs_list</span><span class="p">][</span><span class="nb">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xs_list</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.25</span><span class="p">)</span> <span class="p">:])</span>
                <span class="p">)</span>
                <span class="n">addlength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">added_xs</span><span class="p">)</span>
            <span class="n">chosen_xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">added_xs</span><span class="p">)</span>

        <span class="c1"># Random crossovers</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chosen_xs</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)):</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_xs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">source</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_xs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">cut</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xs_dim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">chosen_xs</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">chosen_xs</span><span class="p">[</span><span class="n">target</span><span class="p">][:</span><span class="n">cut</span><span class="p">])</span> <span class="o">+</span> <span class="n">deepcopy</span><span class="p">(</span>
                <span class="n">chosen_xs</span><span class="p">[</span><span class="n">source</span><span class="p">][</span><span class="n">cut</span><span class="p">:]</span>
            <span class="p">)</span>

        <span class="c1"># Test Xs in parallel</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">10</span><span class="p">)(</span>
            <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_particle</span><span class="p">)(</span>
                <span class="n">chosen_x</span><span class="p">,</span>
                <span class="n">count_last_equal_elements</span><span class="p">(</span><span class="n">max_objvalues</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">chosen_x</span> <span class="ow">in</span> <span class="n">chosen_xs</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">results</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: Something went wrong during fitness calculations&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="c1"># Unpack results</span>
        <span class="k">for</span> <span class="n">fitnesses_and_active_xs</span><span class="p">,</span> <span class="n">mutated_x</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">fitness</span><span class="p">,</span> <span class="n">active_x</span> <span class="ow">in</span> <span class="n">fitnesses_and_active_xs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">active_x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">active_x</span> <span class="o">==</span> <span class="p">[]:</span>
                    <span class="k">continue</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tested_xs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">active_x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">fitness</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">all_xs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">active_x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">fitness</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">all_xs</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">mutated_x</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                <span class="n">fitness</span> <span class="k">for</span> <span class="p">(</span><span class="n">fitness</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">fitnesses_and_active_xs</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_path</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_data</span><span class="p">[</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tested_xs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">json_write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">objvalue_json_data</span><span class="p">)</span>

    <span class="n">best_f_and_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sorted_list_from_tested_xs</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">best_f_and_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">best_f_and_x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cobrak.genetic.COBRAKGENETIC.update_particle" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_particle</span><span class="p">(</span><span class="n">chosen_x</span><span class="p">,</span> <span class="n">num_rounds_without_best_change</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Updates a single particle by introducing mutations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chosen_x</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current solution represented as a list of integers.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_rounds_without_best_change</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of rounds without a change in the
best fitness score.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[list[list[float]], list[int]]: A tuple containing a list of fitness scores</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>and the mutated solution.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/genetic.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_particle</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">chosen_x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">num_rounds_without_best_change</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Updates a single particle by introducing mutations.</span>

<span class="sd">    Args:</span>
<span class="sd">        chosen_x (list[int]): The current solution represented as a list of integers.</span>
<span class="sd">        num_rounds_without_best_change (int): The number of rounds without a change in the</span>
<span class="sd">            best fitness score.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[list[list[float]], list[int]]: A tuple containing a list of fitness scores</span>
<span class="sd">        and the mutated solution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">chosen_x</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[[</span><span class="mi">1_000_000</span><span class="p">,</span> <span class="p">[]]],</span> <span class="p">[]</span>

    <span class="n">min_change_p</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="mf">0.95</span><span class="o">**</span><span class="n">num_rounds_without_best_change</span>
    <span class="n">max_change_p</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="mf">1.05</span><span class="o">**</span><span class="n">num_rounds_without_best_change</span>
    <span class="n">change_p</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="n">min_change_p</span><span class="p">,</span> <span class="n">max_change_p</span><span class="p">)</span>
    <span class="n">change_p</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">change_p</span><span class="p">)</span>
    <span class="n">change_p</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">0.999</span><span class="p">,</span> <span class="n">change_p</span><span class="p">)</span>

    <span class="n">mutation_tries</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">mutated_x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">match</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="k">case</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Extend</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">chosen_x</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">change_p</span><span class="p">:</span>
                        <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Decrease</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">chosen_x</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">change_p</span><span class="p">:</span>
                        <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Extend and decrease</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">chosen_x</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">change_p</span><span class="p">:</span>
                            <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">change_p</span><span class="p">:</span>
                            <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">mutated_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="c1"># case 3:  # Random</span>
            <span class="c1">#    mutated_x = [randint(0, 1) for _ in range(len(chosen_x))]</span>

        <span class="k">if</span> <span class="n">mutation_tries</span> <span class="o">&gt;</span> <span class="mi">250</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[[</span><span class="mi">1_000_000</span><span class="p">,</span> <span class="p">[]]],</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">mutated_x</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_xs</span><span class="p">:</span>
            <span class="n">mutation_tries</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c1"># Evaluate new position</span>
    <span class="n">fitnesses_and_active_xs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitness_function</span><span class="p">(</span><span class="n">mutated_x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fitnesses_and_active_xs</span><span class="p">,</span> <span class="n">mutated_x</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.io" class="doc doc-heading">
            <code>io</code>


</h2>

    <div class="doc doc-contents ">

        <p>General (COBRAk-independent) helper functions, primarily for I/O tasks such as pickle and JSON file handlings.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.io.convert_cobrak_model_to_annotated_cobrapy_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_cobrak_model_to_annotated_cobrapy_model</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">combine_base_reactions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_enzyme_constraints</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Converts a COBRAk model to an annotated COBRApy model.</p>
<p>This function takes a COBRAk model and converts it to a COBRApy model,
adding annotations and constraints as specified by the input parameters.</p>
<p>The function adds the following annotation keys to the COBRApy model:</p>
<ul>
<li><code>cobrak_Cmin</code>: The minimum concentration of a metabolite.</li>
<li><code>cobrak_Cmax</code>: The maximum concentration of a metabolite.</li>
<li><code>cobrak_id_&lt;version&gt;</code>: The ID of the reaction in the COBRAk model.</li>
<li><code>cobrak_dG0_&lt;version&gt;</code>: The standard Gibbs free energy change of a reaction.</li>
<li><code>cobrak_dG0_uncertainty_&lt;version&gt;</code>: The uncertainty of the standard Gibbs free energy change of a reaction.</li>
<li><code>cobrak_k_cat_&lt;version&gt;</code>: The turnover number of an enzyme.</li>
<li><code>cobrak_k_ms_&lt;version&gt;</code>: The Michaelis constant of an enzyme.</li>
<li><code>cobrak_k_is_&lt;version&gt;</code>: The inhibition constant of an enzyme.</li>
<li><code>cobrak_k_as_&lt;version&gt;</code>: The activation constant of an enzyme.</li>
<li><code>cobrak_special_stoichiometries_&lt;version&gt;</code>: Special stoichiometries of a reaction.</li>
<li><code>cobrak_max_prot_pool</code>: The maximum protein pool size.</li>
<li><code>cobrak_R</code>: The gas constant.</li>
<li><code>cobrak_T</code>: The temperature.</li>
<li><code>cobrak_kinetic_ignored_metabolites</code>: A list of metabolites that are ignored in kinetic simulations.</li>
<li><code>cobrak_extra_linear_constraints</code>: A list of extra linear constraints.</li>
<li><code>cobrak_mw</code>: The molecular weight of an enzyme.</li>
<li><code>cobrak_min_conc</code>: The minimum concentration of an enzyme.</li>
<li><code>cobrak_max_conc</code>: The maximum concentration of an enzyme.</li>
</ul>
<p>The conversion process also involves the merging of forward and reverse reactions, as well as isomeric alternatives,
into a single reaction in the COBRApy model. When the combine_base_reactions parameter is set to True,
the function combines these reactions into a single entity, while still preserving the unique characteristics
of each original reaction. To achieve this, the function uses a versioning system, denoted by the <version> suffix,
to differentiate between the annotations of the original reactions. For example, the cobrak_id_<version> annotation
key will contain the ID of the original reaction, with <version> indicating whether it corresponds to the forward or
reverse direction, or an isomeric alternative. This versioning system allows the model to retain the distinct properties
of each reaction, such as their standard Gibbs free energy changes or enzyme kinetics, while still representing them as
a single, unified reaction. The <version> suffix can take on values such as V0, V1, etc., with each value corresponding
to a specific original reaction.</p>
<p>The conversion of a COBRAk model to a COBRApy model also includes the optional direct addition of enzyme constraints
in the style of GECKO [1] (or expaned sMOMENT [2]),
which can be enabled through the add_enzyme_constraints parameter. When this parameter is set to True,
the function introduces new pseudo-metabolites and pseudo-reactions to the model, allowing for the simulation
of enzyme kinetics and protein expression. Specifically, a protein pool pseudo-metabolite is added, which
represents the total amount of protein available in the system. Additionally, pseudo-reactions are created
to deliver enzymes to the protein pool, taking into account the molecular weight and concentration of each enzyme.
The function also adds pseudo-reactions to form enzyme complexes, which are essential for simulating the k_cat-based kinetics
of enzymatic reactions.</p>
<p>[1] https://doi.org/10.15252/msb.20167411
[2] https://doi.org/10.1186/s12859-019-3329-9</p>
<h5 id="cobrak.io.convert_cobrak_model_to_annotated_cobrapy_model--parameters">Parameters</h5>
<p>cobrak_model : Model
    The COBRAk model to be converted.
combine_base_reactions : bool, optional
    Whether to combine base reactions into a single reaction (default: False).
add_enzyme_constraints : bool, optional
    Whether to add enzyme constraints to the model (default: False).</p>
<h5 id="cobrak.io.convert_cobrak_model_to_annotated_cobrapy_model--returns">Returns</h5>
<p>cobra.Model
    The converted COBRApy model.</p>
<h5 id="cobrak.io.convert_cobrak_model_to_annotated_cobrapy_model--raises">Raises</h5>
<p>ValueError
    If combine_base_reactions and add_enzyme_constraints are both True.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">convert_cobrak_model_to_annotated_cobrapy_model</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">combine_base_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">add_enzyme_constraints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a COBRAk model to an annotated COBRApy model.</span>

<span class="sd">    This function takes a COBRAk model and converts it to a COBRApy model,</span>
<span class="sd">    adding annotations and constraints as specified by the input parameters.</span>

<span class="sd">    The function adds the following annotation keys to the COBRApy model:</span>

<span class="sd">    * `cobrak_Cmin`: The minimum concentration of a metabolite.</span>
<span class="sd">    * `cobrak_Cmax`: The maximum concentration of a metabolite.</span>
<span class="sd">    * `cobrak_id_&lt;version&gt;`: The ID of the reaction in the COBRAk model.</span>
<span class="sd">    * `cobrak_dG0_&lt;version&gt;`: The standard Gibbs free energy change of a reaction.</span>
<span class="sd">    * `cobrak_dG0_uncertainty_&lt;version&gt;`: The uncertainty of the standard Gibbs free energy change of a reaction.</span>
<span class="sd">    * `cobrak_k_cat_&lt;version&gt;`: The turnover number of an enzyme.</span>
<span class="sd">    * `cobrak_k_ms_&lt;version&gt;`: The Michaelis constant of an enzyme.</span>
<span class="sd">    * `cobrak_k_is_&lt;version&gt;`: The inhibition constant of an enzyme.</span>
<span class="sd">    * `cobrak_k_as_&lt;version&gt;`: The activation constant of an enzyme.</span>
<span class="sd">    * `cobrak_special_stoichiometries_&lt;version&gt;`: Special stoichiometries of a reaction.</span>
<span class="sd">    * `cobrak_max_prot_pool`: The maximum protein pool size.</span>
<span class="sd">    * `cobrak_R`: The gas constant.</span>
<span class="sd">    * `cobrak_T`: The temperature.</span>
<span class="sd">    * `cobrak_kinetic_ignored_metabolites`: A list of metabolites that are ignored in kinetic simulations.</span>
<span class="sd">    * `cobrak_extra_linear_constraints`: A list of extra linear constraints.</span>
<span class="sd">    * `cobrak_mw`: The molecular weight of an enzyme.</span>
<span class="sd">    * `cobrak_min_conc`: The minimum concentration of an enzyme.</span>
<span class="sd">    * `cobrak_max_conc`: The maximum concentration of an enzyme.</span>

<span class="sd">    The conversion process also involves the merging of forward and reverse reactions, as well as isomeric alternatives,</span>
<span class="sd">    into a single reaction in the COBRApy model. When the combine_base_reactions parameter is set to True,</span>
<span class="sd">    the function combines these reactions into a single entity, while still preserving the unique characteristics</span>
<span class="sd">    of each original reaction. To achieve this, the function uses a versioning system, denoted by the &lt;version&gt; suffix,</span>
<span class="sd">    to differentiate between the annotations of the original reactions. For example, the cobrak_id_&lt;version&gt; annotation</span>
<span class="sd">    key will contain the ID of the original reaction, with &lt;version&gt; indicating whether it corresponds to the forward or</span>
<span class="sd">    reverse direction, or an isomeric alternative. This versioning system allows the model to retain the distinct properties</span>
<span class="sd">    of each reaction, such as their standard Gibbs free energy changes or enzyme kinetics, while still representing them as</span>
<span class="sd">    a single, unified reaction. The &lt;version&gt; suffix can take on values such as V0, V1, etc., with each value corresponding</span>
<span class="sd">    to a specific original reaction.</span>

<span class="sd">    The conversion of a COBRAk model to a COBRApy model also includes the optional direct addition of enzyme constraints</span>
<span class="sd">    in the style of GECKO [1] (or expaned sMOMENT [2]),</span>
<span class="sd">    which can be enabled through the add_enzyme_constraints parameter. When this parameter is set to True,</span>
<span class="sd">    the function introduces new pseudo-metabolites and pseudo-reactions to the model, allowing for the simulation</span>
<span class="sd">    of enzyme kinetics and protein expression. Specifically, a protein pool pseudo-metabolite is added, which</span>
<span class="sd">    represents the total amount of protein available in the system. Additionally, pseudo-reactions are created</span>
<span class="sd">    to deliver enzymes to the protein pool, taking into account the molecular weight and concentration of each enzyme.</span>
<span class="sd">    The function also adds pseudo-reactions to form enzyme complexes, which are essential for simulating the k_cat-based kinetics</span>
<span class="sd">    of enzymatic reactions.</span>

<span class="sd">    [1] https://doi.org/10.15252/msb.20167411</span>
<span class="sd">    [2] https://doi.org/10.1186/s12859-019-3329-9</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cobrak_model : Model</span>
<span class="sd">        The COBRAk model to be converted.</span>
<span class="sd">    combine_base_reactions : bool, optional</span>
<span class="sd">        Whether to combine base reactions into a single reaction (default: False).</span>
<span class="sd">    add_enzyme_constraints : bool, optional</span>
<span class="sd">        Whether to add enzyme constraints to the model (default: False).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cobra.Model</span>
<span class="sd">        The converted COBRApy model.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If combine_base_reactions and add_enzyme_constraints are both True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">combine_base_reactions</span> <span class="ow">and</span> <span class="n">add_enzyme_constraints</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;ERROR: Stoichiometric enzyme constraints do not work with combined base reactions</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;       as for these enzyme constraints, reactions must remain irreversible.&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>

    <span class="n">cobra_model</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>

    <span class="c1"># Add metabolites</span>
    <span class="n">added_metabolites</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">cobra</span><span class="o">.</span><span class="n">Metabolite</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">met_data</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">cobra_metabolite</span><span class="p">:</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Metabolite</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Metabolite</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="n">met_id</span><span class="p">,</span>
            <span class="n">compartment</span><span class="o">=</span><span class="n">met_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;_&quot;</span> <span class="ow">in</span> <span class="n">met_id</span> <span class="k">else</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">met_data</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">formula</span><span class="o">=</span><span class="n">met_data</span><span class="o">.</span><span class="n">formula</span><span class="p">,</span>
            <span class="n">charge</span><span class="o">=</span><span class="n">met_data</span><span class="o">.</span><span class="n">charge</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">cobra_metabolite</span><span class="o">.</span><span class="n">annotation</span> <span class="o">=</span> <span class="n">met_data</span><span class="o">.</span><span class="n">annotation</span>

        <span class="c1"># Add full annotation</span>
        <span class="n">cobra_metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_Cmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">met_data</span><span class="o">.</span><span class="n">log_min_conc</span><span class="p">)</span>
        <span class="n">cobra_metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_Cmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">met_data</span><span class="o">.</span><span class="n">log_max_conc</span><span class="p">)</span>

        <span class="n">added_metabolites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cobra_metabolite</span><span class="p">)</span>
    <span class="n">cobra_model</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">(</span><span class="n">added_metabolites</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">add_enzyme_constraints</span><span class="p">:</span>
        <span class="n">enzyme_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># If set: Add protein pool reaction (flux in ggDW)</span>
        <span class="n">prot_pool_met</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Metabolite</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;prot_pool&quot;</span><span class="p">,</span> <span class="n">compartment</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span>
        <span class="n">cobra_model</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">([</span><span class="n">prot_pool_met</span><span class="p">])</span>

        <span class="n">prot_pool_reac</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
            <span class="s2">&quot;prot_pool_delivery&quot;</span><span class="p">,</span>
            <span class="n">lower_bound</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">upper_bound</span><span class="o">=</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">max_prot_pool</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">prot_pool_reac</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="n">prot_pool_met</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">enzyme_reacs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prot_pool_reac</span><span class="p">)</span>

        <span class="c1"># If set: Add enzyme concentration delivery reactions (flux in mmolgDW)</span>
        <span class="k">for</span> <span class="n">enzyme_id</span><span class="p">,</span> <span class="n">enzyme_data</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">enzymes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">enzyme_met</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Metabolite</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">enzyme_id</span><span class="p">,</span> <span class="n">compartment</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span>

            <span class="n">lower_bound</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">enzyme_data</span><span class="o">.</span><span class="n">min_conc</span> <span class="k">if</span> <span class="n">enzyme_data</span><span class="o">.</span><span class="n">min_conc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mf">0.0</span>
            <span class="p">)</span>
            <span class="n">upper_bound</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">enzyme_data</span><span class="o">.</span><span class="n">max_conc</span> <span class="k">if</span> <span class="n">enzyme_data</span><span class="o">.</span><span class="n">max_conc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mf">100_000.0</span>
            <span class="p">)</span>
            <span class="n">enzyme_reac</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;enzyme_delivery_&quot;</span> <span class="o">+</span> <span class="n">enzyme_id</span><span class="p">,</span>
                <span class="n">lower_bound</span><span class="o">=</span><span class="n">lower_bound</span><span class="p">,</span>
                <span class="n">upper_bound</span><span class="o">=</span><span class="n">upper_bound</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">enzyme_reac</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="n">prot_pool_met</span><span class="p">:</span> <span class="o">-</span><span class="n">enzyme_data</span><span class="o">.</span><span class="n">molecular_weight</span><span class="p">,</span>
                    <span class="n">enzyme_met</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="n">enzyme_reacs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">enzyme_reac</span><span class="p">)</span>

        <span class="n">cobra_model</span><span class="o">.</span><span class="n">add_reactions</span><span class="p">(</span><span class="n">enzyme_reacs</span><span class="p">)</span>

    <span class="c1"># If set: Add enzyme complex metabolites and delivery reactions</span>
    <span class="k">if</span> <span class="n">add_enzyme_constraints</span><span class="p">:</span>
        <span class="n">enzyme_complexes</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nb">tuple</span><span class="p">(</span>
                <span class="n">enzyme_id</span>
                <span class="k">for</span> <span class="n">enzyme_id</span> <span class="ow">in</span> <span class="n">reaction_data</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">reaction_data</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">reaction_data</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">}</span>
        <span class="n">complex_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">enzyme_complex</span> <span class="ow">in</span> <span class="n">enzyme_complexes</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">enzyme_complex</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">enzyme_complex</span> <span class="o">==</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,):</span>
                <span class="k">continue</span>
            <span class="n">complex_met</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Metabolite</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">enzyme_complex</span><span class="p">),</span> <span class="n">compartment</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span>
            <span class="n">complex_reac</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;complex_delivery_&quot;</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">enzyme_complex</span><span class="p">),</span>
                <span class="n">lower_bound</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="n">upper_bound</span><span class="o">=</span><span class="mf">10_000.0</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">complex_reac</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="n">cobra_model</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">enzyme_id</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="k">for</span> <span class="n">enzyme_id</span> <span class="ow">in</span> <span class="n">enzyme_complex</span>
                    <span class="k">if</span> <span class="n">enzyme_id</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="n">complex_reac</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="n">complex_met</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="n">complex_reacs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">complex_reac</span><span class="p">)</span>
        <span class="n">cobra_model</span><span class="o">.</span><span class="n">add_reactions</span><span class="p">(</span><span class="n">complex_reacs</span><span class="p">)</span>

    <span class="c1"># Add reactions</span>
    <span class="n">added_reactions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">combine_base_reactions</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reac_data</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">cobra_reaction</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="n">reac_id</span><span class="p">,</span>
                <span class="n">lower_bound</span><span class="o">=</span><span class="n">reac_data</span><span class="o">.</span><span class="n">min_flux</span><span class="p">,</span>
                <span class="n">upper_bound</span><span class="o">=</span><span class="n">reac_data</span><span class="o">.</span><span class="n">max_flux</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">reac_data</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">cobra_reaction</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="n">cobra_model</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">met_id</span><span class="p">):</span> <span class="n">stoich</span>
                    <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">stoich</span> <span class="ow">in</span> <span class="n">reac_data</span><span class="o">.</span><span class="n">stoichiometries</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">)</span>

            <span class="c1"># Add full annotation</span>
            <span class="n">_add_annotation_to_cobra_reaction</span><span class="p">(</span><span class="n">cobra_reaction</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reac_data</span><span class="p">,</span> <span class="s2">&quot;V0&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">reac_data</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="n">add_enzyme_constraints</span>
                <span class="ow">and</span> <span class="n">reac_data</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span> <span class="o">!=</span> <span class="p">[]</span>
            <span class="p">):</span>
                <span class="n">complex_met_id</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">reac_data</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">complex_met_id</span><span class="p">:</span>
                    <span class="n">cobra_reaction</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">(</span>
                        <span class="p">{</span>
                            <span class="n">cobra_model</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">complex_met_id</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span>
                            <span class="o">/</span> <span class="n">reac_data</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span>
                        <span class="p">}</span>
                    <span class="p">)</span>
            <span class="n">added_reactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cobra_reaction</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">base_id_to_reac_ids</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">base_id</span> <span class="o">=</span> <span class="n">get_base_id</span><span class="p">(</span>
                <span class="n">reac_id</span><span class="p">,</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span><span class="p">,</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">,</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reac_enz_separator</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">base_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">base_id_to_reac_ids</span><span class="p">:</span>
                <span class="n">base_id_to_reac_ids</span><span class="p">[</span><span class="n">base_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">base_id_to_reac_ids</span><span class="p">[</span><span class="n">base_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">base_id</span><span class="p">,</span> <span class="n">reac_ids</span> <span class="ow">in</span> <span class="n">base_id_to_reac_ids</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">rev_ids</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">reac_id</span>
                <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">reac_ids</span>
                <span class="k">if</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">fwd_ids</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">reac_id</span>
                <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">reac_ids</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">)</span>
            <span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rev_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">min_flux</span> <span class="o">=</span> <span class="o">-</span><span class="nb">max</span><span class="p">(</span>
                    <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">rev_id</span><span class="p">]</span><span class="o">.</span><span class="n">max_flux</span> <span class="k">for</span> <span class="n">rev_id</span> <span class="ow">in</span> <span class="n">rev_ids</span>
                <span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">rev_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">min_flux</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                    <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">fwd_id</span><span class="p">]</span><span class="o">.</span><span class="n">min_flux</span> <span class="k">for</span> <span class="n">fwd_id</span> <span class="ow">in</span> <span class="n">fwd_ids</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fwd_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">max_flux</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                    <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">fwd_id</span><span class="p">]</span><span class="o">.</span><span class="n">max_flux</span> <span class="k">for</span> <span class="n">fwd_id</span> <span class="ow">in</span> <span class="n">fwd_ids</span>
                <span class="p">)</span>
                <span class="n">met_stoichiometries</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">cobra_model</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">met_id</span><span class="p">):</span> <span class="n">stoich</span>
                    <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">stoich</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span>
                        <span class="n">fwd_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">stoichiometries</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">}</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">fwd_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">max_flux</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                    <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">rev_id</span><span class="p">]</span><span class="o">.</span><span class="n">max_flux</span> <span class="k">for</span> <span class="n">rev_id</span> <span class="ow">in</span> <span class="n">rev_ids</span>
                <span class="p">)</span>
                <span class="n">met_stoichiometries</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">cobra_model</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">met_id</span><span class="p">):</span> <span class="o">-</span><span class="n">stoich</span>
                    <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">stoich</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span>
                        <span class="n">rev_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">stoichiometries</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">}</span>

            <span class="n">cobra_reaction</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="n">base_id</span><span class="p">,</span>
                <span class="n">lower_bound</span><span class="o">=</span><span class="n">min_flux</span><span class="p">,</span>
                <span class="n">upper_bound</span><span class="o">=</span><span class="n">max_flux</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">cobra_reaction</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">(</span><span class="n">met_stoichiometries</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">number</span><span class="p">,</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reac_ids</span><span class="p">):</span>
                <span class="n">version</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;V</span><span class="si">{</span><span class="n">number</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">reac_data</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
                <span class="n">_add_annotation_to_cobra_reaction</span><span class="p">(</span>
                    <span class="n">cobra_reaction</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reac_data</span><span class="p">,</span> <span class="n">version</span>
                <span class="p">)</span>

            <span class="n">added_reactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cobra_reaction</span><span class="p">)</span>

    <span class="c1"># Add global information reaction</span>
    <span class="n">added_reactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;cobrak_global_settings&quot;</span><span class="p">,</span>
            <span class="n">lower_bound</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">upper_bound</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">added_reactions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_max_prot_pool&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">max_prot_pool</span>
    <span class="n">added_reactions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_R&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">R</span>
    <span class="n">added_reactions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_T&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">T</span>
    <span class="n">added_reactions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_kinetic_ignored_metabolites&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="o">.</span><span class="n">kinetic_ignored_metabolites</span>
    <span class="p">)</span>
    <span class="n">added_reactions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_reac_rev_suffix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span>
    <span class="n">added_reactions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_reac_fwd_suffix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span>
    <span class="n">added_reactions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_reac_enz_separator&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reac_enz_separator</span>
    <span class="p">)</span>
    <span class="n">added_reactions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_extra_linear_constraints&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
        <span class="p">[</span><span class="n">asdict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">extra_linear_constraints</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="n">cobra_model</span><span class="o">.</span><span class="n">add_reactions</span><span class="p">(</span><span class="n">added_reactions</span><span class="p">)</span>

    <span class="n">gene_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">genes</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">enzyme_id</span><span class="p">,</span> <span class="n">enzyme_data</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">enzymes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">enzyme_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gene_ids</span><span class="p">:</span>
            <span class="n">cobra_model</span><span class="o">.</span><span class="n">genes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cobra</span><span class="o">.</span><span class="n">Gene</span><span class="p">(</span><span class="n">enzyme_id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">enzyme_data</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="n">gene</span> <span class="o">=</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">genes</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">enzyme_id</span><span class="p">)</span>
        <span class="n">gene</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_mw&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enzyme_data</span><span class="o">.</span><span class="n">molecular_weight</span>
        <span class="k">if</span> <span class="n">enzyme_data</span><span class="o">.</span><span class="n">min_conc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gene</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_min_conc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enzyme_data</span><span class="o">.</span><span class="n">min_conc</span>
        <span class="k">if</span> <span class="n">enzyme_data</span><span class="o">.</span><span class="n">max_conc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gene</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_max_conc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enzyme_data</span><span class="o">.</span><span class="n">max_conc</span>

    <span class="k">return</span> <span class="n">cobra_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.ensure_folder_existence" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ensure_folder_existence</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Checks if the given folder exists. If not, the folder is created.</p>
<h5 id="cobrak.io.ensure_folder_existence--argument">Argument</h5>
<ul>
<li>folder: str ~ The folder whose existence shall be enforced.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ensure_folder_existence</span><span class="p">(</span><span class="n">folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the given folder exists. If not, the folder is created.</span>

<span class="sd">    Argument</span>
<span class="sd">    ----------</span>
<span class="sd">    * folder: str ~ The folder whose existence shall be enforced.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">folder</span><span class="p">):</span>
        <span class="k">return</span>
    <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="ne">FileExistsError</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.ensure_json_existence" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ensure_json_existence</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Ensures that a JSON file exists at the specified path.</p>
<p>If the file does not exist, it creates an empty JSON file with "{}" as its content.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file path where the JSON file should exist.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ensure_json_existence</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ensures that a JSON file exists at the specified path.</span>

<span class="sd">    If the file does not exist, it creates an empty JSON file with &quot;{}&quot; as its content.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): The file path where the JSON file should exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">return</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>  <span class="c1"># noqa: FURB103</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.get_base_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_base_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">fwd_suffix</span><span class="o">=</span><span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span> <span class="n">rev_suffix</span><span class="o">=</span><span class="n">REAC_REV_SUFFIX</span><span class="p">,</span> <span class="n">reac_enz_separator</span><span class="o">=</span><span class="n">REAC_ENZ_SEPARATOR</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Extract the base ID from a reaction ID by removing specified suffixes and separators.</p>
<p>Processes a reaction ID to remove forward and reverse suffixes
as well as any enzyme separators, to obtain the base reaction ID.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>reac_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reaction ID to be processed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fwd_suffix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The suffix indicating forward reactions. Defaults to REAC_FWD_SUFFIX.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="REAC_FWD_SUFFIX = '_FWD'

  
      module-attribute
   (cobrak.constants.REAC_FWD_SUFFIX)" href="#cobrak.constants.REAC_FWD_SUFFIX">REAC_FWD_SUFFIX</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rev_suffix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The suffix indicating reverse reactions. Defaults to REAC_REV_SUFFIX.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="REAC_REV_SUFFIX = '_REV'

  
      module-attribute
   (cobrak.constants.REAC_REV_SUFFIX)" href="#cobrak.constants.REAC_REV_SUFFIX">REAC_REV_SUFFIX</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reac_enz_separator</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The separator used between reaction and enzyme identifiers. Defaults to REAC_ENZ_SEPARATOR.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="REAC_ENZ_SEPARATOR = '_ENZ_'

  
      module-attribute
   (cobrak.constants.REAC_ENZ_SEPARATOR)" href="#cobrak.constants.REAC_ENZ_SEPARATOR">REAC_ENZ_SEPARATOR</a></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base reaction ID with specified suffixes and separators removed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_base_id</span><span class="p">(</span>
    <span class="n">reac_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">fwd_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span>
    <span class="n">rev_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_REV_SUFFIX</span><span class="p">,</span>
    <span class="n">reac_enz_separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_ENZ_SEPARATOR</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract the base ID from a reaction ID by removing specified suffixes and separators.</span>

<span class="sd">    Processes a reaction ID to remove forward and reverse suffixes</span>
<span class="sd">    as well as any enzyme separators, to obtain the base reaction ID.</span>

<span class="sd">    Args:</span>
<span class="sd">        reac_id (str): The reaction ID to be processed.</span>
<span class="sd">        fwd_suffix (str, optional): The suffix indicating forward reactions. Defaults to REAC_FWD_SUFFIX.</span>
<span class="sd">        rev_suffix (str, optional): The suffix indicating reverse reactions. Defaults to REAC_REV_SUFFIX.</span>
<span class="sd">        reac_enz_separator (str, optional): The separator used between reaction and enzyme identifiers. Defaults to REAC_ENZ_SEPARATOR.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The base reaction ID with specified suffixes and separators removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reac_id_split</span> <span class="o">=</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">reac_enz_separator</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">reac_id_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\b</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fwd_suffix</span><span class="si">}</span><span class="se">\b</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rev_suffix</span><span class="si">}</span><span class="se">\b</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\b</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.get_files" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the names of the files in the given folder as a list of strings.</p>
<h5 id="cobrak.io.get_files--arguments">Arguments</h5>
<ul>
<li>path: str ~ The path to the folder of which the file names shall be returned</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_files</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the names of the files in the given folder as a list of strings.</span>

<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">    * path: str ~ The path to the folder of which the file names shall be returned</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">files</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">files</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">files</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.get_folders" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_folders</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the names of the folders in the given folder as a list of strings.</p>
<h5 id="cobrak.io.get_folders--arguments">Arguments</h5>
<ul>
<li>path: str ~ The path to the folder whose folders shall be returned</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_folders</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the names of the folders in the given folder as a list of strings.</span>

<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">    * path: str ~ The path to the folder whose folders shall be returned</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">folder</span>
        <span class="k">for</span> <span class="n">folder</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">folder</span><span class="p">))</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.json_load" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">json_load</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">dataclass_type</span><span class="o">=</span><span class="n">Any</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Load JSON data from a file and validate it against a specified dataclass type.</p>
<p>This function reads the content of a JSON file located at the given <code>path</code>, parses it,
and validates the parsed data against the provided <code>dataclass_type</code>. If the data is valid
according to the dataclass schema, it returns an instance of the dataclass populated with
the data. Otherwise, it raises an exception.</p>
<h5 id="cobrak.io.json_load--parameters">Parameters:</h5>
<p>path : str
    The file path to the JSON file that needs to be loaded.</p>


<details class="dataclass_type-" open>
  <summary>Type[T]</summary>
  <p>A dataclass type against which the JSON data should be validated and deserialized.</p>
</details>        <h5 id="cobrak.io.json_load--returns">Returns:</h5>
<p>T
    An instance of the specified <code>dataclass_type</code> populated with the data from the JSON file.</p>
<h5 id="cobrak.io.json_load--raises">Raises:</h5>
<p>JSONDecodeError
    If the content of the file is not a valid JSON string.</p>
<p>ValidationError
    If the parsed JSON data does not conform to the schema defined by <code>dataclass_type</code>.</p>
<h5 id="cobrak.io.json_load--examples">Examples:</h5>
<blockquote>
<blockquote>
<blockquote>
<p>@dataclass
... class Person:
...     name: str
...     age: int</p>
<p>person = json_load('person.json', Person)
print(person.name, person.age)
John Doe 30</p>
</blockquote>
</blockquote>
</blockquote>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">json_load</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dataclass_type</span><span class="p">:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load JSON data from a file and validate it against a specified dataclass type.</span>

<span class="sd">    This function reads the content of a JSON file located at the given `path`, parses it,</span>
<span class="sd">    and validates the parsed data against the provided `dataclass_type`. If the data is valid</span>
<span class="sd">    according to the dataclass schema, it returns an instance of the dataclass populated with</span>
<span class="sd">    the data. Otherwise, it raises an exception.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    ----------</span>
<span class="sd">    path : str</span>
<span class="sd">        The file path to the JSON file that needs to be loaded.</span>

<span class="sd">    dataclass_type : Type[T]</span>
<span class="sd">        A dataclass type against which the JSON data should be validated and deserialized.</span>

<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">    T</span>
<span class="sd">        An instance of the specified `dataclass_type` populated with the data from the JSON file.</span>

<span class="sd">    Raises:</span>
<span class="sd">    ------</span>
<span class="sd">    JSONDecodeError</span>
<span class="sd">        If the content of the file is not a valid JSON string.</span>

<span class="sd">    ValidationError</span>
<span class="sd">        If the parsed JSON data does not conform to the schema defined by `dataclass_type`.</span>

<span class="sd">    Examples:</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; @dataclass</span>
<span class="sd">    ... class Person:</span>
<span class="sd">    ...     name: str</span>
<span class="sd">    ...     age: int</span>

<span class="sd">    &gt;&gt;&gt; person = json_load(&#39;person.json&#39;, Person)</span>
<span class="sd">    &gt;&gt;&gt; print(person.name, person.age)</span>
<span class="sd">    John Doe 30</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>  <span class="c1"># noqa: FURB101</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">TypeAdapter</span><span class="p">(</span><span class="n">dataclass_type</span><span class="p">)</span><span class="o">.</span><span class="n">validate_json</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.json_write" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">json_write</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">json_data</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Writes a JSON file at the given path with the given data as content.</p>
<p>Can be also used for any of COBRAk's dataclasses as well as any
dictionary of the form dict[str, dict[str, T] | None] where
T stands for a COBRAk dataclass or any other JSON-compatible
object type.</p>
<h5 id="cobrak.io.json_write--arguments">Arguments</h5>
<ul>
<li>path: str ~  The path of the JSON file that shall be written</li>
<li>json_data: Any ~ The dictionary or list which shalll be the content of
  the created JSON file</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">json_write</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">json_data</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: ANN401</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes a JSON file at the given path with the given data as content.</span>

<span class="sd">    Can be also used for any of COBRAk&#39;s dataclasses as well as any</span>
<span class="sd">    dictionary of the form dict[str, dict[str, T] | None] where</span>
<span class="sd">    T stands for a COBRAk dataclass or any other JSON-compatible</span>
<span class="sd">    object type.</span>

<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">    * path: str ~  The path of the JSON file that shall be written</span>
<span class="sd">    * json_data: Any ~ The dictionary or list which shalll be the content of</span>
<span class="sd">      the created JSON file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_dataclass</span><span class="p">(</span><span class="n">json_data</span><span class="p">):</span>
        <span class="n">json_write</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">asdict</span><span class="p">(</span><span class="n">json_data</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">json_data</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">):</span>
        <span class="n">json_output</span> <span class="o">=</span> <span class="n">json_data</span><span class="o">.</span><span class="n">model_dump_json</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json_output</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">json_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">sum</span><span class="p">(</span>
        <span class="n">is_dataclass</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">json_data</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="p">):</span>
        <span class="n">json_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">json_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">json_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="n">is_dataclass</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="n">json_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">asdict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">json_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="n">json_write</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">json_dict</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">json_output</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">json_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json_output</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.json_zip_load" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">json_zip_load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Loads the given zipped JSON file and returns it as json_data (a list
or a dictionary).</p>
<h5 id="cobrak.io.json_zip_load--arguments">Arguments</h5>
<ul>
<li>path: str ~ The path of the JSON file without ".zip" at the end</li>
</ul>
<h5 id="cobrak.io.json_zip_load--returns">Returns</h5>
<p>dict or list ~ The loaded JSON data</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">json_zip_load</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads the given zipped JSON file and returns it as json_data (a list</span>
<span class="sd">    or a dictionary).</span>

<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">    * path: str ~ The path of the JSON file without &quot;.zip&quot; at the end</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict or list ~ The loaded JSON data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a temporary directory to extract the zip file contents</span>
    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">temp_dir</span><span class="p">:</span>
        <span class="c1"># Construct the full path to the zip file</span>
        <span class="n">zip_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">.zip&quot;</span>

        <span class="c1"># Open the zip file and extract its contents to the temporary directory</span>
        <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">zip_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_file</span><span class="p">:</span>
            <span class="n">zip_file</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>

        <span class="c1"># Construct the full path to the JSON file in the temporary directory</span>
        <span class="n">json_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

        <span class="c1"># Open and load the JSON file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_path</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">json_file</span><span class="p">:</span>
            <span class="n">json_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_file</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">json_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.json_zip_write" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">json_zip_write</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">json_data</span><span class="p">,</span> <span class="n">zip_method</span><span class="o">=</span><span class="n">zipfile</span><span class="o">.</span><span class="n">ZIP_LZMA</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Writes a zipped JSON file at the given path with the given dictionary as content.</p>
<h5 id="cobrak.io.json_zip_write--arguments">Arguments</h5>
<ul>
<li>path: str ~  The path of the JSON file that shall be written without ".zip" at the end</li>
<li>json_data: Any ~ The dictionary or list which shalll be the content of
  the created JSON file</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">json_zip_write</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">json_data</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>  <span class="c1"># noqa: ANN401</span>
    <span class="n">zip_method</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZIP_LZMA</span><span class="p">,</span>  <span class="c1"># noqa: ANN401</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes a zipped JSON file at the given path with the given dictionary as content.</span>

<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">    * path: str ~  The path of the JSON file that shall be written without &quot;.zip&quot; at the end</span>
<span class="sd">    * json_data: Any ~ The dictionary or list which shalll be the content of</span>
<span class="sd">      the created JSON file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">json_output</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">json_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">ZipFile</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="n">zip_method</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_file</span><span class="p">:</span>
        <span class="n">zip_file</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="n">json_output</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.load_annotated_cobrapy_model_as_cobrak_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_annotated_cobrapy_model_as_cobrak_model</span><span class="p">(</span><span class="n">cobra_model</span><span class="p">,</span> <span class="n">exclude_enzyme_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Converts a COBRApy model with (and also without :-) annotations into a COBRAk Model.</p>
<p>This function takes a COBRApy model, which may contain specific annotations for metabolites,
reactions, and genes, and converts it into a COBRAk model. The conversion involves extracting
relevant annotations and constructing COBRAk-specific data structures for metabolites, reactions,
and enzymes.</p>
        <ul>
<li>cobra_model (cobra.Model): The COBRApy model to be converted. This model should contain
  annotations that are compatible with the COBRAk model structure.</li>
<li>exclude_enzyme_constraints (bool): Whether or not to exclude all stoichiometric enzyme constraint additions.
  Defaults to True.</li>
</ul>
        <ul>
<li>Model: A COBRAk model constructed from the annotated COBRApy model, including metabolites,
  reactions, and enzymes with their respective parameters and constraints.</li>
</ul>
<p>Notes:
- The function assumes that certain annotations (e.g., "cobrak_Cmin", "cobrak_dG0") are present
  in the COBRApy model. Missing annotations will result in default values being used.
- Reactions with IDs like "prot_pool_delivery" and those starting with "enzyme_delivery_" are ignored.
- Ensure that the COBRApy model is correctly annotated to fully leverage the conversion process.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_annotated_cobrapy_model_as_cobrak_model</span><span class="p">(</span>
    <span class="n">cobra_model</span><span class="p">:</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span>
    <span class="n">exclude_enzyme_constraints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a COBRApy model with (and also without :-) annotations into a COBRAk Model.</span>

<span class="sd">    This function takes a COBRApy model, which may contain specific annotations for metabolites,</span>
<span class="sd">    reactions, and genes, and converts it into a COBRAk model. The conversion involves extracting</span>
<span class="sd">    relevant annotations and constructing COBRAk-specific data structures for metabolites, reactions,</span>
<span class="sd">    and enzymes.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - cobra_model (cobra.Model): The COBRApy model to be converted. This model should contain</span>
<span class="sd">      annotations that are compatible with the COBRAk model structure.</span>
<span class="sd">    - exclude_enzyme_constraints (bool): Whether or not to exclude all stoichiometric enzyme constraint additions.</span>
<span class="sd">      Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - Model: A COBRAk model constructed from the annotated COBRApy model, including metabolites,</span>
<span class="sd">      reactions, and enzymes with their respective parameters and constraints.</span>

<span class="sd">    Notes:</span>
<span class="sd">    - The function assumes that certain annotations (e.g., &quot;cobrak_Cmin&quot;, &quot;cobrak_dG0&quot;) are present</span>
<span class="sd">      in the COBRApy model. Missing annotations will result in default values being used.</span>
<span class="sd">    - Reactions with IDs like &quot;prot_pool_delivery&quot; and those starting with &quot;enzyme_delivery_&quot; are ignored.</span>
<span class="sd">    - Ensure that the COBRApy model is correctly annotated to fully leverage the conversion process.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">exclude_enzyme_constraints</span><span class="p">:</span>
        <span class="n">gene_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">gene</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">genes</span><span class="p">]</span>

    <span class="k">if</span> <span class="s2">&quot;cobrak_global_settings&quot;</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">]:</span>
        <span class="n">global_settings_reac</span> <span class="o">=</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="s2">&quot;cobrak_global_settings&quot;</span><span class="p">)</span>
        <span class="n">max_prot_pool</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">global_settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_max_prot_pool&quot;</span><span class="p">])</span>
        <span class="n">kinetic_ignored_metabolites</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span>
            <span class="n">global_settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_kinetic_ignored_metabolites&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">extra_linear_constraints</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ExtraLinearConstraint</span><span class="p">(</span><span class="o">**</span><span class="n">x</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">literal_eval</span><span class="p">(</span>
                <span class="n">global_settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_extra_linear_constraints&quot;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">]</span>
        <span class="n">R</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">global_settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_R&quot;</span><span class="p">])</span>
        <span class="n">T</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">global_settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_T&quot;</span><span class="p">])</span>
        <span class="n">reac_fwd_suffix</span> <span class="o">=</span> <span class="n">global_settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_reac_fwd_suffix&quot;</span><span class="p">]</span>
        <span class="n">reac_rev_suffix</span> <span class="o">=</span> <span class="n">global_settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_reac_rev_suffix&quot;</span><span class="p">]</span>
        <span class="n">reac_enz_separator</span> <span class="o">=</span> <span class="n">global_settings_reac</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span>
            <span class="s2">&quot;cobrak_reac_enz_separator&quot;</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">max_prot_pool</span> <span class="o">=</span> <span class="mf">1_000.0</span>
        <span class="n">extra_linear_constraints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">kinetic_ignored_metabolites</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">STANDARD_R</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">STANDARD_T</span>
        <span class="n">reac_fwd_suffix</span> <span class="o">=</span> <span class="n">REAC_FWD_SUFFIX</span>
        <span class="n">reac_rev_suffix</span> <span class="o">=</span> <span class="n">REAC_REV_SUFFIX</span>
        <span class="n">reac_enz_separator</span> <span class="o">=</span> <span class="n">REAC_ENZ_SEPARATOR</span>

    <span class="n">cobrak_metabolites</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Metabolite</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">metabolite</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">exclude_enzyme_constraints</span> <span class="ow">and</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="n">met_split</span> <span class="ow">in</span> <span class="n">gene_ids</span> <span class="k">for</span> <span class="n">met_split</span> <span class="ow">in</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="s2">&quot;cobrak_Cmin&quot;</span> <span class="ow">in</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
            <span class="n">log_min_conc</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_Cmin&quot;</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log_min_conc</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;cobrak_Cmax&quot;</span> <span class="ow">in</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
            <span class="n">log_max_conc</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_Cmax&quot;</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log_max_conc</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>

        <span class="n">cobrak_metabolites</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">Metabolite</span><span class="p">(</span>
            <span class="n">log_min_conc</span><span class="o">=</span><span class="n">log_min_conc</span><span class="p">,</span>
            <span class="n">log_max_conc</span><span class="o">=</span><span class="n">log_max_conc</span><span class="p">,</span>
            <span class="n">annotation</span><span class="o">=</span><span class="p">{</span>
                <span class="n">key</span><span class="p">:</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="s2">&quot;[&quot;</span> <span class="ow">in</span> <span class="n">value</span> <span class="k">else</span> <span class="n">value</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;cobrak_&quot;</span><span class="p">)</span>
            <span class="p">},</span>
            <span class="n">formula</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">metabolite</span><span class="o">.</span><span class="n">formula</span><span class="p">),</span>
            <span class="n">charge</span><span class="o">=</span><span class="n">metabolite</span><span class="o">.</span><span class="n">charge</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">cobrak_reactions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Reaction</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">reaction</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="s2">&quot;prot_pool_delivery&quot;</span>
            <span class="ow">or</span> <span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;enzyme_delivery_&quot;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;complex_delivery_&quot;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;cobrak_global_settings&quot;</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">continue</span>

        <span class="n">version_data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;cobrak_id_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;cobrak_id_&quot;</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">version_data</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">version_data</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">version</span><span class="p">,</span> <span class="n">version_reac_id</span> <span class="ow">in</span> <span class="n">version_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;cobrak_dG0_</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                <span class="n">dG0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;cobrak_dG0_</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dG0</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;cobrak_dG0_uncertainty_</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                <span class="n">dG0_uncertainty</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                    <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;cobrak_dG0_uncertainty_</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dG0_uncertainty</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;cobrak_k_cat_</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">reac_enz_separator</span> <span class="ow">in</span> <span class="n">version_reac_id</span><span class="p">:</span>
                    <span class="n">identifiers</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="p">(</span>
                            <span class="n">version_reac_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_and&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
                                <span class="n">reac_enz_separator</span>
                            <span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\b</span><span class="s2">&quot;</span>
                        <span class="p">)</span>
                        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">reac_fwd_suffix</span><span class="si">}</span><span class="se">\b</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">reac_rev_suffix</span><span class="si">}</span><span class="se">\b</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\b</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">identifiers</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">gene_reaction_rule</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; and &quot;</span><span class="p">)</span>

                <span class="n">k_cat</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;cobrak_k_cat_</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;cobrak_k_ms_</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                    <span class="n">k_ms</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;cobrak_k_ms_</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">k_ms</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;cobrak_k_is_</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                    <span class="n">k_is</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;cobrak_k_is_</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">k_is</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;cobrak_k_as_</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                    <span class="n">k_as</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;cobrak_k_as_</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">k_as</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="sa">f</span><span class="s2">&quot;cobrak_special_stoichiometries_</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                    <span class="n">special_stoichiometries</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span>
                        <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;cobrak_special_stoichiometries_</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">special_stoichiometries</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">enzyme_reaction_data</span> <span class="o">=</span> <span class="n">EnzymeReactionData</span><span class="p">(</span>
                    <span class="n">identifiers</span><span class="o">=</span><span class="n">identifiers</span><span class="p">,</span>
                    <span class="n">k_cat</span><span class="o">=</span><span class="n">k_cat</span><span class="p">,</span>
                    <span class="n">k_ms</span><span class="o">=</span><span class="n">k_ms</span><span class="p">,</span>
                    <span class="n">k_is</span><span class="o">=</span><span class="n">k_is</span><span class="p">,</span>
                    <span class="n">k_as</span><span class="o">=</span><span class="n">k_as</span><span class="p">,</span>
                    <span class="n">special_stoichiometries</span><span class="o">=</span><span class="n">special_stoichiometries</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">enzyme_reaction_data</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">version_data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">version_reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">reac_rev_suffix</span><span class="p">):</span>
                    <span class="n">stoich_multiplier</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="n">min_flux</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="n">max_flux</span> <span class="o">=</span> <span class="o">-</span><span class="n">reaction</span><span class="o">.</span><span class="n">lower_bound</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stoich_multiplier</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span>
                    <span class="n">min_flux</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="n">max_flux</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">upper_bound</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">min_flux</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">lower_bound</span>
                <span class="n">max_flux</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">upper_bound</span>
                <span class="n">stoich_multiplier</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span>

            <span class="n">cobrak_reactions</span><span class="p">[</span><span class="n">version_reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span>
                <span class="n">min_flux</span><span class="o">=</span><span class="n">min_flux</span><span class="p">,</span>
                <span class="n">max_flux</span><span class="o">=</span><span class="n">max_flux</span><span class="p">,</span>
                <span class="n">stoichiometries</span><span class="o">=</span><span class="p">{</span>
                    <span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="n">stoich_multiplier</span> <span class="o">*</span> <span class="n">value</span>
                    <span class="k">for</span> <span class="p">(</span><span class="n">metabolite</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">exclude_enzyme_constraints</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="p">(</span>
                        <span class="ow">not</span> <span class="nb">sum</span><span class="p">(</span>
                            <span class="n">met_split</span> <span class="ow">in</span> <span class="n">gene_ids</span>
                            <span class="k">for</span> <span class="n">met_split</span> <span class="ow">in</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">},</span>
                <span class="n">dG0</span><span class="o">=</span><span class="n">dG0</span><span class="p">,</span>
                <span class="n">dG0_uncertainty</span><span class="o">=</span><span class="n">dG0_uncertainty</span><span class="p">,</span>
                <span class="n">enzyme_reaction_data</span><span class="o">=</span><span class="n">enzyme_reaction_data</span><span class="p">,</span>
                <span class="n">annotation</span><span class="o">=</span><span class="p">{</span>
                    <span class="n">key</span><span class="p">:</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="s2">&quot;[&quot;</span> <span class="ow">in</span> <span class="n">value</span> <span class="k">else</span> <span class="n">value</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;cobrak_&quot;</span><span class="p">)</span>
                <span class="p">},</span>
            <span class="p">)</span>

    <span class="n">cobrak_enzymes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enzyme</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">genes</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;cobrak_mw&quot;</span> <span class="ow">in</span> <span class="n">gene</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;cobrak_min_conc&quot;</span> <span class="ow">in</span> <span class="n">gene</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                <span class="n">min_conc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">gene</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_min_conc&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">min_conc</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="s2">&quot;cobrak_max_conc&quot;</span> <span class="ow">in</span> <span class="n">gene</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
                <span class="n">max_conc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">gene</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_max_conc&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">max_conc</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">cobrak_enzymes</span><span class="p">[</span><span class="n">gene</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">Enzyme</span><span class="p">(</span>
                <span class="n">molecular_weight</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">gene</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;cobrak_mw&quot;</span><span class="p">]),</span>
                <span class="n">min_conc</span><span class="o">=</span><span class="n">min_conc</span><span class="p">,</span>
                <span class="n">max_conc</span><span class="o">=</span><span class="n">max_conc</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">gene</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">Model</span><span class="p">(</span>
        <span class="n">reactions</span><span class="o">=</span><span class="n">cobrak_reactions</span><span class="p">,</span>
        <span class="n">metabolites</span><span class="o">=</span><span class="n">cobrak_metabolites</span><span class="p">,</span>
        <span class="n">enzymes</span><span class="o">=</span><span class="n">cobrak_enzymes</span><span class="p">,</span>
        <span class="n">max_prot_pool</span><span class="o">=</span><span class="n">max_prot_pool</span><span class="p">,</span>
        <span class="n">extra_linear_constraints</span><span class="o">=</span><span class="n">extra_linear_constraints</span><span class="p">,</span>
        <span class="n">kinetic_ignored_metabolites</span><span class="o">=</span><span class="n">kinetic_ignored_metabolites</span><span class="p">,</span>
        <span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span>
        <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span>
        <span class="n">fwd_suffix</span><span class="o">=</span><span class="n">reac_fwd_suffix</span><span class="p">,</span>
        <span class="n">rev_suffix</span><span class="o">=</span><span class="n">reac_rev_suffix</span><span class="p">,</span>
        <span class="n">reac_enz_separator</span><span class="o">=</span><span class="n">reac_enz_separator</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.load_annotated_sbml_model_as_cobrak_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_annotated_sbml_model_as_cobrak_model</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Load an annotated (and also un-annotated :-) SBML model from a file and convert it into a COBRAk Model.</p>
<p>This function reads an SBML file containing a metabolic model with specific annotations
and converts it into a COBRAk Model. It uses the COBRApy library to read the SBML
file and then uses the <code>load_annotated_cobrapy_model_as_cobrak_model</code> function to perform
the conversion.</p>
<p>Parameters:
- filepath (str): The path to the SBML file containing the annotated metabolic model.</p>
        <ul>
<li>Model: A COBRAk Model constructed from the annotated SBML model, ready for further
  kinetic and thermodynamic analyses.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_annotated_sbml_model_as_cobrak_model</span><span class="p">(</span>
    <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load an annotated (and also un-annotated :-) SBML model from a file and convert it into a COBRAk Model.</span>

<span class="sd">    This function reads an SBML file containing a metabolic model with specific annotations</span>
<span class="sd">    and converts it into a COBRAk Model. It uses the COBRApy library to read the SBML</span>
<span class="sd">    file and then uses the `load_annotated_cobrapy_model_as_cobrak_model` function to perform</span>
<span class="sd">    the conversion.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - filepath (str): The path to the SBML file containing the annotated metabolic model.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - Model: A COBRAk Model constructed from the annotated SBML model, ready for further</span>
<span class="sd">      kinetic and thermodynamic analyses.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">load_annotated_cobrapy_model_as_cobrak_model</span><span class="p">(</span>
        <span class="n">cobra</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_sbml_model</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.load_unannotated_sbml_as_cobrapy_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_unannotated_sbml_as_cobrapy_model</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Loads an unannotated SBML model from a file into a COBRApy model.</p>
<p>This function reads an SBML file that contains a metabolic model without specific annotations
and loads it into a COBRApy model object. It utilizes the COBRApy library's <code>read_sbml_model</code>
function to perform the loading.</p>
<p>Parameters:
- path (str): The file path to the SBML file containing the metabolic model.</p>
<p>Returns:
- cobra.Model: A COBRApy model object representing the metabolic network described in the SBML file.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_unannotated_sbml_as_cobrapy_model</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads an unannotated SBML model from a file into a COBRApy model.</span>

<span class="sd">    This function reads an SBML file that contains a metabolic model without specific annotations</span>
<span class="sd">    and loads it into a COBRApy model object. It utilizes the COBRApy library&#39;s `read_sbml_model`</span>
<span class="sd">    function to perform the loading.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - path (str): The file path to the SBML file containing the metabolic model.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - cobra.Model: A COBRApy model object representing the metabolic network described in the SBML file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cobra</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_sbml_model</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.pickle_load" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pickle_load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the value of the given pickle file.</p>
<h5 id="cobrak.io.pickle_load--arguments">Arguments</h5>
<ul>
<li>path: str ~ The path to the pickle file.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pickle_load</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>  <span class="c1"># noqa: ANN401</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the value of the given pickle file.</span>

<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">    * path: str ~ The path to the pickle file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pickle_file</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">pickle_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.pickle_write" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pickle_write</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pickled_object</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Writes the given object as pickled file with the given path</p>
<h5 id="cobrak.io.pickle_write--arguments">Arguments</h5>
<ul>
<li>path: str ~ The path of the pickled file that shall be created</li>
<li>pickled_object: Any ~ The object which shall be saved in the pickle file</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pickle_write</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pickled_object</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># noqa: ANN401</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Writes the given object as pickled file with the given path</span>

<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">    * path: str ~ The path of the pickled file that shall be created</span>
<span class="sd">    * pickled_object: Any ~ The object which shall be saved in the pickle file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pickle_file</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">pickled_object</span><span class="p">,</span> <span class="n">pickle_file</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.save_cobrak_model_as_annotated_sbml_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_cobrak_model_as_annotated_sbml_model</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">combine_base_reactions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_enzyme_constraints</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Exports a COBRAk model to an annotated SBML file.</p>
<p>This function converts a <code>Model</code> to a COBRApy model and writes it to an SBML file at the specified file path.
Optionally, stoichiometric GECKO [1]-like enzyme constraints can be added during the conversion.</p>
<p>[1] Snchez et al. Molecular systems biology, 13(8), 935. https://doi.org/10.15252/msb.20167411</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The <code>Model</code> to be exported.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filepath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file path where the SBML file will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>add_enzyme_constraints</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to add enzyme constraints during the conversion. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">save_cobrak_model_as_annotated_sbml_model</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">combine_base_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">add_enzyme_constraints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exports a COBRAk model to an annotated SBML file.</span>

<span class="sd">    This function converts a `Model` to a COBRApy model and writes it to an SBML file at the specified file path.</span>
<span class="sd">    Optionally, stoichiometric GECKO [1]-like enzyme constraints can be added during the conversion.</span>

<span class="sd">    [1] Snchez et al. Molecular systems biology, 13(8), 935. https://doi.org/10.15252/msb.20167411</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The `Model` to be exported.</span>
<span class="sd">        filepath (str): The file path where the SBML file will be saved.</span>
<span class="sd">        add_enzyme_constraints (bool, optional): Whether to add enzyme constraints during the conversion. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cobra</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write_sbml_model</span><span class="p">(</span>
        <span class="n">convert_cobrak_model_to_annotated_cobrapy_model</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">combine_base_reactions</span><span class="p">,</span>
            <span class="n">add_enzyme_constraints</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">filepath</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.io.standardize_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">standardize_folder</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns for the given folder path is returned in a more standardized way.</p>
<p>I.e., folder paths with potential \ are replaced with /. In addition, if
a path does not end with / will get an added /.
If the given folder path is empty (''), it returns just ''.</p>
<h5 id="cobrak.io.standardize_folder--argument">Argument</h5>
<ul>
<li>folder: str ~ The folder path that shall be standardized.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">standardize_folder</span><span class="p">(</span><span class="n">folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns for the given folder path is returned in a more standardized way.</span>

<span class="sd">    I.e., folder paths with potential \\ are replaced with /. In addition, if</span>
<span class="sd">    a path does not end with / will get an added /.</span>
<span class="sd">    If the given folder path is empty (&#39;&#39;), it returns just &#39;&#39;.</span>

<span class="sd">    Argument</span>
<span class="sd">    ----------</span>
<span class="sd">    * folder: str ~ The folder path that shall be standardized.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Catch empty folders as they don&#39;t need to be standardized</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">folder</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="c1"># Standardize for \ or / as path separator character.</span>
    <span class="n">folder</span> <span class="o">=</span> <span class="n">folder</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>

    <span class="c1"># If the last character is not a path separator, it is</span>
    <span class="c1"># added so that all standardized folder path strings</span>
    <span class="c1"># contain it.</span>
    <span class="k">if</span> <span class="n">folder</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
        <span class="n">folder</span> <span class="o">+=</span> <span class="s2">&quot;/&quot;</span>

    <span class="k">return</span> <span class="n">folder</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.lps" class="doc doc-heading">
            <code>lps</code>


</h2>

    <div class="doc doc-contents ">

        <p>COBRAk LPs and MILPs.</p>
<p>This file contains all linear program (LP) and mixed-integer linear program (MILP)
functions that can be used with COBRAk models.
With LP, one can integrate stoichiometric and enzymatic constraints.
With MILP, one can additionally integrate thermodynamic constraints.
For non-linear-programs (NLP), see nlps.py in the same folder.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.lps.add_flux_sum_var" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_flux_sum_var</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add a flux sum variable to a (N/MI)LP model.</p>
<p>This function introduces a flux sum variable to a given (N/MI)LP Pyomo model, which represents
the total sum of absolute fluxes across all reactions in the COBRAk model. The methodology is based on
the pFBA (Parsimonious Flux Balance Analysis) approach [1].</p>
<p>[1] Lewis et al. Molecular systems biology 6.1 (2010): 390. https://doi.org/10.1038/msb.2010.47</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="pyomo.environ.ConcreteModel">ConcreteModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Pyomo instance of the (N/MI)LP model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The associated metabolic model containing reaction data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ConcreteModel</code></td>            <td>
                  <code><span title="pyomo.environ.ConcreteModel">ConcreteModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The modified Pyomo model with the added flux sum variable and constraint.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/lps.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_flux_sum_var</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">ConcreteModel</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConcreteModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a flux sum variable to a (N/MI)LP model.</span>

<span class="sd">    This function introduces a flux sum variable to a given (N/MI)LP Pyomo model, which represents</span>
<span class="sd">    the total sum of absolute fluxes across all reactions in the COBRAk model. The methodology is based on</span>
<span class="sd">    the pFBA (Parsimonious Flux Balance Analysis) approach [1].</span>

<span class="sd">    [1] Lewis et al. Molecular systems biology 6.1 (2010): 390. https://doi.org/10.1038/msb.2010.47</span>

<span class="sd">    Args:</span>
<span class="sd">        model (ConcreteModel): The Pyomo instance of the (N/MI)LP model.</span>
<span class="sd">        cobrak_model (Model): The associated metabolic model containing reaction data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ConcreteModel: The modified Pyomo model with the added flux sum variable and constraint.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flux_sum_expr</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">flux_sum_expr</span> <span class="o">+=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">continue</span>

    <span class="nb">setattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">FLUX_SUM_VAR_ID</span><span class="p">,</span> <span class="n">Var</span><span class="p">(</span><span class="n">within</span><span class="o">=</span><span class="n">Reals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">)))</span>
    <span class="nb">setattr</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span>
        <span class="s2">&quot;FLUX_SUM_CONSTRAINT&quot;</span><span class="p">,</span>
        <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">FLUX_SUM_VAR_ID</span><span class="p">)</span> <span class="o">==</span> <span class="n">flux_sum_expr</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.lps.add_loop_constraints_to_lp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_loop_constraints_to_lp</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="p">,</span> <span class="n">only_nonthermodynamic</span><span class="p">,</span> <span class="n">ignored_reacs</span><span class="o">=</span><span class="p">[])</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add mixed-integer loop constraints to a (N/MI)LP model to prevent thermodynamically infeasible cycles.</p>
<p>This function incorporates loop constraints into a given (N/MI)LP Pyomo model based on the COBRAk model's
reaction data. It follows the ll-COBRA methodology described in [1] to prevent the formation
of thermodynamically infeasible cycles in metabolic networks.</p>
<p>[1] Schellenberger et al. (2011). Biophysical journal, 100(3), 544-553. https://doi.org/10.1016/j.bpj.2010.12.3707</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="pyomo.environ.ConcreteModel">ConcreteModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Pyomo instance of the (N/MI)LP model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The associated metabolic model containing reaction data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>only_nonthermodynamic</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, only add constraints to reactions without thermodynamic data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ConcreteModel</code></td>            <td>
                  <code><span title="pyomo.environ.ConcreteModel">ConcreteModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The modified Pyomo model with added loop constraints.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/lps.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_loop_constraints_to_lp</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">ConcreteModel</span><span class="p">,</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">only_nonthermodynamic</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">ignored_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConcreteModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add mixed-integer loop constraints to a (N/MI)LP model to prevent thermodynamically infeasible cycles.</span>

<span class="sd">    This function incorporates loop constraints into a given (N/MI)LP Pyomo model based on the COBRAk model&#39;s</span>
<span class="sd">    reaction data. It follows the ll-COBRA methodology described in [1] to prevent the formation</span>
<span class="sd">    of thermodynamically infeasible cycles in metabolic networks.</span>

<span class="sd">    [1] Schellenberger et al. (2011). Biophysical journal, 100(3), 544-553. https://doi.org/10.1016/j.bpj.2010.12.3707</span>

<span class="sd">    Args:</span>
<span class="sd">        model (ConcreteModel): The Pyomo instance of the (N/MI)LP model.</span>
<span class="sd">        cobrak_model (Model): The associated metabolic model containing reaction data.</span>
<span class="sd">        only_nonthermodynamic (bool): If True, only add constraints to reactions without thermodynamic data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ConcreteModel: The modified Pyomo model with added loop constraints.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_id_constraints</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">num_elements_per_constraint</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">ignored_reacs</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">only_nonthermodynamic</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="n">base_id</span> <span class="o">=</span> <span class="n">get_base_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">base_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">base_id_constraints</span><span class="p">:</span>
            <span class="n">base_id_constraints</span><span class="p">[</span><span class="n">base_id</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">num_elements_per_constraint</span><span class="p">[</span><span class="n">base_id</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">zv_var_id</span> <span class="o">=</span> <span class="s2">&quot;zV_var_&quot;</span> <span class="o">+</span> <span class="n">reac_id</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">zv_var_id</span><span class="p">,</span> <span class="n">Var</span><span class="p">(</span><span class="n">within</span><span class="o">=</span><span class="n">Binary</span><span class="p">))</span>
        <span class="nb">setattr</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span>
            <span class="n">reac_id</span> <span class="o">+</span> <span class="s2">&quot;_base&quot;</span><span class="p">,</span>
            <span class="n">Constraint</span><span class="p">(</span>
                <span class="n">rule</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">BIG_M</span> <span class="o">*</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">zv_var_id</span><span class="p">)</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="n">base_id_constraints</span><span class="p">[</span><span class="n">base_id</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">zv_var_id</span><span class="p">)</span>
        <span class="n">num_elements_per_constraint</span><span class="p">[</span><span class="n">base_id</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">base_id</span><span class="p">,</span> <span class="n">constraint_lhs</span> <span class="ow">in</span> <span class="n">base_id_constraints</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">num_elements_per_constraint</span><span class="p">[</span><span class="n">base_id</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="n">base_id</span> <span class="o">+</span> <span class="s2">&quot;_base_constraint&quot;</span><span class="p">,</span>
                <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">constraint_lhs</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.lps.get_lp_from_cobrak_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_lp_from_cobrak_model</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">with_enzyme_constraints</span><span class="p">,</span> <span class="n">with_thermodynamic_constraints</span><span class="p">,</span> <span class="n">with_loop_constraints</span><span class="p">,</span> <span class="n">with_flux_sum_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ignored_reacs</span><span class="o">=</span><span class="p">[],</span> <span class="n">min_mdf</span><span class="o">=</span><span class="n">STANDARD_MIN_MDF</span><span class="p">,</span> <span class="n">add_thermobottleneck_analysis_vars</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">strict_kappa_products_equality</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_extra_linear_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">correction_config</span><span class="o">=</span><span class="n">CorrectionConfig</span><span class="p">(),</span> <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Construct a linear programming (LP) model from a COBRAk model with various constraints and configurations.</p>
<p>This function creates a steady-state LP model from the provided COBRAk Model and enhances it with
different types of constraints and variables based on the specified parameters. It allows for the
inclusion of enzyme constraints, thermodynamic constraints, loop constraints, and additional
linear constraints. Furthermore, it supports the addition of flux sum variables and error handling
configurations.</p>
<p>See the following chapters of COBRAk's documentation for more on these constraints:</p>
<ul>
<li>Steady-state and extra linear constraints  Chapter "Linear Programs"</li>
<li>Enzyme constraints  Chapter "Linear Programs"</li>
<li>Thermodynamic constraints  Chapter "Mixed-Integer Linear Programs"</li>
</ul>
<h5 id="cobrak.lps.get_lp_from_cobrak_model--parameters">Parameters</h5>
<p>cobrak_model : Model
    The COBRAk Model from which to construct the LP model.
with_enzyme_constraints : bool
    If True, adds enzyme-pool constraints to the model.
with_thermodynamic_constraints : bool
    If True, adds thermodynamic MILP constraints to the model, ensuring that reaction fluxes are
    thermodynamically feasible by considering Gibbs free energy changes.
with_loop_constraints : bool
    If True, adds loop constraints to prevent or control flux loops in the metabolic network.
    This constraint makes the LP a MILP as a binary variable controls whether either the
    forward or the reverse reaction is running.
with_flux_sum_var : bool, optional
    If True, adds a flux sum variable to the model, which aggregates the total flux through
    all reactions for optimization or analysis purposes. Defaults to False.
ignored_reacs : list[str], optional
    List of reaction IDs to ignore in the model, which will be excluded. Defaults to [].
min_mdf : float, optional
    Minimum value for Max-Min Driving Force (MDF). Only relevant with thermodynamic
    constraints. Defaults to STANDARD_MIN_MDF.
add_thermobottleneck_analysis_vars : bool, optional
    If True, adds variables for thermodynamic bottleneck analysis, helping to identify
    potential bottlenecks in the metabolic network where thermodynamic constraints might limit
    flux. Defaults to False.
strict_kappa_products_equality : bool, optional
    If True, enforces strict equality for kappa products, ensuring consistency in
    thermodynamic parameters related to reaction products. Defaults to False.
add_extra_linear_constraints : bool, optional
    If True, adds extra linear constraints from the COBRAk Mmodel, allowing for additional
    linear constraints. Defaults to True.
correction_config : CorrectionConfig, optional
    Configuration for parameter correction handling in the model, allowing for the inclusion of error terms
    in constraints related to enzyme activity, thermodynamics, etc. Defaults to CorrectionConfig().
ignore_nonlinear_terms: bool, optional
    Whether or not non-linear extra watches and constraints shall <em>not</em> be included. Defaults to False.
    Note: If such non-linear values exist and are included, the whole problem becomes <em>non-linear</em>, making it
    incompatible with any purely linear solver!</p>
<h5 id="cobrak.lps.get_lp_from_cobrak_model--returns">Returns</h5>
<p>ConcreteModel
    The constructed LP model with the specified constraints and configurations.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/lps.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_lp_from_cobrak_model</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">with_enzyme_constraints</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">with_thermodynamic_constraints</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">with_loop_constraints</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">with_flux_sum_var</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">ignored_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">min_mdf</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">STANDARD_MIN_MDF</span><span class="p">,</span>
    <span class="n">add_thermobottleneck_analysis_vars</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">strict_kappa_products_equality</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">add_extra_linear_constraints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">correction_config</span><span class="p">:</span> <span class="n">CorrectionConfig</span> <span class="o">=</span> <span class="n">CorrectionConfig</span><span class="p">(),</span>
    <span class="n">ignore_nonlinear_terms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConcreteModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct a linear programming (LP) model from a COBRAk model with various constraints and configurations.</span>

<span class="sd">    This function creates a steady-state LP model from the provided COBRAk Model and enhances it with</span>
<span class="sd">    different types of constraints and variables based on the specified parameters. It allows for the</span>
<span class="sd">    inclusion of enzyme constraints, thermodynamic constraints, loop constraints, and additional</span>
<span class="sd">    linear constraints. Furthermore, it supports the addition of flux sum variables and error handling</span>
<span class="sd">    configurations.</span>

<span class="sd">    See the following chapters of COBRAk&#39;s documentation for more on these constraints:</span>

<span class="sd">    * Steady-state and extra linear constraints  Chapter &quot;Linear Programs&quot;</span>
<span class="sd">    * Enzyme constraints  Chapter &quot;Linear Programs&quot;</span>
<span class="sd">    * Thermodynamic constraints  Chapter &quot;Mixed-Integer Linear Programs&quot;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cobrak_model : Model</span>
<span class="sd">        The COBRAk Model from which to construct the LP model.</span>
<span class="sd">    with_enzyme_constraints : bool</span>
<span class="sd">        If True, adds enzyme-pool constraints to the model.</span>
<span class="sd">    with_thermodynamic_constraints : bool</span>
<span class="sd">        If True, adds thermodynamic MILP constraints to the model, ensuring that reaction fluxes are</span>
<span class="sd">        thermodynamically feasible by considering Gibbs free energy changes.</span>
<span class="sd">    with_loop_constraints : bool</span>
<span class="sd">        If True, adds loop constraints to prevent or control flux loops in the metabolic network.</span>
<span class="sd">        This constraint makes the LP a MILP as a binary variable controls whether either the</span>
<span class="sd">        forward or the reverse reaction is running.</span>
<span class="sd">    with_flux_sum_var : bool, optional</span>
<span class="sd">        If True, adds a flux sum variable to the model, which aggregates the total flux through</span>
<span class="sd">        all reactions for optimization or analysis purposes. Defaults to False.</span>
<span class="sd">    ignored_reacs : list[str], optional</span>
<span class="sd">        List of reaction IDs to ignore in the model, which will be excluded. Defaults to [].</span>
<span class="sd">    min_mdf : float, optional</span>
<span class="sd">        Minimum value for Max-Min Driving Force (MDF). Only relevant with thermodynamic</span>
<span class="sd">        constraints. Defaults to STANDARD_MIN_MDF.</span>
<span class="sd">    add_thermobottleneck_analysis_vars : bool, optional</span>
<span class="sd">        If True, adds variables for thermodynamic bottleneck analysis, helping to identify</span>
<span class="sd">        potential bottlenecks in the metabolic network where thermodynamic constraints might limit</span>
<span class="sd">        flux. Defaults to False.</span>
<span class="sd">    strict_kappa_products_equality : bool, optional</span>
<span class="sd">        If True, enforces strict equality for kappa products, ensuring consistency in</span>
<span class="sd">        thermodynamic parameters related to reaction products. Defaults to False.</span>
<span class="sd">    add_extra_linear_constraints : bool, optional</span>
<span class="sd">        If True, adds extra linear constraints from the COBRAk Mmodel, allowing for additional</span>
<span class="sd">        linear constraints. Defaults to True.</span>
<span class="sd">    correction_config : CorrectionConfig, optional</span>
<span class="sd">        Configuration for parameter correction handling in the model, allowing for the inclusion of error terms</span>
<span class="sd">        in constraints related to enzyme activity, thermodynamics, etc. Defaults to CorrectionConfig().</span>
<span class="sd">    ignore_nonlinear_terms: bool, optional</span>
<span class="sd">        Whether or not non-linear extra watches and constraints shall *not* be included. Defaults to False.</span>
<span class="sd">        Note: If such non-linear values exist and are included, the whole problem becomes *non-linear*, making it</span>
<span class="sd">        incompatible with any purely linear solver!</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ConcreteModel</span>
<span class="sd">        The constructed LP model with the specified constraints and configurations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize the steady-state LP model from the COBRA model, ignoring specified reactions</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">ConcreteModel</span> <span class="o">=</span> <span class="n">_get_steady_state_lp_from_cobrak_model</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="o">=</span><span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">ignored_reacs</span><span class="o">=</span><span class="n">ignored_reacs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Add enzyme constraints if enabled</span>
    <span class="k">if</span> <span class="n">with_enzyme_constraints</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">_add_enzyme_constraints_to_lp</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">cobrak_model</span><span class="o">=</span><span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">ignored_reacs</span><span class="o">=</span><span class="n">ignored_reacs</span><span class="p">,</span>
            <span class="n">add_error_term</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">add_kcat_times_e_error_term</span><span class="p">,</span>
            <span class="n">error_cutoff</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">kcat_times_e_error_cutoff</span><span class="p">,</span>
            <span class="n">max_rel_correction</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">max_rel_kcat_times_e_correction</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Add thermodynamic constraints if enabled</span>
    <span class="k">if</span> <span class="n">with_thermodynamic_constraints</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">_add_thermodynamic_constraints_to_lp</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">cobrak_model</span><span class="o">=</span><span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">add_thermobottleneck_analysis_vars</span><span class="o">=</span><span class="n">add_thermobottleneck_analysis_vars</span><span class="p">,</span>
            <span class="n">min_mdf</span><span class="o">=</span><span class="n">min_mdf</span><span class="p">,</span>
            <span class="n">strict_kappa_products_equality</span><span class="o">=</span><span class="n">strict_kappa_products_equality</span><span class="p">,</span>
            <span class="n">add_dG0_error_term</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">add_dG0_error_term</span><span class="p">,</span>
            <span class="n">dG0_error_cutoff</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">dG0_error_cutoff</span><span class="p">,</span>
            <span class="n">max_abs_dG0_correction</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">max_abs_dG0_correction</span><span class="p">,</span>
            <span class="n">add_km_error_term</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">add_km_error_term</span><span class="p">,</span>
            <span class="n">km_error_cutoff</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">km_error_cutoff</span><span class="p">,</span>
            <span class="n">max_rel_km_correction</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">max_rel_km_correction</span><span class="p">,</span>
            <span class="n">ignored_reacs</span><span class="o">=</span><span class="n">ignored_reacs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">max_conc_sum</span> <span class="o">&lt;</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">):</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">_add_conc_sum_constraints</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>

    <span class="c1"># Add loop constraints if enabled</span>
    <span class="k">if</span> <span class="n">with_loop_constraints</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">add_loop_constraints_to_lp</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span>
            <span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">only_nonthermodynamic</span><span class="o">=</span><span class="n">with_thermodynamic_constraints</span><span class="p">,</span>
            <span class="n">ignored_reacs</span><span class="o">=</span><span class="n">ignored_reacs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Add flux sum variable if enabled</span>
    <span class="k">if</span> <span class="n">with_flux_sum_var</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">add_flux_sum_var</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span>
            <span class="n">cobrak_model</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Apply error scenarios and add error sum term if error handling is configured</span>
    <span class="k">if</span> <span class="n">is_any_error_term_active</span><span class="p">(</span><span class="n">correction_config</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">correction_config</span><span class="o">.</span><span class="n">error_scenario</span> <span class="o">!=</span> <span class="p">{}:</span>
            <span class="n">_apply_error_scenario</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="n">cobrak_model</span><span class="p">,</span>
                <span class="n">correction_config</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">correction_config</span><span class="o">.</span><span class="n">add_error_sum_term</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">_add_error_sum_to_model</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="n">cobrak_model</span><span class="p">,</span>
                <span class="n">correction_config</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="c1"># Add extra linear constraints if enabled</span>
    <span class="k">if</span> <span class="n">add_extra_linear_constraints</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">_add_extra_watches_and_constraints_to_lp</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">cobrak_model</span><span class="o">=</span><span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="n">ignore_nonlinear_terms</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.lps.perform_lp_min_active_reactions_analysis" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">perform_lp_min_active_reactions_analysis</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">with_enzyme_constraints</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">,</span> <span class="n">min_mdf</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">SCIP</span><span class="p">,</span> <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Run a mixed-integer linear program to determine the minimum number of active reactions.</p>
<p>This function constructs and solves a mixed-integer linear programming model to find the minimum number of
reactions that need to be active to satisfy the given variability constraints. It uses a binary
variable for each reaction to indicate whether it is active, and the objective is to minimize
the sum of these binary variables. The model includes constraints based on enzyme data,
thermodynamic feasibility, and loop prevention, depending on the specified parameters.</p>
<h5 id="cobrak.lps.perform_lp_min_active_reactions_analysis--parameters">Parameters</h5>
<p>cobrak_model : Model
    The COBRA model containing the metabolic network and reaction data.
with_enzyme_constraints : bool
    If True, includes enzyme-pool constraints in the model.
variability_dict : dict[str, tuple[float, float]]
    A dictionary where keys are reaction IDs and values are tuples specifying (lower bound,
    upper bound) for reaction fluxes.
min_mdf : float, optional
    Minimum value for Min-Max Driving Force (MDF), setting a lower bound on fluxes.
    Defaults to 0.0.
verbose : bool, optional
    If True, enables solver output. Defaults to False.
solver: Solver
    The MILP solver used for this analysis. Defaults to SCIP.
ignore_nonlinear_terms: bool, optional
    Whether or not non-linear extra watches and constraints shall <em>not</em> be included. Defaults to False.
    Note: If such non-linear values exist and are included, the whole problem becomes <em>non-linear</em>, making it
    incompatible with any purely linear solver!</p>
<h5 id="cobrak.lps.perform_lp_min_active_reactions_analysis--returns">Returns</h5>
<p>float
    The minimum number of active reactions required to satisfy the constraints.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/lps.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">perform_lp_min_active_reactions_analysis</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">with_enzyme_constraints</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">min_mdf</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">SCIP</span><span class="p">,</span>
    <span class="n">ignore_nonlinear_terms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a mixed-integer linear program to determine the minimum number of active reactions.</span>

<span class="sd">    This function constructs and solves a mixed-integer linear programming model to find the minimum number of</span>
<span class="sd">    reactions that need to be active to satisfy the given variability constraints. It uses a binary</span>
<span class="sd">    variable for each reaction to indicate whether it is active, and the objective is to minimize</span>
<span class="sd">    the sum of these binary variables. The model includes constraints based on enzyme data,</span>
<span class="sd">    thermodynamic feasibility, and loop prevention, depending on the specified parameters.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cobrak_model : Model</span>
<span class="sd">        The COBRA model containing the metabolic network and reaction data.</span>
<span class="sd">    with_enzyme_constraints : bool</span>
<span class="sd">        If True, includes enzyme-pool constraints in the model.</span>
<span class="sd">    variability_dict : dict[str, tuple[float, float]]</span>
<span class="sd">        A dictionary where keys are reaction IDs and values are tuples specifying (lower bound,</span>
<span class="sd">        upper bound) for reaction fluxes.</span>
<span class="sd">    min_mdf : float, optional</span>
<span class="sd">        Minimum value for Min-Max Driving Force (MDF), setting a lower bound on fluxes.</span>
<span class="sd">        Defaults to 0.0.</span>
<span class="sd">    verbose : bool, optional</span>
<span class="sd">        If True, enables solver output. Defaults to False.</span>
<span class="sd">    solver: Solver</span>
<span class="sd">        The MILP solver used for this analysis. Defaults to SCIP.</span>
<span class="sd">    ignore_nonlinear_terms: bool, optional</span>
<span class="sd">        Whether or not non-linear extra watches and constraints shall *not* be included. Defaults to False.</span>
<span class="sd">        Note: If such non-linear values exist and are included, the whole problem becomes *non-linear*, making it</span>
<span class="sd">        incompatible with any purely linear solver!</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        The minimum number of active reactions required to satisfy the constraints.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a deep copy of the COBRAk model to avoid modifying the original model</span>
    <span class="n">cobrak_model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>

    <span class="c1"># Remove reactions that are not present in the variability dictionary</span>
    <span class="n">minz_cobrak_model</span> <span class="o">=</span> <span class="n">delete_unused_reactions_in_variability_dict</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="p">,</span> <span class="n">variability_dict</span>
    <span class="p">)</span>

    <span class="c1"># Construct the LP model with the specified constraints</span>
    <span class="n">minz_model</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_lp_from_cobrak_model</span><span class="p">(</span>
        <span class="n">minz_cobrak_model</span><span class="p">,</span>
        <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="n">with_enzyme_constraints</span><span class="p">,</span>
        <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">with_loop_constraints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">min_mdf</span><span class="o">=</span><span class="n">min_mdf</span><span class="p">,</span>
        <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="n">ignore_nonlinear_terms</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Initialize the sum of binary variables to zero</span>
    <span class="n">extrazsum_expression</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="c1"># Iterate over all potentially active reactions</span>
    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">get_potentially_active_reactions_in_variability_dict</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="p">,</span> <span class="n">variability_dict</span>
    <span class="p">):</span>
        <span class="c1"># Create a binary variable for each reaction to indicate activity</span>
        <span class="n">extraz_varname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;extraz_var_</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">minz_model</span><span class="p">,</span> <span class="n">extraz_varname</span><span class="p">,</span> <span class="n">Var</span><span class="p">(</span><span class="n">within</span><span class="o">=</span><span class="n">Binary</span><span class="p">))</span>

        <span class="c1"># Add a constraint to relate reaction flux to the binary variable</span>
        <span class="nb">setattr</span><span class="p">(</span>
            <span class="n">minz_model</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;extraz_const_</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">Constraint</span><span class="p">(</span>
                <span class="n">rule</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">minz_model</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">)</span>
                <span class="o">&lt;=</span> <span class="n">BIG_M</span> <span class="o">*</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">minz_model</span><span class="p">,</span> <span class="n">extraz_varname</span><span class="p">)</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Accumulate the binary variables in the sum expression</span>
        <span class="n">extrazsum_expression</span> <span class="o">+=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">minz_model</span><span class="p">,</span> <span class="n">extraz_varname</span><span class="p">)</span>

    <span class="c1"># Add a variable to represent the total sum of active reactions</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">minz_model</span><span class="p">,</span> <span class="s2">&quot;extrazsum&quot;</span><span class="p">,</span> <span class="n">Var</span><span class="p">(</span><span class="n">within</span><span class="o">=</span><span class="n">Reals</span><span class="p">))</span>

    <span class="c1"># Add a constraint to equate the sum variable to the sum expression</span>
    <span class="nb">setattr</span><span class="p">(</span>
        <span class="n">minz_model</span><span class="p">,</span>
        <span class="s2">&quot;extrazsum_const&quot;</span><span class="p">,</span>
        <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">minz_model</span><span class="p">,</span> <span class="s2">&quot;extrazsum&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">extrazsum_expression</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># Set the objective function to minimize the number of active reactions</span>
    <span class="n">minz_model</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">get_objective</span><span class="p">(</span><span class="n">minz_model</span><span class="p">,</span> <span class="s2">&quot;extrazsum&quot;</span><span class="p">,</span> <span class="n">minimize</span><span class="p">)</span>

    <span class="c1"># Initialize the solver with the specified options and attributes</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="n">get_solver</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">solver_options</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">solver_attrs</span><span class="p">)</span>

    <span class="c1"># Solve the LP model</span>
    <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">minz_model</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="o">**</span><span class="n">solver</span><span class="o">.</span><span class="n">solve_extra_options</span><span class="p">)</span>

    <span class="c1"># Retrieve the solution as a dictionary</span>
    <span class="n">minz_dict</span> <span class="o">=</span> <span class="n">get_pyomo_solution_as_dict</span><span class="p">(</span><span class="n">minz_model</span><span class="p">)</span>

    <span class="c1"># Return the minimum number of active reactions</span>
    <span class="k">return</span> <span class="n">minz_dict</span><span class="p">[</span><span class="s2">&quot;extrazsum&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.lps.perform_lp_optimization" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">perform_lp_optimization</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">objective_target</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_loop_constraints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">variability_dict</span><span class="o">=</span><span class="p">{},</span> <span class="n">ignored_reacs</span><span class="o">=</span><span class="p">[],</span> <span class="n">min_mdf</span><span class="o">=</span><span class="n">STANDARD_MIN_MDF</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_flux_sum_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">SCIP</span><span class="p">,</span> <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">correction_config</span><span class="o">=</span><span class="n">CorrectionConfig</span><span class="p">(),</span> <span class="n">var_data_abs_epsilon</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Perform linear programming optimization on a COBRAk model to determine flux distributions.</p>
<p>This function constructs and solves an LP problem for the given metabolic model using specified constraints,
variables, and solver options. It supports various types of constraints such as enzyme constraints, thermodynamic
constraints, and loop constraints. Additionally, it can handle variability dictionaries and ignored reactions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A COBRAk Model object representing the metabolic network.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_target</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target for optimization. Can be a reaction ID if optimizing a single
reaction or a dictionary specifying flux values for multiple reactions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sense of the optimization problem (+1: maximize, -1: minimize).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_enzyme_constraints</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include enzyme constraints in the model. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_thermodynamic_constraints</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include thermodynamic constraints in the model.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_loop_constraints</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include loop closure constraints in the model. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variability_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary specifying variable bounds for reactions
or metabolites. Defaults to an empty dict.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ignored_reacs</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of reaction IDs to deactivate during optimization. Defaults to an empty list.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_mdf</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum metabolic distance factor threshold for thermodynamic constraints. Defaults to STANDARD_MIN_MDF.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="STANDARD_MIN_MDF = 0.001

  
      module-attribute
   (cobrak.constants.STANDARD_MIN_MDF)" href="#cobrak.constants.STANDARD_MIN_MDF">STANDARD_MIN_MDF</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print solver output information. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_flux_sum_var</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include flux sum variable in the model. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solver</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Solver (cobrak.dataclasses.Solver)" href="#cobrak.dataclasses.Solver">Solver</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Solver used for LP. Default is SCIP.</p>
              </div>
            </td>
            <td>
                  <code><span title="cobrak.standard_solvers.SCIP">SCIP</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ignore_nonlinear_terms</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(bool): Whether or not non-linear watches/constraints shall be ignored in ecTFBAs. Defaults to True.
Note: If such non-linear values exist and are included, the whole problem becomes <em>non-linear</em>, making it incompatible with any
purely linear solver!</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>correction_config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CorrectionConfig (cobrak.dataclasses.CorrectionConfig)" href="#cobrak.dataclasses.CorrectionConfig">CorrectionConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for handling prameter corrections and scenarios during optimization.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CorrectionConfig (cobrak.dataclasses.CorrectionConfig)" href="#cobrak.dataclasses.CorrectionConfig">CorrectionConfig</a>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>var_data_abs_epsilon</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(float, optional): Under this value, any data given by the variability dict is considered to be 0. Defaults to 1e-5.</p>
              </div>
            </td>
            <td>
                  <code>1e-05</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, float]: A dictionary containing the flux distribution results for each reaction in the model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/lps.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">perform_lp_optimization</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">objective_target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">with_enzyme_constraints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">with_thermodynamic_constraints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">with_loop_constraints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">ignored_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">min_mdf</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">STANDARD_MIN_MDF</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">with_flux_sum_var</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">SCIP</span><span class="p">,</span>
    <span class="n">ignore_nonlinear_terms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">correction_config</span><span class="p">:</span> <span class="n">CorrectionConfig</span> <span class="o">=</span> <span class="n">CorrectionConfig</span><span class="p">(),</span>
    <span class="n">var_data_abs_epsilon</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform linear programming optimization on a COBRAk model to determine flux distributions.</span>

<span class="sd">    This function constructs and solves an LP problem for the given metabolic model using specified constraints,</span>
<span class="sd">    variables, and solver options. It supports various types of constraints such as enzyme constraints, thermodynamic</span>
<span class="sd">    constraints, and loop constraints. Additionally, it can handle variability dictionaries and ignored reactions.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        cobrak_model (Model): A COBRAk Model object representing the metabolic network.</span>
<span class="sd">        objective_target (str | dict[str, float]): The target for optimization. Can be a reaction ID if optimizing a single</span>
<span class="sd">            reaction or a dictionary specifying flux values for multiple reactions.</span>
<span class="sd">        objective_sense (int): The sense of the optimization problem (+1: maximize, -1: minimize).</span>
<span class="sd">        with_enzyme_constraints (bool, optional): Whether to include enzyme constraints in the model. Defaults to False.</span>
<span class="sd">        with_thermodynamic_constraints (bool, optional): Whether to include thermodynamic constraints in the model.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        with_loop_constraints (bool, optional): Whether to include loop closure constraints in the model. Defaults to False.</span>
<span class="sd">        variability_dict (dict[str, tuple[float, float]], optional): A dictionary specifying variable bounds for reactions</span>
<span class="sd">            or metabolites. Defaults to an empty dict.</span>
<span class="sd">        ignored_reacs (list[str], optional): List of reaction IDs to deactivate during optimization. Defaults to an empty list.</span>
<span class="sd">        min_mdf (float, optional): Minimum metabolic distance factor threshold for thermodynamic constraints. Defaults to STANDARD_MIN_MDF.</span>
<span class="sd">        verbose (bool, optional): Whether to print solver output information. Defaults to False.</span>
<span class="sd">        with_flux_sum_var (bool, optional): Whether to include flux sum variable in the model. Defaults to False.</span>
<span class="sd">        solver (Solver, optional): Solver used for LP. Default is SCIP.</span>
<span class="sd">        ignore_nonlinear_terms: (bool): Whether or not non-linear watches/constraints shall be ignored in ecTFBAs. Defaults to True.</span>
<span class="sd">            Note: If such non-linear values exist and are included, the whole problem becomes *non-linear*, making it incompatible with any</span>
<span class="sd">            purely linear solver!</span>
<span class="sd">        correction_config (CorrectionConfig, optional): Configuration for handling prameter corrections and scenarios during optimization.</span>
<span class="sd">        var_data_abs_epsilon: (float, optional): Under this value, any data given by the variability dict is considered to be 0. Defaults to 1e-5.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, float]: A dictionary containing the flux distribution results for each reaction in the model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">optimization_cobrak_model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">variability_dict</span> <span class="o">!=</span> <span class="p">{}:</span>
        <span class="n">optimization_cobrak_model</span> <span class="o">=</span> <span class="n">delete_unused_reactions_in_variability_dict</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">variability_dict</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">optimization_model</span> <span class="o">=</span> <span class="n">get_lp_from_cobrak_model</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="o">=</span><span class="n">optimization_cobrak_model</span><span class="p">,</span>
        <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="n">with_enzyme_constraints</span><span class="p">,</span>
        <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="n">with_thermodynamic_constraints</span><span class="p">,</span>
        <span class="n">with_loop_constraints</span><span class="o">=</span><span class="n">with_loop_constraints</span><span class="p">,</span>
        <span class="n">with_flux_sum_var</span><span class="o">=</span><span class="n">with_flux_sum_var</span><span class="p">,</span>
        <span class="n">min_mdf</span><span class="o">=</span><span class="n">min_mdf</span><span class="p">,</span>
        <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="n">ignore_nonlinear_terms</span><span class="p">,</span>
        <span class="n">correction_config</span><span class="o">=</span><span class="n">correction_config</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">deactivated_reaction</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">ignored_reacs</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="n">optimization_model</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;DEACTIVATE_</span><span class="si">{</span><span class="n">deactivated_reaction</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">Constraint</span><span class="p">(</span>
                    <span class="n">expr</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">optimization_model</span><span class="p">,</span> <span class="n">deactivated_reaction</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span>
                <span class="p">),</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">continue</span>

    <span class="n">optimization_model</span> <span class="o">=</span> <span class="n">apply_variability_dict</span><span class="p">(</span>
        <span class="n">optimization_model</span><span class="p">,</span>
        <span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">variability_dict</span><span class="p">,</span>
        <span class="n">correction_config</span><span class="o">.</span><span class="n">error_scenario</span><span class="p">,</span>
        <span class="n">abs_epsilon</span><span class="o">=</span><span class="n">var_data_abs_epsilon</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">optimization_model</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">get_objective</span><span class="p">(</span>
        <span class="n">optimization_model</span><span class="p">,</span> <span class="n">objective_target</span><span class="p">,</span> <span class="n">objective_sense</span>
    <span class="p">)</span>

    <span class="n">pyomo_solver</span> <span class="o">=</span> <span class="n">get_solver</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">solver_options</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">solver_attrs</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">pyomo_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span>
        <span class="n">optimization_model</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="o">**</span><span class="n">solver</span><span class="o">.</span><span class="n">solve_extra_options</span>
    <span class="p">)</span>

    <span class="n">fba_dict</span> <span class="o">=</span> <span class="n">get_pyomo_solution_as_dict</span><span class="p">(</span><span class="n">optimization_model</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">add_statuses_to_optimziation_dict</span><span class="p">(</span><span class="n">fba_dict</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.lps.perform_lp_thermodynamic_bottleneck_analysis" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">perform_lp_thermodynamic_bottleneck_analysis</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">min_mdf</span><span class="o">=</span><span class="n">STANDARD_MIN_MDF</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">SCIP</span><span class="p">,</span> <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Perform thermodynamic bottleneck analysis on a COBRAk model using mixed-integer linear programming.</p>
<p>This function identifies a minimal set of thermodynamic bottlenecks in a COBRAk model by minimizing the sum of
newly introduced binary variables that indicate bottleneck reactions, i.e. reactions that do not allow the
max-min driving force (MDF) to become at least the set min_mdf.
This methology was first described in [1]. Keep in mind that results from this function are optimal, but not
neccessarily unique!</p>
<p>[1] Bekiaris et al. (2023). Nature Communications, 14(1), 4660.  https://doi.org/10.1038/s41467-023-40297-8</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model to analyze for thermodynamic bottlenecks.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_enzyme_constraints</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include enzyme constraints in the analysis.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_mdf</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum max-min driving force (MDF) to be enforced. Defaults to STANDARD_MIN_MDF.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="STANDARD_MIN_MDF = 0.001

  
      module-attribute
   (cobrak.constants.STANDARD_MIN_MDF)" href="#cobrak.constants.STANDARD_MIN_MDF">STANDARD_MIN_MDF</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, print detailed information about identified bottlenecks. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solver_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the solver to use for optimization. Defaults to "scip".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solver_options</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span> | <span title="int">int</span> | <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Options for the solver, such as number of threads
                                                     and LP method. Defaults to an empty dictionary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ignore_nonlinear_terms</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bool, optional
Whether or not non-linear extra watches and constraints shall <em>not</em> be included. Defaults to False.
Note: If such non-linear values exist and are included, the whole problem becomes <em>non-linear</em>, making it
incompatible with any purely linear solver!</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]: A list of reaction IDs identified as thermodynamic bottlenecks.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/lps.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">perform_lp_thermodynamic_bottleneck_analysis</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">with_enzyme_constraints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">min_mdf</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">STANDARD_MIN_MDF</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">SCIP</span><span class="p">,</span>
    <span class="n">ignore_nonlinear_terms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform thermodynamic bottleneck analysis on a COBRAk model using mixed-integer linear programming.</span>

<span class="sd">    This function identifies a minimal set of thermodynamic bottlenecks in a COBRAk model by minimizing the sum of</span>
<span class="sd">    newly introduced binary variables that indicate bottleneck reactions, i.e. reactions that do not allow the</span>
<span class="sd">    max-min driving force (MDF) to become at least the set min_mdf.</span>
<span class="sd">    This methology was first described in [1]. Keep in mind that results from this function are optimal, but not</span>
<span class="sd">    neccessarily unique!</span>

<span class="sd">    [1] Bekiaris et al. (2023). Nature Communications, 14(1), 4660.  https://doi.org/10.1038/s41467-023-40297-8</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model to analyze for thermodynamic bottlenecks.</span>
<span class="sd">        with_enzyme_constraints (bool): Whether to include enzyme constraints in the analysis.</span>
<span class="sd">        min_mdf (float, optional): Minimum max-min driving force (MDF) to be enforced. Defaults to STANDARD_MIN_MDF.</span>
<span class="sd">        verbose (bool, optional): If True, print detailed information about identified bottlenecks. Defaults to False.</span>
<span class="sd">        solver_name (str, optional): Name of the solver to use for optimization. Defaults to &quot;scip&quot;.</span>
<span class="sd">        solver_options (dict[str, float | int | str], optional): Options for the solver, such as number of threads</span>
<span class="sd">                                                                 and LP method. Defaults to an empty dictionary.</span>
<span class="sd">        ignore_nonlinear_terms: bool, optional</span>
<span class="sd">            Whether or not non-linear extra watches and constraints shall *not* be included. Defaults to False.</span>
<span class="sd">            Note: If such non-linear values exist and are included, the whole problem becomes *non-linear*, making it</span>
<span class="sd">            incompatible with any purely linear solver!</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: A list of reaction IDs identified as thermodynamic bottlenecks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cobrak_model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
    <span class="n">thermo_constraint_lp</span> <span class="o">=</span> <span class="n">get_lp_from_cobrak_model</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="n">with_enzyme_constraints</span><span class="p">,</span>
        <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">with_loop_constraints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">add_thermobottleneck_analysis_vars</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">min_mdf</span><span class="o">=</span><span class="n">min_mdf</span><span class="p">,</span>
        <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="n">ignore_nonlinear_terms</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">thermo_constraint_lp</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">get_objective</span><span class="p">(</span>
        <span class="n">thermo_constraint_lp</span><span class="p">,</span>
        <span class="s2">&quot;zb_sum&quot;</span><span class="p">,</span>
        <span class="n">objective_sense</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">pyomo_solver</span> <span class="o">=</span> <span class="n">get_solver</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">solver_options</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">solver_attrs</span><span class="p">)</span>
    <span class="n">pyomo_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">thermo_constraint_lp</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="o">**</span><span class="n">solver</span><span class="o">.</span><span class="n">solve_extra_options</span><span class="p">)</span>
    <span class="n">solution_dict</span> <span class="o">=</span> <span class="n">get_pyomo_solution_as_dict</span><span class="p">(</span><span class="n">thermo_constraint_lp</span><span class="p">)</span>

    <span class="n">bottleneck_counter</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">bottleneck_reactions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">var_id</span><span class="p">,</span> <span class="n">var_value</span> <span class="ow">in</span> <span class="n">solution_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">var_id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;zb_var_&quot;</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">var_value</span> <span class="o">&lt;=</span> <span class="mf">0.01</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">bottleneck_reac_id</span> <span class="o">=</span> <span class="n">var_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;zb_var_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">bottleneck_reactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bottleneck_reac_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">bottleneck_dG0</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">bottleneck_reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">dG0</span>
            <span class="k">if</span> <span class="n">bottleneck_dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">printed_dG0</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">bottleneck_dG0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">printed_string</span> <span class="o">=</span> <span class="n">get_reaction_string</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">bottleneck_reac_id</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;#</span><span class="si">{</span><span class="n">bottleneck_counter</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">bottleneck_reac_id</span><span class="si">}</span><span class="s2"> with G&#39; of </span><span class="si">{</span><span class="n">printed_dG0</span><span class="si">}</span><span class="s2"> kJ/mol, </span><span class="si">{</span><span class="n">printed_string</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">bottleneck_counter</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">bottleneck_reactions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.lps.perform_lp_variability_analysis" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">perform_lp_variability_analysis</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">active_reactions</span><span class="o">=</span><span class="p">[],</span> <span class="n">min_active_flux</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">calculate_reacs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">calculate_concs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">calculate_rest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">further_tested_vars</span><span class="o">=</span><span class="p">[],</span> <span class="n">min_mdf</span><span class="o">=</span><span class="n">STANDARD_MIN_MDF</span><span class="p">,</span> <span class="n">min_flux_cutoff</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">abs_df_cutoff</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">min_enzyme_cutoff</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">max_active_enzyme_cutoff</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">SCIP</span><span class="p">,</span> <span class="n">parallel_verbosity_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Perform linear programming variability analysis on a COBRAk model.</p>
<p>This function conducts a variability analysis on a COBRAk model using linear programming (LP).
It evaluates the range of possible flux values for each reaction and all other occuring variables in the model,
considering optional enzyme and thermodynamic constraints. The methodology is based on the approach
described by [1] and parallelized as outlined in [2].</p>
<p>[1] Mahadevan &amp; Schilling. (2003). Metabolic engineering, 5(4), 264-276. https://doi.org/10.1016/j.ymben.2003.09.002
[2] Gudmundsson &amp; Thiele. BMC Bioinformatics 11, 489 (2010). https://doi.org/10.1186/1471-2105-11-489</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model to analyze.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_enzyme_constraints</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include enzyme constraints in the analysis.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_thermodynamic_constraints</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to include thermodynamic constraints in the analysis.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>active_reactions</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of reactions to be set as active with a minimum flux.
                                    Defaults to an empty list.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_active_flux</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum flux value for active reactions. Defaults to 1e-5.</p>
              </div>
            </td>
            <td>
                  <code>0.001</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>calculate_reacs</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, analyze reaction fluxes. Default: True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>calculate_concs</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, analyze concentrations. Default: True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>calculate_rest</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, analyze all other parameters (e.g. kappa values and driving forces). Default: True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_mdf</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum metabolic driving force (MDF) to be enforced. Defaults to 0.0.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="STANDARD_MIN_MDF = 0.001

  
      module-attribute
   (cobrak.constants.STANDARD_MIN_MDF)" href="#cobrak.constants.STANDARD_MIN_MDF">STANDARD_MIN_MDF</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_flux_cutoff</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum flux cutoff for considering a reaction active. Defaults to 1e-8.</p>
              </div>
            </td>
            <td>
                  <code>1e-05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solver</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Solver (cobrak.dataclasses.Solver)" href="#cobrak.dataclasses.Solver">Solver</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MILP solver used for variability analysis. Default is SCIP, recommended is CPLEX_FOR_VARIABILITY_ANALYSIS
                       or GUROBI_FOR_VARIABILITY_ANALYSIS if you have a CPLEX or Gurobi license.</p>
              </div>
            </td>
            <td>
                  <code><span title="cobrak.standard_solvers.SCIP">SCIP</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parallel_verbosity_level</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets the verbosity level for the analysis parallelization. The higher,
                                      the value, the more is printed. Default: 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ignore_nonlinear_terms</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(bool): Whether or not non-linear watches/constraints shall be ignored in ecTFBAs. Defaults to True.
Note: If such non-linear values exist and are included, the whole problem becomes <em>non-linear</em>, making it incompatible with any
purely linear solver!</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, tuple[float, float]]: A dictionary mapping variable IDs to their minimum and maximum values
                            determined by the variability analysis.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/lps.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">perform_lp_variability_analysis</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">with_enzyme_constraints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">with_thermodynamic_constraints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">active_reactions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">min_active_flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span>
    <span class="n">calculate_reacs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">calculate_concs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">calculate_rest</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">further_tested_vars</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">min_mdf</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">STANDARD_MIN_MDF</span><span class="p">,</span>
    <span class="n">min_flux_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
    <span class="n">abs_df_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
    <span class="n">min_enzyme_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
    <span class="n">max_active_enzyme_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">SCIP</span><span class="p">,</span>
    <span class="n">parallel_verbosity_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">ignore_nonlinear_terms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform linear programming variability analysis on a COBRAk model.</span>

<span class="sd">    This function conducts a variability analysis on a COBRAk model using linear programming (LP).</span>
<span class="sd">    It evaluates the range of possible flux values for each reaction and all other occuring variables in the model,</span>
<span class="sd">    considering optional enzyme and thermodynamic constraints. The methodology is based on the approach</span>
<span class="sd">    described by [1] and parallelized as outlined in [2].</span>

<span class="sd">    [1] Mahadevan &amp; Schilling. (2003). Metabolic engineering, 5(4), 264-276. https://doi.org/10.1016/j.ymben.2003.09.002</span>
<span class="sd">    [2] Gudmundsson &amp; Thiele. BMC Bioinformatics 11, 489 (2010). https://doi.org/10.1186/1471-2105-11-489</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model to analyze.</span>
<span class="sd">        with_enzyme_constraints (bool): Whether to include enzyme constraints in the analysis.</span>
<span class="sd">        with_thermodynamic_constraints (bool): Whether to include thermodynamic constraints in the analysis.</span>
<span class="sd">        active_reactions (list[str], optional): List of reactions to be set as active with a minimum flux.</span>
<span class="sd">                                                Defaults to an empty list.</span>
<span class="sd">        min_active_flux (float, optional): Minimum flux value for active reactions. Defaults to 1e-5.</span>
<span class="sd">        calculate_reacs (bool, optional): If True, analyze reaction fluxes. Default: True.</span>
<span class="sd">        calculate_concs (bool, optional): If True, analyze concentrations. Default: True.</span>
<span class="sd">        calculate_rest (bool, optional): If True, analyze all other parameters (e.g. kappa values and driving forces). Default: True.</span>
<span class="sd">        min_mdf (float, optional): Minimum metabolic driving force (MDF) to be enforced. Defaults to 0.0.</span>
<span class="sd">        min_flux_cutoff (float, optional): Minimum flux cutoff for considering a reaction active. Defaults to 1e-8.</span>
<span class="sd">        solver (Solver, optional): MILP solver used for variability analysis. Default is SCIP, recommended is CPLEX_FOR_VARIABILITY_ANALYSIS</span>
<span class="sd">                                   or GUROBI_FOR_VARIABILITY_ANALYSIS if you have a CPLEX or Gurobi license.</span>
<span class="sd">        parallel_verbosity_level (int, optional): Sets the verbosity level for the analysis parallelization. The higher,</span>
<span class="sd">                                                  the value, the more is printed. Default: 0.</span>
<span class="sd">        ignore_nonlinear_terms: (bool): Whether or not non-linear watches/constraints shall be ignored in ecTFBAs. Defaults to True.</span>
<span class="sd">            Note: If such non-linear values exist and are included, the whole problem becomes *non-linear*, making it incompatible with any</span>
<span class="sd">            purely linear solver!</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, tuple[float, float]]: A dictionary mapping variable IDs to their minimum and maximum values</span>
<span class="sd">                                        determined by the variability analysis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cobrak_model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">active_reaction</span> <span class="ow">in</span> <span class="n">active_reactions</span><span class="p">:</span>
        <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">active_reaction</span><span class="p">]</span><span class="o">.</span><span class="n">min_flux</span> <span class="o">=</span> <span class="n">min_active_flux</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">get_lp_from_cobrak_model</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="o">=</span><span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="n">with_enzyme_constraints</span><span class="p">,</span>
        <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="n">with_thermodynamic_constraints</span><span class="p">,</span>
        <span class="n">with_loop_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">min_mdf</span><span class="o">=</span><span class="n">min_mdf</span><span class="p">,</span>
        <span class="n">strict_kappa_products_equality</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">model_var_names</span> <span class="o">=</span> <span class="n">get_model_var_names</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="n">min_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">max_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">objective_targets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">max_flux_sum_result</span> <span class="o">=</span> <span class="n">perform_lp_optimization</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">objective_target</span><span class="o">=</span><span class="n">FLUX_SUM_VAR_ID</span><span class="p">,</span>
        <span class="n">objective_sense</span><span class="o">=+</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="n">with_enzyme_constraints</span><span class="p">,</span>
        <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">with_loop_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">with_flux_sum_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span>
        <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">min_flux_sum_result</span> <span class="o">=</span> <span class="n">perform_lp_optimization</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">objective_target</span><span class="o">=</span><span class="n">FLUX_SUM_VAR_ID</span><span class="p">,</span>
        <span class="n">objective_sense</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="n">with_enzyme_constraints</span><span class="p">,</span>
        <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">with_loop_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">with_flux_sum_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span>
        <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="n">ignore_nonlinear_terms</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">calculate_concs</span> <span class="ow">or</span> <span class="n">calculate_rest</span><span class="p">)</span> <span class="ow">and</span> <span class="n">with_thermodynamic_constraints</span><span class="p">:</span>
        <span class="n">min_mdf_result</span> <span class="o">=</span> <span class="n">perform_lp_optimization</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">objective_target</span><span class="o">=</span><span class="n">MDF_VAR_ID</span><span class="p">,</span>
            <span class="n">objective_sense</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="n">with_enzyme_constraints</span><span class="p">,</span>
            <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">with_loop_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span>
            <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="n">ignore_nonlinear_terms</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">max_mdf_result</span> <span class="o">=</span> <span class="n">perform_lp_optimization</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">objective_target</span><span class="o">=</span><span class="n">MDF_VAR_ID</span><span class="p">,</span>
            <span class="n">objective_sense</span><span class="o">=+</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="n">with_enzyme_constraints</span><span class="p">,</span>
            <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">with_loop_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span>
            <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="n">ignore_nonlinear_terms</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">calculate_concs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">metabolite</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">met_var_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">LNCONC_VAR_PREFIX</span><span class="si">}{</span><span class="n">met_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">met_var_name</span> <span class="ow">in</span> <span class="n">model_var_names</span><span class="p">:</span>
                <span class="n">min_mdf_conc</span> <span class="o">=</span> <span class="n">min_mdf_result</span><span class="p">[</span><span class="n">met_var_name</span><span class="p">]</span>
                <span class="n">max_mdf_conc</span> <span class="o">=</span> <span class="n">min_mdf_result</span><span class="p">[</span><span class="n">met_var_name</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">log_min_conc</span> <span class="ow">in</span> <span class="p">(</span><span class="n">min_mdf_conc</span><span class="p">,</span> <span class="n">max_mdf_conc</span><span class="p">):</span>
                    <span class="n">min_values</span><span class="p">[</span><span class="n">met_var_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">log_min_conc</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">objective_targets</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">met_var_name</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">log_max_conc</span> <span class="ow">in</span> <span class="p">(</span><span class="n">min_mdf_conc</span><span class="p">,</span> <span class="n">max_mdf_conc</span><span class="p">):</span>
                    <span class="n">max_values</span><span class="p">[</span><span class="n">met_var_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">log_max_conc</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">objective_targets</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">met_var_name</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">min_flux_sum_flux</span> <span class="o">=</span> <span class="n">min_flux_sum_result</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
        <span class="n">max_flux_sum_flux</span> <span class="o">=</span> <span class="n">max_flux_sum_result</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">calculate_reacs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">min_flux</span> <span class="ow">in</span> <span class="p">(</span><span class="n">min_flux_sum_flux</span><span class="p">,</span> <span class="n">max_flux_sum_flux</span><span class="p">):</span>
                <span class="n">min_values</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">reaction</span><span class="o">.</span><span class="n">min_flux</span> <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">min_flux</span> <span class="o">&gt;=</span> <span class="n">min_flux_cutoff</span> <span class="k">else</span> <span class="mf">0.0</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">objective_targets</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">max_flux</span> <span class="ow">in</span> <span class="p">(</span><span class="n">min_flux_sum_flux</span><span class="p">,</span> <span class="n">max_flux_sum_flux</span><span class="p">):</span>
                <span class="n">max_values</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">max_flux</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">objective_targets</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">calculate_rest</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">f_var_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DF_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">kappa_substrates_var_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">KAPPA_SUBSTRATES_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">kappa_products_var_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">KAPPA_PRODUCTS_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">f_var_name</span> <span class="ow">in</span> <span class="n">model_var_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">min_mdf</span> <span class="ow">in</span> <span class="p">(</span><span class="n">min_mdf_result</span><span class="p">[</span><span class="n">f_var_name</span><span class="p">],</span> <span class="n">max_mdf_result</span><span class="p">[</span><span class="n">f_var_name</span><span class="p">]):</span>
                <span class="n">min_values</span><span class="p">[</span><span class="n">f_var_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_mdf</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">objective_targets</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">f_var_name</span><span class="p">))</span>
            <span class="n">objective_targets</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">f_var_name</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">kappa_substrates_var_name</span> <span class="ow">in</span> <span class="n">model_var_names</span><span class="p">:</span>
            <span class="n">objective_targets</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kappa_substrates_var_name</span><span class="p">),</span> <span class="p">(</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">kappa_substrates_var_name</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">kappa_products_var_name</span> <span class="ow">in</span> <span class="n">model_var_names</span><span class="p">:</span>
            <span class="n">objective_targets</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kappa_products_var_name</span><span class="p">),</span> <span class="p">(</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">kappa_products_var_name</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">with_enzyme_constraints</span><span class="p">:</span>
            <span class="n">full_enzyme_id</span> <span class="o">=</span> <span class="n">get_full_enzyme_id</span><span class="p">(</span>
                <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">full_enzyme_id</span><span class="p">:</span>
                <span class="n">enzyme_delivery_var_name</span> <span class="o">=</span> <span class="n">get_reaction_enzyme_var_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)</span>
                <span class="k">if</span> <span class="mf">0.0</span> <span class="ow">in</span> <span class="p">(</span><span class="n">min_flux_sum_flux</span><span class="p">,</span> <span class="n">max_flux_sum_flux</span><span class="p">):</span>
                    <span class="n">min_values</span><span class="p">[</span><span class="n">enzyme_delivery_var_name</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">objective_targets</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">enzyme_delivery_var_name</span><span class="p">))</span>
                <span class="n">objective_targets</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">enzyme_delivery_var_name</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">further_tested_var</span> <span class="ow">in</span> <span class="n">further_tested_vars</span><span class="p">:</span>
        <span class="n">objective_targets</span><span class="o">.</span><span class="n">extend</span><span class="p">(((</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">further_tested_var</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">further_tested_var</span><span class="p">)))</span>

    <span class="n">objectives_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">obj_sense</span><span class="p">,</span> <span class="n">target_id</span> <span class="ow">in</span> <span class="n">objective_targets</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">obj_sense</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">objective_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;MIN_OBJ_</span><span class="si">{</span><span class="n">target_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">pyomo_sense</span> <span class="o">=</span> <span class="n">minimize</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">objective_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;MAX_OBJ_</span><span class="si">{</span><span class="n">target_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">pyomo_sense</span> <span class="o">=</span> <span class="n">maximize</span>
        <span class="nb">setattr</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span>
            <span class="n">objective_name</span><span class="p">,</span>
            <span class="n">Objective</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">target_id</span><span class="p">),</span> <span class="n">sense</span><span class="o">=</span><span class="n">pyomo_sense</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">objective_name</span><span class="p">)</span><span class="o">.</span><span class="n">deactivate</span><span class="p">()</span>
        <span class="n">objectives_data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">objective_name</span><span class="p">,</span> <span class="n">target_id</span><span class="p">))</span>

    <span class="n">objectives_data_batches</span> <span class="o">=</span> <span class="n">split_list</span><span class="p">(</span><span class="n">objectives_data</span><span class="p">,</span> <span class="n">cpu_count</span><span class="p">())</span>
    <span class="n">pyomo_solver</span> <span class="o">=</span> <span class="n">get_solver</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">solver_options</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">solver_attrs</span><span class="p">)</span>

    <span class="n">results_list</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">parallel_verbosity_level</span><span class="p">)(</span>
        <span class="n">delayed</span><span class="p">(</span><span class="n">_batch_variability_optimization</span><span class="p">)(</span>
            <span class="n">pyomo_solver</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve_extra_options</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">objectives_data_batches</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">results_list</span><span class="p">):</span>
        <span class="n">is_minimization</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">target_id</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">result_value</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">is_minimization</span><span class="p">:</span>
            <span class="n">min_values</span><span class="p">[</span><span class="n">target_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">max_values</span><span class="p">[</span><span class="n">target_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_value</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">min_value</span> <span class="ow">in</span> <span class="n">min_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="n">min_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_value</span> <span class="k">if</span> <span class="n">min_value</span> <span class="o">&gt;=</span> <span class="n">min_flux_cutoff</span> <span class="k">else</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">ENZYME_VAR_PREFIX</span><span class="p">):</span>
            <span class="n">min_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_value</span> <span class="k">if</span> <span class="n">min_value</span> <span class="o">&gt;=</span> <span class="n">min_enzyme_cutoff</span> <span class="k">else</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">DF_VAR_PREFIX</span><span class="p">):</span>
            <span class="n">min_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_value</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">min_value</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">abs_df_cutoff</span> <span class="k">else</span> <span class="mf">0.0</span>

    <span class="n">enzyme_var_to_reac_id</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">get_reaction_enzyme_var_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span><span class="p">):</span> <span class="n">reac_id</span>
        <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">max_value</span> <span class="ow">in</span> <span class="n">max_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">ENZYME_VAR_PREFIX</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">max_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">max_values</span><span class="p">[</span><span class="n">enzyme_var_to_reac_id</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">max_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_value</span><span class="p">,</span> <span class="n">max_active_enzyme_cutoff</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">DF_VAR_PREFIX</span><span class="p">):</span>
            <span class="n">max_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_value</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">max_value</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">abs_df_cutoff</span> <span class="k">else</span> <span class="mf">0.0</span>

    <span class="n">all_target_ids</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
        <span class="nb">set</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="n">min_values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">max_values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="o">+</span> <span class="p">[</span><span class="n">obj_target</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">obj_target</span> <span class="ow">in</span> <span class="n">objective_targets</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">target_id</span><span class="p">:</span> <span class="p">(</span><span class="n">min_values</span><span class="p">[</span><span class="n">target_id</span><span class="p">],</span> <span class="n">max_values</span><span class="p">[</span><span class="n">target_id</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">target_id</span> <span class="ow">in</span> <span class="n">all_target_ids</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">variability_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.model_instantiation" class="doc doc-heading">
            <code>model_instantiation</code>


</h2>

    <div class="doc doc-contents ">

        <p>This module contains the most convenient ways to create new Model instances from COBRApy models.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.model_instantiation.delete_enzymatically_suboptimal_reactions_in_cobrak_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_enzymatically_suboptimal_reactions_in_cobrak_model</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete enzymatically suboptimal reactions in a COBRA-k model, similar to the idea in sMOMENT/AutoPACMEN [1].</p>
<p>This function processes each reaction in the provided COBRA-k model to
determine if it is enzymatically suboptimal based on Molecular Weight by k_cat (MW/kcat).
Suboptimal reactions are identified by comparing their MW/kcat value with that of other reactions
sharing the same base identifier, retaining only those with the lowest MW/kcat.
The function then removes these suboptimal reactions from the model and cleans up orphaned metabolites.</p>
<ul>
<li>The function assumes that the 'enzyme_reaction_data' attribute of each reaction includes
  identifiers and k_cat information for enzyme-catalyzed reactions. If not, those reactions are skipped.</li>
<li>Reactions with identical base IDs (but different directional suffixes) are considered as variants of the same reaction.</li>
<li>After removing suboptimal reactions, the function calls <code>delete_orphaned_metabolites_and_enzymes</code> to clean up any orphaned metabolites and enzymes that may have been left behind.</li>
</ul>
<p>[1] https://doi.org/10.1186/s12859-019-3329-9</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><span title="cobra.Model">Model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A COBRA-k model containing biochemical reactions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>cobra.Model: The updated COBRA-k model after removing enzymatically suboptimal reactions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/model_instantiation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_enzymatically_suboptimal_reactions_in_cobrak_model</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete enzymatically suboptimal reactions in a COBRA-k model, similar to the idea in sMOMENT/AutoPACMEN [1].</span>

<span class="sd">    This function processes each reaction in the provided COBRA-k model to</span>
<span class="sd">    determine if it is enzymatically suboptimal based on Molecular Weight by k_cat (MW/kcat).</span>
<span class="sd">    Suboptimal reactions are identified by comparing their MW/kcat value with that of other reactions</span>
<span class="sd">    sharing the same base identifier, retaining only those with the lowest MW/kcat.</span>
<span class="sd">    The function then removes these suboptimal reactions from the model and cleans up orphaned metabolites.</span>

<span class="sd">    - The function assumes that the &#39;enzyme_reaction_data&#39; attribute of each reaction includes</span>
<span class="sd">      identifiers and k_cat information for enzyme-catalyzed reactions. If not, those reactions are skipped.</span>
<span class="sd">    - Reactions with identical base IDs (but different directional suffixes) are considered as variants of the same reaction.</span>
<span class="sd">    - After removing suboptimal reactions, the function calls `delete_orphaned_metabolites_and_enzymes` to clean up any orphaned metabolites and enzymes that may have been left behind.</span>

<span class="sd">    [1] https://doi.org/10.1186/s12859-019-3329-9</span>

<span class="sd">    Parameters:</span>
<span class="sd">        cobrak_model (cobra.Model): A COBRA-k model containing biochemical reactions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        cobra.Model: The updated COBRA-k model after removing enzymatically suboptimal reactions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reac_id_to_mw_by_kcat</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">reac_id_to_base_id</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">base_id_to_min_mw_by_kcat</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reac_data</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reac_data</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">reac_data</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">reac_data</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]:</span>
            <span class="k">continue</span>

        <span class="n">mw_by_kcat</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">get_full_enzyme_mw</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">reac_data</span><span class="p">)</span>
            <span class="o">/</span> <span class="n">reac_data</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span>
        <span class="p">)</span>

        <span class="n">reac_id_to_mw_by_kcat</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">mw_by_kcat</span>

        <span class="k">if</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span><span class="p">):</span>
            <span class="n">direction_addition</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span>
        <span class="k">elif</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">):</span>
            <span class="n">direction_addition</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">direction_addition</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">base_id</span> <span class="o">=</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">reac_enz_separator</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">direction_addition</span>

        <span class="n">reac_id_to_base_id</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_id</span>
        <span class="k">if</span> <span class="n">base_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">base_id_to_min_mw_by_kcat</span><span class="p">:</span>
            <span class="n">base_id_to_min_mw_by_kcat</span><span class="p">[</span><span class="n">base_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">mw_by_kcat</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">base_id_to_min_mw_by_kcat</span><span class="p">[</span><span class="n">base_id</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                <span class="n">base_id_to_min_mw_by_kcat</span><span class="p">[</span><span class="n">base_id</span><span class="p">],</span> <span class="n">mw_by_kcat</span>
            <span class="p">)</span>

    <span class="n">reacs_to_delete</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">reac_id</span>
        <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">base_id</span> <span class="ow">in</span> <span class="n">reac_id_to_base_id</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">reac_id_to_mw_by_kcat</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">!=</span> <span class="n">base_id_to_min_mw_by_kcat</span><span class="p">[</span><span class="n">base_id</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">reac_to_delete</span> <span class="ow">in</span> <span class="n">reacs_to_delete</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_to_delete</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">delete_orphaned_metabolites_and_enzymes</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.model_instantiation.delete_enzymatically_suboptimal_reactions_in_fullsplit_cobrapy_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_enzymatically_suboptimal_reactions_in_fullsplit_cobrapy_model</span><span class="p">(</span><span class="n">cobra_model</span><span class="p">,</span> <span class="n">enzyme_reaction_data</span><span class="p">,</span> <span class="n">enzyme_molecular_weights</span><span class="p">,</span> <span class="n">fwd_suffix</span><span class="o">=</span><span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span> <span class="n">rev_suffix</span><span class="o">=</span><span class="n">REAC_REV_SUFFIX</span><span class="p">,</span> <span class="n">reac_enz_separator</span><span class="o">=</span><span class="n">REAC_ENZ_SEPARATOR</span><span class="p">,</span> <span class="n">special_enzyme_stoichiometries</span><span class="o">=</span><span class="p">{})</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Removes enzymatically suboptimal reactions from a fullsplit COBRApy model.</p>
<p>This function identifies and deletes reactions in a COBRApy model that are enzymatically suboptimal based on
enzyme reaction data and molecular weights. I.e., it retains only the reactions with the minimum molecular weight
to k_cat (MW/k_cat) ratio for each base reaction. "base" reaction stands for any originally identical reaction, e.g.,
if there are somehow now multiple phosphoglucokinase (PGK) reactions due to an enzyme fullsplit, only one of these
PGK variants will be retained in the returned model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobra_model</code>
            </td>
            <td>
                  <code><span title="cobra.Model">Model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRA-k model from which suboptimal reactions will be removed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enzyme_reaction_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="EnzymeReactionData (cobrak.dataclasses.EnzymeReactionData)" href="#cobrak.dataclasses.EnzymeReactionData">EnzymeReactionData</a> | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping reaction IDs to
<code>EnzymeReactionData</code> objects or <code>None</code> if the data is missing.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enzyme_molecular_weights</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping enzyme identifiers to their molecular weights.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="cobra.Model">Model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>cobra.Model: The modified COBRA-k model with suboptimal reactions removed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/model_instantiation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_enzymatically_suboptimal_reactions_in_fullsplit_cobrapy_model</span><span class="p">(</span>
    <span class="n">cobra_model</span><span class="p">:</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span>
    <span class="n">enzyme_reaction_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EnzymeReactionData</span> <span class="o">|</span> <span class="kc">None</span><span class="p">],</span>
    <span class="n">enzyme_molecular_weights</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">fwd_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span>
    <span class="n">rev_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_REV_SUFFIX</span><span class="p">,</span>
    <span class="n">reac_enz_separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_ENZ_SEPARATOR</span><span class="p">,</span>
    <span class="n">special_enzyme_stoichiometries</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes enzymatically suboptimal reactions from a fullsplit COBRApy model.</span>

<span class="sd">    This function identifies and deletes reactions in a COBRApy model that are enzymatically suboptimal based on</span>
<span class="sd">    enzyme reaction data and molecular weights. I.e., it retains only the reactions with the minimum molecular weight</span>
<span class="sd">    to k_cat (MW/k_cat) ratio for each base reaction. &quot;base&quot; reaction stands for any originally identical reaction, e.g.,</span>
<span class="sd">    if there are somehow now multiple phosphoglucokinase (PGK) reactions due to an enzyme fullsplit, only one of these</span>
<span class="sd">    PGK variants will be retained in the returned model.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobra_model (cobra.Model): The COBRA-k model from which suboptimal reactions will be removed.</span>
<span class="sd">        enzyme_reaction_data (dict[str, EnzymeReactionData | None]): A dictionary mapping reaction IDs to</span>
<span class="sd">            ```EnzymeReactionData``` objects or ```None``` if the data is missing.</span>
<span class="sd">        enzyme_molecular_weights (dict[str, float]): A dictionary mapping enzyme identifiers to their molecular weights.</span>

<span class="sd">    Returns:</span>
<span class="sd">        cobra.Model: The modified COBRA-k model with suboptimal reactions removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reac_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">]</span>
    <span class="n">ignored_reac_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">base_reacs_to_min_mw_by_k_cat</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">reac_ids</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">reac_enz_separator</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reac_id</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">enzyme_reaction_data</span><span class="p">:</span>
            <span class="n">ignored_reac_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">current_enzyme_reaction_data</span> <span class="o">=</span> <span class="n">enzyme_reaction_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">current_enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ignored_reac_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">mw</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">current_enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">special_enzyme_stoichiometries</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">special_enzyme_stoichiometries</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]:</span>
                    <span class="n">stoichiometry</span> <span class="o">=</span> <span class="n">special_enzyme_stoichiometries</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="n">identifier</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">stoichiometry</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">stoichiometry</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">mw</span> <span class="o">+=</span> <span class="n">stoichiometry</span> <span class="o">*</span> <span class="n">enzyme_molecular_weights</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span>
        <span class="n">k_cat</span> <span class="o">=</span> <span class="n">current_enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span>
        <span class="n">mw_by_k_cat</span> <span class="o">=</span> <span class="n">mw</span> <span class="o">/</span> <span class="n">k_cat</span>

        <span class="k">if</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">fwd_suffix</span><span class="p">):</span>
            <span class="n">direction_addition</span> <span class="o">=</span> <span class="n">fwd_suffix</span>
        <span class="k">elif</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">rev_suffix</span><span class="p">):</span>
            <span class="n">direction_addition</span> <span class="o">=</span> <span class="n">rev_suffix</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">direction_addition</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">base_id</span> <span class="o">=</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">reac_enz_separator</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">direction_addition</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">base_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">base_reacs_to_min_mw_by_k_cat</span>
            <span class="ow">or</span> <span class="n">mw_by_k_cat</span> <span class="o">&lt;</span> <span class="n">base_reacs_to_min_mw_by_k_cat</span><span class="p">[</span><span class="n">base_id</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="n">base_reacs_to_min_mw_by_k_cat</span><span class="p">[</span><span class="n">base_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">mw_by_k_cat</span><span class="p">)</span>
    <span class="n">enz_reacs_to_keep</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">base_reacs_to_min_mw_by_k_cat</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
    <span class="n">reacs_to_delete</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">reac_id</span>
        <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">reac_ids</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">reac_enz_separator</span> <span class="ow">in</span> <span class="n">reac_id</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">enz_reacs_to_keep</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignored_reac_ids</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">cobra_model</span><span class="o">.</span><span class="n">remove_reactions</span><span class="p">(</span><span class="n">reacs_to_delete</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cobra_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.model_instantiation.get_cobrak_model_from_sbml_and_thermokinetic_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_cobrak_model_from_sbml_and_thermokinetic_data</span><span class="p">(</span><span class="n">sbml_path</span><span class="p">,</span> <span class="n">extra_linear_constraints</span><span class="p">,</span> <span class="n">dG0s</span><span class="p">,</span> <span class="n">dG0_uncertainties</span><span class="p">,</span> <span class="n">conc_ranges</span><span class="p">,</span> <span class="n">enzyme_molecular_weights</span><span class="p">,</span> <span class="n">enzyme_reaction_data</span><span class="p">,</span> <span class="n">max_prot_pool</span><span class="p">,</span> <span class="n">kinetic_ignored_metabolites</span><span class="p">,</span> <span class="n">enzyme_conc_ranges</span><span class="o">=</span><span class="p">{},</span> <span class="n">do_model_fullsplit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_delete_enzymatically_suboptimal_reactions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="n">STANDARD_R</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">STANDARD_T</span><span class="p">,</span> <span class="n">fwd_suffix</span><span class="o">=</span><span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span> <span class="n">rev_suffix</span><span class="o">=</span><span class="n">REAC_REV_SUFFIX</span><span class="p">,</span> <span class="n">reac_enz_separator</span><span class="o">=</span><span class="n">REAC_ENZ_SEPARATOR</span><span class="p">,</span> <span class="n">omitted_metabolites</span><span class="o">=</span><span class="p">[],</span> <span class="n">keep_parameter_refs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creates a COBRAk model from an SBML and given further thermokinetic (thermodynamic and enzymatic) data.</p>
<p>This function constructs a <code>Model</code> by integrating thermokinetic data and additional constraints
into an existing COBRA-k model. It allows for the specification of concentration ranges, enzyme molecular weights, and
reaction data, among other parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sbml_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SBML model to be converted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>extra_linear_constraints</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="ExtraLinearConstraint (cobrak.dataclasses.ExtraLinearConstraint)" href="#cobrak.dataclasses.ExtraLinearConstraint">ExtraLinearConstraint</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional linear constraints to be applied to the model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dG0s</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Standard Gibbs free energy changes for reactions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dG0_uncertainties</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Uncertainties in the standard Gibbs free energy changes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conc_ranges</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Concentration ranges for metabolites.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enzyme_molecular_weights</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Molecular weights of enzymes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enzyme_reaction_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="EnzymeReactionData (cobrak.dataclasses.EnzymeReactionData)" href="#cobrak.dataclasses.EnzymeReactionData">EnzymeReactionData</a> | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Enzyme reaction data for reactions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_prot_pool</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum protein pool constraint.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kinetic_ignored_metabolites</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metabolites to be ignored in kinetic calculations.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enzyme_conc_ranges</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>] | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Concentration ranges for enzymes. Defaults to {}.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>do_model_fullsplit</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to perform a full split of the model. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>do_delete_enzymatically_suboptimal_reactions</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to delete enzymatically suboptimal reactions. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>R</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Universal gas constant. Defaults to STANDARD_R.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="STANDARD_R = 0.008314

  
      module-attribute
   (cobrak.constants.STANDARD_R)" href="#cobrak.constants.STANDARD_R">STANDARD_R</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>T</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temperature in Kelvin. Defaults to STANDARD_T.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="STANDARD_T = 298.15

  
      module-attribute
   (cobrak.constants.STANDARD_T)" href="#cobrak.constants.STANDARD_T">STANDARD_T</a></code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a concentration range for a metabolite is not provided and no default is set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Model</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The constructed <code>Model</code> with integrated thermokinetic data and constraints.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/model_instantiation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_cobrak_model_from_sbml_and_thermokinetic_data</span><span class="p">(</span>
    <span class="n">sbml_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">extra_linear_constraints</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ExtraLinearConstraint</span><span class="p">],</span>
    <span class="n">dG0s</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">dG0_uncertainties</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">conc_ranges</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">enzyme_molecular_weights</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">enzyme_reaction_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EnzymeReactionData</span> <span class="o">|</span> <span class="kc">None</span><span class="p">],</span>
    <span class="n">max_prot_pool</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">kinetic_ignored_metabolites</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">enzyme_conc_ranges</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">do_model_fullsplit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">do_delete_enzymatically_suboptimal_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">R</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">STANDARD_R</span><span class="p">,</span>
    <span class="n">T</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">STANDARD_T</span><span class="p">,</span>
    <span class="n">fwd_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span>
    <span class="n">rev_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_REV_SUFFIX</span><span class="p">,</span>
    <span class="n">reac_enz_separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_ENZ_SEPARATOR</span><span class="p">,</span>
    <span class="n">omitted_metabolites</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">keep_parameter_refs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a COBRAk model from an SBML and given further thermokinetic (thermodynamic and enzymatic) data.</span>

<span class="sd">    This function constructs a `Model` by integrating thermokinetic data and additional constraints</span>
<span class="sd">    into an existing COBRA-k model. It allows for the specification of concentration ranges, enzyme molecular weights, and</span>
<span class="sd">    reaction data, among other parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        sbml_path (str): The SBML model to be converted.</span>
<span class="sd">        extra_linear_constraints (list[ExtraLinearConstraint]): Additional linear constraints to be applied to the model.</span>
<span class="sd">        dG0s (dict[str, float]): Standard Gibbs free energy changes for reactions.</span>
<span class="sd">        dG0_uncertainties (dict[str, float]): Uncertainties in the standard Gibbs free energy changes.</span>
<span class="sd">        conc_ranges (dict[str, tuple[float, float]]): Concentration ranges for metabolites.</span>
<span class="sd">        enzyme_molecular_weights (dict[str, float]): Molecular weights of enzymes.</span>
<span class="sd">        enzyme_reaction_data (dict[str, EnzymeReactionData | None]): Enzyme reaction data for reactions.</span>
<span class="sd">        max_prot_pool (float): Maximum protein pool constraint.</span>
<span class="sd">        kinetic_ignored_metabolites (list[str]): Metabolites to be ignored in kinetic calculations.</span>
<span class="sd">        enzyme_conc_ranges (dict[str, tuple[float, float] | None], optional): Concentration ranges for enzymes. Defaults to {}.</span>
<span class="sd">        do_model_fullsplit (bool, optional): Whether to perform a full split of the model. Defaults to True.</span>
<span class="sd">        do_delete_enzymatically_suboptimal_reactions (bool, optional): Whether to delete enzymatically suboptimal reactions. Defaults to True.</span>
<span class="sd">        R (float, optional): Universal gas constant. Defaults to STANDARD_R.</span>
<span class="sd">        T (float, optional): Temperature in Kelvin. Defaults to STANDARD_T.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If a concentration range for a metabolite is not provided and no default is set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Model: The constructed `Model` with integrated thermokinetic data and constraints.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cobra_model</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_sbml_model</span><span class="p">(</span><span class="n">sbml_path</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">do_model_fullsplit</span><span class="p">:</span>
        <span class="n">cobra_model</span> <span class="o">=</span> <span class="n">get_fullsplit_cobra_model</span><span class="p">(</span><span class="n">cobra_model</span><span class="p">)</span>

    <span class="n">cobrak_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span>
        <span class="n">reactions</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">metabolites</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">enzymes</span><span class="o">=</span><span class="p">{},</span>
        <span class="n">max_prot_pool</span><span class="o">=</span><span class="n">max_prot_pool</span><span class="p">,</span>
        <span class="n">extra_linear_constraints</span><span class="o">=</span><span class="n">extra_linear_constraints</span><span class="p">,</span>
        <span class="n">kinetic_ignored_metabolites</span><span class="o">=</span><span class="n">kinetic_ignored_metabolites</span><span class="p">,</span>
        <span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span>
        <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span>
        <span class="n">fwd_suffix</span><span class="o">=</span><span class="n">fwd_suffix</span><span class="p">,</span>
        <span class="n">rev_suffix</span><span class="o">=</span><span class="n">rev_suffix</span><span class="p">,</span>
        <span class="n">reac_enz_separator</span><span class="o">=</span><span class="n">reac_enz_separator</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">metabolite</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">omitted_metabolites</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">conc_ranges</span><span class="p">:</span>
            <span class="n">min_conc</span> <span class="o">=</span> <span class="n">conc_ranges</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">max_conc</span> <span class="o">=</span> <span class="n">conc_ranges</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;DEFAULT&quot;</span> <span class="ow">in</span> <span class="n">conc_ranges</span><span class="p">:</span>
            <span class="n">min_conc</span> <span class="o">=</span> <span class="n">conc_ranges</span><span class="p">[</span><span class="s2">&quot;DEFAULT&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">max_conc</span> <span class="o">=</span> <span class="n">conc_ranges</span><span class="p">[</span><span class="s2">&quot;DEFAULT&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERROR: No concentration range for metabolite </span><span class="si">{</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fixes: 1) Set its specific range; 2) Set a &#39;DEFAULT&#39; range.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

        <span class="n">cobrak_model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">[</span><span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">Metabolite</span><span class="p">(</span>
            <span class="n">log_min_conc</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">min_conc</span><span class="p">),</span>
            <span class="n">log_max_conc</span><span class="o">=</span><span class="n">log</span><span class="p">(</span><span class="n">max_conc</span><span class="p">),</span>
            <span class="n">annotation</span><span class="o">=</span><span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">metabolite</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">formula</span><span class="o">=</span><span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">formula</span> <span class="k">else</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">formula</span><span class="p">,</span>
            <span class="n">charge</span><span class="o">=</span><span class="n">metabolite</span><span class="o">.</span><span class="n">charge</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="n">dG0</span> <span class="o">=</span> <span class="n">dG0s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="n">dG0_uncertainty</span> <span class="o">=</span> <span class="n">dG0_uncertainties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">enzyme_reaction_data</span><span class="p">:</span>
            <span class="n">used_enzyme_reaction_data</span> <span class="o">=</span> <span class="n">enzyme_reaction_data</span><span class="p">[</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">used_enzyme_reaction_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">keep_parameter_refs</span><span class="p">):</span>
                <span class="n">used_enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat_references</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">used_enzyme_reaction_data</span><span class="o">.</span><span class="n">k_m_references</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">used_enzyme_reaction_data</span><span class="o">.</span><span class="n">k_i_references</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">used_enzyme_reaction_data</span><span class="o">.</span><span class="n">k_a_references</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">used_enzyme_reaction_data</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span>
            <span class="n">min_flux</span><span class="o">=</span><span class="n">reaction</span><span class="o">.</span><span class="n">lower_bound</span><span class="p">,</span>
            <span class="n">max_flux</span><span class="o">=</span><span class="n">reaction</span><span class="o">.</span><span class="n">upper_bound</span><span class="p">,</span>
            <span class="n">stoichiometries</span><span class="o">=</span><span class="p">{</span>
                <span class="n">metabolite</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="n">value</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">metabolite</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">omitted_metabolites</span>
            <span class="p">},</span>
            <span class="n">dG0</span><span class="o">=</span><span class="n">dG0</span><span class="p">,</span>
            <span class="n">dG0_uncertainty</span><span class="o">=</span><span class="n">dG0_uncertainty</span><span class="p">,</span>
            <span class="n">enzyme_reaction_data</span><span class="o">=</span><span class="n">used_enzyme_reaction_data</span><span class="p">,</span>
            <span class="n">annotation</span><span class="o">=</span><span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">reaction</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">cobra_gene_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">gene</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">genes</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">enzyme_id</span><span class="p">,</span> <span class="n">molecular_weight</span> <span class="ow">in</span> <span class="n">enzyme_molecular_weights</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">min_enzyme_conc</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">max_enzyme_conc</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">enzyme_id</span> <span class="ow">in</span> <span class="n">enzyme_conc_ranges</span><span class="p">:</span>
            <span class="n">conc_range</span> <span class="o">=</span> <span class="n">enzyme_conc_ranges</span><span class="p">[</span><span class="n">enzyme_id</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">conc_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">min_enzyme_conc</span> <span class="o">=</span> <span class="n">conc_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">max_enzyme_conc</span> <span class="o">=</span> <span class="n">conc_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">enzyme_id</span> <span class="ow">in</span> <span class="n">cobra_gene_ids</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">genes</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">enzyme_id</span><span class="p">)</span><span class="o">.</span><span class="n">id</span>
            <span class="n">annotation</span> <span class="o">=</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">genes</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">enzyme_id</span><span class="p">)</span><span class="o">.</span><span class="n">annotation</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">annotation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">cobrak_model</span><span class="o">.</span><span class="n">enzymes</span><span class="p">[</span><span class="n">enzyme_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">Enzyme</span><span class="p">(</span>
            <span class="n">molecular_weight</span><span class="o">=</span><span class="n">molecular_weight</span><span class="p">,</span>
            <span class="n">min_conc</span><span class="o">=</span><span class="n">min_enzyme_conc</span><span class="p">,</span>
            <span class="n">max_conc</span><span class="o">=</span><span class="n">max_enzyme_conc</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">annotation</span><span class="o">=</span><span class="n">annotation</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">do_delete_enzymatically_suboptimal_reactions</span><span class="p">:</span>
        <span class="n">cobrak_model</span> <span class="o">=</span> <span class="n">delete_enzymatically_suboptimal_reactions_in_cobrak_model</span><span class="p">(</span>
            <span class="n">cobrak_model</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">cobrak_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.model_instantiation.get_cobrak_model_with_kinetic_data_from_sbml_model_alone" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_cobrak_model_with_kinetic_data_from_sbml_model_alone</span><span class="p">(</span><span class="n">sbml_path</span><span class="p">,</span> <span class="n">path_to_external_resources</span><span class="p">,</span> <span class="n">folder_of_sabio_database</span><span class="p">,</span> <span class="n">brenda_version</span><span class="p">,</span> <span class="n">prefer_brenda</span><span class="p">,</span> <span class="n">base_species</span><span class="p">,</span> <span class="n">max_prot_pool</span><span class="p">,</span> <span class="n">conc_ranges</span><span class="p">,</span> <span class="n">inner_to_outer_compartments</span><span class="p">,</span> <span class="n">phs</span><span class="p">,</span> <span class="n">pmgs</span><span class="p">,</span> <span class="n">ionic_strenghts</span><span class="p">,</span> <span class="n">potential_differences</span><span class="p">,</span> <span class="n">kinetic_ignored_enzymes</span><span class="p">,</span> <span class="n">custom_kms_and_kcats</span><span class="p">,</span> <span class="n">kinetic_ignored_metabolites</span><span class="p">,</span> <span class="n">do_model_fullsplit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">do_delete_enzymatically_suboptimal_reactions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ignore_dG0_uncertainty</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">enzyme_conc_ranges</span><span class="o">=</span><span class="p">{},</span> <span class="n">dG0_exclusion_prefixes</span><span class="o">=</span><span class="p">[],</span> <span class="n">dG0_exclusion_inner_parts</span><span class="o">=</span><span class="p">[],</span> <span class="n">dG0_corrections</span><span class="o">=</span><span class="p">{},</span> <span class="n">extra_linear_constraints</span><span class="o">=</span><span class="p">[],</span> <span class="n">data_cache_folder</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="n">STANDARD_R</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">STANDARD_T</span><span class="p">,</span> <span class="n">keep_parameter_refs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">enzymes_to_delete</span><span class="o">=</span><span class="p">[],</span> <span class="n">max_taxonomy_level</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">add_hill_coefficients</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This functions creates a Model out of an SBML model and automatically collects kinetic and thermodynamic data.</p>
<p>To make this function work, the functions needs in the COBRApy model...
...for the reactions: An EC number annotation [for enzymatic constraints]
...for the metabolites: BiGG IDs
...and all the other non-optional data in its arguments</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sbml_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The SBML model file path from which the Model and associated data retrieval shall be made</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path_to_external_resources</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>brenda_version</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_species</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_prot_pool</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conc_ranges</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>inner_to_outer_compartments</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>phs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pmgs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ionic_strenghts</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>potential_differences</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="tuple">tuple</span>[<span title="str">str</span>, <span title="str">str</span>], <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kinetic_ignored_enzymes</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>custom_kms_and_kcats</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="EnzymeReactionData (cobrak.dataclasses.EnzymeReactionData)" href="#cobrak.dataclasses.EnzymeReactionData">EnzymeReactionData</a> | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kinetic_ignored_metabolites</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>do_model_fullsplit</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>do_delete_enzymatically_suboptimal_reactions</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ignore_dG0_uncertainty</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enzyme_conc_ranges</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>] | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to {}.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dG0_exclusion_prefixes</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dG0_exclusion_inner_parts</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>extra_linear_constraints</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="ExtraLinearConstraint (cobrak.dataclasses.ExtraLinearConstraint)" href="#cobrak.dataclasses.ExtraLinearConstraint">ExtraLinearConstraint</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_cache_folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>R</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to STANDARD_R.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="STANDARD_R = 0.008314

  
      module-attribute
   (cobrak.constants.STANDARD_R)" href="#cobrak.constants.STANDARD_R">STANDARD_R</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>T</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to STANDARD_T.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="STANDARD_T = 298.15

  
      module-attribute
   (cobrak.constants.STANDARD_T)" href="#cobrak.constants.STANDARD_T">STANDARD_T</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>add_hill_coefficients</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether Hill coefficeints shall be collected (True) or not (False).
They are added (as they cannot be separated for ,  <em>and</em>  as HilLCoefficient instances). Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Model</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/model_instantiation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_cobrak_model_with_kinetic_data_from_sbml_model_alone</span><span class="p">(</span>
    <span class="n">sbml_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">path_to_external_resources</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">folder_of_sabio_database</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">brenda_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">prefer_brenda</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">base_species</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">max_prot_pool</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">conc_ranges</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">inner_to_outer_compartments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">phs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">pmgs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">ionic_strenghts</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">potential_differences</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">kinetic_ignored_enzymes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">custom_kms_and_kcats</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EnzymeReactionData</span> <span class="o">|</span> <span class="kc">None</span><span class="p">],</span>
    <span class="n">kinetic_ignored_metabolites</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">do_model_fullsplit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">do_delete_enzymatically_suboptimal_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ignore_dG0_uncertainty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">enzyme_conc_ranges</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">dG0_exclusion_prefixes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">dG0_exclusion_inner_parts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">dG0_corrections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">extra_linear_constraints</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ExtraLinearConstraint</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">data_cache_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">R</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">STANDARD_R</span><span class="p">,</span>
    <span class="n">T</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">STANDARD_T</span><span class="p">,</span>
    <span class="n">keep_parameter_refs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">enzymes_to_delete</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">max_taxonomy_level</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
    <span class="n">add_hill_coefficients</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This functions creates a Model out of an SBML model and automatically collects kinetic and thermodynamic data.</span>

<span class="sd">    To make this function work, the functions needs in the COBRApy model...</span>
<span class="sd">    ...for the reactions: An EC number annotation [for enzymatic constraints]</span>
<span class="sd">    ...for the metabolites: BiGG IDs</span>
<span class="sd">    ...and all the other non-optional data in its arguments</span>

<span class="sd">    Args:</span>
<span class="sd">        sbml_path (str): The SBML model file path from which the Model and associated data retrieval shall be made</span>
<span class="sd">        path_to_external_resources (str): _description_</span>
<span class="sd">        brenda_version (str): _description_</span>
<span class="sd">        base_species (str): _description_</span>
<span class="sd">        max_prot_pool (float): _description_</span>
<span class="sd">        conc_ranges (dict[str, tuple[float, float]]): _description_</span>
<span class="sd">        inner_to_outer_compartments (list[str]): _description_</span>
<span class="sd">        phs (dict[str, float]): _description_</span>
<span class="sd">        pmgs (dict[str, float]): _description_</span>
<span class="sd">        ionic_strenghts (dict[str, float]): _description_</span>
<span class="sd">        potential_differences (dict[tuple[str, str], float]): _description_</span>
<span class="sd">        kinetic_ignored_enzymes (list[str]): _description_</span>
<span class="sd">        custom_kms_and_kcats (dict[str, EnzymeReactionData  |  None]): _description_</span>
<span class="sd">        kinetic_ignored_metabolites (list[str]): _description_</span>
<span class="sd">        do_model_fullsplit (bool, optional): _description_. Defaults to True.</span>
<span class="sd">        do_delete_enzymatically_suboptimal_reactions (bool, optional): _description_. Defaults to True.</span>
<span class="sd">        ignore_dG0_uncertainty (bool, optional): _description_. Defaults to True.</span>
<span class="sd">        enzyme_conc_ranges (dict[str, tuple[float, float]  |  None], optional): _description_. Defaults to {}.</span>
<span class="sd">        dG0_exclusion_prefixes (list[str], optional): _description_. Defaults to [].</span>
<span class="sd">        dG0_exclusion_inner_parts (list[str], optional): _description_. Defaults to [].</span>
<span class="sd">        extra_linear_constraints (list[ExtraLinearConstraint], optional): _description_. Defaults to [].</span>
<span class="sd">        data_cache_folder (str, optional): _description_. Defaults to &quot;&quot;.</span>
<span class="sd">        R (float, optional): _description_. Defaults to STANDARD_R.</span>
<span class="sd">        T (float, optional): _description_. Defaults to STANDARD_T.</span>
<span class="sd">        add_hill_coefficients (bool, optional): Whether Hill coefficeints shall be collected (True) or not (False).</span>
<span class="sd">            They are added (as they cannot be separated for ,  *and*  as HilLCoefficient instances). Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Model: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cobra_model</span> <span class="o">=</span> <span class="n">load_unannotated_sbml_as_cobrapy_model</span><span class="p">(</span><span class="n">sbml_path</span><span class="p">)</span>
    <span class="n">remove_genes</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">cobra_model</span><span class="p">,</span>
        <span class="n">gene_list</span><span class="o">=</span><span class="n">enzymes_to_delete</span><span class="p">,</span>
        <span class="n">remove_reactions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">path_to_external_resources</span> <span class="o">=</span> <span class="n">standardize_folder</span><span class="p">(</span><span class="n">path_to_external_resources</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data_cache_folder</span><span class="p">:</span>
        <span class="n">data_cache_folder</span> <span class="o">=</span> <span class="n">standardize_folder</span><span class="p">(</span><span class="n">data_cache_folder</span><span class="p">)</span>
        <span class="n">data_cache_files</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">data_cache_folder</span><span class="p">)</span>

    <span class="n">parse_external_resources</span><span class="p">(</span><span class="n">path_to_external_resources</span><span class="p">,</span> <span class="n">brenda_version</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">do_model_fullsplit</span><span class="p">:</span>
        <span class="n">fullsplit_model</span> <span class="o">=</span> <span class="n">get_fullsplit_cobra_model</span><span class="p">(</span><span class="n">cobra_model</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fullsplit_model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cobra_model</span><span class="p">)</span>

    <span class="n">enzyme_reaction_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EnzymeReactionData</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">data_cache_folder</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">data_cache_folder</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;_cache_dG0.json&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_cache_files</span><span class="p">)</span>
            <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;_cache_dG0_uncertainties.json&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_cache_files</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">):</span>
        <span class="n">brenda_enzyme_reaction_data</span> <span class="o">=</span> <span class="n">brenda_select_enzyme_kinetic_data_for_model</span><span class="p">(</span>
            <span class="n">cobra_model</span><span class="o">=</span><span class="n">fullsplit_model</span><span class="p">,</span>
            <span class="n">brenda_json_targz_file_path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path_to_external_resources</span><span class="si">}</span><span class="s2">brenda_2024_1.json.tar.gz&quot;</span><span class="p">,</span>
            <span class="n">bigg_metabolites_json_path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path_to_external_resources</span><span class="si">}</span><span class="s2">bigg_models_metabolites.json&quot;</span><span class="p">,</span>
            <span class="n">brenda_version</span><span class="o">=</span><span class="n">brenda_version</span><span class="p">,</span>
            <span class="n">base_species</span><span class="o">=</span><span class="n">base_species</span><span class="p">,</span>
            <span class="n">ncbi_parsed_json_path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path_to_external_resources</span><span class="si">}</span><span class="s2">parsed_taxdmp.json&quot;</span><span class="p">,</span>
            <span class="n">kinetic_ignored_metabolites</span><span class="o">=</span><span class="n">kinetic_ignored_metabolites</span><span class="p">,</span>
            <span class="n">kinetic_ignored_enzyme_ids</span><span class="o">=</span><span class="n">kinetic_ignored_enzymes</span><span class="p">,</span>
            <span class="n">custom_enzyme_kinetic_data</span><span class="o">=</span><span class="n">custom_kms_and_kcats</span><span class="p">,</span>
            <span class="n">max_taxonomy_level</span><span class="o">=</span><span class="n">max_taxonomy_level</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">sabio_enzyme_reaction_data</span> <span class="o">=</span> <span class="n">sabio_select_enzyme_kinetic_data_for_model</span><span class="p">(</span>
            <span class="n">cobra_model</span><span class="o">=</span><span class="n">fullsplit_model</span><span class="p">,</span>
            <span class="n">sabio_target_folder</span><span class="o">=</span><span class="n">folder_of_sabio_database</span><span class="p">,</span>
            <span class="n">base_species</span><span class="o">=</span><span class="n">base_species</span><span class="p">,</span>
            <span class="n">ncbi_parsed_json_path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path_to_external_resources</span><span class="si">}</span><span class="s2">parsed_taxdmp.json&quot;</span><span class="p">,</span>
            <span class="n">bigg_metabolites_json_path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path_to_external_resources</span><span class="si">}</span><span class="s2">bigg_models_metabolites.json&quot;</span><span class="p">,</span>
            <span class="n">kinetic_ignored_metabolites</span><span class="o">=</span><span class="n">kinetic_ignored_metabolites</span><span class="p">,</span>
            <span class="n">kinetic_ignored_enzyme_ids</span><span class="o">=</span><span class="n">kinetic_ignored_enzymes</span><span class="p">,</span>
            <span class="n">custom_enzyme_kinetic_data</span><span class="o">=</span><span class="n">custom_kms_and_kcats</span><span class="p">,</span>
            <span class="n">max_taxonomy_level</span><span class="o">=</span><span class="n">max_taxonomy_level</span><span class="p">,</span>
            <span class="n">add_hill_coefficients</span><span class="o">=</span><span class="n">add_hill_coefficients</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">enzyme_reaction_data</span> <span class="o">=</span> <span class="n">combine_enzyme_reaction_datasets</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">(</span>
                    <span class="n">brenda_enzyme_reaction_data</span>
                    <span class="k">if</span> <span class="n">prefer_brenda</span>
                    <span class="k">else</span> <span class="n">sabio_enzyme_reaction_data</span>
                <span class="p">),</span>
                <span class="p">(</span>
                    <span class="n">sabio_enzyme_reaction_data</span>
                    <span class="k">if</span> <span class="n">prefer_brenda</span>
                    <span class="k">else</span> <span class="n">brenda_enzyme_reaction_data</span>
                <span class="p">),</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">data_cache_folder</span><span class="p">:</span>
            <span class="n">json_write</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_cache_folder</span><span class="si">}</span><span class="s2">_cache_enzyme_reaction_data.json&quot;</span><span class="p">,</span>
                <span class="n">enzyme_reaction_data</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">enzyme_reaction_data</span> <span class="o">=</span> <span class="n">json_load</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_cache_folder</span><span class="si">}</span><span class="s2">_cache_enzyme_reaction_data.json&quot;</span><span class="p">,</span>
            <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EnzymeReactionData</span> <span class="o">|</span> <span class="kc">None</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="n">enzyme_molecular_weights</span> <span class="o">=</span> <span class="n">uniprot_get_enzyme_molecular_weights</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">fullsplit_model</span><span class="p">,</span>
        <span class="n">cache_basepath</span><span class="o">=</span><span class="n">data_cache_folder</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">do_delete_enzymatically_suboptimal_reactions</span><span class="p">:</span>
        <span class="n">fullsplit_model</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">delete_enzymatically_suboptimal_reactions_in_fullsplit_cobrapy_model</span><span class="p">(</span>
                <span class="n">fullsplit_model</span><span class="p">,</span>
                <span class="n">enzyme_reaction_data</span><span class="p">,</span>
                <span class="n">enzyme_molecular_weights</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">data_cache_folder</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">data_cache_folder</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;_cache_dG0.json&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_cache_files</span><span class="p">)</span>
            <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;_cache_dG0_uncertainties.json&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_cache_files</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">):</span>
        <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdict</span><span class="p">:</span>
            <span class="n">cobra</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write_sbml_model</span><span class="p">(</span><span class="n">fullsplit_model</span><span class="p">,</span> <span class="n">tmpdict</span> <span class="o">+</span> <span class="s2">&quot;temp.xml&quot;</span><span class="p">)</span>
        <span class="n">dG0s</span><span class="p">,</span> <span class="n">dG0_uncertainties</span> <span class="o">=</span> <span class="n">equilibrator_get_model_dG0_and_uncertainty_values</span><span class="p">(</span>
            <span class="n">tmpdict</span> <span class="o">+</span> <span class="s2">&quot;temp.xml&quot;</span><span class="p">,</span>
            <span class="n">inner_to_outer_compartments</span><span class="p">,</span>
            <span class="n">phs</span><span class="p">,</span>
            <span class="n">pmgs</span><span class="p">,</span>
            <span class="n">ionic_strenghts</span><span class="p">,</span>
            <span class="n">potential_differences</span><span class="p">,</span>
            <span class="n">dG0_exclusion_prefixes</span><span class="p">,</span>
            <span class="n">dG0_exclusion_inner_parts</span><span class="p">,</span>
            <span class="n">ignore_dG0_uncertainty</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">data_cache_folder</span><span class="p">:</span>
            <span class="n">json_write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_cache_folder</span><span class="si">}</span><span class="s2">_cache_dG0.json&quot;</span><span class="p">,</span> <span class="n">dG0s</span><span class="p">)</span>
            <span class="n">json_write</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_cache_folder</span><span class="si">}</span><span class="s2">_cache_dG0_uncertainties.json&quot;</span><span class="p">,</span> <span class="n">dG0_uncertainties</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dG0s</span> <span class="o">=</span> <span class="n">json_load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_cache_folder</span><span class="si">}</span><span class="s2">_cache_dG0.json&quot;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span>
        <span class="n">dG0_uncertainties</span> <span class="o">=</span> <span class="n">json_load</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_cache_folder</span><span class="si">}</span><span class="s2">_cache_dG0_uncertainties.json&quot;</span><span class="p">,</span>
            <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">dG0_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dG0s</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">dG0_key</span> <span class="ow">in</span> <span class="n">dG0_keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
                <span class="n">dG0_key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">dG0_exclusion_prefix</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">dG0_exclusion_prefix</span> <span class="ow">in</span> <span class="n">dG0_exclusion_prefixes</span>
            <span class="p">)</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span>
                <span class="n">dG0_exclusion_inner_part</span> <span class="ow">in</span> <span class="n">dG0_key</span>
                <span class="k">for</span> <span class="n">dG0_exclusion_inner_part</span> <span class="ow">in</span> <span class="n">dG0_exclusion_inner_parts</span>
            <span class="p">):</span>
                <span class="k">del</span> <span class="n">dG0s</span><span class="p">[</span><span class="n">dG0_key</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">dG0_key</span> <span class="ow">in</span> <span class="n">dG0_uncertainties</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">dG0_uncertainties</span><span class="p">[</span><span class="n">dG0_key</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dG0_corrections</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">dG0s</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="n">value</span>

    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdict</span><span class="p">:</span>
        <span class="n">cobra</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write_sbml_model</span><span class="p">(</span><span class="n">fullsplit_model</span><span class="p">,</span> <span class="n">tmpdict</span> <span class="o">+</span> <span class="s2">&quot;temp.xml&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">get_cobrak_model_from_sbml_and_thermokinetic_data</span><span class="p">(</span>
            <span class="n">sbml_path</span><span class="o">=</span><span class="n">tmpdict</span> <span class="o">+</span> <span class="s2">&quot;temp.xml&quot;</span><span class="p">,</span>
            <span class="n">extra_linear_constraints</span><span class="o">=</span><span class="n">extra_linear_constraints</span><span class="p">,</span>
            <span class="n">dG0s</span><span class="o">=</span><span class="n">dG0s</span><span class="p">,</span>
            <span class="n">dG0_uncertainties</span><span class="o">=</span><span class="n">dG0_uncertainties</span><span class="p">,</span>
            <span class="n">conc_ranges</span><span class="o">=</span><span class="n">conc_ranges</span><span class="p">,</span>
            <span class="n">enzyme_molecular_weights</span><span class="o">=</span><span class="n">enzyme_molecular_weights</span><span class="p">,</span>
            <span class="n">enzyme_reaction_data</span><span class="o">=</span><span class="n">enzyme_reaction_data</span><span class="p">,</span>
            <span class="n">max_prot_pool</span><span class="o">=</span><span class="n">max_prot_pool</span><span class="p">,</span>
            <span class="n">kinetic_ignored_metabolites</span><span class="o">=</span><span class="n">kinetic_ignored_metabolites</span><span class="p">,</span>
            <span class="n">enzyme_conc_ranges</span><span class="o">=</span><span class="n">enzyme_conc_ranges</span><span class="p">,</span>
            <span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">,</span>
            <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span>
            <span class="n">keep_parameter_refs</span><span class="o">=</span><span class="n">keep_parameter_refs</span><span class="p">,</span>
            <span class="n">do_delete_enzymatically_suboptimal_reactions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.ncbi_taxonomy_functionality" class="doc doc-heading">
            <code>ncbi_taxonomy_functionality</code>


</h2>

    <div class="doc doc-contents ">

        <p>ncbi_taxonomy.py</p>
<p>This module contains functions which can access NCBI TAXONOMY.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.ncbi_taxonomy_functionality.get_taxonomy_dict_from_nbci_taxonomy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_taxonomy_dict_from_nbci_taxonomy</span><span class="p">(</span><span class="n">organisms</span><span class="p">,</span> <span class="n">parsed_json_data</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a taxonomy dictionary from NCBI taxonomy data.</p>
<p>This function constructs a dictionary mapping each organism to its taxonomy path based on the provided NCBI taxonomy data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>organisms</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of organism names for which taxonomy paths are to be retrieved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parsed_json_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parsed JSON data containing taxonomy information, including:
- "number_to_names_dict": A dictionary mapping taxonomy numbers to names.
- "names_to_number_dict": A dictionary mapping organism names to taxonomy numbers.
- "nodes_dict": A dictionary representing the taxonomy tree structure.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, list[str]]: A dictionary where each key is an organism name and the value is a list of taxonomy names</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>representing the path from the organism to the root of the taxonomy tree.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/ncbi_taxonomy_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_taxonomy_dict_from_nbci_taxonomy</span><span class="p">(</span>
    <span class="n">organisms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">parsed_json_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a taxonomy dictionary from NCBI taxonomy data.</span>

<span class="sd">    This function constructs a dictionary mapping each organism to its taxonomy path based on the provided NCBI taxonomy data.</span>

<span class="sd">    Args:</span>
<span class="sd">        organisms (list[str]): A list of organism names for which taxonomy paths are to be retrieved.</span>
<span class="sd">        parsed_json_data (dict[str, Any]): Parsed JSON data containing taxonomy information, including:</span>
<span class="sd">            - &quot;number_to_names_dict&quot;: A dictionary mapping taxonomy numbers to names.</span>
<span class="sd">            - &quot;names_to_number_dict&quot;: A dictionary mapping organism names to taxonomy numbers.</span>
<span class="sd">            - &quot;nodes_dict&quot;: A dictionary representing the taxonomy tree structure.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, list[str]]: A dictionary where each key is an organism name and the value is a list of taxonomy names</span>
<span class="sd">        representing the path from the organism to the root of the taxonomy tree.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">number_to_names_dict</span> <span class="o">=</span> <span class="n">parsed_json_data</span><span class="p">[</span><span class="s2">&quot;number_to_names_dict&quot;</span><span class="p">]</span>
    <span class="n">names_to_number_dict</span> <span class="o">=</span> <span class="n">parsed_json_data</span><span class="p">[</span><span class="s2">&quot;names_to_number_dict&quot;</span><span class="p">]</span>
    <span class="n">nodes_dict</span> <span class="o">=</span> <span class="n">parsed_json_data</span><span class="p">[</span><span class="s2">&quot;nodes_dict&quot;</span><span class="p">]</span>

    <span class="n">organism_to_taxonomy_dicts</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">organism</span> <span class="ow">in</span> <span class="n">organisms</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">node_train</span> <span class="o">=</span> <span class="p">[</span><span class="n">names_to_number_dict</span><span class="p">[</span><span class="n">organism</span><span class="p">]]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">organism_to_taxonomy_dicts</span><span class="p">[</span><span class="n">organism</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">organism</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">]</span>
            <span class="k">continue</span>
        <span class="n">current_number</span> <span class="o">=</span> <span class="n">names_to_number_dict</span><span class="p">[</span><span class="n">organism</span><span class="p">]</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">next_number</span> <span class="o">=</span> <span class="n">nodes_dict</span><span class="p">[</span><span class="n">current_number</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">next_number</span> <span class="o">==</span> <span class="s2">&quot;END&quot;</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">node_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_number</span><span class="p">)</span>
            <span class="n">current_number</span> <span class="o">=</span> <span class="n">next_number</span>
        <span class="n">node_train_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">number_to_names_dict</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">node_train</span><span class="p">]</span>
        <span class="n">organism_to_taxonomy_dicts</span><span class="p">[</span><span class="n">organism</span><span class="p">]</span> <span class="o">=</span> <span class="n">node_train_names</span>
    <span class="k">return</span> <span class="n">organism_to_taxonomy_dicts</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.ncbi_taxonomy_functionality.get_taxonomy_scores" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_taxonomy_scores</span><span class="p">(</span><span class="n">base_species</span><span class="p">,</span> <span class="n">taxonomy_dict</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a dictionary with a taxonomic distance from the given organism.</p>
<p>e.g. if base_species is "Escherichia coli" and taxonomy_dict is</p>
<pre>
{
    "Escherichia coli": ["Escherichia", "Bacteria", "Organism"],
    "Pseudomonas": ["Pseudomonas", "Bacteria", "Organism"],
    "Homo sapiens": ["Homo", "Mammalia", "Animalia", "Organism"],
}
</pre>
<p>this function would return</p>
<pre>
{
    "Escherichia coli": 0,
    "Pseudomonas": 1,
    "Homo sapiens": 4,
}
</pre>

<h5 id="cobrak.ncbi_taxonomy_functionality.get_taxonomy_scores--arguments">Arguments</h5>
<ul>
<li>base_species: str ~ The species to which a relation is made.</li>
<li>taxonomy_dict: dict[str, list[str]] ~ A dictionary with organism names as keys and
  their taxonomic levels (sorted from nearest to farthest) as string list.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/ncbi_taxonomy_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_taxonomy_scores</span><span class="p">(</span>
    <span class="n">base_species</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">taxonomy_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">NonNegativeInt</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a dictionary with a taxonomic distance from the given organism.</span>

<span class="sd">    e.g. if base_species is &quot;Escherichia coli&quot; and taxonomy_dict is</span>
<span class="sd">    &lt;pre&gt;</span>
<span class="sd">    {</span>
<span class="sd">        &quot;Escherichia coli&quot;: [&quot;Escherichia&quot;, &quot;Bacteria&quot;, &quot;Organism&quot;],</span>
<span class="sd">        &quot;Pseudomonas&quot;: [&quot;Pseudomonas&quot;, &quot;Bacteria&quot;, &quot;Organism&quot;],</span>
<span class="sd">        &quot;Homo sapiens&quot;: [&quot;Homo&quot;, &quot;Mammalia&quot;, &quot;Animalia&quot;, &quot;Organism&quot;],</span>
<span class="sd">    }</span>
<span class="sd">    &lt;/pre&gt;</span>
<span class="sd">    this function would return</span>
<span class="sd">    &lt;pre&gt;</span>
<span class="sd">    {</span>
<span class="sd">        &quot;Escherichia coli&quot;: 0,</span>
<span class="sd">        &quot;Pseudomonas&quot;: 1,</span>
<span class="sd">        &quot;Homo sapiens&quot;: 4,</span>
<span class="sd">    }</span>
<span class="sd">    &lt;/pre&gt;</span>

<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">    * base_species: str ~ The species to which a relation is made.</span>
<span class="sd">    * taxonomy_dict: dict[str, list[str]] ~ A dictionary with organism names as keys and</span>
<span class="sd">      their taxonomic levels (sorted from nearest to farthest) as string list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_species_taxonomy</span> <span class="o">=</span> <span class="n">taxonomy_dict</span><span class="p">[</span><span class="n">base_species</span><span class="p">]</span>
    <span class="n">taxonomy_scores</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">base_species</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">other_species_name</span><span class="p">,</span> <span class="n">other_species_taxonomy</span> <span class="ow">in</span> <span class="n">taxonomy_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">taxonomy_part</span> <span class="ow">in</span> <span class="n">base_species_taxonomy</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">taxonomy_part</span> <span class="ow">in</span> <span class="n">other_species_taxonomy</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">taxonomy_scores</span><span class="p">[</span><span class="n">other_species_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">score</span>

    <span class="k">return</span> <span class="n">taxonomy_scores</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.ncbi_taxonomy_functionality.most_taxonomic_similar" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">most_taxonomic_similar</span><span class="p">(</span><span class="n">base_species</span><span class="p">,</span> <span class="n">taxonomy_dict</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a dictionary with a score of taxonomic distance from the given organism.</p>
<p>e.g. if base_species is "Escherichia coli" and taxonomy_dict is</p>
<pre>
{
    "Escherichia coli": ["Escherichia", "Bacteria", "Organism"],
    "Pseudomonas": ["Pseudomonas", "Bacteria", "Organism"],
    "Homo sapiens": ["Homo", "Mammalia", "Animalia", "Organism"],
}
</pre>
<p>this function would return</p>
<pre>
{
    "Escherichia coli": 0,
    "Pseudomonas": 1,
    "Homo sapiens": 2,
}
</pre>

<h5 id="cobrak.ncbi_taxonomy_functionality.most_taxonomic_similar--arguments">Arguments</h5>
<ul>
<li>base_species: str ~ The species to which a relation is made.</li>
<li>taxonomy_dict: dict[str, list[str]] ~ A dictionary with organism names as keys and
  their taxonomic levels (sorted from nearest to farthest) as string list.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/ncbi_taxonomy_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">most_taxonomic_similar</span><span class="p">(</span>
    <span class="n">base_species</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">taxonomy_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a dictionary with a score of taxonomic distance from the given organism.</span>

<span class="sd">    e.g. if base_species is &quot;Escherichia coli&quot; and taxonomy_dict is</span>
<span class="sd">    &lt;pre&gt;</span>
<span class="sd">    {</span>
<span class="sd">        &quot;Escherichia coli&quot;: [&quot;Escherichia&quot;, &quot;Bacteria&quot;, &quot;Organism&quot;],</span>
<span class="sd">        &quot;Pseudomonas&quot;: [&quot;Pseudomonas&quot;, &quot;Bacteria&quot;, &quot;Organism&quot;],</span>
<span class="sd">        &quot;Homo sapiens&quot;: [&quot;Homo&quot;, &quot;Mammalia&quot;, &quot;Animalia&quot;, &quot;Organism&quot;],</span>
<span class="sd">    }</span>
<span class="sd">    &lt;/pre&gt;</span>
<span class="sd">    this function would return</span>
<span class="sd">    &lt;pre&gt;</span>
<span class="sd">    {</span>
<span class="sd">        &quot;Escherichia coli&quot;: 0,</span>
<span class="sd">        &quot;Pseudomonas&quot;: 1,</span>
<span class="sd">        &quot;Homo sapiens&quot;: 2,</span>
<span class="sd">    }</span>
<span class="sd">    &lt;/pre&gt;</span>

<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">    * base_species: str ~ The species to which a relation is made.</span>
<span class="sd">    * taxonomy_dict: dict[str, list[str]] ~ A dictionary with organism names as keys and</span>
<span class="sd">      their taxonomic levels (sorted from nearest to farthest) as string list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_taxonomy</span> <span class="o">=</span> <span class="n">taxonomy_dict</span><span class="p">[</span><span class="n">base_species</span><span class="p">]</span>
    <span class="n">level_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">level</span><span class="p">,</span> <span class="n">taxonomic_level</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">base_taxonomy</span><span class="p">):</span>
        <span class="n">level_dict</span><span class="p">[</span><span class="n">taxonomic_level</span><span class="p">]</span> <span class="o">=</span> <span class="n">level</span>

    <span class="n">score_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">species</span><span class="p">,</span> <span class="n">taxonomic_levels</span> <span class="ow">in</span> <span class="n">taxonomy_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">taxonomic_level</span> <span class="ow">in</span> <span class="n">taxonomic_levels</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">taxonomic_level</span> <span class="ow">in</span> <span class="n">level_dict</span><span class="p">:</span>
                <span class="n">score_dict</span><span class="p">[</span><span class="n">species</span><span class="p">]</span> <span class="o">=</span> <span class="n">level_dict</span><span class="p">[</span><span class="n">taxonomic_level</span><span class="p">]</span>
                <span class="k">break</span>

    <span class="k">return</span> <span class="n">score_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.ncbi_taxonomy_functionality.parse_ncbi_taxonomy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_ncbi_taxonomy</span><span class="p">(</span><span class="n">ncbi_taxdmp_zipfile_path</span><span class="p">,</span> <span class="n">ncbi_parsed_json_path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parses NCBI taxonomy data from a taxdump zip file and saves it as a JSON file.</p>
<p>This function extracts the necessary files from the NCBI taxdump zip archive, parses the taxonomy data,
and writes the parsed data to a JSON file. The parsed data includes mappings from taxonomy numbers to names
and vice versa, as well as the taxonomy tree structure.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ncbi_taxdmp_zipfile_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file path to the NCBI taxdump zip archive.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ncbi_parsed_json_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file path where the parsed JSON data will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/ncbi_taxonomy_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">parse_ncbi_taxonomy</span><span class="p">(</span>
    <span class="n">ncbi_taxdmp_zipfile_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">ncbi_parsed_json_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses NCBI taxonomy data from a taxdump zip file and saves it as a JSON file.</span>

<span class="sd">    This function extracts the necessary files from the NCBI taxdump zip archive, parses the taxonomy data,</span>
<span class="sd">    and writes the parsed data to a JSON file. The parsed data includes mappings from taxonomy numbers to names</span>
<span class="sd">    and vice versa, as well as the taxonomy tree structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        ncbi_taxdmp_zipfile_path (str): The file path to the NCBI taxdump zip archive.</span>
<span class="sd">        ncbi_parsed_json_path (str): The file path where the parsed JSON data will be saved.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">old_wd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">folder</span> <span class="o">=</span> <span class="n">standardize_folder</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">ncbi_taxdmp_zipfile_path</span><span class="p">))</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">ncbi_taxdmp_zipfile_path</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">ZipFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zipfile</span><span class="p">:</span>
        <span class="n">zipfile</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s2">&quot;names.dmp&quot;</span><span class="p">)</span>
        <span class="n">zipfile</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s2">&quot;nodes.dmp&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;names.dmp&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">name_lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;nodes.dmp&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">node_lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;names.dmp&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;nodes.dmp&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">old_wd</span><span class="p">)</span>

    <span class="n">parsed_json_data</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">number_to_names_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">names_to_number_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">name_lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;scientific name&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">line</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;synonym&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">line</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">number</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">number</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">number_to_names_dict</span><span class="p">:</span>
            <span class="n">number_to_names_dict</span><span class="p">[</span><span class="n">number</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">number_to_names_dict</span><span class="p">[</span><span class="n">number</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">names_to_number_dict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">number</span>

    <span class="n">parsed_json_data</span><span class="p">[</span><span class="s2">&quot;number_to_names_dict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">number_to_names_dict</span>
    <span class="n">parsed_json_data</span><span class="p">[</span><span class="s2">&quot;names_to_number_dict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">names_to_number_dict</span>

    <span class="n">nodes_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">node_lines</span><span class="p">:</span>
        <span class="n">begin</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">begin</span> <span class="o">==</span> <span class="n">end</span><span class="p">:</span>
            <span class="n">nodes_dict</span><span class="p">[</span><span class="n">begin</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;END&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nodes_dict</span><span class="p">[</span><span class="n">begin</span><span class="p">]</span> <span class="o">=</span> <span class="n">end</span>
    <span class="n">parsed_json_data</span><span class="p">[</span><span class="s2">&quot;nodes_dict&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nodes_dict</span>
    <span class="n">json_zip_write</span><span class="p">(</span><span class="n">ncbi_parsed_json_path</span><span class="p">,</span> <span class="n">parsed_json_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.nlps" class="doc doc-heading">
            <code>nlps</code>


</h2>

    <div class="doc doc-contents ">

        <p>This file contains all non-linear programs (NLP) functions, including the evolutionary NLP optimization algorithm,
that can be used with COBRAk models.
With NLPs, all types of constraints (stoichiomnetric, enzymatic, , , , ...) can be integrated.
However, NLPs can be very slow.
For linear-programs (LP) and mixed-integer linear programs (MILP),
see lps.py in the same folder.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.nlps.add_loop_constraints_to_nlp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_loop_constraints_to_nlp</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Adds loop constraints to a non-linear program (NLP) model.</p>
<p>The loop constraints are of the nonlinear form v_fwd * v_rev = 0.0
for any forward/reverse pair of split reversible reactions.</p>
<p>Parameters
* <code>model</code> (<code>ConcreteModel</code>): The NLP model to add constraints to.
* <code>cobrak_model</code> (<code>Model</code>): The COBRAk model associated with the NLP model.</p>
<p>Returns
* <code>ConcreteModel</code>: The NLP model with added loop constraints.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/nlps.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_loop_constraints_to_nlp</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">ConcreteModel</span><span class="p">,</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConcreteModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds loop constraints to a non-linear program (NLP) model.</span>

<span class="sd">    The loop constraints are of the nonlinear form v_fwd * v_rev = 0.0</span>
<span class="sd">    for any forward/reverse pair of split reversible reactions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    * `model` (`ConcreteModel`): The NLP model to add constraints to.</span>
<span class="sd">    * `cobrak_model` (`Model`): The COBRAk model associated with the NLP model.</span>

<span class="sd">    Returns</span>
<span class="sd">    * `ConcreteModel`: The NLP model with added loop constraints.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model_var_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">component_objects</span><span class="p">(</span><span class="n">Var</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">other_reac_id</span> <span class="o">=</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">other_reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model_var_names</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="nb">setattr</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;loop_constraint_</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">Constraint</span><span class="p">(</span>
                <span class="n">rule</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">)</span> <span class="o">*</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">other_reac_id</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span>
            <span class="p">),</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.nlps.get_nlp_from_cobrak_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_nlp_from_cobrak_model</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">ignored_reacs</span><span class="o">=</span><span class="p">[],</span> <span class="n">with_kappa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_gamma</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_iota</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_alpha</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">approximation_value</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">irreversible_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">variability_data</span><span class="o">=</span><span class="p">{},</span> <span class="n">strict_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">single_strict_reacs</span><span class="o">=</span><span class="p">[],</span> <span class="n">irreversible_mode_min_mdf</span><span class="o">=</span><span class="n">STANDARD_MIN_MDF</span><span class="p">,</span> <span class="n">with_flux_sum_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">correction_config</span><span class="o">=</span><span class="n">CorrectionConfig</span><span class="p">())</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creates a pyomo non-linear program (NLP) model instance from a COBRAk Model.</p>
<p>For more, see COBRAk's NLP documentation chapter.</p>
<h4 id="cobrak.nlps.get_nlp_from_cobrak_model--parameters">Parameters</h4>
<ul>
<li><code>cobrak_model</code> (<code>Model</code>): The COBRAk model to create the NLP model from.</li>
<li><code>ignored_reacs</code> (<code>list[str]</code>, optional): List of reaction IDs to ignore. Defaults to <code>[]</code>.</li>
<li><code>with_kappa</code> (<code>bool</code>, optional): Whether to include  saturation term terms. Defaults to <code>True</code>.</li>
<li><code>with_gamma</code> (<code>bool</code>, optional): Whether to include  thermodynamic terms. Defaults to <code>True</code>.</li>
<li><code>with_iota</code> (<code>bool</code>, optional): Whether to include  inhibition terms. Defaults to <code>False</code> and untested!</li>
<li><code>with_alpha</code> (<code>bool</code>, optional): Whether to include  activation terms. Defaults to <code>False</code> and untested!</li>
<li><code>approximation_value</code> (<code>float</code>, optional): Approximation value for , , , and  terms. Defaults to <code>0.0001</code>. This value is the
   minimal value for , , , and  terms, and can lead to an overapproximation in this regard.</li>
<li><code>irreversible_mode</code> (<code>bool</code>, optional): Whether to use irreversible mode. Defaults to <code>False</code>.</li>
<li><code>variability_data</code> (<code>dict[str, tuple[float, float]]</code>, optional): Variability data for reactions. Defaults to <code>{}</code>.</li>
<li><code>strict_mode</code> (<code>bool</code>, optional): Whether to use strict mode (i.e. all &lt;= heuristics become == relations). Defaults to <code>False</code>.</li>
<li><code>single_strict_reacs</code> (<code>list[str]</code>, optional): If 'strict_mode==False', only reactions with an ID in this list are set to strict mode.</li>
<li><code>irreversible_mode_min_mdf</code> (<code>float</code>, optional): Minimum MDF value for irreversible mode. Defaults to <code>STANDARD_MIN_MDF</code>.</li>
<li><code>with_flux_sum_var</code> (<code>bool</code>, optional): Whether to include a flux sum variable of name <code>cobrak.constants.FLUX_SUM_VAR</code>. Defaults to <code>False</code>.</li>
<li><code>correction_config</code> (<code>CorrectionConfig</code>, optional): Parameter correction configuration. Defaults to <code>CorrectionConfig()</code>.</li>
</ul>
<h4 id="cobrak.nlps.get_nlp_from_cobrak_model--returns">Returns</h4>
<ul>
<li><code>ConcreteModel</code>: The created NLP model.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/nlps.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_nlp_from_cobrak_model</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">ignored_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">with_kappa</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_gamma</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_iota</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">with_alpha</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">approximation_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">,</span>
    <span class="n">irreversible_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">variability_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">strict_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">single_strict_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">irreversible_mode_min_mdf</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">STANDARD_MIN_MDF</span><span class="p">,</span>
    <span class="n">with_flux_sum_var</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">correction_config</span><span class="p">:</span> <span class="n">CorrectionConfig</span> <span class="o">=</span> <span class="n">CorrectionConfig</span><span class="p">(),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConcreteModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a pyomo non-linear program (NLP) model instance from a COBRAk Model.</span>

<span class="sd">    For more, see COBRAk&#39;s NLP documentation chapter.</span>

<span class="sd">    # Parameters</span>
<span class="sd">    * `cobrak_model` (`Model`): The COBRAk model to create the NLP model from.</span>
<span class="sd">    * `ignored_reacs` (`list[str]`, optional): List of reaction IDs to ignore. Defaults to `[]`.</span>
<span class="sd">    * `with_kappa` (`bool`, optional): Whether to include  saturation term terms. Defaults to `True`.</span>
<span class="sd">    * `with_gamma` (`bool`, optional): Whether to include  thermodynamic terms. Defaults to `True`.</span>
<span class="sd">    * `with_iota` (`bool`, optional): Whether to include  inhibition terms. Defaults to `False` and untested!</span>
<span class="sd">    * `with_alpha` (`bool`, optional): Whether to include  activation terms. Defaults to `False` and untested!</span>
<span class="sd">    * `approximation_value` (`float`, optional): Approximation value for , , , and  terms. Defaults to `0.0001`. This value is the</span>
<span class="sd">       minimal value for , , , and  terms, and can lead to an overapproximation in this regard.</span>
<span class="sd">    * `irreversible_mode` (`bool`, optional): Whether to use irreversible mode. Defaults to `False`.</span>
<span class="sd">    * `variability_data` (`dict[str, tuple[float, float]]`, optional): Variability data for reactions. Defaults to `{}`.</span>
<span class="sd">    * `strict_mode` (`bool`, optional): Whether to use strict mode (i.e. all &lt;= heuristics become == relations). Defaults to `False`.</span>
<span class="sd">    * `single_strict_reacs` (`list[str]`, optional): If &#39;strict_mode==False&#39;, only reactions with an ID in this list are set to strict mode.</span>
<span class="sd">    * `irreversible_mode_min_mdf` (`float`, optional): Minimum MDF value for irreversible mode. Defaults to `STANDARD_MIN_MDF`.</span>
<span class="sd">    * `with_flux_sum_var` (`bool`, optional): Whether to include a flux sum variable of name ```cobrak.constants.FLUX_SUM_VAR```. Defaults to `False`.</span>
<span class="sd">    * `correction_config` (`CorrectionConfig`, optional): Parameter correction configuration. Defaults to `CorrectionConfig()`.</span>

<span class="sd">    # Returns</span>
<span class="sd">    * `ConcreteModel`: The created NLP model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cobrak_model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>

    <span class="n">reac_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">enforced_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ignored_reacs</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">ignored_reacs</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">variability_data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reac_ids</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">min_flux</span> <span class="o">=</span> <span class="n">variability_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">min_flux</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">enforced_reacs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_REV&quot;</span><span class="p">):</span>
            <span class="n">other_id</span> <span class="o">=</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_REV&quot;</span><span class="p">,</span> <span class="s2">&quot;_FWD&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_FWD&quot;</span><span class="p">):</span>
            <span class="n">other_id</span> <span class="o">=</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_FWD&quot;</span><span class="p">,</span> <span class="s2">&quot;_REV&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">other_id</span> <span class="ow">in</span> <span class="n">reac_ids</span><span class="p">:</span>
            <span class="n">ignored_reacs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">other_id</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">get_lp_from_cobrak_model</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="o">=</span><span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">ignored_reacs</span><span class="o">=</span><span class="n">ignored_reacs</span><span class="p">,</span>
        <span class="n">with_enzyme_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">with_thermodynamic_constraints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">with_loop_constraints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">add_extra_linear_constraints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">with_flux_sum_var</span><span class="o">=</span><span class="n">with_flux_sum_var</span><span class="p">,</span>
        <span class="n">correction_config</span><span class="o">=</span><span class="n">CorrectionConfig</span><span class="p">(</span>
            <span class="n">add_kcat_times_e_error_term</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">add_kcat_times_e_error_term</span><span class="p">,</span>
            <span class="n">kcat_times_e_error_cutoff</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">kcat_times_e_error_cutoff</span><span class="p">,</span>
            <span class="n">max_rel_kcat_times_e_correction</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">max_rel_kcat_times_e_correction</span><span class="p">,</span>
            <span class="n">add_error_sum_term</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">_add_concentration_vars_and_constraints</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">correction_config</span><span class="o">.</span><span class="n">add_kcat_times_e_error_term</span><span class="p">:</span>
        <span class="n">model_vars</span> <span class="o">=</span> <span class="n">get_model_var_names</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">correction_config</span><span class="o">.</span><span class="n">add_km_error_term</span><span class="p">:</span>
        <span class="n">kms_lowbound</span><span class="p">,</span> <span class="n">kms_highbound</span> <span class="o">=</span> <span class="n">_get_km_bounds</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="p">,</span> <span class="n">correction_config</span><span class="o">.</span><span class="n">km_error_cutoff</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kms_lowbound</span><span class="p">,</span> <span class="n">kms_highbound</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>

    <span class="k">if</span> <span class="n">correction_config</span><span class="o">.</span><span class="n">add_dG0_error_term</span><span class="p">:</span>
        <span class="n">dG0_highbound</span> <span class="o">=</span> <span class="n">_get_dG0_highbound</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="p">,</span> <span class="n">correction_config</span><span class="o">.</span><span class="n">dG0_error_cutoff</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dG0_highbound</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="nb">setattr</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span>
        <span class="n">MDF_VAR_ID</span><span class="p">,</span>
        <span class="n">Var</span><span class="p">(</span><span class="n">within</span><span class="o">=</span><span class="n">Reals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="n">irreversible_mode_min_mdf</span><span class="p">,</span> <span class="mi">1_000_000</span><span class="p">)),</span>
    <span class="p">)</span>
    <span class="c1"># Set &quot;MM&quot; constraints</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">irreversible_mode</span><span class="p">:</span>
        <span class="n">reaction_couples</span> <span class="o">=</span> <span class="n">get_stoichiometrically_coupled_reactions</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="o">=</span><span class="n">cobrak_model</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">reac_id_to_reac_couple_id</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">couple</span> <span class="ow">in</span> <span class="n">reaction_couples</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">couple</span><span class="p">:</span>
                <span class="n">reac_id_to_reac_couple_id</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">couple</span><span class="p">)</span>
        <span class="n">created_z_vars</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">with_alpha</span> <span class="ow">or</span> <span class="n">with_iota</span><span class="p">:</span>
        <span class="n">model_var_names</span> <span class="o">=</span> <span class="n">get_model_var_names</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">ignored_reacs</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">f_var_name</span> <span class="o">=</span> <span class="n">_add_df_and_dG0_var_for_reaction</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="n">reac_id</span><span class="p">,</span>
                <span class="n">reaction</span><span class="p">,</span>
                <span class="n">cobrak_model</span><span class="p">,</span>
                <span class="n">strict_df_equality</span><span class="o">=</span><span class="n">strict_mode</span> <span class="ow">or</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">single_strict_reacs</span><span class="p">,</span>
                <span class="n">add_error_term</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">add_dG0_error_term</span>
                <span class="ow">and</span> <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="o">&gt;=</span> <span class="n">dG0_highbound</span><span class="p">),</span>
                <span class="n">max_abs_dG0_correction</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">max_abs_dG0_correction</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="n">irreversible_mode</span>
                <span class="ow">and</span> <span class="n">variability_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span>
                <span class="ow">and</span> <span class="n">variability_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span>
            <span class="p">):</span>
                <span class="n">z_varname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Z_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id_to_reac_couple_id</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">z_varname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">created_z_vars</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">z_varname</span><span class="p">,</span> <span class="n">Var</span><span class="p">(</span><span class="n">within</span><span class="o">=</span><span class="n">Binary</span><span class="p">))</span>
                    <span class="n">created_z_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z_varname</span><span class="p">)</span>

                <span class="c1"># Big-M 0: r_i &lt;= lb * z_i</span>
                <span class="n">bigm_optmdfpathway_0_constraint</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">reac_id</span>
                <span class="p">)</span> <span class="o">&lt;=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">max_flux</span> <span class="o">*</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">z_varname</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;bigm_optmdfpathway_0_</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">bigm_optmdfpathway_0_constraint</span><span class="p">),</span>
                <span class="p">)</span>

                <span class="c1"># Big-M 1: f_i + (1-z_i) * M_i &gt;= var_B</span>
                <span class="n">bigm_optmdfpathway_1_constraint</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">f_var_name</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
                    <span class="mi">1</span> <span class="o">-</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">z_varname</span><span class="p">)</span>
                <span class="p">)</span> <span class="o">*</span> <span class="n">BIG_M</span> <span class="o">&gt;=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">MDF_VAR_ID</span><span class="p">)</span>

                <span class="nb">setattr</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;bigm_optmdfpathway_1_</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">bigm_optmdfpathway_1_constraint</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">variability_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">mdf_constraint</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">f_var_name</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">getattr</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">MDF_VAR_ID</span>
                <span class="p">)</span>

                <span class="nb">setattr</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;mdf_constraint_</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">mdf_constraint</span><span class="p">),</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Determine whether or not , ,  and  are possible to add to the reaction</span>
        <span class="c1"># given its current kinetic and thermodynamic data.</span>
        <span class="n">has_gamma</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">has_kappa</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">have_all_unignored_km</span><span class="p">(</span>
            <span class="n">reaction</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">kinetic_ignored_metabolites</span>
        <span class="p">):</span>
            <span class="n">has_kappa</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">has_gamma</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">has_kappa</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">has_gamma</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">has_iota</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_is</span> <span class="o">!=</span> <span class="p">{}</span>
        <span class="n">has_alpha</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_as</span> <span class="o">!=</span> <span class="p">{}</span>

        <span class="n">reac_full_enzyme_id</span> <span class="o">=</span> <span class="n">get_full_enzyme_id</span><span class="p">(</span>
            <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">reac_full_enzyme_id</span><span class="p">:</span>  <span class="c1"># E.g., in ATPM</span>
            <span class="k">continue</span>
        <span class="n">enzyme_var_id</span> <span class="o">=</span> <span class="n">get_reaction_enzyme_var_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)</span>

        <span class="c1"># V+</span>
        <span class="n">k_cat</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span>

        <span class="k">if</span> <span class="n">correction_config</span><span class="o">.</span><span class="n">add_kcat_times_e_error_term</span><span class="p">:</span>
            <span class="n">kcat_times_e_error_var_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ERROR_VAR_PREFIX</span><span class="si">}</span><span class="s2">_kcat_times_e_</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">kcat_times_e_error_var_id</span> <span class="ow">in</span> <span class="n">model_vars</span><span class="p">:</span>
                <span class="n">v_plus</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">enzyme_var_id</span><span class="p">)</span> <span class="o">*</span> <span class="n">k_cat</span> <span class="o">+</span> <span class="nb">getattr</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span> <span class="n">kcat_times_e_error_var_id</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v_plus</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">enzyme_var_id</span><span class="p">)</span> <span class="o">*</span> <span class="n">k_cat</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v_plus</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">enzyme_var_id</span><span class="p">)</span> <span class="o">*</span> <span class="n">k_cat</span>

        <span class="c1">#  (for solver stability, with a minimal value of 0.0001)</span>
        <span class="k">if</span> <span class="n">has_kappa</span> <span class="ow">and</span> <span class="n">with_kappa</span><span class="p">:</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">kappa_substrates_var_id</span><span class="p">,</span> <span class="n">kappa_products_var_id</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">_add_kappa_substrates_and_products_vars</span><span class="p">(</span>
                    <span class="n">model</span><span class="p">,</span>
                    <span class="n">reac_id</span><span class="p">,</span>
                    <span class="n">reaction</span><span class="p">,</span>
                    <span class="n">cobrak_model</span><span class="p">,</span>
                    <span class="n">strict_kappa_products_equality</span><span class="o">=</span><span class="n">strict_mode</span>
                    <span class="ow">or</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">single_strict_reacs</span><span class="p">,</span>
                    <span class="n">add_error_term</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">add_km_error_term</span><span class="p">,</span>
                    <span class="n">max_rel_km_correction</span><span class="o">=</span><span class="n">correction_config</span><span class="o">.</span><span class="n">max_rel_km_correction</span><span class="p">,</span>
                    <span class="n">kms_lowbound</span><span class="o">=</span><span class="n">kms_lowbound</span><span class="p">,</span>
                    <span class="n">kms_highbound</span><span class="o">=</span><span class="n">kms_highbound</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="n">kappa_var_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">KAPPA_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="n">kappa_var_id</span><span class="p">,</span>
                <span class="n">Var</span><span class="p">(</span><span class="n">within</span><span class="o">=</span><span class="n">Reals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="n">approximation_value</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)),</span>
            <span class="p">)</span>
            <span class="n">kappa_rhs</span> <span class="o">=</span> <span class="n">approximation_value</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">kappa_substrates_var_id</span><span class="p">)</span>
            <span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                <span class="mi">1</span>
                <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">kappa_substrates_var_id</span><span class="p">))</span>
                <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">kappa_products_var_id</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">strict_mode</span> <span class="ow">or</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">single_strict_reacs</span><span class="p">:</span>
                <span class="n">kappa_constraint</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">kappa_var_id</span><span class="p">)</span> <span class="o">==</span> <span class="n">kappa_rhs</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kappa_constraint</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">kappa_var_id</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">kappa_rhs</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;kappa_constraint_</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">kappa_constraint</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="c1">#  (for solver stability, with a minimal value of 0.0001)</span>
        <span class="k">if</span> <span class="n">has_gamma</span> <span class="ow">and</span> <span class="n">with_gamma</span><span class="p">:</span>
            <span class="n">gamma_var_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">GAMMA_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">min_gamma_value</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">approximation_value</span> <span class="k">if</span> <span class="n">irreversible_mode</span> <span class="k">else</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="n">gamma_var_name</span><span class="p">,</span>
                <span class="n">Var</span><span class="p">(</span><span class="n">within</span><span class="o">=</span><span class="n">Reals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="n">min_gamma_value</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)),</span>
            <span class="p">)</span>
            <span class="n">f_by_RT</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">f_var_name</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">irreversible_mode</span><span class="p">:</span>
                <span class="n">gamma_rhs</span> <span class="o">=</span> <span class="n">approximation_value</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">f_by_RT</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">gamma_rhs</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">approximation_value</span>
                    <span class="o">+</span> <span class="p">(</span>
                        <span class="mi">1</span>
                        <span class="o">-</span> <span class="n">exp</span><span class="p">(</span>
                            <span class="o">-</span><span class="n">f_by_RT</span>
                        <span class="p">)</span>  <span class="c1"># * getattr(model, f&quot;{Z_VAR_PREFIX}{reac_id_to_reac_couple_id[reac_id]}&quot;)</span>
                    <span class="p">)</span>
                <span class="p">)</span>  <span class="c1"># (f_by_RT**2) / (1 + (f_by_RT**2)) would be a rough approximation</span>

            <span class="k">if</span> <span class="n">strict_mode</span> <span class="ow">or</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">single_strict_reacs</span><span class="p">:</span>
                <span class="n">gamma_var_constraint_0</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">gamma_var_name</span><span class="p">)</span> <span class="o">==</span> <span class="n">gamma_rhs</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">gamma_var_constraint_0</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">gamma_var_name</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">gamma_rhs</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;gamma_var_constraint_</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">_0&quot;</span><span class="p">,</span>
                <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">gamma_var_constraint_0</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="c1">#  (for solver stability, with a minimal value of 0.0001)</span>
        <span class="k">if</span> <span class="n">with_iota</span> <span class="ow">and</span> <span class="n">has_iota</span><span class="p">:</span>
            <span class="n">iota_product</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">k_i</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_is</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">kinetic_ignored_metabolites</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">var_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">LNCONC_VAR_PREFIX</span><span class="si">}{</span><span class="n">met_id</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model_var_names</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">stoichiometry</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span>
                    <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">met_id</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
                <span class="p">)</span> <span class="o">*</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="o">.</span><span class="n">iota</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="n">met_id</span><span class="p">,</span> <span class="mf">1.0</span>
                <span class="p">)</span>
                <span class="n">term_without_error</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">correction_config</span><span class="o">.</span><span class="n">add_ki_error_term</span>
                <span class="p">):</span>  <span class="c1"># Error term to make k_I *higher*</span>
                    <span class="n">all_kis</span> <span class="o">=</span> <span class="n">get_model_kis</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="n">k_i</span>
                        <span class="o">&lt;</span> <span class="n">all_kis</span><span class="p">[</span>
                            <span class="p">:</span> <span class="n">ceil</span><span class="p">(</span><span class="n">correction_config</span><span class="o">.</span><span class="n">ki_error_cutoff</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_kis</span><span class="p">))</span>
                        <span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="p">):</span>
                        <span class="n">term_without_error</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="n">ki_error_var</span> <span class="o">=</span> <span class="nb">setattr</span><span class="p">(</span>
                            <span class="n">model</span><span class="p">,</span>
                            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ERROR_VAR_PREFIX</span><span class="si">}</span><span class="s2">____</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">____</span><span class="si">{</span><span class="n">met_id</span><span class="si">}</span><span class="s2">____iota&quot;</span><span class="p">,</span>
                            <span class="n">Var</span><span class="p">(</span>
                                <span class="n">within</span><span class="o">=</span><span class="n">Reals</span><span class="p">,</span>
                                <span class="n">bounds</span><span class="o">=</span><span class="p">(</span>
                                    <span class="mf">0.0</span><span class="p">,</span>
                                    <span class="n">log</span><span class="p">(</span><span class="n">correction_config</span><span class="o">.</span><span class="n">max_rel_ki_correction</span> <span class="o">*</span> <span class="n">k_i</span><span class="p">),</span>
                                <span class="p">),</span>
                            <span class="p">),</span>
                        <span class="p">)</span>
                        <span class="n">iota_product</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span>
                            <span class="mi">1</span>
                            <span class="o">+</span> <span class="n">exp</span><span class="p">(</span>
                                <span class="n">stoichiometry</span> <span class="o">*</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">var_id</span><span class="p">)</span>
                                <span class="o">-</span> <span class="n">stoichiometry</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">k_i</span><span class="p">)</span>
                                <span class="o">+</span> <span class="n">stoichiometry</span> <span class="o">*</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ki_error_var</span><span class="p">)</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                <span class="k">if</span> <span class="n">term_without_error</span><span class="p">:</span>
                    <span class="n">iota_product</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span>
                        <span class="mi">1</span>
                        <span class="o">+</span> <span class="n">exp</span><span class="p">(</span>
                            <span class="n">stoichiometry</span> <span class="o">*</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">var_id</span><span class="p">)</span>
                            <span class="o">-</span> <span class="n">stoichiometry</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">k_i</span><span class="p">)</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
            <span class="n">iota_var_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">IOTA_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="n">iota_var_name</span><span class="p">,</span>
                <span class="n">Var</span><span class="p">(</span><span class="n">within</span><span class="o">=</span><span class="n">Reals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="n">approximation_value</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">strict_mode</span> <span class="ow">or</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">single_strict_reacs</span><span class="p">:</span>
                <span class="n">iota_var_constraint_0</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">iota_var_name</span><span class="p">)</span> <span class="o">==</span> <span class="n">approximation_value</span> <span class="o">+</span> <span class="n">iota_product</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">iota_var_constraint_0</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">iota_var_name</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">approximation_value</span> <span class="o">+</span> <span class="n">iota_product</span>
                <span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;iota_var_constraint_</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">_0&quot;</span><span class="p">,</span>
                <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">iota_var_constraint_0</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">with_alpha</span> <span class="ow">and</span> <span class="n">has_alpha</span><span class="p">:</span>
            <span class="n">alpha_product</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">k_a</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_as</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">kinetic_ignored_metabolites</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">var_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">LNCONC_VAR_PREFIX</span><span class="si">}{</span><span class="n">met_id</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model_var_names</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">stoichiometry</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span>
                    <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">met_id</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
                <span class="p">)</span> <span class="o">*</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="n">met_id</span><span class="p">,</span> <span class="mf">1.0</span>
                <span class="p">)</span>

                <span class="n">term_without_error</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">correction_config</span><span class="o">.</span><span class="n">add_ki_error_term</span>
                <span class="p">):</span>  <span class="c1"># Error term to make k_A *lower*</span>
                    <span class="n">all_kas</span> <span class="o">=</span> <span class="n">get_model_kas</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="n">k_a</span>
                        <span class="o">&gt;</span> <span class="n">all_kas</span><span class="p">[</span>
                            <span class="n">floor</span><span class="p">(</span>
                                <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">correction_config</span><span class="o">.</span><span class="n">ka_error_cutoff</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_kas</span><span class="p">)</span>
                            <span class="p">)</span> <span class="p">:</span>
                        <span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="p">):</span>
                        <span class="n">term_without_error</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="n">ka_error_var</span> <span class="o">=</span> <span class="nb">setattr</span><span class="p">(</span>
                            <span class="n">model</span><span class="p">,</span>
                            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ERROR_VAR_PREFIX</span><span class="si">}</span><span class="s2">____</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">____</span><span class="si">{</span><span class="n">met_id</span><span class="si">}</span><span class="s2">____alpha&quot;</span><span class="p">,</span>
                            <span class="n">Var</span><span class="p">(</span>
                                <span class="n">within</span><span class="o">=</span><span class="n">Reals</span><span class="p">,</span>
                                <span class="n">bounds</span><span class="o">=</span><span class="p">(</span>
                                    <span class="mf">0.0</span><span class="p">,</span>
                                    <span class="n">log</span><span class="p">(</span><span class="n">correction_config</span><span class="o">.</span><span class="n">max_rel_ki_correction</span> <span class="o">*</span> <span class="n">k_i</span><span class="p">),</span>
                                <span class="p">),</span>
                            <span class="p">),</span>
                        <span class="p">)</span>
                        <span class="n">iota_product</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span>
                            <span class="mi">1</span>
                            <span class="o">+</span> <span class="n">exp</span><span class="p">(</span>
                                <span class="n">stoichiometry</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">k_a</span><span class="p">)</span>
                                <span class="o">-</span> <span class="n">stoichiometry</span> <span class="o">*</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">var_id</span><span class="p">)</span>
                                <span class="o">-</span> <span class="n">stoichiometry</span> <span class="o">*</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ka_error_var</span><span class="p">)</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                <span class="k">if</span> <span class="n">term_without_error</span><span class="p">:</span>
                    <span class="n">alpha_product</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span>
                        <span class="mi">1</span>
                        <span class="o">+</span> <span class="n">exp</span><span class="p">(</span>
                            <span class="n">stoichiometry</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">k_a</span><span class="p">)</span>
                            <span class="o">-</span> <span class="n">stoichiometry</span> <span class="o">*</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">var_id</span><span class="p">)</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

            <span class="n">alpha_var_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ALPHA_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="n">alpha_var_name</span><span class="p">,</span>
                <span class="n">Var</span><span class="p">(</span><span class="n">within</span><span class="o">=</span><span class="n">Reals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="n">approximation_value</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)),</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">strict_mode</span> <span class="ow">or</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">single_strict_reacs</span><span class="p">:</span>
                <span class="n">alpha_var_constraint_0</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">alpha_var_name</span><span class="p">)</span>
                    <span class="o">==</span> <span class="n">approximation_value</span> <span class="o">+</span> <span class="n">alpha_product</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">alpha_var_constraint_0</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">alpha_var_name</span><span class="p">)</span>
                    <span class="o">&lt;=</span> <span class="n">approximation_value</span> <span class="o">+</span> <span class="n">alpha_product</span>
                <span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;alpha_var_constraint_</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">_0&quot;</span><span class="p">,</span>
                <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">alpha_var_constraint_0</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="c1"># Build kinetic term for reaction according to included parts</span>
        <span class="n">kinetic_rhs</span> <span class="o">=</span> <span class="n">v_plus</span>
        <span class="k">if</span> <span class="n">has_kappa</span> <span class="ow">and</span> <span class="n">with_kappa</span><span class="p">:</span>
            <span class="n">kinetic_rhs</span> <span class="o">*=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">kappa_var_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">has_gamma</span> <span class="ow">and</span> <span class="n">with_gamma</span><span class="p">:</span>
            <span class="n">kinetic_rhs</span> <span class="o">*=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">gamma_var_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">has_iota</span> <span class="ow">and</span> <span class="n">with_iota</span><span class="p">:</span>
            <span class="n">kinetic_rhs</span> <span class="o">*=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">iota_var_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">has_alpha</span> <span class="ow">and</span> <span class="n">with_alpha</span><span class="p">:</span>
            <span class="n">kinetic_rhs</span> <span class="o">*=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">alpha_var_name</span><span class="p">)</span>

        <span class="c1"># Apply strict mode</span>
        <span class="k">if</span> <span class="n">strict_mode</span> <span class="ow">or</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">single_strict_reacs</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;full_reac_constraint_</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">)</span> <span class="o">==</span> <span class="n">kinetic_rhs</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;full_reac_constraint_</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">kinetic_rhs</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">_add_extra_watches_and_constraints_to_lp</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="p">,</span> <span class="n">ignore_nonlinear_terms</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">is_any_error_term_active</span><span class="p">(</span><span class="n">correction_config</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">correction_config</span><span class="o">.</span><span class="n">error_scenario</span> <span class="o">!=</span> <span class="p">{}:</span>
            <span class="n">_apply_error_scenario</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="n">cobrak_model</span><span class="p">,</span>
                <span class="n">correction_config</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">correction_config</span><span class="o">.</span><span class="n">add_error_sum_term</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">_add_error_sum_to_model</span><span class="p">(</span>
                <span class="n">model</span><span class="p">,</span>
                <span class="n">cobrak_model</span><span class="p">,</span>
                <span class="n">correction_config</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="c1">########################</span>
    <span class="k">if</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">max_conc_sum</span> <span class="o">&lt;</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">):</span>
        <span class="n">met_sum_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">get_model_var_names</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">var_id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">LNCONC_VAR_PREFIX</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span>
                <span class="n">var_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">conc_sum_include_suffixes</span>
            <span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
                <span class="n">var_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">LNCONC_VAR_PREFIX</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">conc_sum_ignore_prefixes</span>
            <span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">met_sum_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var_id</span><span class="p">)</span>

        <span class="n">conc_sum_expr</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">met_sum_id</span> <span class="ow">in</span> <span class="n">met_sum_ids</span><span class="p">:</span>
            <span class="n">met_id</span> <span class="o">=</span> <span class="n">met_sum_id</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">LNCONC_VAR_PREFIX</span><span class="p">)</span> <span class="p">:]</span>
            <span class="c1"># exp_var_id = f&quot;expvar_{met_sum_id}&quot;</span>
            <span class="c1"># setattr(model, exp_var_id, Var(within=Reals, bounds=(1e-5, 1e6)),)</span>
            <span class="c1"># setattr(</span>
            <span class="c1">#     model,</span>
            <span class="c1">#     f&quot;expvarconstraint_{met_sum_id}&quot;,</span>
            <span class="c1">#     Constraint(rule=getattr(model, exp_var_id) &gt;= getattr(model, met_sum_id)),</span>
            <span class="c1"># )</span>
            <span class="n">conc_sum_expr</span> <span class="o">+=</span> <span class="n">exp</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">met_sum_id</span><span class="p">))</span>
        <span class="nb">setattr</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span>
            <span class="s2">&quot;met_sum_var&quot;</span><span class="p">,</span>
            <span class="n">Var</span><span class="p">(</span><span class="n">within</span><span class="o">=</span><span class="n">Reals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">max_conc_sum</span><span class="p">)),</span>
        <span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span>
            <span class="s2">&quot;met_sum_constraint&quot;</span><span class="p">,</span>
            <span class="n">Constraint</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="n">conc_sum_expr</span> <span class="o">&lt;=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;met_sum_var&quot;</span><span class="p">)),</span>
        <span class="p">)</span>
    <span class="c1">################</span>

    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.nlps.perform_nlp_irreversible_optimization" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">perform_nlp_irreversible_optimization</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">objective_target</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">,</span> <span class="n">with_kappa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_gamma</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_iota</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_alpha</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">approximation_value</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">strict_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">single_strict_reacs</span><span class="o">=</span><span class="p">[],</span> <span class="n">min_mdf</span><span class="o">=</span><span class="n">STANDARD_MIN_MDF</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">IPOPT</span><span class="p">,</span> <span class="n">min_flux</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">with_flux_sum_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">correction_config</span><span class="o">=</span><span class="n">CorrectionConfig</span><span class="p">(),</span> <span class="n">var_data_abs_epsilon</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Performs an irreversible non-linear program (NLP) optimization on a COBRAk model.</p>
<p>For more about the NLP, see the COBRAk documentation's NLP chapter.</p>
<h4 id="cobrak.nlps.perform_nlp_irreversible_optimization--parameters">Parameters</h4>
<ul>
<li><code>cobrak_model</code> (<code>Model</code>): The COBRAk model to optimize.</li>
<li><code>objective_target</code> (<code>str | dict[str, float]</code>): The objective target (reaction ID or dictionary of reaction IDs and coefficients).</li>
<li><code>objective_sense</code> (<code>int</code>): The objective sense (1 for maximization, -1 for minimization).</li>
<li><code>variability_dict</code> (<code>dict[str, tuple[float, float]]</code>): Dictionary of reaction IDs and their variability (lower and upper bounds).</li>
<li><code>with_kappa</code> (<code>bool</code>, optional): Whether to include  saturation terms. Defaults to <code>True</code>.</li>
<li><code>with_gamma</code> (<code>bool</code>, optional): Whether to include  thermodynamic terms. Defaults to <code>True</code>.</li>
<li><code>with_iota</code> (<code>bool</code>, optional): Whether to include  inhibition terms. Defaults to <code>False</code> and untested!</li>
<li><code>with_alpha</code> (<code>bool</code>, optional): Whether to include  activation terms. Defaults to <code>False</code> and untested!</li>
<li><code>approximation_value</code> (<code>float</code>, optional): Approximation value for , , , and  terms. Defaults to <code>0.0001</code>. This value is the
   minimal value for , , , and  terms, and can lead to an overapproximation in this regard.</li>
<li><code>verbose</code> (<code>bool</code>, optional): Whether to print solver output. Defaults to <code>False</code>.</li>
<li><code>strict_mode</code> (<code>bool</code>, optional): Whether to use strict mode (i.e. all &lt;= heuristics become == relations). Defaults to <code>False</code>.</li>
<li><code>single_strict_reacs</code> (<code>list[str]</code>, optional): If 'strict_mode==False', only reactions with an ID in this list are set to strict mode.</li>
<li><code>min_mdf</code> (<code>float</code>, optional): Minimum MDF value. Defaults to <code>STANDARD_MIN_MDF</code>.</li>
<li><code>solver_name</code> (Solver, optional): Used NLP solver. Defaults to IPOPT.</li>
<li><code>min_flux</code> (<code>float</code>, optional): Minimum flux value. Defaults to <code>0.0</code>.</li>
<li><code>with_flux_sum_var</code> (<code>bool</code>, optional): Whether to include a reaction flux sum variable of name <code>cobrak.constants.FLUX_SUM_VAR</code>. Defaults to <code>False</code>.</li>
<li><code>correction_config</code> (<code>CorrectionConfig</code>, optional): Parameter correction configuration. Defaults to <code>CorrectionConfig()</code>.</li>
<li>var_data_abs_epsilon: (<code>float</code>, optional): Under this value, any data given by the variability dict is considered to be 0. Defaults to 1e-5.</li>
</ul>
<h4 id="cobrak.nlps.perform_nlp_irreversible_optimization--returns">Returns</h4>
<ul>
<li><code>dict[str, float]</code>: The optimization results.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/nlps.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">perform_nlp_irreversible_optimization</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">objective_target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">with_kappa</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_gamma</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_iota</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">with_alpha</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">approximation_value</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">strict_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">single_strict_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">min_mdf</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">STANDARD_MIN_MDF</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">IPOPT</span><span class="p">,</span>
    <span class="n">min_flux</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">with_flux_sum_var</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">correction_config</span><span class="p">:</span> <span class="n">CorrectionConfig</span> <span class="o">=</span> <span class="n">CorrectionConfig</span><span class="p">(),</span>
    <span class="n">var_data_abs_epsilon</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs an irreversible non-linear program (NLP) optimization on a COBRAk model.</span>

<span class="sd">    For more about the NLP, see the COBRAk documentation&#39;s NLP chapter.</span>

<span class="sd">    # Parameters</span>
<span class="sd">    * `cobrak_model` (`Model`): The COBRAk model to optimize.</span>
<span class="sd">    * `objective_target` (`str | dict[str, float]`): The objective target (reaction ID or dictionary of reaction IDs and coefficients).</span>
<span class="sd">    * `objective_sense` (`int`): The objective sense (1 for maximization, -1 for minimization).</span>
<span class="sd">    * `variability_dict` (`dict[str, tuple[float, float]]`): Dictionary of reaction IDs and their variability (lower and upper bounds).</span>
<span class="sd">    * `with_kappa` (`bool`, optional): Whether to include  saturation terms. Defaults to `True`.</span>
<span class="sd">    * `with_gamma` (`bool`, optional): Whether to include  thermodynamic terms. Defaults to `True`.</span>
<span class="sd">    * `with_iota` (`bool`, optional): Whether to include  inhibition terms. Defaults to `False` and untested!</span>
<span class="sd">    * `with_alpha` (`bool`, optional): Whether to include  activation terms. Defaults to `False` and untested!</span>
<span class="sd">    * `approximation_value` (`float`, optional): Approximation value for , , , and  terms. Defaults to `0.0001`. This value is the</span>
<span class="sd">       minimal value for , , , and  terms, and can lead to an overapproximation in this regard.</span>
<span class="sd">    * `verbose` (`bool`, optional): Whether to print solver output. Defaults to `False`.</span>
<span class="sd">    * `strict_mode` (`bool`, optional): Whether to use strict mode (i.e. all &lt;= heuristics become == relations). Defaults to `False`.</span>
<span class="sd">    * `single_strict_reacs` (`list[str]`, optional): If &#39;strict_mode==False&#39;, only reactions with an ID in this list are set to strict mode.</span>
<span class="sd">    * `min_mdf` (`float`, optional): Minimum MDF value. Defaults to `STANDARD_MIN_MDF`.</span>
<span class="sd">    * `solver_name` (Solver, optional): Used NLP solver. Defaults to IPOPT.</span>
<span class="sd">    * `min_flux` (`float`, optional): Minimum flux value. Defaults to `0.0`.</span>
<span class="sd">    * `with_flux_sum_var` (`bool`, optional): Whether to include a reaction flux sum variable of name ```cobrak.constants.FLUX_SUM_VAR```. Defaults to `False`.</span>
<span class="sd">    * `correction_config` (`CorrectionConfig`, optional): Parameter correction configuration. Defaults to `CorrectionConfig()`.</span>
<span class="sd">    *  var_data_abs_epsilon: (`float`, optional): Under this value, any data given by the variability dict is considered to be 0. Defaults to 1e-5.</span>

<span class="sd">    # Returns</span>
<span class="sd">    * `dict[str, float]`: The optimization results.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nlp_model</span> <span class="o">=</span> <span class="n">get_nlp_from_cobrak_model</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">with_kappa</span><span class="o">=</span><span class="n">with_kappa</span><span class="p">,</span>
        <span class="n">with_gamma</span><span class="o">=</span><span class="n">with_gamma</span><span class="p">,</span>
        <span class="n">with_iota</span><span class="o">=</span><span class="n">with_iota</span><span class="p">,</span>
        <span class="n">with_alpha</span><span class="o">=</span><span class="n">with_alpha</span><span class="p">,</span>
        <span class="n">approximation_value</span><span class="o">=</span><span class="n">approximation_value</span><span class="p">,</span>
        <span class="n">irreversible_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">variability_data</span><span class="o">=</span><span class="n">variability_dict</span><span class="p">,</span>
        <span class="n">strict_mode</span><span class="o">=</span><span class="n">strict_mode</span><span class="p">,</span>
        <span class="n">single_strict_reacs</span><span class="o">=</span><span class="n">single_strict_reacs</span><span class="p">,</span>
        <span class="n">irreversible_mode_min_mdf</span><span class="o">=</span><span class="n">min_mdf</span><span class="p">,</span>
        <span class="n">with_flux_sum_var</span><span class="o">=</span><span class="n">with_flux_sum_var</span><span class="p">,</span>
        <span class="n">correction_config</span><span class="o">=</span><span class="n">correction_config</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">variability_dict</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">variability_dict</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">min_flux</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">in</span> <span class="n">variability_dict</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">variability_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span><span class="n">variability_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_flux</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">variability_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">min_flux</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">nlp_model</span> <span class="o">=</span> <span class="n">apply_variability_dict</span><span class="p">(</span>
        <span class="n">nlp_model</span><span class="p">,</span>
        <span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">variability_dict</span><span class="p">,</span>
        <span class="n">correction_config</span><span class="o">.</span><span class="n">error_scenario</span><span class="p">,</span>
        <span class="n">var_data_abs_epsilon</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">nlp_model</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">get_objective</span><span class="p">(</span><span class="n">nlp_model</span><span class="p">,</span> <span class="n">objective_target</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">)</span>
    <span class="n">pyomo_solver</span> <span class="o">=</span> <span class="n">get_solver</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">solver_options</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">solver_attrs</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">pyomo_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">nlp_model</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="o">**</span><span class="n">solver</span><span class="o">.</span><span class="n">solve_extra_options</span><span class="p">)</span>
    <span class="n">mmtfba_dict</span> <span class="o">=</span> <span class="n">get_pyomo_solution_as_dict</span><span class="p">(</span><span class="n">nlp_model</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">add_statuses_to_optimziation_dict</span><span class="p">(</span><span class="n">mmtfba_dict</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.nlps.perform_nlp_irreversible_optimization_with_active_reacs_only" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">perform_nlp_irreversible_optimization_with_active_reacs_only</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">objective_target</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">optimization_dict</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">,</span> <span class="n">with_kappa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_gamma</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_iota</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_alpha</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">approximation_value</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">strict_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">single_strict_reacs</span><span class="o">=</span><span class="p">[],</span> <span class="n">min_mdf</span><span class="o">=</span><span class="n">STANDARD_MIN_MDF</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">IPOPT</span><span class="p">,</span> <span class="n">do_not_delete_with_z_var_one</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">correction_config</span><span class="o">=</span><span class="n">CorrectionConfig</span><span class="p">(),</span> <span class="n">var_data_abs_epsilon</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Performs an irreversible non-linear program (NLP) optimization on a COBRAk model, considering only active reactions of the optimization dict.</p>
<p>For more about the NLP, see the COBRAk documentation's NLP chapter.</p>
<h4 id="cobrak.nlps.perform_nlp_irreversible_optimization_with_active_reacs_only--parameters">Parameters</h4>
<ul>
<li><code>cobrak_model</code> (<code>Model</code>): The COBRAk model to optimize.</li>
<li><code>objective_target</code> (<code>str | dict[str, float]</code>): The objective target (reaction ID or dictionary of reaction IDs and coefficients).</li>
<li><code>objective_sense</code> (<code>int</code>): The objective sense (1 for maximization, -1 for minimization).</li>
<li><code>optimization_dict</code> (<code>dict[str, float]</code>): Dictionary of reaction IDs and their optimization values.</li>
<li><code>variability_dict</code> (<code>dict[str, tuple[float, float]]</code>): Dictionary of reaction IDs and their variability (lower and upper bounds).</li>
<li><code>with_kappa</code> (<code>bool</code>, optional): Whether to include  terms. Defaults to <code>True</code>.</li>
<li><code>with_gamma</code> (<code>bool</code>, optional): Whether to include  terms. Defaults to <code>True</code>.</li>
<li><code>with_iota</code> (<code>bool</code>, optional): Whether to include  inhibition terms. Defaults to <code>False</code> and untested!</li>
<li><code>with_alpha</code> (<code>bool</code>, optional): Whether to include  activation terms. Defaults to <code>False</code> and untested!</li>
<li><code>approximation_value</code> (<code>float</code>, optional): Approximation value for , , , and  terms. Defaults to <code>0.0001</code>. This value is the
   minimal value for , , , and  terms, and can lead to an overapproximation in this regard.</li>
<li><code>verbose</code> (<code>bool</code>, optional): Whether to print solver output. Defaults to <code>False</code>.</li>
<li><code>strict_mode</code> (<code>bool</code>, optional): Whether to use strict mode (i.e. all &lt;= heuristics become == relations). Defaults to <code>False</code>.</li>
<li><code>single_strict_reacs</code> (<code>list[str]</code>, optional): If 'strict_mode==False', only reactions with an ID in this list are set to strict mode.</li>
<li><code>min_mdf</code> (<code>float</code>, optional): Minimum MDF value. Defaults to <code>STANDARD_MIN_MDF</code>.</li>
<li><code>solver</code> (Solver, optional): Used NLP solver. Defaults to IPOPT.</li>
<li><code>do_not_delete_with_z_var_one</code> (<code>bool</code>, optional): Whether to delete reactions with associated Z variables (in the optimization dics) equal to one.
  Defaults to <code>False</code>.</li>
<li><code>correction_config</code> (<code>CorrectionConfig</code>, optional): Paramter correction configuration. Defaults to <code>CorrectionConfig()</code>.</li>
<li>var_data_abs_epsilon: (<code>float</code>, optional): Under this value, any data given by the variability dict is considered to be 0. Defaults to 1e-5.</li>
</ul>
<h4 id="cobrak.nlps.perform_nlp_irreversible_optimization_with_active_reacs_only--returns">Returns</h4>
<ul>
<li><code>dict[str, float]</code>: The optimization results.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/nlps.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">perform_nlp_irreversible_optimization_with_active_reacs_only</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">objective_target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">optimization_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">with_kappa</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_gamma</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_iota</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">with_alpha</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">approximation_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">strict_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">single_strict_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">min_mdf</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">STANDARD_MIN_MDF</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">IPOPT</span><span class="p">,</span>
    <span class="n">do_not_delete_with_z_var_one</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">correction_config</span><span class="p">:</span> <span class="n">CorrectionConfig</span> <span class="o">=</span> <span class="n">CorrectionConfig</span><span class="p">(),</span>
    <span class="n">var_data_abs_epsilon</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs an irreversible non-linear program (NLP) optimization on a COBRAk model, considering only active reactions of the optimization dict.</span>

<span class="sd">    For more about the NLP, see the COBRAk documentation&#39;s NLP chapter.</span>

<span class="sd">    # Parameters</span>
<span class="sd">    * `cobrak_model` (`Model`): The COBRAk model to optimize.</span>
<span class="sd">    * `objective_target` (`str | dict[str, float]`): The objective target (reaction ID or dictionary of reaction IDs and coefficients).</span>
<span class="sd">    * `objective_sense` (`int`): The objective sense (1 for maximization, -1 for minimization).</span>
<span class="sd">    * `optimization_dict` (`dict[str, float]`): Dictionary of reaction IDs and their optimization values.</span>
<span class="sd">    * `variability_dict` (`dict[str, tuple[float, float]]`): Dictionary of reaction IDs and their variability (lower and upper bounds).</span>
<span class="sd">    * `with_kappa` (`bool`, optional): Whether to include  terms. Defaults to `True`.</span>
<span class="sd">    * `with_gamma` (`bool`, optional): Whether to include  terms. Defaults to `True`.</span>
<span class="sd">    * `with_iota` (`bool`, optional): Whether to include  inhibition terms. Defaults to `False` and untested!</span>
<span class="sd">    * `with_alpha` (`bool`, optional): Whether to include  activation terms. Defaults to `False` and untested!</span>
<span class="sd">    * `approximation_value` (`float`, optional): Approximation value for , , , and  terms. Defaults to `0.0001`. This value is the</span>
<span class="sd">       minimal value for , , , and  terms, and can lead to an overapproximation in this regard.</span>
<span class="sd">    * `verbose` (`bool`, optional): Whether to print solver output. Defaults to `False`.</span>
<span class="sd">    * `strict_mode` (`bool`, optional): Whether to use strict mode (i.e. all &lt;= heuristics become == relations). Defaults to `False`.</span>
<span class="sd">    * `single_strict_reacs` (`list[str]`, optional): If &#39;strict_mode==False&#39;, only reactions with an ID in this list are set to strict mode.</span>
<span class="sd">    * `min_mdf` (`float`, optional): Minimum MDF value. Defaults to `STANDARD_MIN_MDF`.</span>
<span class="sd">    * `solver` (Solver, optional): Used NLP solver. Defaults to IPOPT.</span>
<span class="sd">    * `do_not_delete_with_z_var_one` (`bool`, optional): Whether to delete reactions with associated Z variables (in the optimization dics) equal to one.</span>
<span class="sd">      Defaults to `False`.</span>
<span class="sd">    * `correction_config` (`CorrectionConfig`, optional): Paramter correction configuration. Defaults to `CorrectionConfig()`.</span>
<span class="sd">    *  var_data_abs_epsilon: (`float`, optional): Under this value, any data given by the variability dict is considered to be 0. Defaults to 1e-5.</span>

<span class="sd">    # Returns</span>
<span class="sd">    * `dict[str, float]`: The optimization results.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">optimization_dict</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">optimization_dict</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">single_strict_reac</span> <span class="ow">in</span> <span class="n">single_strict_reacs</span><span class="p">:</span>
        <span class="n">optimization_dict</span><span class="p">[</span><span class="n">single_strict_reac</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">nlp_cobrak_model</span> <span class="o">=</span> <span class="n">delete_unused_reactions_in_optimization_dict</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="o">=</span><span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">optimization_dict</span><span class="o">=</span><span class="n">optimization_dict</span><span class="p">,</span>
        <span class="n">do_not_delete_with_z_var_one</span><span class="o">=</span><span class="n">do_not_delete_with_z_var_one</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">perform_nlp_irreversible_optimization</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="o">=</span><span class="n">nlp_cobrak_model</span><span class="p">,</span>
        <span class="n">objective_target</span><span class="o">=</span><span class="n">objective_target</span><span class="p">,</span>
        <span class="n">objective_sense</span><span class="o">=</span><span class="n">objective_sense</span><span class="p">,</span>
        <span class="n">variability_dict</span><span class="o">=</span><span class="n">variability_dict</span><span class="p">,</span>
        <span class="n">with_kappa</span><span class="o">=</span><span class="n">with_kappa</span><span class="p">,</span>
        <span class="n">with_gamma</span><span class="o">=</span><span class="n">with_gamma</span><span class="p">,</span>
        <span class="n">with_iota</span><span class="o">=</span><span class="n">with_iota</span><span class="p">,</span>
        <span class="n">with_alpha</span><span class="o">=</span><span class="n">with_alpha</span><span class="p">,</span>
        <span class="n">approximation_value</span><span class="o">=</span><span class="n">approximation_value</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="n">strict_mode</span><span class="o">=</span><span class="n">strict_mode</span><span class="p">,</span>
        <span class="n">single_strict_reacs</span><span class="o">=</span><span class="n">single_strict_reacs</span><span class="p">,</span>
        <span class="n">min_mdf</span><span class="o">=</span><span class="n">min_mdf</span><span class="p">,</span>
        <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span>
        <span class="n">correction_config</span><span class="o">=</span><span class="n">correction_config</span><span class="p">,</span>
        <span class="n">var_data_abs_epsilon</span><span class="o">=</span><span class="n">var_data_abs_epsilon</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.nlps.perform_nlp_irreversible_variability_analysis_with_active_reacs_only" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">perform_nlp_irreversible_variability_analysis_with_active_reacs_only</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">optimization_dict</span><span class="p">,</span> <span class="n">tfba_variability_dict</span><span class="p">,</span> <span class="n">with_kappa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_gamma</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_iota</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_alpha</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">active_reactions</span><span class="o">=</span><span class="p">[],</span> <span class="n">min_active_flux</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">calculate_reacs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">calculate_concs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">calculate_rest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">extra_tested_vars_max</span><span class="o">=</span><span class="p">[],</span> <span class="n">extra_tested_vars_min</span><span class="o">=</span><span class="p">[],</span> <span class="n">strict_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">single_strict_reacs</span><span class="o">=</span><span class="p">[],</span> <span class="n">min_mdf</span><span class="o">=</span><span class="n">STANDARD_MIN_MDF</span><span class="p">,</span> <span class="n">min_flux_cutoff</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">IPOPT</span><span class="p">,</span> <span class="n">do_not_delete_with_z_var_one</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">parallel_verbosity_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">approximation_value</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Performs an irreversible non-linear program (NLP) variability analysis on a COBRAk model, considering only active reactions.</p>
<p>This function calculates the minimum and maximum values of reaction fluxes, metabolite concentrations, and other variables in the model,
given a set of active reactions and a variability dictionary.
It uses a combination of NLP optimizations and parallel processing to efficiently compute the variability of the model.</p>
<h4 id="cobrak.nlps.perform_nlp_irreversible_variability_analysis_with_active_reacs_only--parameters">Parameters</h4>
<ul>
<li><code>cobrak_model</code> (<code>Model</code>): The COBRAk model to analyze.</li>
<li><code>optimization_dict</code> (<code>dict[str, float]</code>): Dictionary of reaction IDs and their optimization values.</li>
<li><code>tfba_variability_dict</code> (<code>dict[str, tuple[float, float]]</code>): Dictionary of reaction IDs and their TFBA variability (lower and upper bounds).</li>
<li><code>with_kappa</code> (<code>bool</code>, optional): Whether to include  saturation terms. Defaults to <code>True</code>.</li>
<li><code>with_gamma</code> (<code>bool</code>, optional): Whether to include  thermodynamic terms. Defaults to <code>True</code>.</li>
<li><code>with_iota</code> (<code>bool</code>, optional): Whether to include  inhibition terms. Defaults to <code>False</code> and untested!</li>
<li><code>with_alpha</code> (<code>bool</code>, optional): Whether to include  activation terms. Defaults to <code>False</code> and untested!</li>
<li><code>active_reactions</code> (<code>list[str]</code>, optional): List of active reaction IDs. Defaults to <code>[]</code>.</li>
<li><code>min_active_flux</code> (<code>float</code>, optional): Minimum flux value for active reactions. Defaults to <code>1e-5</code>.</li>
<li><code>calculate_reacs</code> (<code>bool</code>, optional): Whether to calculate reaction flux variability. Defaults to <code>True</code>.</li>
<li><code>calculate_concs</code> (<code>bool</code>, optional): Whether to calculate metabolite concentration variability. Defaults to <code>True</code>.</li>
<li><code>calculate_rest</code> (<code>bool</code>, optional): Whether to calculate variability of other variables (e.g., enzyme delivery, , ). Defaults to <code>True</code>.</li>
<li><code>strict_mode</code> (<code>bool</code>, optional): Whether to use strict mode (i.e. all &lt;= heuristics become == relations). Defaults to <code>False</code>.</li>
<li><code>single_strict_reacs</code> (<code>list[str]</code>, optional): If 'strict_mode==False', only reactions with an ID in this list are set to strict mode.</li>
<li><code>min_mdf</code> (<code>float</code>, optional): Minimum MDF value. Defaults to <code>STANDARD_MIN_MDF</code>.</li>
<li><code>min_flux_cutoff</code> (<code>float</code>, optional): Minimum flux cutoff value. Defaults to <code>1e-8</code>.</li>
<li><code>solver</code> (Solver, optional): Used NLP solver. Defaults to IPOPT.</li>
<li><code>do_not_delete_with_z_var_one</code> (<code>bool</code>, optional): Whether to delete reactions with Z variable equal to one. Defaults to <code>False</code>.</li>
<li><code>parallel_verbosity_level</code> (<code>int</code>, optional): Verbosity level for parallel processing. Defaults to <code>0</code>.</li>
<li><code>approximation_value</code> (<code>float</code>, optional): Approximation value for , , , and  terms. Defaults to <code>0.0001</code>. This value is the
   minimal value for , , , and  terms, and can lead to an overapproximation in this regard.</li>
</ul>
<h4 id="cobrak.nlps.perform_nlp_irreversible_variability_analysis_with_active_reacs_only--returns">Returns</h4>
<ul>
<li><code>dict[str, tuple[float, float]]</code>: A dictionary of variable IDs and their variability (lower and upper bounds).</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/nlps.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">perform_nlp_irreversible_variability_analysis_with_active_reacs_only</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">optimization_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">tfba_variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">with_kappa</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_gamma</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_iota</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">with_alpha</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">active_reactions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">min_active_flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
    <span class="n">calculate_reacs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">calculate_concs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">calculate_rest</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">extra_tested_vars_max</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">extra_tested_vars_min</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">strict_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">single_strict_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">min_mdf</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">STANDARD_MIN_MDF</span><span class="p">,</span>
    <span class="n">min_flux_cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">IPOPT</span><span class="p">,</span>
    <span class="n">do_not_delete_with_z_var_one</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">parallel_verbosity_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">approximation_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs an irreversible non-linear program (NLP) variability analysis on a COBRAk model, considering only active reactions.</span>

<span class="sd">    This function calculates the minimum and maximum values of reaction fluxes, metabolite concentrations, and other variables in the model,</span>
<span class="sd">    given a set of active reactions and a variability dictionary.</span>
<span class="sd">    It uses a combination of NLP optimizations and parallel processing to efficiently compute the variability of the model.</span>

<span class="sd">    # Parameters</span>
<span class="sd">    * `cobrak_model` (`Model`): The COBRAk model to analyze.</span>
<span class="sd">    * `optimization_dict` (`dict[str, float]`): Dictionary of reaction IDs and their optimization values.</span>
<span class="sd">    * `tfba_variability_dict` (`dict[str, tuple[float, float]]`): Dictionary of reaction IDs and their TFBA variability (lower and upper bounds).</span>
<span class="sd">    * `with_kappa` (`bool`, optional): Whether to include  saturation terms. Defaults to `True`.</span>
<span class="sd">    * `with_gamma` (`bool`, optional): Whether to include  thermodynamic terms. Defaults to `True`.</span>
<span class="sd">    * `with_iota` (`bool`, optional): Whether to include  inhibition terms. Defaults to `False` and untested!</span>
<span class="sd">    * `with_alpha` (`bool`, optional): Whether to include  activation terms. Defaults to `False` and untested!</span>
<span class="sd">    * `active_reactions` (`list[str]`, optional): List of active reaction IDs. Defaults to `[]`.</span>
<span class="sd">    * `min_active_flux` (`float`, optional): Minimum flux value for active reactions. Defaults to `1e-5`.</span>
<span class="sd">    * `calculate_reacs` (`bool`, optional): Whether to calculate reaction flux variability. Defaults to `True`.</span>
<span class="sd">    * `calculate_concs` (`bool`, optional): Whether to calculate metabolite concentration variability. Defaults to `True`.</span>
<span class="sd">    * `calculate_rest` (`bool`, optional): Whether to calculate variability of other variables (e.g., enzyme delivery, , ). Defaults to `True`.</span>
<span class="sd">    * `strict_mode` (`bool`, optional): Whether to use strict mode (i.e. all &lt;= heuristics become == relations). Defaults to `False`.</span>
<span class="sd">    * `single_strict_reacs` (`list[str]`, optional): If &#39;strict_mode==False&#39;, only reactions with an ID in this list are set to strict mode.</span>
<span class="sd">    * `min_mdf` (`float`, optional): Minimum MDF value. Defaults to `STANDARD_MIN_MDF`.</span>
<span class="sd">    * `min_flux_cutoff` (`float`, optional): Minimum flux cutoff value. Defaults to `1e-8`.</span>
<span class="sd">    * `solver` (Solver, optional): Used NLP solver. Defaults to IPOPT.</span>
<span class="sd">    * `do_not_delete_with_z_var_one` (`bool`, optional): Whether to delete reactions with Z variable equal to one. Defaults to `False`.</span>
<span class="sd">    * `parallel_verbosity_level` (`int`, optional): Verbosity level for parallel processing. Defaults to `0`.</span>
<span class="sd">    * `approximation_value` (`float`, optional): Approximation value for , , , and  terms. Defaults to `0.0001`. This value is the</span>
<span class="sd">       minimal value for , , , and  terms, and can lead to an overapproximation in this regard.</span>

<span class="sd">    # Returns</span>
<span class="sd">    * `dict[str, tuple[float, float]]`: A dictionary of variable IDs and their variability (lower and upper bounds).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cobrak_model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
    <span class="n">cobrak_model</span> <span class="o">=</span> <span class="n">delete_unused_reactions_in_optimization_dict</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="o">=</span><span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">optimization_dict</span><span class="o">=</span><span class="n">optimization_dict</span><span class="p">,</span>
        <span class="n">do_not_delete_with_z_var_one</span><span class="o">=</span><span class="n">do_not_delete_with_z_var_one</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">active_reaction</span> <span class="ow">in</span> <span class="n">active_reactions</span><span class="p">:</span>
        <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">active_reaction</span><span class="p">]</span><span class="o">.</span><span class="n">min_flux</span> <span class="o">=</span> <span class="n">min_active_flux</span>

    <span class="n">model</span><span class="p">:</span> <span class="n">ConcreteModel</span> <span class="o">=</span> <span class="n">get_nlp_from_cobrak_model</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">),</span>
        <span class="n">with_kappa</span><span class="o">=</span><span class="n">with_kappa</span><span class="p">,</span>
        <span class="n">with_gamma</span><span class="o">=</span><span class="n">with_gamma</span><span class="p">,</span>
        <span class="n">with_iota</span><span class="o">=</span><span class="n">with_iota</span><span class="p">,</span>
        <span class="n">with_alpha</span><span class="o">=</span><span class="n">with_alpha</span><span class="p">,</span>
        <span class="n">approximation_value</span><span class="o">=</span><span class="n">approximation_value</span><span class="p">,</span>
        <span class="n">variability_data</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tfba_variability_dict</span><span class="p">),</span>
        <span class="n">strict_mode</span><span class="o">=</span><span class="n">strict_mode</span><span class="p">,</span>
        <span class="n">irreversible_mode_min_mdf</span><span class="o">=</span><span class="n">min_mdf</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">model_var_names</span> <span class="o">=</span> <span class="n">get_model_var_names</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="n">min_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">max_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">objective_targets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    min_flux_sum_result = perform_nlp_irreversible_optimization(</span>
<span class="sd">        deepcopy(cobrak_model),</span>
<span class="sd">        objective_target=FLUX_SUM_VAR_ID,</span>
<span class="sd">        objective_sense=-1,</span>
<span class="sd">        with_kappa=with_kappa,</span>
<span class="sd">        with_gamma=with_gamma,</span>
<span class="sd">        with_iota=with_iota,</span>
<span class="sd">        with_alpha=with_alpha,</span>
<span class="sd">        approximation_value=approximation_value,</span>
<span class="sd">        variability_dict=deepcopy(tfba_variability_dict),</span>
<span class="sd">        strict_mode=strict_mode,</span>
<span class="sd">        min_mdf=min_mdf,</span>
<span class="sd">        with_flux_sum_var=True,</span>
<span class="sd">        solver=solver,</span>
<span class="sd">    )</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">calculate_concs</span> <span class="ow">or</span> <span class="n">calculate_rest</span><span class="p">:</span>
        <span class="n">min_mdf_result</span> <span class="o">=</span> <span class="n">perform_nlp_irreversible_optimization</span><span class="p">(</span>
            <span class="n">deepcopy</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">),</span>
            <span class="n">objective_target</span><span class="o">=</span><span class="n">MDF_VAR_ID</span><span class="p">,</span>
            <span class="n">objective_sense</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">with_kappa</span><span class="o">=</span><span class="n">with_kappa</span><span class="p">,</span>
            <span class="n">with_gamma</span><span class="o">=</span><span class="n">with_gamma</span><span class="p">,</span>
            <span class="n">with_iota</span><span class="o">=</span><span class="n">with_iota</span><span class="p">,</span>
            <span class="n">with_alpha</span><span class="o">=</span><span class="n">with_alpha</span><span class="p">,</span>
            <span class="n">approximation_value</span><span class="o">=</span><span class="n">approximation_value</span><span class="p">,</span>
            <span class="n">variability_dict</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tfba_variability_dict</span><span class="p">),</span>
            <span class="n">strict_mode</span><span class="o">=</span><span class="n">strict_mode</span><span class="p">,</span>
            <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">calculate_concs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">metabolite</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">met_var_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">LNCONC_VAR_PREFIX</span><span class="si">}{</span><span class="n">met_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">met_var_name</span> <span class="ow">in</span> <span class="n">model_var_names</span><span class="p">:</span>
                <span class="n">min_mdf_conc</span> <span class="o">=</span> <span class="n">min_mdf_result</span><span class="p">[</span><span class="n">met_var_name</span><span class="p">]</span>
                <span class="n">max_mdf_conc</span> <span class="o">=</span> <span class="n">min_mdf_result</span><span class="p">[</span><span class="n">met_var_name</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">log_min_conc</span> <span class="ow">in</span> <span class="p">(</span><span class="n">min_mdf_conc</span><span class="p">,</span> <span class="n">max_mdf_conc</span><span class="p">):</span>
                    <span class="n">min_values</span><span class="p">[</span><span class="n">met_var_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">log_min_conc</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">objective_targets</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">met_var_name</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">log_max_conc</span> <span class="ow">in</span> <span class="p">(</span><span class="n">min_mdf_conc</span><span class="p">,</span> <span class="n">max_mdf_conc</span><span class="p">):</span>
                    <span class="n">max_values</span><span class="p">[</span><span class="n">met_var_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">log_max_conc</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">objective_targets</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">met_var_name</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># min_flux_sum_flux = min_flux_sum_result[reac_id]</span>
        <span class="k">if</span> <span class="n">calculate_reacs</span><span class="p">:</span>
            <span class="c1"># if reaction.min_flux in (min_flux_sum_flux,):</span>
            <span class="c1">#    min_values[reac_id] = (</span>
            <span class="c1">#        reaction.min_flux if reaction.min_flux &gt;= min_flux_cutoff else 0.0</span>
            <span class="c1">#    )</span>
            <span class="c1"># else:</span>
            <span class="c1"># if reaction.max_flux in (min_flux_sum_flux,):</span>
            <span class="c1">#    max_values[reac_id] = reaction.max_flux</span>
            <span class="c1"># else:</span>
            <span class="n">objective_targets</span><span class="o">.</span><span class="n">extend</span><span class="p">(((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">),</span> <span class="p">(</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">)))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">calculate_rest</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">kappa_var_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">KAPPA_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">gamma_var_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">GAMMA_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">kappa_var_name</span> <span class="ow">in</span> <span class="n">model_var_names</span><span class="p">:</span>
            <span class="n">objective_targets</span><span class="o">.</span><span class="n">extend</span><span class="p">(((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kappa_var_name</span><span class="p">),</span> <span class="p">(</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">kappa_var_name</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">gamma_var_name</span> <span class="ow">in</span> <span class="n">model_var_names</span><span class="p">:</span>
            <span class="n">objective_targets</span><span class="o">.</span><span class="n">extend</span><span class="p">(((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">gamma_var_name</span><span class="p">),</span> <span class="p">(</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">gamma_var_name</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">full_enzyme_id</span> <span class="o">=</span> <span class="n">get_full_enzyme_id</span><span class="p">(</span>
                <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">full_enzyme_id</span><span class="p">:</span>
                <span class="n">enzyme_delivery_var_name</span> <span class="o">=</span> <span class="n">get_reaction_enzyme_var_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)</span>
                <span class="c1"># if 0.0 in (min_flux_sum_flux,):</span>
                <span class="c1">#    min_values[enzyme_delivery_var_name] = 0.0</span>
                <span class="c1"># else:</span>
                <span class="n">objective_targets</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">enzyme_delivery_var_name</span><span class="p">),</span> <span class="p">(</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">enzyme_delivery_var_name</span><span class="p">))</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">extra_tested_vars_min</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">extra_tested_var</span> <span class="ow">in</span> <span class="n">extra_tested_vars_max</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">extra_tested_var</span> <span class="ow">in</span> <span class="n">model_var_names</span><span class="p">:</span>
                <span class="n">objective_targets</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">extra_tested_var</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">extra_tested_vars_max</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">extra_tested_var</span> <span class="ow">in</span> <span class="n">extra_tested_vars_max</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">extra_tested_var</span> <span class="ow">in</span> <span class="n">model_var_names</span><span class="p">:</span>
                <span class="n">objective_targets</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">extra_tested_var</span><span class="p">))</span>

    <span class="n">objectives_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">obj_sense</span><span class="p">,</span> <span class="n">target_id</span> <span class="ow">in</span> <span class="n">objective_targets</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">obj_sense</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">objective_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;MIN_OBJ_</span><span class="si">{</span><span class="n">target_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">pyomo_sense</span> <span class="o">=</span> <span class="n">minimize</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">objective_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;MAX_OBJ_</span><span class="si">{</span><span class="n">target_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">pyomo_sense</span> <span class="o">=</span> <span class="n">maximize</span>
        <span class="nb">setattr</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span>
            <span class="n">objective_name</span><span class="p">,</span>
            <span class="n">Objective</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">target_id</span><span class="p">),</span> <span class="n">sense</span><span class="o">=</span><span class="n">pyomo_sense</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">objective_name</span><span class="p">)</span><span class="o">.</span><span class="n">deactivate</span><span class="p">()</span>
        <span class="n">objectives_data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">objective_name</span><span class="p">,</span> <span class="n">target_id</span><span class="p">))</span>

    <span class="n">objectives_data_batches</span> <span class="o">=</span> <span class="n">split_list</span><span class="p">(</span>
        <span class="n">objectives_data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">objectives_data</span><span class="p">)</span>
    <span class="p">)</span>  <span class="c1"># cpu_count())</span>

    <span class="n">results_list</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">parallel_verbosity_level</span><span class="p">)(</span>
        <span class="n">delayed</span><span class="p">(</span><span class="n">_batch_nlp_variability_optimization</span><span class="p">)(</span>
            <span class="n">batch</span><span class="p">,</span>
            <span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">with_kappa</span><span class="p">,</span>
            <span class="n">with_gamma</span><span class="p">,</span>
            <span class="n">with_iota</span><span class="p">,</span>
            <span class="n">with_alpha</span><span class="p">,</span>
            <span class="n">approximation_value</span><span class="p">,</span>
            <span class="n">tfba_variability_dict</span><span class="p">,</span>
            <span class="n">strict_mode</span><span class="p">,</span>
            <span class="n">single_strict_reacs</span><span class="p">,</span>
            <span class="n">min_mdf</span><span class="p">,</span>
            <span class="n">solver</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">objectives_data_batches</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">results_list</span><span class="p">):</span>
        <span class="n">is_minimization</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">target_id</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">result_value</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">is_minimization</span><span class="p">:</span>
            <span class="n">min_values</span><span class="p">[</span><span class="n">target_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">max_values</span><span class="p">[</span><span class="n">target_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_value</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">min_value</span> <span class="ow">in</span> <span class="n">min_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">ENZYME_VAR_PREFIX</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">min_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">min_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_value</span> <span class="k">if</span> <span class="n">min_value</span> <span class="o">&gt;=</span> <span class="n">min_flux_cutoff</span> <span class="k">else</span> <span class="mf">0.0</span>

    <span class="n">all_target_ids</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
        <span class="nb">set</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="n">min_values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">max_values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="o">+</span> <span class="p">[</span><span class="n">obj_target</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">obj_target</span> <span class="ow">in</span> <span class="n">objective_targets</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">all_target_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">objectives_data</span><span class="p">]</span>
    <span class="n">variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">target_id</span><span class="p">:</span> <span class="p">(</span><span class="n">min_values</span><span class="p">[</span><span class="n">target_id</span><span class="p">],</span> <span class="n">max_values</span><span class="p">[</span><span class="n">target_id</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">target_id</span> <span class="ow">in</span> <span class="n">all_target_ids</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">variability_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.nlps.perform_nlp_reversible_optimization" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">perform_nlp_reversible_optimization</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">objective_target</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">,</span> <span class="n">with_kappa</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_gamma</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_iota</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_alpha</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">approximation_value</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">strict_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">single_strict_reacs</span><span class="o">=</span><span class="p">[],</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">SCIP</span><span class="p">,</span> <span class="n">with_flux_sum_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">correction_config</span><span class="o">=</span><span class="n">CorrectionConfig</span><span class="p">(),</span> <span class="n">show_variable_count</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">var_data_abs_epsilon</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Performs a reversible MILP-based non-linear program (NLP) optimization on a COBRAk model.</p>
<p>For more on the MINLP, see the COBRAk documentation's NLP chapter.</p>
<h6 id="cobrak.nlps.perform_nlp_reversible_optimization--parameters">Parameters</h6>
<ul>
<li><code>cobrak_model</code> (<code>Model</code>): The COBRAk model to optimize.</li>
<li><code>objective_target</code> (<code>str | dict[str, float]</code>): The objective target (reaction ID or dictionary of reaction IDs and coefficients).</li>
<li><code>objective_sense</code> (<code>int</code>): The objective sense (1 for maximization, -1 for minimization).</li>
<li><code>variability_dict</code> (<code>dict[str, tuple[float, float]]</code>): Dictionary of reaction IDs and their variability (lower and upper bounds).</li>
<li><code>with_kappa</code> (<code>bool</code>, optional): Whether to include  saturation terms. Defaults to <code>True</code>.</li>
<li><code>with_gamma</code> (<code>bool</code>, optional): Whether to include  thermodynamic terms. Defaults to <code>True</code>.</li>
<li><code>with_iota</code> (<code>bool</code>, optional): Whether to include  inhibition terms. Defaults to <code>False</code> and untested!</li>
<li><code>with_alpha</code> (<code>bool</code>, optional): Whether to include  activation terms. Defaults to <code>False</code> and untested!</li>
<li><code>approximation_value</code> (<code>float</code>, optional): Approximation value for , , , and  terms. Defaults to <code>0.0001</code>. This value is the
   minimal value for , , , and  terms, and can lead to an overapproximation in this regard.</li>
<li><code>strict_mode</code> (<code>bool</code>, optional): Whether to use strict mode (i.e. all &lt;= heuristics become == relations). Defaults to <code>False</code>.</li>
<li><code>single_strict_reacs</code> (<code>list[str]</code>, optional): If 'strict_mode==False', only reactions with an ID in this list are set to strict mode.</li>
<li><code>verbose</code> (<code>bool</code>, optional): Whether to print solver output. Defaults to <code>False</code>.</li>
<li><code>solver_name</code> (<code>str</code>, optional): Used MINLP solver. Defaults to SCIP,</li>
<li><code>with_flux_sum_var</code> (<code>bool</code>, optional): Whether to include a reaction flux sum variable of name <code>cobrak.constants.FLUX_SUM_VAR</code>. Defaults to <code>False</code>.</li>
<li><code>correction_config</code> (<code>CorrectionConfig</code>, optional): Parameter correction configuration. Defaults to <code>CorrectionConfig()</code>.</li>
<li>var_data_abs_epsilon: (<code>float</code>, optional): Under this value, any data given by the variability dict is considered to be 0. Defaults to 1e-5.</li>
</ul>
<h6 id="cobrak.nlps.perform_nlp_reversible_optimization--returns">Returns</h6>
<ul>
<li><code>dict[str, float]</code>: The optimization results.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/nlps.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">perform_nlp_reversible_optimization</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">objective_target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">with_kappa</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_gamma</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">with_iota</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">with_alpha</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">approximation_value</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">=</span> <span class="mf">0.0001</span><span class="p">,</span>
    <span class="n">strict_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">single_strict_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">SCIP</span><span class="p">,</span>
    <span class="n">with_flux_sum_var</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">correction_config</span><span class="p">:</span> <span class="n">CorrectionConfig</span> <span class="o">=</span> <span class="n">CorrectionConfig</span><span class="p">(),</span>
    <span class="n">show_variable_count</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">var_data_abs_epsilon</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performs a reversible MILP-based non-linear program (NLP) optimization on a COBRAk model.</span>

<span class="sd">    For more on the MINLP, see the COBRAk documentation&#39;s NLP chapter.</span>

<span class="sd">    #### Parameters</span>
<span class="sd">    * `cobrak_model` (`Model`): The COBRAk model to optimize.</span>
<span class="sd">    * `objective_target` (`str | dict[str, float]`): The objective target (reaction ID or dictionary of reaction IDs and coefficients).</span>
<span class="sd">    * `objective_sense` (`int`): The objective sense (1 for maximization, -1 for minimization).</span>
<span class="sd">    * `variability_dict` (`dict[str, tuple[float, float]]`): Dictionary of reaction IDs and their variability (lower and upper bounds).</span>
<span class="sd">    * `with_kappa` (`bool`, optional): Whether to include  saturation terms. Defaults to `True`.</span>
<span class="sd">    * `with_gamma` (`bool`, optional): Whether to include  thermodynamic terms. Defaults to `True`.</span>
<span class="sd">    * `with_iota` (`bool`, optional): Whether to include  inhibition terms. Defaults to `False` and untested!</span>
<span class="sd">    * `with_alpha` (`bool`, optional): Whether to include  activation terms. Defaults to `False` and untested!</span>
<span class="sd">    * `approximation_value` (`float`, optional): Approximation value for , , , and  terms. Defaults to `0.0001`. This value is the</span>
<span class="sd">       minimal value for , , , and  terms, and can lead to an overapproximation in this regard.</span>
<span class="sd">    * `strict_mode` (`bool`, optional): Whether to use strict mode (i.e. all &lt;= heuristics become == relations). Defaults to `False`.</span>
<span class="sd">    * `single_strict_reacs` (`list[str]`, optional): If &#39;strict_mode==False&#39;, only reactions with an ID in this list are set to strict mode.</span>
<span class="sd">    * `verbose` (`bool`, optional): Whether to print solver output. Defaults to `False`.</span>
<span class="sd">    * `solver_name` (`str`, optional): Used MINLP solver. Defaults to SCIP,</span>
<span class="sd">    * `with_flux_sum_var` (`bool`, optional): Whether to include a reaction flux sum variable of name ```cobrak.constants.FLUX_SUM_VAR```. Defaults to `False`.</span>
<span class="sd">    * `correction_config` (`CorrectionConfig`, optional): Parameter correction configuration. Defaults to `CorrectionConfig()`.</span>
<span class="sd">    *  var_data_abs_epsilon: (`float`, optional): Under this value, any data given by the variability dict is considered to be 0. Defaults to 1e-5.</span>

<span class="sd">    #### Returns</span>
<span class="sd">    * `dict[str, float]`: The optimization results.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nlp_model</span> <span class="o">=</span> <span class="n">get_nlp_from_cobrak_model</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">with_kappa</span><span class="o">=</span><span class="n">with_kappa</span><span class="p">,</span>
        <span class="n">with_gamma</span><span class="o">=</span><span class="n">with_gamma</span><span class="p">,</span>
        <span class="n">with_iota</span><span class="o">=</span><span class="n">with_iota</span><span class="p">,</span>
        <span class="n">with_alpha</span><span class="o">=</span><span class="n">with_alpha</span><span class="p">,</span>
        <span class="n">approximation_value</span><span class="o">=</span><span class="n">approximation_value</span><span class="p">,</span>
        <span class="n">irreversible_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">variability_data</span><span class="o">=</span><span class="n">variability_dict</span><span class="p">,</span>
        <span class="n">strict_mode</span><span class="o">=</span><span class="n">strict_mode</span><span class="p">,</span>
        <span class="n">single_strict_reacs</span><span class="o">=</span><span class="n">single_strict_reacs</span><span class="p">,</span>
        <span class="n">with_flux_sum_var</span><span class="o">=</span><span class="n">with_flux_sum_var</span><span class="p">,</span>
        <span class="n">correction_config</span><span class="o">=</span><span class="n">correction_config</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">nlp_model</span> <span class="o">=</span> <span class="n">apply_variability_dict</span><span class="p">(</span>
        <span class="n">nlp_model</span><span class="p">,</span>
        <span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">variability_dict</span><span class="p">,</span>
        <span class="n">correction_config</span><span class="o">.</span><span class="n">error_scenario</span><span class="p">,</span>
        <span class="n">var_data_abs_epsilon</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">nlp_model</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">get_objective</span><span class="p">(</span><span class="n">nlp_model</span><span class="p">,</span> <span class="n">objective_target</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">)</span>
    <span class="n">pyomo_solver</span> <span class="o">=</span> <span class="n">get_solver</span><span class="p">(</span><span class="n">solver</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">solver_options</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">solver_attrs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_variable_count</span><span class="p">:</span>
        <span class="n">float_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">nlp_model</span><span class="o">.</span><span class="n">component_objects</span><span class="p">(</span><span class="n">Var</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">domain</span> <span class="o">==</span> <span class="n">Reals</span><span class="p">]</span>
        <span class="n">num_float_vars</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">float_vars</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v</span><span class="p">)</span>
        <span class="n">binary_vars</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">nlp_model</span><span class="o">.</span><span class="n">component_objects</span><span class="p">(</span><span class="n">Var</span><span class="p">)</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">domain</span> <span class="o">==</span> <span class="n">Binary</span>
        <span class="p">]</span>
        <span class="n">num_binary_vars</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">binary_vars</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">v</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# FLOAT VARS:&quot;</span><span class="p">,</span> <span class="n">num_float_vars</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# BINARY VARS:&quot;</span><span class="p">,</span> <span class="n">num_binary_vars</span><span class="p">)</span>

    <span class="n">results</span> <span class="o">=</span> <span class="n">pyomo_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">nlp_model</span><span class="p">,</span> <span class="n">tee</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="o">**</span><span class="n">solver</span><span class="o">.</span><span class="n">solve_extra_options</span><span class="p">)</span>

    <span class="n">nlp_result</span> <span class="o">=</span> <span class="n">get_pyomo_solution_as_dict</span><span class="p">(</span><span class="n">nlp_model</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">add_statuses_to_optimziation_dict</span><span class="p">(</span><span class="n">nlp_result</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.plotting" class="doc doc-heading">
            <code>plotting</code>


</h2>

    <div class="doc doc-contents ">

        <p>Functions for plotting different types of data or reaction kinetics, all using matplotlib.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.plotting.dual_axis_plot" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dual_axis_plot</span><span class="p">(</span><span class="n">xpoints</span><span class="p">,</span> <span class="n">leftaxis_ypoints_list</span><span class="p">,</span> <span class="n">rightaxis_ypoints_list</span><span class="p">,</span> <span class="n">xaxis_caption</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">leftaxis_caption</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">rightaxis_caption</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">leftaxis_colors</span><span class="o">=</span><span class="p">[],</span> <span class="n">rightaxis_colors</span><span class="o">=</span><span class="p">[],</span> <span class="n">leftaxis_titles</span><span class="o">=</span><span class="p">[],</span> <span class="n">rightaxis_titles</span><span class="o">=</span><span class="p">[],</span> <span class="n">extrapoints</span><span class="o">=</span><span class="p">[],</span> <span class="n">has_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend_direction</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">legend_position</span><span class="o">=</span><span class="p">(),</span> <span class="n">is_leftaxis_logarithmic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_rightaxis_logarithmic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">point_style</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">line_style</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">max_digits_after_comma</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">savepath</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">left_ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right_ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">left_axis_in_front</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">left_legend_position</span><span class="o">=</span><span class="p">[],</span> <span class="n">right_legend_position</span><span class="o">=</span><span class="p">[],</span> <span class="n">figure_size_inches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">special_figure_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creates a plot with a dual Y-axis.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>xpoints</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X-axis data points.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>leftaxis_ypoints_list</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Y-axis data points for the left axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rightaxis_ypoints_list</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Y-axis data points for the right axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xaxis_caption</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X-axis caption. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>leftaxis_caption</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Left Y-axis caption. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rightaxis_caption</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Right Y-axis caption. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>leftaxis_colors</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colors for left axis lines. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rightaxis_colors</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Colors for right axis lines. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>leftaxis_titles</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Legend titles for left axis lines. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rightaxis_titles</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Legend titles for right axis lines. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>extrapoints</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="bool">bool</span>, <span title="str">str</span>, <span title="str">str</span>, <span title="str">str</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of single points,
described by tuples with the content [x, y, is_left_axis, color, marker, label, yerr]. If yerr=0,
no error bar is drawn at all. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>has_legend</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to show the legend. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>legend_direction</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Legend direction. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>legend_position</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Legend position. Defaults to ().</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_leftaxis_logarithmic</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use a logarithmic scale for the left axis. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_rightaxis_logarithmic</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use a logarithmic scale for the right axis. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>point_style</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Style for points. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>line_style</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Style for lines. Defaults to "-".</p>
              </div>
            </td>
            <td>
                  <code>&#39;-&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_digits_after_comma</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Max digits after comma shown. Defaults to 4.</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>savepath</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If given, the plot is not shown but saved at the given path. Defaults to ""</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None (displays the plot)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dual_axis_plot</span><span class="p">(</span>
    <span class="n">xpoints</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">leftaxis_ypoints_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
    <span class="n">rightaxis_ypoints_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
    <span class="n">xaxis_caption</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">leftaxis_caption</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">rightaxis_caption</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">leftaxis_colors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">rightaxis_colors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">leftaxis_titles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">rightaxis_titles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">extrapoints</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">has_legend</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">legend_direction</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">legend_position</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="n">is_leftaxis_logarithmic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">is_rightaxis_logarithmic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">point_style</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">line_style</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
    <span class="n">max_digits_after_comma</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">savepath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">left_ylim</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">right_ylim</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">xlim</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">left_axis_in_front</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">left_legend_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">right_legend_position</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">figure_size_inches</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">special_figure_mode</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a plot with a dual Y-axis.</span>

<span class="sd">    Args:</span>
<span class="sd">        xpoints (list[float]): X-axis data points.</span>
<span class="sd">        leftaxis_ypoints_list (list[list[float]]): List of Y-axis data points for the left axis.</span>
<span class="sd">        rightaxis_ypoints_list (list[list[float]]): List of Y-axis data points for the right axis.</span>
<span class="sd">        xaxis_caption (str, optional): X-axis caption. Defaults to &quot;&quot;.</span>
<span class="sd">        leftaxis_caption (str, optional): Left Y-axis caption. Defaults to &quot;&quot;.</span>
<span class="sd">        rightaxis_caption (str, optional): Right Y-axis caption. Defaults to &quot;&quot;.</span>
<span class="sd">        leftaxis_colors (list[str], optional): Colors for left axis lines. Defaults to [].</span>
<span class="sd">        rightaxis_colors (list[str], optional): Colors for right axis lines. Defaults to [].</span>
<span class="sd">        leftaxis_titles (list[str], optional): Legend titles for left axis lines. Defaults to [].</span>
<span class="sd">        rightaxis_titles (list[str], optional): Legend titles for right axis lines. Defaults to [].</span>
<span class="sd">        extrapoints (list[tuple[float, float, bool, str, str, str, float]], optional): List of single points,</span>
<span class="sd">            described by tuples with the content [x, y, is_left_axis, color, marker, label, yerr]. If yerr=0,</span>
<span class="sd">            no error bar is drawn at all. Defaults to [].</span>
<span class="sd">        has_legend (bool, optional): Whether to show the legend. Defaults to True.</span>
<span class="sd">        legend_direction (str, optional): Legend direction. Defaults to &quot;&quot;.</span>
<span class="sd">        legend_position (tuple[float, float], optional): Legend position. Defaults to ().</span>
<span class="sd">        is_leftaxis_logarithmic (bool, optional): Whether to use a logarithmic scale for the left axis. Defaults to False.</span>
<span class="sd">        is_rightaxis_logarithmic (bool, optional): Whether to use a logarithmic scale for the right axis. Defaults to False.</span>
<span class="sd">        point_style (str, optional): Style for points. Defaults to &quot;&quot;.</span>
<span class="sd">        line_style (str, optional): Style for lines. Defaults to &quot;-&quot;.</span>
<span class="sd">        max_digits_after_comma (int, optional): Max digits after comma shown. Defaults to 4.</span>
<span class="sd">        savepath (str): If given, the plot is not shown but saved at the given path. Defaults to &quot;&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        None (displays the plot)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">figure_size_inches</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">figure_size_inches</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">figure_size_inches</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Left Axis Plotting</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ypoints</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">leftaxis_ypoints_list</span><span class="p">):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">leftaxis_colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">leftaxis_colors</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">leftaxis_titles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">leftaxis_titles</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">xpoints</span><span class="p">,</span>
            <span class="n">ypoints</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="n">line_style</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="n">point_style</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xaxis_caption</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">leftaxis_caption</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_leftaxis_logarithmic</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">left_ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">left_ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">left_ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>

    <span class="c1"># Right Axis Plotting</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rightaxis_ypoints_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ypoints</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rightaxis_ypoints_list</span><span class="p">):</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">rightaxis_colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">rightaxis_colors</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">rightaxis_titles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">rightaxis_titles</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">xpoints</span><span class="p">,</span>
                <span class="n">ypoints</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="n">line_style</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="n">point_style</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">rightaxis_caption</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_rightaxis_logarithmic</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">right_ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">right_ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">right_ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">left_axis_in_front</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_zorder</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">extrapoint</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">extrapoints</span><span class="p">):</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">ax1</span> <span class="k">if</span> <span class="n">extrapoint</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">else</span> <span class="n">ax2</span>
        <span class="k">if</span> <span class="n">extrapoint</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
                <span class="n">extrapoint</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">extrapoint</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">yerr</span><span class="o">=</span><span class="n">extrapoint</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span>
                <span class="n">ecolor</span><span class="o">=</span><span class="n">extrapoint</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">extrapoint</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                <span class="n">marker</span><span class="o">=</span><span class="n">extrapoint</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="n">extrapoint</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">extrapoint</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">extrapoint</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">extrapoint</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                <span class="n">marker</span><span class="o">=</span><span class="n">extrapoint</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="n">extrapoint</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
            <span class="p">)</span>

    <span class="c1"># Legend</span>
    <span class="k">if</span> <span class="n">has_legend</span><span class="p">:</span>
        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rightaxis_ypoints_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">handles2</span><span class="p">,</span> <span class="n">labels2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">left_legend_position</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="n">oldhandles</span><span class="p">,</span> <span class="n">oldlabels</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">handles</span><span class="p">),</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">left_legend_position</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">left_legend_position</span><span class="p">):</span>
                    <span class="n">handles</span><span class="p">[</span><span class="n">left_legend_position</span><span class="p">]</span> <span class="o">=</span> <span class="n">oldhandles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">labels</span><span class="p">[</span><span class="n">left_legend_position</span><span class="p">]</span> <span class="o">=</span> <span class="n">oldlabels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">right_legend_position</span> <span class="o">!=</span> <span class="p">[]:</span>
                <span class="n">oldhandles2</span><span class="p">,</span> <span class="n">oldlabels2</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">handles2</span><span class="p">),</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">labels2</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">right_legend_position</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">right_legend_position</span><span class="p">):</span>
                    <span class="n">handles2</span><span class="p">[</span><span class="n">right_legend_position</span><span class="p">]</span> <span class="o">=</span> <span class="n">oldhandles2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">labels2</span><span class="p">[</span><span class="n">right_legend_position</span><span class="p">]</span> <span class="o">=</span> <span class="n">oldlabels2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">special_figure_mode</span><span class="p">:</span>
                <span class="c1"># Just for COBRA-k&#39;s initial publication :-)</span>
                <span class="k">del</span> <span class="n">handles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">handles2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oldhandles</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">labels2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oldlabels</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>

            <span class="n">handles</span> <span class="o">=</span> <span class="n">handles</span> <span class="o">+</span> <span class="n">handles2</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span> <span class="o">+</span> <span class="n">labels2</span>
        <span class="n">extraargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="n">legend_position</span><span class="p">}</span> <span class="k">if</span> <span class="n">legend_position</span> <span class="o">!=</span> <span class="p">()</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">legend_direction</span><span class="p">:</span>
            <span class="n">extraargs</span><span class="p">[</span><span class="s2">&quot;loc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">legend_direction</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="n">handles</span><span class="p">,</span>
            <span class="n">labels</span><span class="p">,</span>
            <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mf">10.5</span><span class="p">},</span>
            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">legend_position</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">legend_direction</span>
            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">extraargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>

    <span class="c1"># Format axis ticks</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">max_digits_after_comma</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">max_digits_after_comma</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rightaxis_ypoints_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">max_digits_after_comma</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># Adjust layout to prevent labels from overlapping</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">savepath</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">savepath</span><span class="p">)</span>

    <span class="c1"># Close the plot to free up memory</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.plotting.plot_combinations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_combinations</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">min_values</span><span class="p">,</span> <span class="n">max_values</span><span class="p">,</span> <span class="n">num_subplots_per_window</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">num_subplots_per_row</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plot all unique combinations of 2 variable arguments and constant values for the other arguments.</p>
<p>The plot is a scatter plot with different colors for each category in the hue column. The x-axis represents the x-data,
the y-axis represents the y-data, and the hue axis represents the category.</p>
<p>The plot has the following features:</p>
<ul>
<li>A title at the top of the plot with the specified title.</li>
<li>Labels for the x-axis and y-axis with the specified labels.</li>
<li>A legend on the right side of the plot with the specified hue label.</li>
<li>Different colors for each category in the hue column, specified by the palette.</li>
<li>A scatter plot with points representing the data.</li>
</ul>
<p>Example usage:</p>
<blockquote>
<blockquote>
<blockquote>
<p>min_values = [-1.0, 0.0, 0.0]
max_values = [10.0, 5.0, 10.0]
def example_func(args: List[float]) -&gt; float:
   return args[0] + args[1] + args[2]</p>
<p>plot_combinations(example_func, min_values, max_values)</p>
</blockquote>
</blockquote>
</blockquote>
<p>Args:
- func: The function to be plotted. It takes a list of floats and returns a float.
- min_values: A list of minimum possible values for each argument.
- max_values: A list of maximum possible values for each argument.
- num_subplots_per_window: The maximum number of subplots per window. Defaults to 18.
- num_subplots_per_row: The maximum number of subplots per row in a window. Defaults to 6.</p>
<p>Returns:
- None</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_combinations</span><span class="p">(</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">min_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">max_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
    <span class="n">num_subplots_per_window</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
    <span class="n">num_subplots_per_row</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot all unique combinations of 2 variable arguments and constant values for the other arguments.</span>

<span class="sd">    The plot is a scatter plot with different colors for each category in the hue column. The x-axis represents the x-data,</span>
<span class="sd">    the y-axis represents the y-data, and the hue axis represents the category.</span>

<span class="sd">    The plot has the following features:</span>

<span class="sd">    * A title at the top of the plot with the specified title.</span>
<span class="sd">    * Labels for the x-axis and y-axis with the specified labels.</span>
<span class="sd">    * A legend on the right side of the plot with the specified hue label.</span>
<span class="sd">    * Different colors for each category in the hue column, specified by the palette.</span>
<span class="sd">    * A scatter plot with points representing the data.</span>

<span class="sd">    Example usage:</span>
<span class="sd">    &gt;&gt;&gt; min_values = [-1.0, 0.0, 0.0]</span>
<span class="sd">    &gt;&gt;&gt; max_values = [10.0, 5.0, 10.0]</span>
<span class="sd">    &gt;&gt;&gt; def example_func(args: List[float]) -&gt; float:</span>
<span class="sd">    &gt;&gt;&gt;    return args[0] + args[1] + args[2]</span>
<span class="sd">    &gt;&gt;&gt;</span>
<span class="sd">    &gt;&gt;&gt; plot_combinations(example_func, min_values, max_values)</span>

<span class="sd">    Args:</span>
<span class="sd">    - func: The function to be plotted. It takes a list of floats and returns a float.</span>
<span class="sd">    - min_values: A list of minimum possible values for each argument.</span>
<span class="sd">    - max_values: A list of maximum possible values for each argument.</span>
<span class="sd">    - num_subplots_per_window: The maximum number of subplots per window. Defaults to 18.</span>
<span class="sd">    - num_subplots_per_row: The maximum number of subplots per row in a window. Defaults to 6.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - None</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Generate all possible combinations of 2 variable arguments</span>
    <span class="n">variable_combinations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">min_values</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">min_values</span><span class="p">)):</span>
            <span class="n">variable_combinations</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>

    <span class="c1"># Generate all unique combinations of variable and constant arguments</span>
    <span class="n">combinations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">variable_combination</span> <span class="ow">in</span> <span class="n">variable_combinations</span><span class="p">:</span>
        <span class="n">constant_combinations</span> <span class="o">=</span> <span class="n">_get_constant_combinations</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">min_values</span><span class="p">),</span> <span class="n">variable_combination</span><span class="p">,</span> <span class="n">min_values</span><span class="p">,</span> <span class="n">max_values</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">constant_combination</span> <span class="ow">in</span> <span class="n">constant_combinations</span><span class="p">:</span>
            <span class="n">combinations</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">variable_combination</span><span class="p">,</span> <span class="n">constant_combination</span><span class="p">))</span>

    <span class="c1"># Plot each combination</span>
    <span class="n">num_windows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">combinations</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_subplots_per_window</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">window_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_windows</span><span class="p">):</span>
        <span class="n">num_subplots</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
            <span class="n">num_subplots_per_window</span><span class="p">,</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">combinations</span><span class="p">)</span> <span class="o">-</span> <span class="n">window_index</span> <span class="o">*</span> <span class="n">num_subplots_per_window</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">num_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_subplots</span> <span class="o">/</span> <span class="n">num_subplots_per_row</span><span class="p">))</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
            <span class="n">num_rows</span><span class="p">,</span>
            <span class="n">num_subplots_per_row</span><span class="p">,</span>
            <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">num_rows</span><span class="p">),</span>
            <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="s2">&quot;3d&quot;</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">num_subplots_per_row</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">axs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">ax</span><span class="p">]</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">num_rows</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">axs</span> <span class="o">=</span> <span class="p">[</span><span class="n">axs</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">axs_row</span><span class="p">)</span> <span class="k">for</span> <span class="n">axs_row</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">]</span>

        <span class="n">z_mins</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">z_maxs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">combination</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">[</span>
            <span class="n">window_index</span> <span class="o">*</span> <span class="n">num_subplots_per_window</span> <span class="p">:</span> <span class="p">(</span><span class="n">window_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">num_subplots_per_window</span>
        <span class="p">]:</span>
            <span class="n">variable_combination</span><span class="p">,</span> <span class="n">constant_combination</span> <span class="o">=</span> <span class="n">combination</span>
            <span class="k">if</span> <span class="n">variable_combination</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">z_mins</span><span class="p">:</span>
                <span class="n">z_mins</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
                <span class="n">z_maxs</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-inf&quot;</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                <span class="n">min_values</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">max_values</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="mi">100</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                <span class="n">min_values</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                <span class="n">max_values</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                <span class="mi">100</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="p">(</span>
                            <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">variable_combination</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">variable_combination</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                <span class="k">else</span> <span class="n">constant_combination</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">min_values</span><span class="p">))</span>
                    <span class="p">]</span>
                    <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
            <span class="n">z_mins</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">z_mins</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span>  <span class="c1"># type: ignore</span>
            <span class="n">z_maxs</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">z_maxs</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span>  <span class="c1"># type: ignore</span>

        <span class="k">for</span> <span class="n">subplot_index</span><span class="p">,</span> <span class="n">combination</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
            <span class="n">combinations</span><span class="p">[</span>
                <span class="n">window_index</span> <span class="o">*</span> <span class="n">num_subplots_per_window</span> <span class="p">:</span> <span class="p">(</span><span class="n">window_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="o">*</span> <span class="n">num_subplots_per_window</span>
            <span class="p">]</span>
        <span class="p">):</span>
            <span class="n">variable_combination</span><span class="p">,</span> <span class="n">constant_combination</span> <span class="o">=</span> <span class="n">combination</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                <span class="n">min_values</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="n">max_values</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                <span class="mi">100</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                <span class="n">min_values</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                <span class="n">max_values</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                <span class="mi">100</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="p">(</span>
                            <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">variable_combination</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="k">else</span> <span class="p">(</span>
                                <span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">variable_combination</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                <span class="k">else</span> <span class="n">constant_combination</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">min_values</span><span class="p">))</span>
                    <span class="p">]</span>
                    <span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

            <span class="n">row_index</span> <span class="o">=</span> <span class="n">subplot_index</span> <span class="o">//</span> <span class="n">num_subplots_per_row</span>
            <span class="n">col_index</span> <span class="o">=</span> <span class="n">subplot_index</span> <span class="o">%</span> <span class="n">num_subplots_per_row</span>

            <span class="n">axs</span><span class="p">[</span><span class="n">row_index</span><span class="p">][</span><span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span>
                <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span>
            <span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">row_index</span><span class="p">][</span><span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Argument </span><span class="si">{</span><span class="n">variable_combination</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">row_index</span><span class="p">][</span><span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Argument </span><span class="si">{</span><span class="n">variable_combination</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">row_index</span><span class="p">][</span><span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span>
                <span class="n">z_mins</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">],</span> <span class="n">z_maxs</span><span class="p">[</span><span class="n">variable_combination</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="n">constant_title</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">constant_combination</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">min_values</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">variable_combination</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">row_index</span><span class="p">][</span><span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Variable: </span><span class="si">{</span><span class="n">variable_combination</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">variable_combination</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Constant: </span><span class="si">{</span><span class="n">constant_title</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="k">if</span> <span class="n">constant_title</span>
                    <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;Variable: </span><span class="si">{</span><span class="n">variable_combination</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">variable_combination</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">),</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Hide empty plots</span>
            <span class="k">if</span> <span class="n">subplot_index</span> <span class="o">&gt;=</span> <span class="n">num_subplots</span><span class="p">:</span>
                <span class="n">axs</span><span class="p">[</span><span class="n">row_index</span><span class="p">][</span><span class="n">col_index</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.plotting.plot_objvalue_evolution" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_objvalue_evolution</span><span class="p">(</span><span class="n">json_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Objective value&#39;</span><span class="p">,</span> <span class="n">objvalue_multiplicator</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">with_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;genetic&#39;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plots the evolution of the objective value over computational time.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>json_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the JSON file containing the data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to save the plot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ylabel</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for the Y-axis. Defaults to "Objective value".</p>
              </div>
            </td>
            <td>
                  <code>&#39;Objective value&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objvalue_multiplicator</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multiplier to apply to the objective value. Defaults to -1.0.</p>
              </div>
            </td>
            <td>
                  <code>-1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_legend</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to display the legend. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>algorithm</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;pso&#39;, &#39;genetic&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optimization algorithm used. Defaults to "genetic".</p>
              </div>
            </td>
            <td>
                  <code>&#39;genetic&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of decimal places to display on the Y-axis. Defaults to 4.</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None. Saves the plot to the specified output path.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_objvalue_evolution</span><span class="p">(</span>
    <span class="n">json_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Objective value&quot;</span><span class="p">,</span>
    <span class="n">objvalue_multiplicator</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">with_legend</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;pso&quot;</span><span class="p">,</span> <span class="s2">&quot;genetic&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;genetic&quot;</span><span class="p">,</span>
    <span class="n">precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots the evolution of the objective value over computational time.</span>

<span class="sd">    Args:</span>
<span class="sd">        json_path (str): Path to the JSON file containing the data.</span>
<span class="sd">        output_path (str): Path to save the plot.</span>
<span class="sd">        ylabel (str, optional): Label for the Y-axis. Defaults to &quot;Objective value&quot;.</span>
<span class="sd">        objvalue_multiplicator (float, optional): Multiplier to apply to the objective value. Defaults to -1.0.</span>
<span class="sd">        with_legend (bool, optional): Whether to display the legend. Defaults to False.</span>
<span class="sd">        algorithm (Literal[&quot;pso&quot;, &quot;genetic&quot;], optional): The optimization algorithm used. Defaults to &quot;genetic&quot;.</span>
<span class="sd">        precision (int, optional): The number of decimal places to display on the Y-axis. Defaults to 4.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None. Saves the plot to the specified output path.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_decimal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>  <span class="c1"># noqa: ANN001</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.</span><span class="si">{</span><span class="n">precision</span><span class="si">}</span><span class="s2">f</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># Use the specified precision</span>

    <span class="c1"># Load data from JSON file</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">json_load</span><span class="p">(</span><span class="n">json_path</span><span class="p">,</span> <span class="n">Any</span><span class="p">)</span>

    <span class="c1"># Extract timepoints</span>
    <span class="n">timepoints</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span>

    <span class="c1"># Initialize objvalues list</span>
    <span class="k">match</span> <span class="n">algorithm</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;pso&quot;</span><span class="p">:</span>
            <span class="n">objvalues</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]))]</span>
        <span class="k">case</span> <span class="s2">&quot;genetic&quot;</span><span class="p">:</span>
            <span class="n">objvalues</span> <span class="o">=</span> <span class="p">[[]]</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>

    <span class="c1"># Populate objvalues list</span>
    <span class="k">for</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">match</span> <span class="n">algorithm</span><span class="p">:</span>
            <span class="k">case</span> <span class="s2">&quot;pso&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">value_idx</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mf">1_000_000.0</span><span class="p">:</span>
                        <span class="n">objvalues</span><span class="p">[</span><span class="n">value_idx</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">objvalues</span><span class="p">[</span><span class="n">value_idx</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="n">objvalue_multiplicator</span><span class="p">)</span>
            <span class="k">case</span> <span class="s2">&quot;genetic&quot;</span><span class="p">:</span>
                <span class="n">objvalues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">objvalue_multiplicator</span> <span class="o">*</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
    <span class="k">match</span> <span class="n">algorithm</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;pso&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">objvalue_idx</span><span class="p">,</span> <span class="n">objvalue_list</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">objvalues</span><span class="p">):</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">timepoints</span><span class="p">,</span>
                    <span class="n">objvalue_list</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Particle </span><span class="si">{</span><span class="n">objvalue_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;genetic&quot;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="n">timepoints</span><span class="p">,</span> <span class="n">objvalues</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Best value&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Customize the plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Computational Time [s]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ylabel</span><span class="si">}</span><span class="s2"> Evolution Over Time&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">with_legend</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">format_decimal</span><span class="p">))</span>

    <span class="c1"># Save the plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>

    <span class="c1"># Close the plot to free up memory</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.plotting.plot_variabilities" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_variabilities</span><span class="p">(</span><span class="n">variabilities</span><span class="p">,</span> <span class="n">variability_names</span><span class="p">,</span> <span class="n">variability_titles</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">plot_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Plots the mean values and whisker bars for multiple variabilities.</p>
<p>This function generates a plot where each variability is represented by a series of points (triangles) and whisker bars.
Each point (if plot_mean==True) represents the mean value of a data point in the variability, and the whisker bars represent the lower and upper bounds.
The variabilities are grouped together for each data point, with a space between each group to clearly distinguish them.</p>
<h5 id="cobrak.plotting.plot_variabilities--parameters">Parameters:</h5>
<p>variabilities : List[List[Tuple[float, float, float]]]
A list of lists, where each inner list represents a variability. Each tuple in the inner list contains
(lower_bound, upper_bound, mean_value) for each data point in the variability.</p>
<p>variability_names : List[str]
A list of strings representing the names of the variabilities.</p>
<p>colors : List[str]
A list of strings representing the colors for each variability, e.g. using names from https://matplotlib.org/stable/gallery/color/named_colors.html</p>
<p>plot_mean : bool, optional
If True, the mean value is plotted as a triangle. If False, only the whisker bars are plotted. Default is True.</p>
<p>save_path : str, optional
The file path where the plot should be saved. If None, the plot is displayed. Default is None.</p>
<h5 id="cobrak.plotting.plot_variabilities--returns">Returns:</h5>
<p>None
The function either displays the plot or saves it to the specified path.</p>
<h5 id="cobrak.plotting.plot_variabilities--example">Example:</h5>
<blockquote>
<blockquote>
<blockquote>
<p>in_vivo = [(1.0, 3.0, 2.0), (2.0, 4.0, 3.0), (3.0, 5.0, 4.0)]
in_silico = [(1.5, 3.5, 2.5), (2.5, 4.5, 3.5), (3.5, 5.5, 4.5)]
another_variability = [(1.2, 3.2, 2.2), (2.2, 4.2, 3.2), (3.2, 5.2, 4.2)]
variabilities = [in_vivo, in_silico, another_variability]
variability_names = ['in_vivo', 'in_silico', 'another_variability']
colors = ['blue', 'orange', 'green']
plot_variabilities(variabilities, variability_names, colors)
plot_variabilities(variabilities, variability_names, colors, plot_mean=False)
plot_variabilities(variabilities, variability_names, colors, save_path='plot.png')</p>
</blockquote>
</blockquote>
</blockquote>


            <details class="quote">
              <summary>Source code in <code>cobrak/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_variabilities</span><span class="p">(</span>
    <span class="n">variabilities</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]],</span>
    <span class="n">variability_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">variability_titles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">colors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">xlabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">yscale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;log&quot;</span><span class="p">,</span>
    <span class="n">plot_mean</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots the mean values and whisker bars for multiple variabilities.</span>

<span class="sd">    This function generates a plot where each variability is represented by a series of points (triangles) and whisker bars.</span>
<span class="sd">    Each point (if plot_mean==True) represents the mean value of a data point in the variability, and the whisker bars represent the lower and upper bounds.</span>
<span class="sd">    The variabilities are grouped together for each data point, with a space between each group to clearly distinguish them.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    variabilities : List[List[Tuple[float, float, float]]]</span>
<span class="sd">    A list of lists, where each inner list represents a variability. Each tuple in the inner list contains</span>
<span class="sd">    (lower_bound, upper_bound, mean_value) for each data point in the variability.</span>

<span class="sd">    variability_names : List[str]</span>
<span class="sd">    A list of strings representing the names of the variabilities.</span>

<span class="sd">    colors : List[str]</span>
<span class="sd">    A list of strings representing the colors for each variability, e.g. using names from https://matplotlib.org/stable/gallery/color/named_colors.html</span>

<span class="sd">    plot_mean : bool, optional</span>
<span class="sd">    If True, the mean value is plotted as a triangle. If False, only the whisker bars are plotted. Default is True.</span>

<span class="sd">    save_path : str, optional</span>
<span class="sd">    The file path where the plot should be saved. If None, the plot is displayed. Default is None.</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    None</span>
<span class="sd">    The function either displays the plot or saves it to the specified path.</span>

<span class="sd">    Example:</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; in_vivo = [(1.0, 3.0, 2.0), (2.0, 4.0, 3.0), (3.0, 5.0, 4.0)]</span>
<span class="sd">    &gt;&gt;&gt; in_silico = [(1.5, 3.5, 2.5), (2.5, 4.5, 3.5), (3.5, 5.5, 4.5)]</span>
<span class="sd">    &gt;&gt;&gt; another_variability = [(1.2, 3.2, 2.2), (2.2, 4.2, 3.2), (3.2, 5.2, 4.2)]</span>
<span class="sd">    &gt;&gt;&gt; variabilities = [in_vivo, in_silico, another_variability]</span>
<span class="sd">    &gt;&gt;&gt; variability_names = [&#39;in_vivo&#39;, &#39;in_silico&#39;, &#39;another_variability&#39;]</span>
<span class="sd">    &gt;&gt;&gt; colors = [&#39;blue&#39;, &#39;orange&#39;, &#39;green&#39;]</span>
<span class="sd">    &gt;&gt;&gt; plot_variabilities(variabilities, variability_names, colors)</span>
<span class="sd">    &gt;&gt;&gt; plot_variabilities(variabilities, variability_names, colors, plot_mean=False)</span>
<span class="sd">    &gt;&gt;&gt; plot_variabilities(variabilities, variability_names, colors, save_path=&#39;plot.png&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Number of variabilities</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">variabilities</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">num_variabilities</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">variabilities</span><span class="p">)</span>

    <span class="c1"># Create a figure and axis</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

    <span class="c1"># Define the positions for the groups</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">list</span><span class="p">(</span>
            <span class="nb">range</span><span class="p">(</span>
                <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="n">num_variabilities</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="n">num_variabilities</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">num_variabilities</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># Plot each variability</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">pos_group</span><span class="p">,</span> <span class="n">variability</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">variabilities</span><span class="p">))):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">mean</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pos_group</span><span class="p">,</span> <span class="n">variability</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">plot_mean</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
                    <span class="n">pos</span><span class="p">,</span>
                    <span class="n">mean</span><span class="p">,</span>
                    <span class="n">yerr</span><span class="o">=</span><span class="p">[[</span><span class="n">mean</span> <span class="o">-</span> <span class="n">lower</span><span class="p">],</span> <span class="p">[</span><span class="n">upper</span> <span class="o">-</span> <span class="n">mean</span><span class="p">]],</span>
                    <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
                    <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
                    <span class="n">ecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">variability_titles</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
                    <span class="n">pos</span><span class="p">,</span>
                    <span class="n">mean</span><span class="p">,</span>
                    <span class="n">yerr</span><span class="o">=</span><span class="p">[[</span><span class="n">mean</span> <span class="o">-</span> <span class="n">lower</span><span class="p">],</span> <span class="p">[</span><span class="n">upper</span> <span class="o">-</span> <span class="n">mean</span><span class="p">]],</span>
                    <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                    <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                    <span class="n">ecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">variability_titles</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="p">)</span>

    <span class="c1"># Calculate midpoints between groups for vertical lines</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># Get the end of the current group and the start of the next group</span>
        <span class="n">current_group_end</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">next_group_start</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Calculate the midpoint</span>
        <span class="n">midpoint</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_group_end</span> <span class="o">+</span> <span class="n">next_group_start</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="c1"># Draw a thin vertical black line at the midpoint</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">midpoint</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

    <span class="c1"># Set the x-axis labels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">num_variabilities</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">variability_names</span><span class="p">)</span>  <span class="c1"># [f&quot;Exp {i+1}&quot; for i in range(n)])</span>

    <span class="c1"># Add labels and title</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Comparison of Variabilities&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">yscale</span><span class="p">)</span>

    <span class="c1"># Add legend</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Save or show the plot</span>
    <span class="k">if</span> <span class="n">save_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.plotting.scatterplot_with_labels" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">scatterplot_with_labels</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">x_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">x_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">identical_axis_lims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xlim_overwrite</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim_overwrite</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extratext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">x_labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">y_labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a scatter plot with error bars and optional point labels.</p>
<p>Can be used standalone ("one-off" plot with plt.show()), or for subplotting by passing an Axes object.
Optionally saves the figure if save_path is provided.</p>
<h5 id="cobrak.plotting.scatterplot_with_labels--parameters">Parameters</h5>
<p>x_data : list[tuple[float, float, float]]
    Each tuple is (lower bound, upper bound, drawn value) for x.
y_data : list[tuple[float, float, float]]
    Each tuple is (lower bound, upper bound, drawn value) for y.
labels : list[str]
    Labels for each point (used if add_labels is True).
x_label : str, optional
    X-axis label.
y_label : str, optional
    Y-axis label.
y_log : bool, default True
    Use log scale for y-axis.
x_log : bool, default True
    Use log scale for x-axis.
add_labels : bool, default False
    Annotate points with corresponding label.
identical_axis_lims : bool, default True
    Make x and y axis limits identical and auto-scale them.
ax : matplotlib.axes.Axes, optional
    If provided, plot is drawn on this Axes (for subplotting).
save_path : str, optional
    If provided and <code>ax</code> is None (standalone plotting), save the figure at this path instead of showing.</p>
<h5 id="cobrak.plotting.scatterplot_with_labels--returns">Returns</h5>
<p>ax : matplotlib.axes.Axes
    The axis object containing the plot.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/plotting.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">scatterplot_with_labels</span><span class="p">(</span>
    <span class="n">x_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">y_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">x_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">y_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">y_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">x_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">add_labels</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">identical_axis_lims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">xlim_overwrite</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ylim_overwrite</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">extratext</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">x_labelsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
    <span class="n">y_labelsize</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a scatter plot with error bars and optional point labels.</span>

<span class="sd">    Can be used standalone (&quot;one-off&quot; plot with plt.show()), or for subplotting by passing an Axes object.</span>
<span class="sd">    Optionally saves the figure if save_path is provided.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x_data : list[tuple[float, float, float]]</span>
<span class="sd">        Each tuple is (lower bound, upper bound, drawn value) for x.</span>
<span class="sd">    y_data : list[tuple[float, float, float]]</span>
<span class="sd">        Each tuple is (lower bound, upper bound, drawn value) for y.</span>
<span class="sd">    labels : list[str]</span>
<span class="sd">        Labels for each point (used if add_labels is True).</span>
<span class="sd">    x_label : str, optional</span>
<span class="sd">        X-axis label.</span>
<span class="sd">    y_label : str, optional</span>
<span class="sd">        Y-axis label.</span>
<span class="sd">    y_log : bool, default True</span>
<span class="sd">        Use log scale for y-axis.</span>
<span class="sd">    x_log : bool, default True</span>
<span class="sd">        Use log scale for x-axis.</span>
<span class="sd">    add_labels : bool, default False</span>
<span class="sd">        Annotate points with corresponding label.</span>
<span class="sd">    identical_axis_lims : bool, default True</span>
<span class="sd">        Make x and y axis limits identical and auto-scale them.</span>
<span class="sd">    ax : matplotlib.axes.Axes, optional</span>
<span class="sd">        If provided, plot is drawn on this Axes (for subplotting).</span>
<span class="sd">    save_path : str, optional</span>
<span class="sd">        If provided and `ax` is None (standalone plotting), save the figure at this path instead of showing.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        The axis object containing the plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate midpoints and error sizes for x and y coordinates</span>
    <span class="n">x_drawn</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_data</span><span class="p">]</span>
    <span class="n">x_low</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_data</span><span class="p">]</span>
    <span class="n">x_high</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_data</span><span class="p">]</span>
    <span class="n">x_err_low</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_drawn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_low</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">))]</span>
    <span class="n">x_err_high</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_high</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_drawn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">))]</span>

    <span class="n">y_drawn</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">y_data</span><span class="p">]</span>
    <span class="n">y_low</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">y_data</span><span class="p">]</span>
    <span class="n">y_high</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">y_data</span><span class="p">]</span>
    <span class="n">y_err_low</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_drawn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_low</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_data</span><span class="p">))]</span>
    <span class="n">y_err_high</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_high</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_drawn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_data</span><span class="p">))]</span>

    <span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_drawn</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;viridis&quot;</span><span class="p">)(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_points</span><span class="p">))</span>

    <span class="n">_created_fig</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">_created_fig</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Plot each point individually to assign different colors</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_points</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
            <span class="n">x_drawn</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">y_drawn</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">xerr</span><span class="o">=</span><span class="p">[[</span><span class="n">x_err_low</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="p">[</span><span class="n">x_err_high</span><span class="p">[</span><span class="n">i</span><span class="p">]]],</span>
            <span class="n">yerr</span><span class="o">=</span><span class="p">[[</span><span class="n">y_err_low</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="p">[</span><span class="n">y_err_high</span><span class="p">[</span><span class="n">i</span><span class="p">]]],</span>
            <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="n">capthick</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">elinewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Add labels to each point</span>
    <span class="k">if</span> <span class="n">add_labels</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x_drawn</span><span class="p">,</span> <span class="n">y_drawn</span><span class="p">)):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">),</span>
                <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="c1"># Axis limits &amp; unity line</span>
    <span class="n">all_x_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_datapoint</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x_datapoint</span> <span class="ow">in</span> <span class="n">x_data</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
        <span class="n">x_datapoint</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x_datapoint</span> <span class="ow">in</span> <span class="n">x_data</span>
    <span class="p">]</span>
    <span class="n">all_y_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_datapoint</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">y_datapoint</span> <span class="ow">in</span> <span class="n">y_data</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
        <span class="n">y_datapoint</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">y_datapoint</span> <span class="ow">in</span> <span class="n">y_data</span>
    <span class="p">]</span>

    <span class="n">min_val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="o">*</span><span class="n">all_y_values</span><span class="p">,</span> <span class="o">*</span><span class="n">all_x_values</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.99</span>
    <span class="n">max_val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="o">*</span><span class="n">all_y_values</span><span class="p">,</span> <span class="o">*</span><span class="n">all_x_values</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.2</span>

    <span class="k">if</span> <span class="n">identical_axis_lims</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xlim_overwrite</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim_overwrite</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim_overwrite</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">ylim_overwrite</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim_overwrite</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim_overwrite</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">x_unity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">y_unity</span> <span class="o">=</span> <span class="n">x_unity</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_unity</span><span class="p">,</span> <span class="n">y_unity</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">y_log</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">x_log</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">x_label</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">x_labelsize</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y_label</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">y_labelsize</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">extratext</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.15</span><span class="p">,</span>
            <span class="mf">0.975</span><span class="p">,</span>
            <span class="n">extratext</span><span class="p">,</span>
            <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
            <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;minor&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">_created_fig</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">save_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.printing" class="doc doc-heading">
            <code>printing</code>


</h2>

    <div class="doc doc-contents ">

        <p>Pretty-print summaries of optimization and variability results as well as COBRAk Model instances.</p>
<p>For results, its methods generate <code>rich</code> tables that display flux values and variability information for each category.
For models, its methods generate <code>rich</code>tables that display the model's structure and parameters.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.printing.print_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_dict</span><span class="p">(</span><span class="n">dictionary</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Pretty-print a dictionary in a JSON formatted string with the specified indentation.</p>
<p>Args:
dictionary (dict[Any, Any]): The dictionary to print.
indent (int, optional): The number of spaces for indentation. Defaults to 4.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/printing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">print_dict</span><span class="p">(</span><span class="n">dictionary</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pretty-print a dictionary in a JSON formatted string with the specified indentation.</span>

<span class="sd">    Args:</span>
<span class="sd">    dictionary (dict[Any, Any]): The dictionary to print.</span>
<span class="sd">    indent (int, optional): The number of spaces for indentation. Defaults to 4.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">dictionary</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.printing.print_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_model</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">print_reacs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_enzymes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_mets</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_extra_linear_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">conc_rounding</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Pretty-print a detailed summary of the model, including reactions, enzymes, metabolites, and settings.</p>
<p>Args:
cobrak_model (Model): The model to print.
print_reacs (bool, optional): Whether to print reactions. Defaults to True.
print_enzymes (bool, optional): Whether to print enzymes. Defaults to True.
print_mets (bool, optional): Whether to print metabolites. Defaults to True.
print_extra_linear_constraints (bool, optional): Whether to print extra linear constraints. Defaults to True.
print_settings (bool, optional): Whether to print general settings. Defaults to True.
conc_rounding (int, optional): Number of decimal places to round concentrations to. Defaults to 6.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/printing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">print_model</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">print_reacs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">print_enzymes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">print_mets</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">print_extra_linear_constraints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">print_settings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">conc_rounding</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pretty-print a detailed summary of the model, including reactions, enzymes, metabolites, and settings.</span>

<span class="sd">    Args:</span>
<span class="sd">    cobrak_model (Model): The model to print.</span>
<span class="sd">    print_reacs (bool, optional): Whether to print reactions. Defaults to True.</span>
<span class="sd">    print_enzymes (bool, optional): Whether to print enzymes. Defaults to True.</span>
<span class="sd">    print_mets (bool, optional): Whether to print metabolites. Defaults to True.</span>
<span class="sd">    print_extra_linear_constraints (bool, optional): Whether to print extra linear constraints. Defaults to True.</span>
<span class="sd">    print_settings (bool, optional): Whether to print general settings. Defaults to True.</span>
<span class="sd">    conc_rounding (int, optional): Number of decimal places to round concentrations to. Defaults to 6.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[b u]Model[b u]&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">print_reacs</span><span class="p">:</span>
        <span class="n">reac_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Reactions&quot;</span><span class="p">,</span> <span class="n">title_justify</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;String&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;G&#39;&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;kcat&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;kM&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;kI&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;kA&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Hills&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Annotation&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">sort_dict_keys</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">reac_id</span><span class="p">,</span>
                <span class="n">get_reaction_string</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">),</span>
                <span class="n">_none_as_na</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span><span class="p">),</span>
                <span class="p">(</span>
                    <span class="s2">&quot;N/A&quot;</span>
                    <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span>
                    <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span><span class="p">)</span>
                <span class="p">),</span>
                <span class="p">(</span>
                    <span class="s2">&quot;N/A&quot;</span>
                    <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span>
                    <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">)</span>
                <span class="p">),</span>
                <span class="p">(</span>
                    <span class="s2">&quot;N/A&quot;</span>
                    <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span>
                    <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_is</span><span class="p">)</span>
                <span class="p">),</span>
                <span class="p">(</span>
                    <span class="s2">&quot;N/A&quot;</span>
                    <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span>
                    <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_as</span><span class="p">)</span>
                <span class="p">),</span>
                <span class="p">(</span>
                    <span class="s2">&quot;N/A&quot;</span>
                    <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span>
                    <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="p">)</span>
                <span class="p">),</span>
                <span class="n">reaction</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">),</span>
            <span class="p">]</span>
            <span class="n">reac_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">arguments</span><span class="p">)</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">reac_table</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">print_enzymes</span> <span class="ow">and</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">enzymes</span> <span class="o">!=</span> <span class="p">{}:</span>
        <span class="n">enzyme_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Enzymes&quot;</span><span class="p">,</span> <span class="n">title_justify</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="n">enzyme_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">)</span>
        <span class="n">enzyme_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;MW&quot;</span><span class="p">)</span>
        <span class="n">enzyme_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;min([E])&quot;</span><span class="p">)</span>
        <span class="n">enzyme_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;max([E])&quot;</span><span class="p">)</span>
        <span class="n">enzyme_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span>
        <span class="n">enzyme_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Annotation&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">enzyme_id</span><span class="p">,</span> <span class="n">enzyme</span> <span class="ow">in</span> <span class="n">sort_dict_keys</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">enzymes</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">enzyme_id</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">enzyme</span><span class="o">.</span><span class="n">molecular_weight</span><span class="p">),</span>
                <span class="n">_none_as_na</span><span class="p">(</span><span class="n">enzyme</span><span class="o">.</span><span class="n">min_conc</span><span class="p">),</span>
                <span class="n">_none_as_na</span><span class="p">(</span><span class="n">enzyme</span><span class="o">.</span><span class="n">max_conc</span><span class="p">),</span>
                <span class="n">enzyme</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">enzyme</span><span class="o">.</span><span class="n">annotation</span><span class="p">),</span>
            <span class="p">]</span>
            <span class="n">enzyme_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">arguments</span><span class="p">)</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">enzyme_table</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">print_mets</span><span class="p">:</span>
        <span class="n">met_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Metabolites&quot;</span><span class="p">,</span> <span class="n">title_justify</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="n">met_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">)</span>
        <span class="n">met_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;min(c)&quot;</span><span class="p">)</span>
        <span class="n">met_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;max(c)&quot;</span><span class="p">)</span>
        <span class="n">met_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">)</span>
        <span class="n">met_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Annotation&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">metabolite</span> <span class="ow">in</span> <span class="n">sort_dict_keys</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">met_id</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">metabolite</span><span class="o">.</span><span class="n">log_min_conc</span><span class="p">),</span> <span class="n">conc_rounding</span><span class="p">)),</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">metabolite</span><span class="o">.</span><span class="n">log_max_conc</span><span class="p">),</span> <span class="n">conc_rounding</span><span class="p">)),</span>
                <span class="n">metabolite</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">metabolite</span><span class="o">.</span><span class="n">annotation</span><span class="p">),</span>
            <span class="p">]</span>
            <span class="n">met_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">arguments</span><span class="p">)</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">met_table</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">print_extra_linear_constraints</span> <span class="ow">and</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">extra_linear_constraints</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[b u]Extra linear constraints[b u]&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">extra_linear_constraint</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">extra_linear_constraints</span><span class="p">:</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">get_extra_linear_constraint_string</span><span class="p">(</span><span class="n">extra_linear_constraint</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">print_settings</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[i]General settings[i]&quot;</span><span class="p">)</span>
        <span class="n">print_strkey_dict_as_table</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;Protein pool&quot;</span><span class="p">:</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                <span class="s2">&quot;R [kJKmol]&quot;</span><span class="p">:</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">R</span><span class="p">,</span>
                <span class="s2">&quot;T [K]&quot;</span><span class="p">:</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                <span class="s2">&quot;Kinetic-ignored mets&quot;</span><span class="p">:</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">cobrak_model</span><span class="o">.</span><span class="n">kinetic_ignored_metabolites</span>
                <span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.printing.print_optimization_result" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_optimization_result</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">optimization_dict</span><span class="p">,</span> <span class="n">print_exchanges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_reactions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_enzymes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_mets</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_error_values_if_existing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_stoichiometries</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">conc_rounding</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ignore_unused</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">multiple_tables_per_line</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unused_limit</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Pretty-Print the results of an optimization, including exchanges, reactions, enzymes, and metabolites.</p>
<p>Args:
cobrak_model (Model): The model used for optimization.
optimization_dict (dict[str, float]): A dictionary containing the optimization results.
print_exchanges (bool, optional): Whether to print exchange reactions. Defaults to True.
print_reactions (bool, optional): Whether to print non-exchange reactions. Defaults to True.
print_enzymes (bool, optional): Whether to print enzyme usage. Defaults to True.
print_mets (bool, optional): Whether to print metabolite concentrations. Defaults to True.
add_stoichiometries (bool, optional): Whether to include reaction stoichiometries. Defaults to False.
rounding (int, optional): Number of decimal places to round to. Defaults to 3.
conc_rounding (int, optional): Number of decimal places to round concentrations to. Defaults to 6.
ignore_unused (bool, optional): Whether to ignore reactions with zero flux. Defaults to False.
multiple_tables_per_line (bool, optional): Whether to display multiple tables side by side. Defaults to True.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/printing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">print_optimization_result</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">optimization_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">print_exchanges</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">print_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">print_enzymes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">print_mets</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">print_error_values_if_existing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">add_stoichiometries</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">rounding</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">conc_rounding</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">ignore_unused</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">multiple_tables_per_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">unused_limit</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-4</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pretty-Print the results of an optimization, including exchanges, reactions, enzymes, and metabolites.</span>

<span class="sd">    Args:</span>
<span class="sd">    cobrak_model (Model): The model used for optimization.</span>
<span class="sd">    optimization_dict (dict[str, float]): A dictionary containing the optimization results.</span>
<span class="sd">    print_exchanges (bool, optional): Whether to print exchange reactions. Defaults to True.</span>
<span class="sd">    print_reactions (bool, optional): Whether to print non-exchange reactions. Defaults to True.</span>
<span class="sd">    print_enzymes (bool, optional): Whether to print enzyme usage. Defaults to True.</span>
<span class="sd">    print_mets (bool, optional): Whether to print metabolite concentrations. Defaults to True.</span>
<span class="sd">    add_stoichiometries (bool, optional): Whether to include reaction stoichiometries. Defaults to False.</span>
<span class="sd">    rounding (int, optional): Number of decimal places to round to. Defaults to 3.</span>
<span class="sd">    conc_rounding (int, optional): Number of decimal places to round concentrations to. Defaults to 6.</span>
<span class="sd">    ignore_unused (bool, optional): Whether to ignore reactions with zero flux. Defaults to False.</span>
<span class="sd">    multiple_tables_per_line (bool, optional): Whether to display multiple tables side by side. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">table_columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Table</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">all_fluxes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">optimization_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">optimization_dict</span>
    <span class="p">]</span>
    <span class="n">min_flux</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">all_fluxes</span><span class="p">)</span>
    <span class="n">max_flux</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">all_fluxes</span><span class="p">)</span>
    <span class="n">all_dfs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">optimization_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">optimization_dict</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">DF_VAR_PREFIX</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">substrate_reac_ids</span><span class="p">,</span> <span class="n">product_reac_ids</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">get_substrate_and_product_exchanges</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">optimization_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">print_exchanges</span>
        <span class="k">else</span> <span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">print_exchanges</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">title</span><span class="p">,</span> <span class="n">exchange_ids</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;Substrates&quot;</span><span class="p">,</span> <span class="n">substrate_reac_ids</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;Products&quot;</span><span class="p">,</span> <span class="n">product_reac_ids</span><span class="p">),</span>
        <span class="p">):</span>
            <span class="n">exchange_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">title_justify</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
            <span class="n">exchange_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">)</span>
            <span class="n">exchange_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Flux&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">exchange_id</span> <span class="ow">in</span> <span class="n">exchange_ids</span><span class="p">:</span>
                <span class="n">exchange_flux</span> <span class="o">=</span> <span class="n">optimization_dict</span><span class="p">[</span><span class="n">exchange_id</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">ignore_unused</span> <span class="ow">and</span> <span class="n">exchange_flux</span> <span class="o">&lt;=</span> <span class="n">unused_limit</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">exchange_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
                    <span class="n">exchange_id</span><span class="p">,</span>
                    <span class="n">_mapcolored</span><span class="p">(</span>
                        <span class="nb">round</span><span class="p">(</span><span class="n">optimization_dict</span><span class="p">[</span><span class="n">exchange_id</span><span class="p">],</span> <span class="n">rounding</span><span class="p">),</span>
                        <span class="n">min_flux</span><span class="p">,</span>
                        <span class="n">max_flux</span><span class="p">,</span>
                        <span class="n">prefix</span><span class="o">=</span><span class="n">_zero_prefix</span><span class="p">(</span><span class="n">exchange_flux</span><span class="p">),</span>
                        <span class="n">suffix</span><span class="o">=</span><span class="n">_zero_suffix</span><span class="p">(</span><span class="n">exchange_flux</span><span class="p">),</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="n">table_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exchange_table</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">print_reactions</span><span class="p">:</span>
        <span class="n">reac_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Non-exchange reactions&quot;</span> <span class="k">if</span> <span class="n">print_exchanges</span> <span class="k">else</span> <span class="s2">&quot;Reactions&quot;</span><span class="p">,</span>
            <span class="n">title_justify</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">add_stoichiometries</span><span class="p">:</span>
            <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Stoichiometries&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;df&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">reac_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">sort_dict_keys</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ignore_unused</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">optimization_dict</span>
                <span class="ow">or</span> <span class="n">optimization_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">unused_limit</span>
            <span class="p">):</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">optimization_dict</span><span class="p">)</span>
                <span class="ow">or</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">in</span> <span class="n">product_reac_ids</span><span class="p">)</span>
                <span class="ow">or</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">in</span> <span class="n">substrate_reac_ids</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">arguments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">add_stoichiometries</span><span class="p">:</span>
                <span class="n">arguments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_reaction_string</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">))</span>

            <span class="n">reac_flux</span> <span class="o">=</span> <span class="n">optimization_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
            <span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="n">_zero_prefix</span><span class="p">(</span><span class="n">reac_flux</span><span class="p">),</span> <span class="n">_zero_suffix</span><span class="p">(</span><span class="n">reac_flux</span><span class="p">)</span>

            <span class="n">arguments</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">_mapcolored</span><span class="p">(</span>
                        <span class="nb">round</span><span class="p">(</span><span class="n">reac_flux</span><span class="p">,</span> <span class="n">rounding</span><span class="p">),</span>
                        <span class="n">min_flux</span><span class="p">,</span>
                        <span class="n">max_flux</span><span class="p">,</span>
                        <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
                        <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">_get_mapcolored_value_or_na</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DF_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">optimization_dict</span><span class="p">,</span>
                        <span class="nb">min</span><span class="p">(</span><span class="n">all_dfs</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_dfs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span><span class="p">,</span>
                        <span class="nb">max</span><span class="p">(</span><span class="n">all_dfs</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_dfs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.0</span><span class="p">,</span>
                        <span class="n">rounding</span><span class="o">=</span><span class="n">rounding</span><span class="p">,</span>
                        <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
                        <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">_get_mapcolored_value_or_na</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">KAPPA_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">optimization_dict</span><span class="p">,</span>
                        <span class="mf">0.0</span><span class="p">,</span>
                        <span class="mf">1.0</span><span class="p">,</span>
                        <span class="n">rounding</span><span class="o">=</span><span class="n">rounding</span><span class="p">,</span>
                        <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
                        <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">_get_mapcolored_value_or_na</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">GAMMA_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">optimization_dict</span><span class="p">,</span>
                        <span class="mf">0.0</span><span class="p">,</span>
                        <span class="mf">1.0</span><span class="p">,</span>
                        <span class="n">rounding</span><span class="o">=</span><span class="n">rounding</span><span class="p">,</span>
                        <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
                        <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">_get_mapcolored_value_or_na</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">IOTA_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">optimization_dict</span><span class="p">,</span>
                        <span class="mf">0.0</span><span class="p">,</span>
                        <span class="mf">1.0</span><span class="p">,</span>
                        <span class="n">rounding</span><span class="o">=</span><span class="n">rounding</span><span class="p">,</span>
                        <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
                        <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">_get_mapcolored_value_or_na</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ALPHA_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">optimization_dict</span><span class="p">,</span>
                        <span class="mf">0.0</span><span class="p">,</span>
                        <span class="mf">1.0</span><span class="p">,</span>
                        <span class="n">rounding</span><span class="o">=</span><span class="n">rounding</span><span class="p">,</span>
                        <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
                        <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">reac_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">arguments</span><span class="p">)</span>
        <span class="n">table_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_table</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">print_enzymes</span><span class="p">:</span>
        <span class="n">enzyme_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Enzyme usage&quot;</span><span class="p">,</span> <span class="n">title_justify</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="n">enzyme_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Pool %&quot;</span><span class="p">)</span>
        <span class="n">enzyme_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Enzyme IDs&quot;</span><span class="p">)</span>

        <span class="n">enzyme_usage</span> <span class="o">=</span> <span class="n">get_enzyme_usage_by_protein_pool_fraction</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="p">,</span> <span class="n">optimization_dict</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">pool_fraction</span><span class="p">,</span> <span class="n">enzyme_ids</span> <span class="ow">in</span> <span class="n">enzyme_usage</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">ignore_unused</span> <span class="ow">and</span> <span class="n">pool_fraction</span> <span class="o">&lt;=</span> <span class="n">unused_limit</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">enzyme_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
                <span class="n">_mapcolored</span><span class="p">(</span>
                    <span class="nb">round</span><span class="p">(</span><span class="n">pool_fraction</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">rounding</span><span class="p">),</span>
                    <span class="mf">0.0</span><span class="p">,</span>
                    <span class="mf">100.0</span><span class="p">,</span>
                    <span class="n">prefix</span><span class="o">=</span><span class="n">_zero_prefix</span><span class="p">(</span><span class="n">pool_fraction</span><span class="p">),</span>
                    <span class="n">suffix</span><span class="o">=</span><span class="n">_zero_suffix</span><span class="p">(</span><span class="n">pool_fraction</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">enzyme_ids</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="n">table_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">enzyme_table</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">print_mets</span><span class="p">:</span>
        <span class="n">met_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Metabolites&quot;</span><span class="p">,</span> <span class="n">title_justify</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="n">met_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">)</span>
        <span class="n">met_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Concentration&quot;</span><span class="p">)</span>
        <span class="n">met_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Consumption&quot;</span><span class="p">)</span>
        <span class="n">met_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Production&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">metabolite</span> <span class="ow">in</span> <span class="n">sort_dict_keys</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">met_var_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">LNCONC_VAR_PREFIX</span><span class="si">}{</span><span class="n">met_id</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">consumption</span><span class="p">,</span> <span class="n">production</span> <span class="o">=</span> <span class="n">get_metabolite_consumption_and_production</span><span class="p">(</span>
                <span class="n">cobrak_model</span><span class="p">,</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">optimization_dict</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">ignore_unused</span> <span class="ow">and</span> <span class="n">production</span> <span class="o">&lt;=</span> <span class="n">unused_limit</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="n">_zero_prefix</span><span class="p">(</span><span class="n">consumption</span><span class="p">),</span> <span class="n">_zero_suffix</span><span class="p">(</span><span class="n">consumption</span><span class="p">)</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span><span class="n">met_id</span><span class="p">]</span>
            <span class="n">arguments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">_get_mapcolored_value_or_na</span><span class="p">(</span>
                    <span class="n">met_var_id</span><span class="p">,</span>
                    <span class="n">optimization_dict</span><span class="p">,</span>
                    <span class="n">metabolite</span><span class="o">.</span><span class="n">log_min_conc</span><span class="p">,</span>
                    <span class="n">metabolite</span><span class="o">.</span><span class="n">log_max_conc</span><span class="p">,</span>
                    <span class="n">apply</span><span class="o">=</span><span class="n">exp</span><span class="p">,</span>
                    <span class="n">special_value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                    <span class="n">rounding</span><span class="o">=</span><span class="n">conc_rounding</span><span class="p">,</span>
                    <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
                    <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="n">arguments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_none_as_na</span><span class="p">(</span><span class="n">consumption</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">))</span>
            <span class="n">arguments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_none_as_na</span><span class="p">(</span><span class="n">production</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">))</span>

            <span class="n">met_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">arguments</span><span class="p">)</span>
        <span class="n">table_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">met_table</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="n">print_error_values_if_existing</span>
        <span class="ow">and</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">ERROR_VAR_PREFIX</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">optimization_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="p">)</span>
        <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="p">):</span>
        <span class="n">error_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Errors&quot;</span><span class="p">,</span> <span class="n">title_justify</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="n">error_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">)</span>
        <span class="n">sorted_error_values</span> <span class="o">=</span> <span class="n">sort_dict_keys</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="n">key</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">ERROR_VAR_PREFIX</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]:</span> <span class="n">value</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">optimization_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">ERROR_VAR_PREFIX</span><span class="p">)</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="n">ERROR_SUM_VAR_ID</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">min_error_value</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">sorted_error_values</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="n">max_error_value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">sorted_error_values</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">error_name</span><span class="p">,</span> <span class="n">error_value</span> <span class="ow">in</span> <span class="n">sorted_error_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">ignore_unused</span> <span class="ow">and</span> <span class="p">(</span><span class="n">error_value</span> <span class="o">&lt;=</span> <span class="n">unused_limit</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="n">_zero_prefix</span><span class="p">(</span><span class="n">error_value</span><span class="p">),</span> <span class="n">_zero_suffix</span><span class="p">(</span><span class="n">error_value</span><span class="p">)</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">arguments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_name</span><span class="p">)</span>
            <span class="n">arguments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">_get_mapcolored_value_or_na</span><span class="p">(</span>
                    <span class="n">error_name</span><span class="p">,</span>
                    <span class="n">sorted_error_values</span><span class="p">,</span>
                    <span class="n">min_value</span><span class="o">=</span><span class="n">min_error_value</span><span class="p">,</span>
                    <span class="n">max_value</span><span class="o">=</span><span class="n">max_error_value</span><span class="p">,</span>
                    <span class="n">prefix</span><span class="o">=</span><span class="n">prefix</span><span class="p">,</span>
                    <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">error_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">arguments</span><span class="p">)</span>
        <span class="n">error_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="s2">&quot;SUM&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">optimization_dict</span><span class="p">[</span><span class="n">ERROR_SUM_VAR_ID</span><span class="p">])])</span>
        <span class="n">table_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_table</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">multiple_tables_per_line</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">Columns</span><span class="p">(</span><span class="n">table_columns</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">table_columns</span><span class="p">:</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span>
        <span class="s2">&quot;OBJECTIVE VALUE:&quot;</span><span class="p">,</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">optimization_dict</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]),</span>
        <span class="s2">&quot;| SOLVE STATUS OK?&quot;</span><span class="p">,</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">optimization_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.printing.print_strkey_dict_as_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_strkey_dict_as_table</span><span class="p">(</span><span class="n">dictionary</span><span class="p">,</span> <span class="n">table_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">key_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">value_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Print a dictionary as a formatted table.</p>
<p>Args:
dictionary (dict[str, Any]): The dictionary to print.
table_title (str, optional): The title of the table. Defaults to "".
key_title (str, optional): The title for the key column. Defaults to "".
value_title (str, optional): The title for the value column. Defaults to "".</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/printing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">print_strkey_dict_as_table</span><span class="p">(</span>
    <span class="n">dictionary</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">table_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">key_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">value_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print a dictionary as a formatted table.</span>

<span class="sd">    Args:</span>
<span class="sd">    dictionary (dict[str, Any]): The dictionary to print.</span>
<span class="sd">    table_title (str, optional): The title of the table. Defaults to &quot;&quot;.</span>
<span class="sd">    key_title (str, optional): The title for the key column. Defaults to &quot;&quot;.</span>
<span class="sd">    value_title (str, optional): The title for the value column. Defaults to &quot;&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">table_title</span><span class="p">,</span> <span class="n">title_justify</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">show_header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">key_title</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">,</span> <span class="n">no_wrap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">value_title</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;magenta&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sort_dict_keys</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
    <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.printing.print_variability_result" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_variability_result</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">,</span> <span class="n">print_exchanges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_reacs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_enzymes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">print_mets</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ignore_unused</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_stoichiometries</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">multiple_tables_per_line</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Print the variability analysis results, including exchanges, reactions, enzymes, and metabolites.</p>
<p>Args:
cobrak_model (Model): The model used for variability analysis.
variability_dict (dict[str, tuple[float, float]]): A dictionary containing the variability results.
print_exchanges (bool, optional): Whether to print exchange reactions. Defaults to True.
print_reacs (bool, optional): Whether to print non-exchange reactions. Defaults to True.
print_enzymes (bool, optional): Whether to print enzyme usage. Defaults to False.
print_mets (bool, optional): Whether to print metabolite concentrations. Defaults to True.
ignore_unused (bool, optional): Whether to ignore reactions with zero flux. Defaults to False.
add_stoichiometries (bool, optional): Whether to include reaction stoichiometries. Defaults to False.
rounding (int, optional): Number of decimal places to round to. Defaults to 3.
multiple_tables_per_line (bool, optional): Whether to display multiple tables side by side. Defaults to True.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/printing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">print_variability_result</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">print_exchanges</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">print_reacs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">print_enzymes</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">print_mets</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ignore_unused</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">add_stoichiometries</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">rounding</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">multiple_tables_per_line</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print the variability analysis results, including exchanges, reactions, enzymes, and metabolites.</span>

<span class="sd">    Args:</span>
<span class="sd">    cobrak_model (Model): The model used for variability analysis.</span>
<span class="sd">    variability_dict (dict[str, tuple[float, float]]): A dictionary containing the variability results.</span>
<span class="sd">    print_exchanges (bool, optional): Whether to print exchange reactions. Defaults to True.</span>
<span class="sd">    print_reacs (bool, optional): Whether to print non-exchange reactions. Defaults to True.</span>
<span class="sd">    print_enzymes (bool, optional): Whether to print enzyme usage. Defaults to False.</span>
<span class="sd">    print_mets (bool, optional): Whether to print metabolite concentrations. Defaults to True.</span>
<span class="sd">    ignore_unused (bool, optional): Whether to ignore reactions with zero flux. Defaults to False.</span>
<span class="sd">    add_stoichiometries (bool, optional): Whether to include reaction stoichiometries. Defaults to False.</span>
<span class="sd">    rounding (int, optional): Number of decimal places to round to. Defaults to 3.</span>
<span class="sd">    multiple_tables_per_line (bool, optional): Whether to display multiple tables side by side. Defaults to True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">table_columns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Table</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">substrate_reac_ids</span><span class="p">,</span> <span class="n">product_reac_ids</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">get_substrate_and_product_exchanges</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">print_exchanges</span>
        <span class="k">else</span> <span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
    <span class="p">)</span>

    <span class="n">reac_columns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;min(v)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;max(v)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;min(df)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;max(df)&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">add_stoichiometries</span><span class="p">:</span>
        <span class="n">reac_columns</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Reac string&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">print_exchanges</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">title</span><span class="p">,</span> <span class="n">exchange_ids</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;Substrates&quot;</span><span class="p">,</span> <span class="n">substrate_reac_ids</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;Products&quot;</span><span class="p">,</span> <span class="n">product_reac_ids</span><span class="p">),</span>
        <span class="p">):</span>
            <span class="n">exchange_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">title_justify</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">add_stoichiometries</span><span class="p">:</span>
                <span class="n">exchange_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;Reac string&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">reac_column</span> <span class="ow">in</span> <span class="n">reac_columns</span><span class="p">:</span>
                <span class="n">exchange_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">reac_column</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">exchange_reac_id</span> <span class="ow">in</span> <span class="n">exchange_ids</span><span class="p">:</span>
                <span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="n">_varcolor</span><span class="p">(</span><span class="n">exchange_reac_id</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">)</span>
                <span class="n">flux_range</span> <span class="o">=</span> <span class="n">_get_var_or_na</span><span class="p">(</span>
                    <span class="n">exchange_reac_id</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">,</span> <span class="n">rounding</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">ignore_unused</span> <span class="ow">and</span> <span class="n">flux_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">arguments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">exchange_reac_id</span><span class="p">,</span>
                    <span class="o">*</span><span class="n">flux_range</span><span class="p">,</span>
                    <span class="o">*</span><span class="n">_get_var_or_na</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DF_VAR_PREFIX</span><span class="si">}{</span><span class="n">exchange_reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">variability_dict</span><span class="p">,</span>
                        <span class="n">rounding</span><span class="p">,</span>
                        <span class="n">prefix</span><span class="p">,</span>
                        <span class="n">suffix</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">]</span>
                <span class="n">exchange_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">arguments</span><span class="p">)</span>
            <span class="n">table_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exchange_table</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">print_reacs</span><span class="p">:</span>
        <span class="n">reacs_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Non-exchange reactions&quot;</span> <span class="k">if</span> <span class="n">print_exchanges</span> <span class="k">else</span> <span class="s2">&quot;Reactions&quot;</span><span class="p">,</span>
            <span class="n">title_justify</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">reac_column</span> <span class="ow">in</span> <span class="n">reac_columns</span><span class="p">:</span>
            <span class="n">reacs_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">reac_column</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">sort_dict_keys</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="p">[</span><span class="o">*</span><span class="n">substrate_reac_ids</span><span class="p">,</span> <span class="o">*</span><span class="n">product_reac_ids</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="n">_varcolor</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">)</span>

            <span class="n">flux_range</span> <span class="o">=</span> <span class="n">_get_var_or_na</span><span class="p">(</span>
                <span class="n">reac_id</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">,</span> <span class="n">rounding</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">ignore_unused</span> <span class="ow">and</span> <span class="n">flux_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">reac_id</span><span class="p">,</span>
                <span class="o">*</span><span class="n">flux_range</span><span class="p">,</span>
                <span class="o">*</span><span class="n">_get_var_or_na</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DF_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">variability_dict</span><span class="p">,</span>
                    <span class="n">rounding</span><span class="p">,</span>
                    <span class="n">prefix</span><span class="p">,</span>
                    <span class="n">suffix</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">]</span>
            <span class="n">reacs_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span><span class="o">*</span><span class="n">arguments</span><span class="p">)</span>
        <span class="n">table_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reacs_table</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">print_enzymes</span><span class="p">:</span>
        <span class="n">enzymes_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Enzymes&quot;</span><span class="p">,</span> <span class="n">title_justify</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="n">enzymes_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">)</span>
        <span class="n">enzymes_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;min(E)&quot;</span><span class="p">)</span>
        <span class="n">enzymes_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;max(E)&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">sort_dict_keys</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">enzyme_var_id</span> <span class="o">=</span> <span class="n">get_reaction_enzyme_var_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)</span>
            <span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span> <span class="o">=</span> <span class="n">_varcolor</span><span class="p">(</span><span class="n">enzyme_var_id</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">)</span>
            <span class="n">conc_range</span> <span class="o">=</span> <span class="n">_get_var_or_na</span><span class="p">(</span>
                <span class="n">enzyme_var_id</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">,</span> <span class="n">rounding</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">ignore_unused</span> <span class="ow">and</span> <span class="n">conc_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">reacs_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
                <span class="o">*</span><span class="p">[</span>
                    <span class="n">enzyme_var_id</span><span class="p">,</span>
                    <span class="n">conc_range</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="n">conc_range</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">table_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">enzymes_table</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">print_mets</span><span class="p">:</span>
        <span class="n">mets_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Metabolites&quot;</span><span class="p">,</span> <span class="n">title_justify</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="n">mets_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">)</span>
        <span class="n">mets_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;min(c)&quot;</span><span class="p">)</span>
        <span class="n">mets_table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s2">&quot;max(c)&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">sort_dict_keys</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">):</span>
            <span class="n">min_conc_str</span><span class="p">,</span> <span class="n">max_conc_str</span> <span class="o">=</span> <span class="n">_get_var_or_na</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">LNCONC_VAR_PREFIX</span><span class="si">}{</span><span class="n">met_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="mi">1_000</span>
            <span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">min_conc</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">min_conc_str</span><span class="p">)),</span> <span class="n">rounding</span><span class="p">))</span>
                <span class="n">max_conc</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">max_conc_str</span><span class="p">)),</span> <span class="n">rounding</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">min_conc</span> <span class="o">=</span> <span class="n">min_conc_str</span>
                <span class="n">max_conc</span> <span class="o">=</span> <span class="n">max_conc_str</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;[blue]&quot;</span> <span class="k">if</span> <span class="n">min_conc</span> <span class="o">!=</span> <span class="n">max_conc</span> <span class="k">else</span> <span class="s2">&quot;[red]&quot;</span>
            <span class="n">mets_table</span><span class="o">.</span><span class="n">add_row</span><span class="p">(</span>
                <span class="o">*</span><span class="p">[</span>
                    <span class="n">met_id</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">min_conc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">max_conc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="n">table_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mets_table</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">multiple_tables_per_line</span><span class="p">:</span>
        <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">Columns</span><span class="p">(</span><span class="n">table_columns</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">table_columns</span><span class="p">:</span>
            <span class="n">console</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.pyomo_functionality" class="doc doc-heading">
            <code>pyomo_functionality</code>


</h2>

    <div class="doc doc-contents ">

        <p>Utilities to work with pyomo ConcreteModel instances directly.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="cobrak.pyomo_functionality.ApproximationPoint" class="doc doc-heading">
            <code>ApproximationPoint</code>


</h3>


    <div class="doc doc-contents ">


        <p>Represents a point in a linear approximation.</p>
<p>This dataclass is used to store the slope, intercept, and x-coordinate of a point in a linear approximation.</p>
<p>Attributes:
- slope (float): The slope of the line passing through this point.
- intercept (float): The y-intercept of the line passing through this point.
- x_point (float): The x-coordinate of this point.</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/pyomo_functionality.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ApproximationPoint</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a point in a linear approximation.</span>

<span class="sd">    This dataclass is used to store the slope, intercept, and x-coordinate of a point in a linear approximation.</span>

<span class="sd">    Attributes:</span>
<span class="sd">    - slope (float): The slope of the line passing through this point.</span>
<span class="sd">    - intercept (float): The y-intercept of the line passing through this point.</span>
<span class="sd">    - x_point (float): The x-coordinate of this point.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">slope</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">intercept</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">x_point</span><span class="p">:</span> <span class="nb">float</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="cobrak.pyomo_functionality.add_linear_approximation_to_pyomo_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_linear_approximation_to_pyomo_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">y_function</span><span class="p">,</span> <span class="n">y_function_derivative</span><span class="p">,</span> <span class="n">x_reference_var_id</span><span class="p">,</span> <span class="n">new_y_var_name</span><span class="p">,</span> <span class="n">min_x</span><span class="p">,</span> <span class="n">max_x</span><span class="p">,</span> <span class="n">max_rel_difference</span><span class="p">,</span> <span class="n">max_num_segments</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">min_abs_error</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add a linear approximation of a given function to a Pyomo model.</p>
<p>This function approximates the provided function <code>y_function</code> with a piecewise linear function
and adds the approximation to the given Pyomo model. The approximation is based on the derivative
of the function <code>y_function_derivative</code>. The approximation is added as a new variable and a set
of constraints to the model.</p>
<p>Parameters:
- model (ConcreteModel): The Pyomo model to which the approximation will be added.
- y_function (Callable[[float], float]): The function to be approximated.
- y_function_derivative (Callable[[float], float]): The derivative of the function to be approximated.
- x_reference_var_id (str): The name of the variable in the model that will be used as the independent variable for the approximation.
- new_y_var_name (str): The name of the new variable that will be added to the model to represent the approximation.
- min_x (float): The minimum value of the independent variable for the approximation.
- max_x (float): The maximum value of the independent variable for the approximation.
- max_rel_difference (float): The maximum allowed relative difference between the approximation and the original function.
- max_num_segments (int, optional): The maximum number of segments to use for the piecewise linear approximation. Defaults to infinity.
- min_abs_error (float, optional): The minimum absolute error allowed between the approximation and the original function. Defaults to 1e-6.</p>
<p>Returns:
- ConcreteModel: The Pyomo model with the added approximation.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/pyomo_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_linear_approximation_to_pyomo_model</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">ConcreteModel</span><span class="p">,</span>
    <span class="n">y_function</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">y_function_derivative</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">x_reference_var_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">new_y_var_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">min_x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">max_x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">max_rel_difference</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">max_num_segments</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
    <span class="n">min_abs_error</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConcreteModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a linear approximation of a given function to a Pyomo model.</span>

<span class="sd">    This function approximates the provided function `y_function` with a piecewise linear function</span>
<span class="sd">    and adds the approximation to the given Pyomo model. The approximation is based on the derivative</span>
<span class="sd">    of the function `y_function_derivative`. The approximation is added as a new variable and a set</span>
<span class="sd">    of constraints to the model.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - model (ConcreteModel): The Pyomo model to which the approximation will be added.</span>
<span class="sd">    - y_function (Callable[[float], float]): The function to be approximated.</span>
<span class="sd">    - y_function_derivative (Callable[[float], float]): The derivative of the function to be approximated.</span>
<span class="sd">    - x_reference_var_id (str): The name of the variable in the model that will be used as the independent variable for the approximation.</span>
<span class="sd">    - new_y_var_name (str): The name of the new variable that will be added to the model to represent the approximation.</span>
<span class="sd">    - min_x (float): The minimum value of the independent variable for the approximation.</span>
<span class="sd">    - max_x (float): The maximum value of the independent variable for the approximation.</span>
<span class="sd">    - max_rel_difference (float): The maximum allowed relative difference between the approximation and the original function.</span>
<span class="sd">    - max_num_segments (int, optional): The maximum number of segments to use for the piecewise linear approximation. Defaults to infinity.</span>
<span class="sd">    - min_abs_error (float, optional): The minimum absolute error allowed between the approximation and the original function. Defaults to 1e-6.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - ConcreteModel: The Pyomo model with the added approximation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Find fitting approximation</span>
    <span class="n">num_segments</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">approximation_points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ApproximationPoint</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">ignored_is</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">x_points</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">min_x</span><span class="p">,</span> <span class="n">max_x</span><span class="p">,</span> <span class="n">num_segments</span><span class="p">)</span>
        <span class="n">approximation_points</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">ApproximationPoint</span><span class="p">(</span>
                <span class="n">slope</span><span class="o">=</span><span class="n">y_function_derivative</span><span class="p">(</span><span class="n">x_point</span><span class="p">),</span>
                <span class="n">intercept</span><span class="o">=</span><span class="n">y_function</span><span class="p">(</span><span class="n">x_point</span><span class="p">)</span>
                <span class="o">-</span> <span class="n">y_function_derivative</span><span class="p">(</span><span class="n">x_point</span><span class="p">)</span> <span class="o">*</span> <span class="n">x_point</span><span class="p">,</span>
                <span class="n">x_point</span><span class="o">=</span><span class="n">x_point</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">x_point</span> <span class="ow">in</span> <span class="n">x_points</span>
        <span class="p">]</span>

        <span class="n">max_found_min_rel_difference</span> <span class="o">=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
        <span class="n">x_midpoints_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_points</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">first_index</span><span class="p">,</span> <span class="n">second_index</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">approximation_points</span><span class="p">[</span><span class="n">first_index</span><span class="p">]</span><span class="o">.</span><span class="n">slope</span>
                <span class="o">-</span> <span class="n">approximation_points</span><span class="p">[</span><span class="n">second_index</span><span class="p">]</span><span class="o">.</span><span class="n">slope</span>
                <span class="o">==</span> <span class="mi">0</span>
            <span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">x_midpoint</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">approximation_points</span><span class="p">[</span><span class="n">second_index</span><span class="p">]</span><span class="o">.</span><span class="n">intercept</span>
                <span class="o">-</span> <span class="n">approximation_points</span><span class="p">[</span><span class="n">first_index</span><span class="p">]</span><span class="o">.</span><span class="n">intercept</span>
            <span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                <span class="n">approximation_points</span><span class="p">[</span><span class="n">first_index</span><span class="p">]</span><span class="o">.</span><span class="n">slope</span>
                <span class="o">-</span> <span class="n">approximation_points</span><span class="p">[</span><span class="n">second_index</span><span class="p">]</span><span class="o">.</span><span class="n">slope</span>
            <span class="p">)</span>
            <span class="n">x_midpoints_data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">first_index</span><span class="p">,</span> <span class="n">second_index</span><span class="p">,</span> <span class="n">x_midpoint</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">first_index</span><span class="p">,</span> <span class="n">second_index</span><span class="p">,</span> <span class="n">x_value</span> <span class="ow">in</span> <span class="n">x_midpoints_data</span><span class="p">:</span>
            <span class="n">real_y</span> <span class="o">=</span> <span class="n">y_function</span><span class="p">(</span><span class="n">x_value</span><span class="p">)</span>
            <span class="n">y_approx_one</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">approximation_points</span><span class="p">[</span><span class="n">first_index</span><span class="p">]</span><span class="o">.</span><span class="n">slope</span> <span class="o">*</span> <span class="n">x_value</span>
                <span class="o">+</span> <span class="n">approximation_points</span><span class="p">[</span><span class="n">first_index</span><span class="p">]</span><span class="o">.</span><span class="n">intercept</span>
            <span class="p">)</span>
            <span class="n">y_approx_two</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">approximation_points</span><span class="p">[</span><span class="n">second_index</span><span class="p">]</span><span class="o">.</span><span class="n">slope</span> <span class="o">*</span> <span class="n">x_value</span>
                <span class="o">+</span> <span class="n">approximation_points</span><span class="p">[</span><span class="n">second_index</span><span class="p">]</span><span class="o">.</span><span class="n">intercept</span>
            <span class="p">)</span>
            <span class="n">errors_absolute</span> <span class="o">=</span> <span class="p">(</span><span class="n">real_y</span> <span class="o">-</span> <span class="n">y_approx_one</span><span class="p">,</span> <span class="n">real_y</span> <span class="o">-</span> <span class="n">y_approx_two</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">errors_absolute</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_error</span><span class="p">:</span>
                <span class="n">ignored_is</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">first_index</span><span class="p">)</span>
            <span class="n">errors_relative</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">abs</span><span class="p">(</span><span class="n">errors_absolute</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">real_y</span><span class="p">),</span>
                <span class="nb">abs</span><span class="p">(</span><span class="n">errors_absolute</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">real_y</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">max_found_min_rel_difference</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                <span class="n">max_found_min_rel_difference</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">errors_relative</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">max_found_min_rel_difference</span> <span class="o">&lt;=</span> <span class="n">max_rel_difference</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">num_segments</span> <span class="o">==</span> <span class="n">max_num_segments</span>
        <span class="p">):</span>
            <span class="k">break</span>

        <span class="n">num_segments</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1"># Add approximation to model</span>
    <span class="n">min_approx_y</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">approximation_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">slope</span> <span class="o">*</span> <span class="n">x_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">approximation_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">intercept</span>
    <span class="p">)</span>
    <span class="n">max_approx_y</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">approximation_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">slope</span> <span class="o">*</span> <span class="n">x_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="o">+</span> <span class="n">approximation_points</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">intercept</span>
    <span class="p">)</span>
    <span class="nb">setattr</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">new_y_var_name</span><span class="p">,</span> <span class="n">Var</span><span class="p">(</span><span class="n">within</span><span class="o">=</span><span class="n">Reals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="n">min_approx_y</span><span class="p">,</span> <span class="n">max_approx_y</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">approx_i</span><span class="p">,</span> <span class="n">approximation_point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">approximation_points</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">approx_i</span> <span class="ow">in</span> <span class="n">ignored_is</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="nb">setattr</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">new_y_var_name</span><span class="si">}</span><span class="s2">_constraint_</span><span class="si">{</span><span class="n">approx_i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">Constraint</span><span class="p">(</span>
                <span class="n">rule</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">new_y_var_name</span><span class="p">)</span>
                <span class="o">&gt;=</span> <span class="n">approximation_point</span><span class="o">.</span><span class="n">slope</span> <span class="o">*</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x_reference_var_id</span><span class="p">)</span>
                <span class="o">+</span> <span class="n">approximation_point</span><span class="o">.</span><span class="n">intercept</span>
            <span class="p">),</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.pyomo_functionality.add_objective_to_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_objective_to_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">objective_target</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">objective_name</span><span class="p">,</span> <span class="n">objective_var_name</span><span class="o">=</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add an objective function to a Pyomo model.</p>
<p>This function adds an objective function to the given Pyomo model based on the provided target and sense.
The target can be a single variable name or a dictionary of variable names with their corresponding multipliers.
The sense can be either maximization (as int, value &gt; 0) or minimization (as int, value &lt; 0).</p>
<p>Parameters:
- model (ConcreteModel): The Pyomo model to which the objective function will be added.
- objective_target (str | dict[str, float]): The target for the objective function. It can be a single variable name or a dictionary of variable names with their corresponding multipliers.
- objective_sense (int): The sense of the objective function. It can be an integer (positive for maximization, negative for minimization, zero for no objective).
- objective_name (str): The name of the new objective function that will be added to the model.
- objective_var_name (str, optional): The name of the new variable that will be added to the model to represent the objective function. Defaults to OBJECTIVE_VAR_NAME.</p>
<p>Returns:
- ConcreteModel: The Pyomo model with the added objective function.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/pyomo_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_objective_to_model</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">ConcreteModel</span><span class="p">,</span>
    <span class="n">objective_target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">objective_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">objective_var_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">OBJECTIVE_VAR_NAME</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConcreteModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add an objective function to a Pyomo model.</span>

<span class="sd">    This function adds an objective function to the given Pyomo model based on the provided target and sense.</span>
<span class="sd">    The target can be a single variable name or a dictionary of variable names with their corresponding multipliers.</span>
<span class="sd">    The sense can be either maximization (as int, value &gt; 0) or minimization (as int, value &lt; 0).</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - model (ConcreteModel): The Pyomo model to which the objective function will be added.</span>
<span class="sd">    - objective_target (str | dict[str, float]): The target for the objective function. It can be a single variable name or a dictionary of variable names with their corresponding multipliers.</span>
<span class="sd">    - objective_sense (int): The sense of the objective function. It can be an integer (positive for maximization, negative for minimization, zero for no objective).</span>
<span class="sd">    - objective_name (str): The name of the new objective function that will be added to the model.</span>
<span class="sd">    - objective_var_name (str, optional): The name of the new variable that will be added to the model to represent the objective function. Defaults to OBJECTIVE_VAR_NAME.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - ConcreteModel: The Pyomo model with the added objective function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">setattr</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span>
        <span class="n">objective_name</span><span class="p">,</span>
        <span class="n">get_objective</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span>
            <span class="n">objective_target</span><span class="p">,</span>
            <span class="n">objective_sense</span><span class="p">,</span>
            <span class="n">objective_var_name</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.pyomo_functionality.get_model_var_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_model_var_names</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Extracts and returns a list of names of all variable components from a Pyomo model.</p>
<p>This function iterates over all variable objects (<code>Var</code>) defined in the given Pyomo concrete model instance.
It collects the name attribute of each variable object and returns these names as a list of strings.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="pyomo.environ.ConcreteModel">ConcreteModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Pyomo concrete model instance containing various components, including variables.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]: A list of string names representing all variable objects in the provided Pyomo model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Examples:</p>
<pre><code>&gt;&gt;&gt; from pyomo.environ import ConcreteModel, Var
&gt;&gt;&gt; m = ConcreteModel()
&gt;&gt;&gt; m.x = Var(initialize=1.0)
&gt;&gt;&gt; m.y = Var([1, 2], initialize=lambda m,i: i)  # Creates two variables y[1] and y[2]
&gt;&gt;&gt; var_names = get_model_var_names(m)
&gt;&gt;&gt; print(var_names)
['x', 'y[1]', 'y[2]']
</code></pre>


            <details class="quote">
              <summary>Source code in <code>cobrak/pyomo_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_model_var_names</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">ConcreteModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts and returns a list of names of all variable components from a Pyomo model.</span>

<span class="sd">    This function iterates over all variable objects (`Var`) defined in the given Pyomo concrete model instance.</span>
<span class="sd">    It collects the name attribute of each variable object and returns these names as a list of strings.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        model (ConcreteModel): A Pyomo concrete model instance containing various components, including variables.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: A list of string names representing all variable objects in the provided Pyomo model.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from pyomo.environ import ConcreteModel, Var</span>
<span class="sd">        &gt;&gt;&gt; m = ConcreteModel()</span>
<span class="sd">        &gt;&gt;&gt; m.x = Var(initialize=1.0)</span>
<span class="sd">        &gt;&gt;&gt; m.y = Var([1, 2], initialize=lambda m,i: i)  # Creates two variables y[1] and y[2]</span>
<span class="sd">        &gt;&gt;&gt; var_names = get_model_var_names(m)</span>
<span class="sd">        &gt;&gt;&gt; print(var_names)</span>
<span class="sd">        [&#39;x&#39;, &#39;y[1]&#39;, &#39;y[2]&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">component_objects</span><span class="p">(</span><span class="n">Var</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.pyomo_functionality.get_objective" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_objective</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">objective_target</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">,</span> <span class="n">objective_var_name</span><span class="o">=</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create and return a pyomo objective function for the given model.</p>
<p>Sets up an objective function based on the provided target and sense.
The target can be a single variable or a weighted sum of multiple variables.
The sense can be either maximization (as int, value &gt; 0) or minimization (as int, value &lt; 0).</p>
<p>Parameters:
- model (ConcreteModel): The Pyomo model to which the objective function will be added.
- objective_target (str | dict[str, float]): The target for the objective function. It can be a single variable name or a dictionary of
                                             variable names with their corresponding multipliers.
- objective_sense (int): The sense of the objective function. It can be an integer
                                    (positive for maximization, negative for minimization, zero for no objective).</p>
<p>Returns:
- Objective: The Pyomo Objective object representing the objective function.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/pyomo_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_objective</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">ConcreteModel</span><span class="p">,</span>
    <span class="n">objective_target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">objective_var_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">OBJECTIVE_VAR_NAME</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Objective</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create and return a pyomo objective function for the given model.</span>

<span class="sd">    Sets up an objective function based on the provided target and sense.</span>
<span class="sd">    The target can be a single variable or a weighted sum of multiple variables.</span>
<span class="sd">    The sense can be either maximization (as int, value &gt; 0) or minimization (as int, value &lt; 0).</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - model (ConcreteModel): The Pyomo model to which the objective function will be added.</span>
<span class="sd">    - objective_target (str | dict[str, float]): The target for the objective function. It can be a single variable name or a dictionary of</span>
<span class="sd">                                                 variable names with their corresponding multipliers.</span>
<span class="sd">    - objective_sense (int): The sense of the objective function. It can be an integer</span>
<span class="sd">                                        (positive for maximization, negative for minimization, zero for no objective).</span>

<span class="sd">    Returns:</span>
<span class="sd">    - Objective: The Pyomo Objective object representing the objective function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">expr</span> <span class="o">=</span> <span class="n">set_target_as_var_and_value</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span>
        <span class="n">objective_target</span><span class="p">,</span>
        <span class="n">objective_var_name</span><span class="p">,</span>
        <span class="s2">&quot;constraint_of_&quot;</span> <span class="o">+</span> <span class="n">objective_var_name</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">objective_sense</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">expr</span> <span class="o">*=</span> <span class="n">objective_sense</span>
            <span class="n">pyomo_sense</span> <span class="o">=</span> <span class="n">maximize</span>
        <span class="k">elif</span> <span class="n">objective_sense</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">expr</span> <span class="o">*=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">)</span>
            <span class="n">pyomo_sense</span> <span class="o">=</span> <span class="n">minimize</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># objective_sense == 0</span>
            <span class="n">expr</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">pyomo_sense</span> <span class="o">=</span> <span class="n">minimize</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERROR: Objective sense is </span><span class="si">{</span><span class="n">objective_sense</span><span class="si">}</span><span class="s2">, but must be an integer.&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="k">return</span> <span class="n">Objective</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="n">expr</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">pyomo_sense</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.pyomo_functionality.get_solver" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_solver</span><span class="p">(</span><span class="n">solver_name</span><span class="p">,</span> <span class="n">solver_options</span><span class="p">,</span> <span class="n">solver_attrs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create and configure a solver for the given solver name and options.</p>
<p>This function returns a Pyomo solver using the specified solver name and applies the provided options to it.</p>
<p>Parameters:
- solver_name (str): The name of the solver to be used (e.g., 'glpk', 'cbc').
- solver_options (dict[str, float | int | str]): A dictionary of solver options where keys are option names and values are the corresponding option values.
- solver_attrs (dict[str, float | int | str]): A dictionary of solver attributes where keys are attribute names and values are the corresponding attribute values.</p>
<p>Returns:
- SolverFactoryClass: The configured solver instance.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/pyomo_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_solver</span><span class="p">(</span>
    <span class="n">solver_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">solver_options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">solver_attrs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SolverFactoryClass</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create and configure a solver for the given solver name and options.</span>

<span class="sd">    This function returns a Pyomo solver using the specified solver name and applies the provided options to it.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - solver_name (str): The name of the solver to be used (e.g., &#39;glpk&#39;, &#39;cbc&#39;).</span>
<span class="sd">    - solver_options (dict[str, float | int | str]): A dictionary of solver options where keys are option names and values are the corresponding option values.</span>
<span class="sd">    - solver_attrs (dict[str, float | int | str]): A dictionary of solver attributes where keys are attribute names and values are the corresponding attribute values.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - SolverFactoryClass: The configured solver instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">solver_name</span> <span class="o">==</span> <span class="s2">&quot;ipopt&quot;</span> <span class="ow">and</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">:</span>
        <span class="n">solver</span> <span class="o">=</span> <span class="n">SolverFactory</span><span class="p">(</span><span class="n">solver_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">solver</span> <span class="o">=</span> <span class="n">SolverFactory</span><span class="p">(</span><span class="n">solver_name</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span> <span class="ow">in</span> <span class="n">solver_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">solver</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">option_name</span><span class="p">,</span> <span class="n">option_value</span> <span class="ow">in</span> <span class="n">solver_options</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">solver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="n">option_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">option_value</span>
    <span class="k">return</span> <span class="n">solver</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.pyomo_functionality.set_target_as_var_and_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_target_as_var_and_value</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">constraint_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set a target as a variable and its value in a Pyomo model.</p>
<p>This function adds a new variable to the given Pyomo model and sets its value to the provided target.
The target can be either a single variable name or a dictionary of variable names with their corresponding multipliers.</p>
<p>Parameters:
- model (ConcreteModel): The Pyomo model to which the variable and constraint will be added.
- target (str | dict[str, float]): The target for the new variable. It can be a single variable name or a dictionary of variable names with their corresponding multipliers.
- var_name (str): The name of the new variable that will be added to the model.
- constraint_name (str): The name of the new constraint that will be added to the model to set the value of the new variable.</p>
<p>Returns:
- tuple[ConcreteModel, Expression]: The Pyomo model with the added variable and constraint, and the expression representing the target.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/pyomo_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_target_as_var_and_value</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">ConcreteModel</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">var_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">constraint_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">ConcreteModel</span><span class="p">,</span> <span class="n">Expression</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set a target as a variable and its value in a Pyomo model.</span>

<span class="sd">    This function adds a new variable to the given Pyomo model and sets its value to the provided target.</span>
<span class="sd">    The target can be either a single variable name or a dictionary of variable names with their corresponding multipliers.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - model (ConcreteModel): The Pyomo model to which the variable and constraint will be added.</span>
<span class="sd">    - target (str | dict[str, float]): The target for the new variable. It can be a single variable name or a dictionary of variable names with their corresponding multipliers.</span>
<span class="sd">    - var_name (str): The name of the new variable that will be added to the model.</span>
<span class="sd">    - constraint_name (str): The name of the new constraint that will be added to the model to set the value of the new variable.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - tuple[ConcreteModel, Expression]: The Pyomo model with the added variable and constraint, and the expression representing the target.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">expr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">expr</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">target_id</span><span class="p">,</span> <span class="n">multiplier</span> <span class="ow">in</span> <span class="n">target</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>  <span class="c1"># type: ignore</span>
            <span class="n">expr</span> <span class="o">+=</span> <span class="n">multiplier</span> <span class="o">*</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">target_id</span><span class="p">)</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">Var</span><span class="p">(</span><span class="n">within</span><span class="o">=</span><span class="n">Reals</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">QUASI_INF</span><span class="p">,</span> <span class="n">QUASI_INF</span><span class="p">)))</span>
    <span class="nb">setattr</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span>
        <span class="n">constraint_name</span><span class="p">,</span>
        <span class="n">Constraint</span><span class="p">(</span><span class="n">expr</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">var_name</span><span class="p">)</span> <span class="o">==</span> <span class="n">expr</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">expr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.sabio_rk_functionality" class="doc doc-heading">
            <code>sabio_rk_functionality</code>


</h2>

    <div class="doc doc-contents ">

        <p>Functions and associated dataclasses for retrieving kinetic data from SABIO-RK</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="cobrak.sabio_rk_functionality.SabioDict" class="doc doc-heading">
            <code>SabioDict</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Includes all retrieved SabioEntry instances and shows of which type they are</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/sabio_rk_functionality.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass_json</span>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SabioDict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Includes all retrieved SabioEntry instances and shows of which type they are&quot;&quot;&quot;</span>

    <span class="n">kcat_entries</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">SabioEntry</span><span class="p">]]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Turnover number entries&quot;&quot;&quot;</span>
    <span class="n">km_entries</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">SabioEntry</span><span class="p">]]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Michaelis-Menten constant entries&quot;&quot;&quot;</span>
    <span class="n">ki_entries</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">SabioEntry</span><span class="p">]]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inhibition constant entries&quot;&quot;&quot;</span>
    <span class="n">ka_entries</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">SabioEntry</span><span class="p">]]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Activation constant entries&quot;&quot;&quot;</span>
    <span class="n">hill_entries</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">SabioEntry</span><span class="p">]]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Hill number entries&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioDict.hill_entries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hill_entries</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Hill number entries</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioDict.ka_entries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ka_entries</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Activation constant entries</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioDict.kcat_entries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">kcat_entries</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Turnover number entries</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioDict.ki_entries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ki_entries</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Inhibition constant entries</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioDict.km_entries" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">km_entries</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Michaelis-Menten constant entries</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.sabio_rk_functionality.SabioEntry" class="doc doc-heading">
            <code>SabioEntry</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Represents the COBRAk-relevant data retrieved from a single SABIO-RK entry.</p>
<p>Of which type this entry is (k_cat, k_m, k_i) is not determined here. This is done
in the dataclass SabioDict.</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/sabio_rk_functionality.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass_json</span>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SabioEntry</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents the COBRAk-relevant data retrieved from a single SABIO-RK entry.</span>

<span class="sd">    Of which type this entry is (k_cat, k_m, k_i) is not determined here. This is done</span>
<span class="sd">    in the dataclass SabioDict.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">entry_id</span><span class="p">:</span> <span class="nb">int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The entry&#39;s ID number&quot;&quot;&quot;</span>
    <span class="n">is_recombinant</span><span class="p">:</span> <span class="nb">bool</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Whether or not the entry is from a recombinant enzyme&quot;&quot;&quot;</span>
    <span class="n">kinetics_mechanism_type</span><span class="p">:</span> <span class="nb">str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The reaction&#39;s kinetic mechanism (e.g., &quot;Michaelis-Menten&quot;)&quot;&quot;&quot;</span>
    <span class="n">organism</span><span class="p">:</span> <span class="nb">str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The organism (latin-greek name) associated with this entry&quot;&quot;&quot;</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[None if not given] The measurement&#39;s temperature in C&quot;&quot;&quot;</span>
    <span class="n">ph</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;[None if not given] The measurement&#39;s pH&quot;&quot;&quot;</span>
    <span class="n">parameter_value</span><span class="p">:</span> <span class="nb">float</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The value of the parameter&quot;&quot;&quot;</span>
    <span class="n">parameter_unit</span><span class="p">:</span> <span class="nb">str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The unit of the value&quot;&quot;&quot;</span>
    <span class="n">parameter_associated_species</span><span class="p">:</span> <span class="nb">str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The species (metabolite) associated with the parameter&quot;&quot;&quot;</span>
    <span class="n">substrates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The list of substrate names&quot;&quot;&quot;</span>
    <span class="n">products</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The list of product names&quot;&quot;&quot;</span>
    <span class="n">chebi_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The list of all CHEBI IDs&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioEntry.chebi_ids" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">chebi_ids</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The list of all CHEBI IDs</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioEntry.entry_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">entry_id</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The entry's ID number</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioEntry.is_recombinant" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_recombinant</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Whether or not the entry is from a recombinant enzyme</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioEntry.kinetics_mechanism_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">kinetics_mechanism_type</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The reaction's kinetic mechanism (e.g., "Michaelis-Menten")</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioEntry.organism" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">organism</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The organism (latin-greek name) associated with this entry</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioEntry.parameter_associated_species" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parameter_associated_species</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The species (metabolite) associated with the parameter</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioEntry.parameter_unit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parameter_unit</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The unit of the value</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioEntry.parameter_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parameter_value</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The value of the parameter</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioEntry.ph" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ph</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[None if not given] The measurement's pH</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioEntry.products" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">products</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The list of product names</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioEntry.substrates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">substrates</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The list of substrate names</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.sabio_rk_functionality.SabioEntry.temperature" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">temperature</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>[None if not given] The measurement's temperature in C</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.sabio_rk_functionality.SabioThread" class="doc doc-heading">
            <code>SabioThread</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="threading.Thread">Thread</span></code></p>


        <p>Represents a single Sabio-RK connection, ready for multi-threading (on one CPU core) using the threading module</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/sabio_rk_functionality.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SabioThread</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a single Sabio-RK connection, ready for multi-threading (on one CPU core) using the threading module&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temp_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">start_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes a SabioThread instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            temp_folder (str): The path to the temporary folder where the results will be saved.</span>
<span class="sd">            start_number (int): The starting number for the query range.</span>
<span class="sd">            end_number (int): The ending number for the query range.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">temp_folder</span> <span class="o">=</span> <span class="n">standardize_folder</span><span class="p">(</span><span class="n">temp_folder</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_number</span> <span class="o">=</span> <span class="n">start_number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_number</span> <span class="o">=</span> <span class="n">end_number</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Executes the thread&#39;s SABIO-RK data request</span>

<span class="sd">        Constructs a query string, sends a POST request to the SABIO-RK web service,</span>
<span class="sd">        and writes the response to a file in the temporary folder.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">query_numbers</span> <span class="o">=</span> <span class="s2">&quot; OR &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_number</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="p">)</span>
        <span class="n">query_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;EntryID&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">query_numbers</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">}</span>
        <span class="n">query_string</span> <span class="o">=</span> <span class="s2">&quot; AND &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">query_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="n">query_string</span> <span class="o">+=</span> <span class="s1">&#39; AND Parametertype:(&quot;activation constant&quot; OR &quot;Ki&quot; OR &quot;kcat&quot; OR &quot;km&quot; OR &quot;Hill coefficient&quot;) AND EnzymeType:&quot;wildtype&quot;&#39;</span>
        <span class="n">query</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;fields[]&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;EntryID&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Organism&quot;</span><span class="p">,</span>
                <span class="s2">&quot;IsRecombinant&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ECNumber&quot;</span><span class="p">,</span>
                <span class="s2">&quot;KineticMechanismType&quot;</span><span class="p">,</span>
                <span class="s2">&quot;SabioCompoundID&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ChebiID&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Parameter&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Substrate&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Product&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Temperature&quot;</span><span class="p">,</span>
                <span class="s2">&quot;pH&quot;</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="n">query_string</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="s2">&quot;http://sabiork.h-its.org/sabioRestWebServices/kineticlawsExportTsv&quot;</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
            <span class="n">timeout</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">request</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span>  <span class="c1"># noqa: FURB103</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_folder</span><span class="si">}</span><span class="s2">zzz</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start_number</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="cobrak.sabio_rk_functionality.SabioThread.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">temp_folder</span><span class="p">,</span> <span class="n">start_number</span><span class="p">,</span> <span class="n">end_number</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Initializes a SabioThread instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>temp_folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the temporary folder where the results will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_number</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The starting number for the query range.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_number</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ending number for the query range.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/sabio_rk_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temp_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">start_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes a SabioThread instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        temp_folder (str): The path to the temporary folder where the results will be saved.</span>
<span class="sd">        start_number (int): The starting number for the query range.</span>
<span class="sd">        end_number (int): The ending number for the query range.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">temp_folder</span> <span class="o">=</span> <span class="n">standardize_folder</span><span class="p">(</span><span class="n">temp_folder</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_number</span> <span class="o">=</span> <span class="n">start_number</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">end_number</span> <span class="o">=</span> <span class="n">end_number</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cobrak.sabio_rk_functionality.SabioThread.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Executes the thread's SABIO-RK data request</p>
<p>Constructs a query string, sends a POST request to the SABIO-RK web service,
and writes the response to a file in the temporary folder.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/sabio_rk_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Executes the thread&#39;s SABIO-RK data request</span>

<span class="sd">    Constructs a query string, sends a POST request to the SABIO-RK web service,</span>
<span class="sd">    and writes the response to a file in the temporary folder.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">query_numbers</span> <span class="o">=</span> <span class="s2">&quot; OR &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_number</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_number</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="n">query_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;EntryID&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">query_numbers</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">}</span>
    <span class="n">query_string</span> <span class="o">=</span> <span class="s2">&quot; AND &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">query_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
    <span class="n">query_string</span> <span class="o">+=</span> <span class="s1">&#39; AND Parametertype:(&quot;activation constant&quot; OR &quot;Ki&quot; OR &quot;kcat&quot; OR &quot;km&quot; OR &quot;Hill coefficient&quot;) AND EnzymeType:&quot;wildtype&quot;&#39;</span>
    <span class="n">query</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;fields[]&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;EntryID&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Organism&quot;</span><span class="p">,</span>
            <span class="s2">&quot;IsRecombinant&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ECNumber&quot;</span><span class="p">,</span>
            <span class="s2">&quot;KineticMechanismType&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SabioCompoundID&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ChebiID&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Parameter&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Substrate&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Product&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Temperature&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pH&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="n">query_string</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">&quot;http://sabiork.h-its.org/sabioRestWebServices/kineticlawsExportTsv&quot;</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
        <span class="n">timeout</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">request</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span>  <span class="c1"># noqa: FURB103</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_folder</span><span class="si">}</span><span class="s2">zzz</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start_number</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="cobrak.sabio_rk_functionality.get_full_sabio_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_full_sabio_dict</span><span class="p">(</span><span class="n">sabio_target_folder</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parses a SABIO-RK web query TSV file from the target folder to create a SabioDict instance containing SABIO-RK entries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sabio_target_folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the folder containing the TSV file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>SabioDict</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="SabioDict


  
      dataclass
   (cobrak.sabio_rk_functionality.SabioDict)" href="#cobrak.sabio_rk_functionality.SabioDict">SabioDict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A SabioDict instance whichm in turn, contains SabioEntry instances</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/sabio_rk_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_full_sabio_dict</span><span class="p">(</span><span class="n">sabio_target_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SabioDict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses a SABIO-RK web query TSV file from the target folder to create a SabioDict instance containing SABIO-RK entries.</span>

<span class="sd">    Args:</span>
<span class="sd">        sabio_target_folder (str): The path to the folder containing the TSV file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SabioDict: A SabioDict instance whichm in turn, contains SabioEntry instances</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tsv_str</span> <span class="o">=</span> <span class="n">_get_sabio_tsv_str</span><span class="p">(</span><span class="n">sabio_target_folder</span><span class="p">)</span>

    <span class="n">tsv_lines</span> <span class="o">=</span> <span class="n">tsv_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">titles</span> <span class="o">=</span> <span class="n">tsv_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">tsv_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">sabio_dict</span> <span class="o">=</span> <span class="n">SabioDict</span><span class="p">({},</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{})</span>
    <span class="k">for</span> <span class="n">tsv_line</span> <span class="ow">in</span> <span class="n">tsv_lines</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">tsv_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">parameter_value_str</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">titles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;parameter.startValue&quot;</span><span class="p">)]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">parameter_value_str</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">parameter_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parameter_value_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parameter_value</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">continue</span>  <span class="c1"># There is no kinetic parameter that is just 0 or below</span>

        <span class="n">parameter_type_str</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">titles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;parameter.type&quot;</span><span class="p">)]</span>
        <span class="k">match</span> <span class="n">parameter_type_str</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="k">case</span> <span class="s2">&quot;kcat&quot;</span><span class="p">:</span>
                <span class="n">sabio_dict_pointer</span> <span class="o">=</span> <span class="n">sabio_dict</span><span class="o">.</span><span class="n">kcat_entries</span>
            <span class="k">case</span> <span class="s2">&quot;km&quot;</span><span class="p">:</span>
                <span class="n">sabio_dict_pointer</span> <span class="o">=</span> <span class="n">sabio_dict</span><span class="o">.</span><span class="n">km_entries</span>
            <span class="k">case</span> <span class="s2">&quot;ki&quot;</span><span class="p">:</span>
                <span class="n">sabio_dict_pointer</span> <span class="o">=</span> <span class="n">sabio_dict</span><span class="o">.</span><span class="n">ki_entries</span>
            <span class="k">case</span> <span class="s2">&quot;activation constant&quot;</span><span class="p">:</span>
                <span class="n">sabio_dict_pointer</span> <span class="o">=</span> <span class="n">sabio_dict</span><span class="o">.</span><span class="n">ka_entries</span>
            <span class="k">case</span> <span class="s2">&quot;hill coefficient&quot;</span><span class="p">:</span>
                <span class="n">sabio_dict_pointer</span> <span class="o">=</span> <span class="n">sabio_dict</span><span class="o">.</span><span class="n">hill_entries</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="n">ec_number</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">titles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;ECNumber&quot;</span><span class="p">)]</span>
        <span class="n">entry_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">titles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;EntryID&quot;</span><span class="p">)])</span>
        <span class="n">organism</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">titles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;Organism&quot;</span><span class="p">)]</span>
        <span class="n">is_recombinant</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">titles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;IsRecombinant&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span>
        <span class="n">kinetics_mechanism_type</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">titles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;KineticMechanismType&quot;</span><span class="p">)]</span>
        <span class="n">parameter_unit</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">titles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;parameter.unit&quot;</span><span class="p">)]</span>
        <span class="n">parameter_associated_species</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">titles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;parameter.associatedSpecies&quot;</span><span class="p">)]</span>
        <span class="n">substrates</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">titles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;Substrate&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
        <span class="n">products</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">titles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;Product&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
        <span class="n">chebi_ids</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">titles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;ChebiID&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">temperature</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">titles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;Temperature&quot;</span><span class="p">)])</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
            <span class="n">temperature</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ph</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">titles</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;pH&quot;</span><span class="p">)])</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
            <span class="n">ph</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">ec_number</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sabio_dict_pointer</span><span class="p">:</span>
            <span class="n">sabio_dict_pointer</span><span class="p">[</span><span class="n">ec_number</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sabio_dict_pointer</span><span class="p">[</span><span class="n">ec_number</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">SabioEntry</span><span class="p">(</span>
                <span class="n">entry_id</span><span class="o">=</span><span class="n">entry_id</span><span class="p">,</span>
                <span class="n">is_recombinant</span><span class="o">=</span><span class="n">is_recombinant</span><span class="p">,</span>
                <span class="n">kinetics_mechanism_type</span><span class="o">=</span><span class="n">kinetics_mechanism_type</span><span class="p">,</span>
                <span class="n">organism</span><span class="o">=</span><span class="n">organism</span><span class="p">,</span>
                <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
                <span class="n">ph</span><span class="o">=</span><span class="n">ph</span><span class="p">,</span>
                <span class="n">parameter_unit</span><span class="o">=</span><span class="n">parameter_unit</span><span class="p">,</span>
                <span class="n">parameter_value</span><span class="o">=</span><span class="n">parameter_value</span><span class="p">,</span>
                <span class="n">parameter_associated_species</span><span class="o">=</span><span class="n">parameter_associated_species</span><span class="p">,</span>
                <span class="n">substrates</span><span class="o">=</span><span class="n">substrates</span><span class="p">,</span>
                <span class="n">products</span><span class="o">=</span><span class="n">products</span><span class="p">,</span>
                <span class="n">chebi_ids</span><span class="o">=</span><span class="n">chebi_ids</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">sabio_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.sabio_rk_functionality.sabio_select_enzyme_kinetic_data_for_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sabio_select_enzyme_kinetic_data_for_model</span><span class="p">(</span><span class="n">cobra_model</span><span class="p">,</span> <span class="n">sabio_target_folder</span><span class="p">,</span> <span class="n">base_species</span><span class="p">,</span> <span class="n">ncbi_parsed_json_path</span><span class="p">,</span> <span class="n">bigg_metabolites_json_path</span><span class="p">,</span> <span class="n">kinetic_ignored_metabolites</span><span class="o">=</span><span class="p">[],</span> <span class="n">kinetic_ignored_enzyme_ids</span><span class="o">=</span><span class="p">[],</span> <span class="n">custom_enzyme_kinetic_data</span><span class="o">=</span><span class="p">{},</span> <span class="n">min_ph</span><span class="o">=-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">max_ph</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">accept_nan_ph</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_temperature</span><span class="o">=-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">max_temperature</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">accept_nan_temperature</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kcat_overwrite</span><span class="o">=</span><span class="p">{},</span> <span class="n">transfered_ec_number_json</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">max_taxonomy_level</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="n">add_hill_coefficients</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Selects enzyme kinetic data for a given COBRA-k model using SABIO-RK data.</p>
<p>If this data cannot be found, an internet connection is built to SABIO-RK and the relevant
data is downloaded, which may take some time in the order of dozens of minutes.
If you want to download the full SABIO-RK data beforehand, run get_full_sabio_dict() from
this module beforehand, with the same sabio_target_folder.</p>
<p>Collected data includes k_cat, k_m, k_i, k_a and Hill coefficients for all EC numbers that
occur in the model's BiGG-compliant EC number annotation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobra_model</code>
            </td>
            <td>
                  <code><span title="cobra.Model">Model</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRA-k model for which enzyme kinetic data is to be selected.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sabio_target_folder</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the folder containing SABIO-RK data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_species</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base species for taxonomy comparison.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ncbi_parsed_json_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the NCBI parsed JSON file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bigg_metabolites_json_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the BIGG metabolites JSON file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kinetic_ignored_metabolites</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of metabolites to ignore. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kinetic_ignored_enzyme_ids</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of enzyme IDs to ignore. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>custom_enzyme_kinetic_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="EnzymeReactionData (cobrak.dataclasses.EnzymeReactionData)" href="#cobrak.dataclasses.EnzymeReactionData">EnzymeReactionData</a> | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom enzyme kinetic data. Defaults to {}.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_ph</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum pH value for filtering. Defaults to -float("inf").</p>
              </div>
            </td>
            <td>
                  <code>-<span title="float">float</span>(&#39;inf&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_ph</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum pH value for filtering. Defaults to float("inf").</p>
              </div>
            </td>
            <td>
                  <code><span title="float">float</span>(&#39;inf&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>accept_nan_ph</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to accept entries with NaN pH values. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_temperature</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum temperature value for filtering. Defaults to -float("inf").</p>
              </div>
            </td>
            <td>
                  <code>-<span title="float">float</span>(&#39;inf&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_temperature</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum temperature value for filtering. Defaults to float("inf").</p>
              </div>
            </td>
            <td>
                  <code><span title="float">float</span>(&#39;inf&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>accept_nan_temperature</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to accept entries with NaN temperature values. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kcat_overwrite</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary to overwrite kcat values. Defaults to {}.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>add_hill_coefficients</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether Hill coefficeints shall be collected (True) or not (False). Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="EnzymeReactionData (cobrak.dataclasses.EnzymeReactionData)" href="#cobrak.dataclasses.EnzymeReactionData">EnzymeReactionData</a> | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, EnzymeReactionData | None]: A dictionary mapping reaction IDs to enzyme kinetic data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>cobra_model = cobra.io.read_sbml_model("model.xml")
sabio_target_folder = "/path/to/sabio/data"
base_species = "Escherichia coli"
ncbi_parsed_json_path = "/path/to/ncbi.json"
bigg_metabolites_json_path = "/path/to/bigg_metabolites.json"
enzyme_kinetic_data = sabio_select_enzyme_kinetic_data_for_model(
    cobra_model,
    sabio_target_folder,
    base_species,
    ncbi_parsed_json_path,
    bigg_metabolites_json_path
)
print(enzyme_kinetic_data)</p>
</details>

            <details class="quote">
              <summary>Source code in <code>cobrak/sabio_rk_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sabio_select_enzyme_kinetic_data_for_model</span><span class="p">(</span>
    <span class="n">cobra_model</span><span class="p">:</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span>
    <span class="n">sabio_target_folder</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">base_species</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">ncbi_parsed_json_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">bigg_metabolites_json_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">kinetic_ignored_metabolites</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">kinetic_ignored_enzyme_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">custom_enzyme_kinetic_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EnzymeReactionData</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">min_ph</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
    <span class="n">max_ph</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
    <span class="n">accept_nan_ph</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">min_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
    <span class="n">max_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
    <span class="n">accept_nan_temperature</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">kcat_overwrite</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">transfered_ec_number_json</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">max_taxonomy_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span>
    <span class="n">add_hill_coefficients</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EnzymeReactionData</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Selects enzyme kinetic data for a given COBRA-k model using SABIO-RK data.</span>

<span class="sd">    If this data cannot be found, an internet connection is built to SABIO-RK and the relevant</span>
<span class="sd">    data is downloaded, which may take some time in the order of dozens of minutes.</span>
<span class="sd">    If you want to download the full SABIO-RK data beforehand, run get_full_sabio_dict() from</span>
<span class="sd">    this module beforehand, with the same sabio_target_folder.</span>

<span class="sd">    Collected data includes k_cat, k_m, k_i, k_a and Hill coefficients for all EC numbers that</span>
<span class="sd">    occur in the model&#39;s BiGG-compliant EC number annotation.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobra_model (cobra.Model): The COBRA-k model for which enzyme kinetic data is to be selected.</span>
<span class="sd">        sabio_target_folder (str): The path to the folder containing SABIO-RK data.</span>
<span class="sd">        base_species (str): The base species for taxonomy comparison.</span>
<span class="sd">        ncbi_parsed_json_path (str): The path to the NCBI parsed JSON file.</span>
<span class="sd">        bigg_metabolites_json_path (str): The path to the BIGG metabolites JSON file.</span>
<span class="sd">        kinetic_ignored_metabolites (list[str], optional): List of metabolites to ignore. Defaults to [].</span>
<span class="sd">        kinetic_ignored_enzyme_ids (list[str], optional): List of enzyme IDs to ignore. Defaults to [].</span>
<span class="sd">        custom_enzyme_kinetic_data (dict[str, EnzymeReactionData | None], optional): Custom enzyme kinetic data. Defaults to {}.</span>
<span class="sd">        min_ph (float, optional): Minimum pH value for filtering. Defaults to -float(&quot;inf&quot;).</span>
<span class="sd">        max_ph (float, optional): Maximum pH value for filtering. Defaults to float(&quot;inf&quot;).</span>
<span class="sd">        accept_nan_ph (bool, optional): Whether to accept entries with NaN pH values. Defaults to True.</span>
<span class="sd">        min_temperature (float, optional): Minimum temperature value for filtering. Defaults to -float(&quot;inf&quot;).</span>
<span class="sd">        max_temperature (float, optional): Maximum temperature value for filtering. Defaults to float(&quot;inf&quot;).</span>
<span class="sd">        accept_nan_temperature (bool, optional): Whether to accept entries with NaN temperature values. Defaults to True.</span>
<span class="sd">        kcat_overwrite (dict[str, float], optional): Dictionary to overwrite kcat values. Defaults to {}.</span>
<span class="sd">        add_hill_coefficients (bool, optional): Whether Hill coefficeints shall be collected (True) or not (False). Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, EnzymeReactionData | None]: A dictionary mapping reaction IDs to enzyme kinetic data.</span>

<span class="sd">    Example:</span>
<span class="sd">        cobra_model = cobra.io.read_sbml_model(&quot;model.xml&quot;)</span>
<span class="sd">        sabio_target_folder = &quot;/path/to/sabio/data&quot;</span>
<span class="sd">        base_species = &quot;Escherichia coli&quot;</span>
<span class="sd">        ncbi_parsed_json_path = &quot;/path/to/ncbi.json&quot;</span>
<span class="sd">        bigg_metabolites_json_path = &quot;/path/to/bigg_metabolites.json&quot;</span>
<span class="sd">        enzyme_kinetic_data = sabio_select_enzyme_kinetic_data_for_model(</span>
<span class="sd">            cobra_model,</span>
<span class="sd">            sabio_target_folder,</span>
<span class="sd">            base_species,</span>
<span class="sd">            ncbi_parsed_json_path,</span>
<span class="sd">            bigg_metabolites_json_path</span>
<span class="sd">        )</span>
<span class="sd">        print(enzyme_kinetic_data)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sabio_dict</span> <span class="o">=</span> <span class="n">get_full_sabio_dict</span><span class="p">(</span>
        <span class="n">sabio_target_folder</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ncbi_parsed_json_data</span> <span class="o">=</span> <span class="n">json_zip_load</span><span class="p">(</span><span class="n">ncbi_parsed_json_path</span><span class="p">)</span>
    <span class="n">name_to_bigg_id_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">json_load</span><span class="p">(</span>
        <span class="n">bigg_metabolites_json_path</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># Get reaction&lt;-&gt;enzyme reaction data mapping</span>
    <span class="n">enzyme_reaction_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EnzymeReactionData</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">transfered_ec_codes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">json_load</span><span class="p">(</span><span class="n">transfered_ec_number_json</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">transfered_ec_number_json</span>
        <span class="k">else</span> <span class="p">{}</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;ec-code&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">enzyme_identifiers</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">gene_reaction_rule</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; and &quot;</span><span class="p">)</span>
        <span class="n">has_found_ignored_enzyme</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">enzyme_identifier</span> <span class="ow">in</span> <span class="n">enzyme_identifiers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">enzyme_identifier</span> <span class="ow">in</span> <span class="n">kinetic_ignored_enzyme_ids</span><span class="p">:</span>
                <span class="n">has_found_ignored_enzyme</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">has_found_ignored_enzyme</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">reac_met_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">met</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">met</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">metabolites</span><span class="p">]</span>
        <span class="n">substrate_bigg_ids</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">met_id</span><span class="p">[:</span> <span class="n">met_id</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">reac_met_ids</span>
            <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">metabolites</span><span class="p">[</span><span class="n">cobra_model</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">met_id</span><span class="p">)]</span> <span class="o">&lt;</span> <span class="mi">0</span>
        <span class="p">]</span>
        <span class="n">product_bigg_ids</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">met_id</span><span class="p">[:</span> <span class="n">met_id</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">reac_met_ids</span>
            <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">metabolites</span><span class="p">[</span><span class="n">cobra_model</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">met_id</span><span class="p">)]</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="p">]</span>

        <span class="n">ec_codes</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;ec-code&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ec_codes</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">ec_codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ec_codes</span><span class="p">]</span>
        <span class="n">reaction_transfered_ec_codes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">transfered_ec_codes</span><span class="p">[</span><span class="n">ec_code</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">ec_code</span> <span class="ow">in</span> <span class="n">ec_codes</span>
            <span class="k">if</span> <span class="n">ec_code</span> <span class="ow">in</span> <span class="n">transfered_ec_codes</span>
        <span class="p">]</span>
        <span class="n">ec_codes</span> <span class="o">+=</span> <span class="n">reaction_transfered_ec_codes</span>

        <span class="n">all_entries</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span>
                <span class="s2">&quot;kcat&quot;</span><span class="p">,</span>
                <span class="n">_get_ec_code_entries</span><span class="p">(</span>
                    <span class="n">sabio_dict</span><span class="o">.</span><span class="n">kcat_entries</span><span class="p">,</span>
                    <span class="n">ec_codes</span><span class="p">,</span>
                    <span class="n">min_ph</span><span class="p">,</span>
                    <span class="n">max_ph</span><span class="p">,</span>
                    <span class="n">accept_nan_ph</span><span class="p">,</span>
                    <span class="n">min_temperature</span><span class="p">,</span>
                    <span class="n">max_temperature</span><span class="p">,</span>
                    <span class="n">accept_nan_temperature</span><span class="p">,</span>
                    <span class="n">substrate_bigg_ids</span><span class="p">,</span>
                    <span class="n">product_bigg_ids</span><span class="p">,</span>
                    <span class="n">name_to_bigg_id_dict</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="s2">&quot;km&quot;</span><span class="p">,</span>
                <span class="n">_get_ec_code_entries</span><span class="p">(</span>
                    <span class="n">sabio_dict</span><span class="o">.</span><span class="n">km_entries</span><span class="p">,</span>
                    <span class="n">ec_codes</span><span class="p">,</span>
                    <span class="n">min_ph</span><span class="p">,</span>
                    <span class="n">max_ph</span><span class="p">,</span>
                    <span class="n">accept_nan_ph</span><span class="p">,</span>
                    <span class="n">min_temperature</span><span class="p">,</span>
                    <span class="n">max_temperature</span><span class="p">,</span>
                    <span class="n">accept_nan_temperature</span><span class="p">,</span>
                    <span class="n">substrate_bigg_ids</span><span class="p">,</span>
                    <span class="n">product_bigg_ids</span><span class="p">,</span>
                    <span class="n">name_to_bigg_id_dict</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="s2">&quot;ki&quot;</span><span class="p">,</span>
                <span class="n">_get_ec_code_entries</span><span class="p">(</span>
                    <span class="n">sabio_dict</span><span class="o">.</span><span class="n">ki_entries</span><span class="p">,</span>
                    <span class="n">ec_codes</span><span class="p">,</span>
                    <span class="n">min_ph</span><span class="p">,</span>
                    <span class="n">max_ph</span><span class="p">,</span>
                    <span class="n">accept_nan_ph</span><span class="p">,</span>
                    <span class="n">min_temperature</span><span class="p">,</span>
                    <span class="n">max_temperature</span><span class="p">,</span>
                    <span class="n">accept_nan_temperature</span><span class="p">,</span>
                    <span class="n">substrate_bigg_ids</span><span class="p">,</span>
                    <span class="n">product_bigg_ids</span><span class="p">,</span>
                    <span class="n">name_to_bigg_id_dict</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="s2">&quot;ka&quot;</span><span class="p">,</span>
                <span class="n">_get_ec_code_entries</span><span class="p">(</span>
                    <span class="n">sabio_dict</span><span class="o">.</span><span class="n">ka_entries</span><span class="p">,</span>
                    <span class="n">ec_codes</span><span class="p">,</span>
                    <span class="n">min_ph</span><span class="p">,</span>
                    <span class="n">max_ph</span><span class="p">,</span>
                    <span class="n">accept_nan_ph</span><span class="p">,</span>
                    <span class="n">min_temperature</span><span class="p">,</span>
                    <span class="n">max_temperature</span><span class="p">,</span>
                    <span class="n">accept_nan_temperature</span><span class="p">,</span>
                    <span class="n">substrate_bigg_ids</span><span class="p">,</span>
                    <span class="n">product_bigg_ids</span><span class="p">,</span>
                    <span class="n">name_to_bigg_id_dict</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="s2">&quot;hill&quot;</span><span class="p">,</span>
                <span class="n">_get_ec_code_entries</span><span class="p">(</span>
                    <span class="n">sabio_dict</span><span class="o">.</span><span class="n">hill_entries</span><span class="p">,</span>
                    <span class="n">ec_codes</span><span class="p">,</span>
                    <span class="n">min_ph</span><span class="p">,</span>
                    <span class="n">max_ph</span><span class="p">,</span>
                    <span class="n">accept_nan_ph</span><span class="p">,</span>
                    <span class="n">min_temperature</span><span class="p">,</span>
                    <span class="n">max_temperature</span><span class="p">,</span>
                    <span class="n">accept_nan_temperature</span><span class="p">,</span>
                    <span class="n">substrate_bigg_ids</span><span class="p">,</span>
                    <span class="n">product_bigg_ids</span><span class="p">,</span>
                    <span class="n">name_to_bigg_id_dict</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># {&#39;mol&#39;, &#39;katal*g^(-1)&#39;, &#39;M&#39;, &#39;M^2&#39;, &#39;g&#39;, &#39;mol/mol&#39;, &#39;J/mol&#39;, &#39;-&#39;,</span>
        <span class="c1"># &#39;s^(-1)&#39;, &#39;s^(-1)*g^(-1)&#39;, &#39;mg/ml&#39;, &#39;mol*s^(-1)*mol^(-1)&#39;, &#39;M^(-1)&#39;, &#39;Pa&#39;,</span>
        <span class="c1"># &#39;M^(-1)*s^(-1)&#39;, &#39;mol*s^(-1)*g^(-1)&#39;, &#39;katal&#39;}</span>
        <span class="n">k_cat_per_tax_score</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">k_cat_refs_per_tax_score</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">k_ms_per_tax_score</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">k_m_refs_per_tax_score</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">k_is_per_tax_score</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">k_i_refs_per_tax_score</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">k_as_per_tax_score</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">k_a_refs_per_tax_score</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">hills_per_tax_score</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">hill_refs_per_tax_score</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">entries_type</span><span class="p">,</span> <span class="n">entries</span> <span class="ow">in</span> <span class="n">all_entries</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">entries_type</span> <span class="o">==</span> <span class="s2">&quot;kcat&quot;</span><span class="p">:</span>  <span class="c1"># Reaction-wide search</span>
                <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
                    <span class="k">match</span> <span class="n">entry</span><span class="o">.</span><span class="n">parameter_unit</span><span class="p">:</span>
                        <span class="k">case</span> <span class="s2">&quot;s^(-1)&quot;</span><span class="p">:</span>
                            <span class="n">multiplier</span> <span class="o">=</span> <span class="mi">3_600</span>
                        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                            <span class="k">continue</span>

                    <span class="n">taxonomy_dict</span> <span class="o">=</span> <span class="n">get_taxonomy_dict_from_nbci_taxonomy</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">base_species</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">organism</span><span class="p">],</span> <span class="n">ncbi_parsed_json_data</span>
                    <span class="p">)</span>
                    <span class="n">taxonomy_score</span> <span class="o">=</span> <span class="n">get_taxonomy_scores</span><span class="p">(</span><span class="n">base_species</span><span class="p">,</span> <span class="n">taxonomy_dict</span><span class="p">)[</span>
                        <span class="n">entry</span><span class="o">.</span><span class="n">organism</span>
                    <span class="p">]</span>
                    <span class="k">if</span> <span class="n">taxonomy_score</span> <span class="o">&gt;</span> <span class="n">max_taxonomy_level</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="n">taxonomy_score</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">k_cat_per_tax_score</span><span class="p">:</span>
                        <span class="n">k_cat_per_tax_score</span><span class="p">[</span><span class="n">taxonomy_score</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">k_cat_refs_per_tax_score</span><span class="p">[</span><span class="n">taxonomy_score</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">k_cat_per_tax_score</span><span class="p">[</span><span class="n">taxonomy_score</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">entry</span><span class="o">.</span><span class="n">parameter_value</span> <span class="o">*</span> <span class="n">multiplier</span>
                    <span class="p">)</span>
                    <span class="n">k_cat_refs_per_tax_score</span><span class="p">[</span><span class="n">taxonomy_score</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">ParameterReference</span><span class="p">(</span>
                            <span class="n">database</span><span class="o">=</span><span class="s2">&quot;SABIO-RK&quot;</span><span class="p">,</span>
                            <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;SabioEntryID: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">entry_id</span><span class="p">),</span>
                            <span class="n">species</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">organism</span><span class="p">,</span>
                            <span class="n">substrate</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">parameter_associated_species</span><span class="p">,</span>
                            <span class="n">value</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">parameter_value</span> <span class="o">*</span> <span class="n">multiplier</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Metabolite-wide search</span>
                <span class="k">match</span> <span class="n">entries_type</span><span class="p">:</span>
                    <span class="k">case</span> <span class="s2">&quot;ka&quot;</span><span class="p">:</span>
                        <span class="n">values_pointer</span> <span class="o">=</span> <span class="n">k_as_per_tax_score</span>
                        <span class="n">ref_pointer</span> <span class="o">=</span> <span class="n">k_a_refs_per_tax_score</span>
                    <span class="k">case</span> <span class="s2">&quot;ki&quot;</span><span class="p">:</span>
                        <span class="n">values_pointer</span> <span class="o">=</span> <span class="n">k_is_per_tax_score</span>
                        <span class="n">ref_pointer</span> <span class="o">=</span> <span class="n">k_i_refs_per_tax_score</span>
                    <span class="k">case</span> <span class="s2">&quot;km&quot;</span><span class="p">:</span>
                        <span class="n">values_pointer</span> <span class="o">=</span> <span class="n">k_ms_per_tax_score</span>
                        <span class="n">ref_pointer</span> <span class="o">=</span> <span class="n">k_m_refs_per_tax_score</span>
                    <span class="k">case</span> <span class="s2">&quot;hill&quot;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">add_hill_coefficients</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="n">values_pointer</span> <span class="o">=</span> <span class="n">hills_per_tax_score</span>
                        <span class="n">ref_pointer</span> <span class="o">=</span> <span class="n">hill_refs_per_tax_score</span>
                    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span>
                <span class="k">for</span> <span class="n">met</span> <span class="ow">in</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">met</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">kinetic_ignored_metabolites</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">entries_type</span> <span class="o">==</span> <span class="s2">&quot;km&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">met</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">metabolites</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">bigg_id</span> <span class="o">=</span> <span class="n">met</span><span class="o">.</span><span class="n">id</span><span class="p">[:</span> <span class="n">met</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)]</span>
                    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
                        <span class="n">entry_met_id</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">entry</span><span class="o">.</span><span class="n">parameter_associated_species</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="p">)</span>
                        <span class="k">if</span> <span class="n">entry_met_id</span> <span class="ow">in</span> <span class="n">name_to_bigg_id_dict</span><span class="p">:</span>
                            <span class="n">entry_bigg_id</span> <span class="o">=</span> <span class="n">name_to_bigg_id_dict</span><span class="p">[</span><span class="n">entry_met_id</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">entry_bigg_id</span> <span class="o">=</span> <span class="n">_search_metname_in_bigg_ids</span><span class="p">(</span>
                                <span class="n">met_id</span><span class="o">=</span><span class="n">entry_met_id</span><span class="p">,</span>
                                <span class="n">bigg_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                                <span class="n">entry</span><span class="o">=</span><span class="n">entry</span><span class="p">,</span>
                                <span class="n">name_to_bigg_id_dict</span><span class="o">=</span><span class="n">name_to_bigg_id_dict</span><span class="p">,</span>
                            <span class="p">)</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">entry_bigg_id</span><span class="p">:</span>
                                <span class="k">continue</span>
                        <span class="k">if</span> <span class="n">entry_bigg_id</span> <span class="o">!=</span> <span class="n">bigg_id</span><span class="p">:</span>
                            <span class="k">continue</span>

                        <span class="k">match</span> <span class="n">entry</span><span class="o">.</span><span class="n">parameter_unit</span><span class="p">:</span>
                            <span class="k">case</span> <span class="s2">&quot;M^2&quot;</span><span class="p">:</span>
                                <span class="n">applier</span> <span class="o">=</span> <span class="n">sqrt</span>
                            <span class="k">case</span> <span class="s2">&quot;M^(-1)&quot;</span><span class="p">:</span>
                                <span class="n">applier</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">x</span>  <span class="c1"># noqa: E731</span>
                            <span class="k">case</span> <span class="s2">&quot;M&quot;</span><span class="p">:</span>
                                <span class="n">applier</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span>  <span class="c1"># noqa: E731</span>
                            <span class="k">case</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>  <span class="c1"># e.g. for Hill coefficients</span>
                                <span class="n">applier</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span>  <span class="c1"># noqa: E731</span>
                            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>  <span class="c1"># unknown unit</span>
                                <span class="k">continue</span>
                        <span class="n">taxonomy_dict</span> <span class="o">=</span> <span class="n">get_taxonomy_dict_from_nbci_taxonomy</span><span class="p">(</span>
                            <span class="p">[</span><span class="n">base_species</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">organism</span><span class="p">],</span> <span class="n">ncbi_parsed_json_data</span>
                        <span class="p">)</span>
                        <span class="n">taxonomy_score</span> <span class="o">=</span> <span class="n">get_taxonomy_scores</span><span class="p">(</span>
                            <span class="n">base_species</span><span class="p">,</span> <span class="n">taxonomy_dict</span>
                        <span class="p">)[</span><span class="n">entry</span><span class="o">.</span><span class="n">organism</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">taxonomy_score</span> <span class="o">&gt;</span> <span class="n">max_taxonomy_level</span><span class="p">:</span>
                            <span class="k">continue</span>

                        <span class="k">if</span> <span class="n">met</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">values_pointer</span><span class="p">:</span>
                            <span class="n">values_pointer</span><span class="p">[</span><span class="n">met</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                            <span class="n">ref_pointer</span><span class="p">[</span><span class="n">met</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                        <span class="k">if</span> <span class="n">taxonomy_score</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">values_pointer</span><span class="p">[</span><span class="n">met</span><span class="o">.</span><span class="n">id</span><span class="p">]:</span>
                            <span class="n">values_pointer</span><span class="p">[</span><span class="n">met</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="n">taxonomy_score</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                            <span class="n">ref_pointer</span><span class="p">[</span><span class="n">met</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="n">taxonomy_score</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">values_pointer</span><span class="p">[</span><span class="n">met</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="n">taxonomy_score</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">applier</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">parameter_value</span><span class="p">)</span>
                        <span class="p">)</span>
                        <span class="n">ref_pointer</span><span class="p">[</span><span class="n">met</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="n">taxonomy_score</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">ParameterReference</span><span class="p">(</span>
                                <span class="n">database</span><span class="o">=</span><span class="s2">&quot;SABIO-RK&quot;</span><span class="p">,</span>
                                <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;SabioEntryID: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">entry_id</span><span class="p">),</span>
                                <span class="n">species</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">organism</span><span class="p">,</span>
                                <span class="n">substrate</span><span class="o">=</span><span class="n">entry</span><span class="o">.</span><span class="n">parameter_associated_species</span><span class="p">,</span>
                                <span class="n">tax_distance</span><span class="o">=</span><span class="n">taxonomy_score</span><span class="p">,</span>
                                <span class="n">value</span><span class="o">=</span><span class="n">applier</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">parameter_value</span><span class="p">),</span>
                            <span class="p">)</span>
                        <span class="p">)</span>

        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">kcat_overwrite</span><span class="p">:</span>
            <span class="n">k_cat</span> <span class="o">=</span> <span class="n">kcat_overwrite</span><span class="p">[</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>
            <span class="n">k_cat_references</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">ParameterReference</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s2">&quot;OVERWRITE&quot;</span><span class="p">,</span> <span class="n">tax_distance</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kcat_overwrite</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">kcat_overwrite</span> <span class="o">!=</span> <span class="p">{})</span>
        <span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">k_cat_per_tax_score</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">min_k_cat_tax_score</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">k_cat_per_tax_score</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">k_cat</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span><span class="n">k_cat_per_tax_score</span><span class="p">[</span><span class="n">min_k_cat_tax_score</span><span class="p">])</span>
            <span class="n">k_cat_references</span> <span class="o">=</span> <span class="n">k_cat_refs_per_tax_score</span><span class="p">[</span><span class="n">min_k_cat_tax_score</span><span class="p">]</span>

        <span class="n">k_ms</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">k_m_references</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">k_m_per_tax_score</span> <span class="ow">in</span> <span class="n">k_ms_per_tax_score</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">k_ms</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span><span class="n">k_m_per_tax_score</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">k_m_per_tax_score</span><span class="o">.</span><span class="n">keys</span><span class="p">())])</span>
            <span class="n">k_m_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_m_refs_per_tax_score</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span>
                <span class="nb">min</span><span class="p">(</span><span class="n">k_m_per_tax_score</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="p">]</span>

        <span class="n">k_is</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">k_i_references</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">k_i_per_tax_score</span> <span class="ow">in</span> <span class="n">k_is_per_tax_score</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">k_is</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span><span class="n">k_i_per_tax_score</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">k_i_per_tax_score</span><span class="o">.</span><span class="n">keys</span><span class="p">())])</span>
            <span class="n">k_i_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_i_refs_per_tax_score</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span>
                <span class="nb">min</span><span class="p">(</span><span class="n">k_i_per_tax_score</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="p">]</span>

        <span class="n">k_as</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">k_a_references</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">k_a_per_tax_score</span> <span class="ow">in</span> <span class="n">k_as_per_tax_score</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">k_as</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span><span class="n">k_a_per_tax_score</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">k_a_per_tax_score</span><span class="o">.</span><span class="n">keys</span><span class="p">())])</span>
            <span class="n">k_a_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_a_refs_per_tax_score</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span>
                <span class="nb">min</span><span class="p">(</span><span class="n">k_a_per_tax_score</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="p">]</span>

        <span class="n">hills</span><span class="p">:</span> <span class="n">HillCoefficients</span> <span class="o">=</span> <span class="n">HillCoefficients</span><span class="p">()</span>
        <span class="n">hill_references</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ParameterReference</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">hills_per_tax_score</span> <span class="ow">in</span> <span class="n">hills_per_tax_score</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">hills</span><span class="o">.</span><span class="n">kappa</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span>
                <span class="n">hills_per_tax_score</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">hills_per_tax_score</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
            <span class="p">)</span>
            <span class="n">hills</span><span class="o">.</span><span class="n">iota</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span>
                <span class="n">hills_per_tax_score</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">hills_per_tax_score</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
            <span class="p">)</span>
            <span class="n">hills</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">median</span><span class="p">(</span>
                <span class="n">hills_per_tax_score</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">hills_per_tax_score</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
            <span class="p">)</span>
            <span class="n">hill_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">hill_refs_per_tax_score</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span>
                <span class="nb">min</span><span class="p">(</span><span class="n">hills_per_tax_score</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="p">]</span>

        <span class="n">enzyme_reaction_data</span><span class="p">[</span><span class="n">reaction</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnzymeReactionData</span><span class="p">(</span>
            <span class="n">identifiers</span><span class="o">=</span><span class="n">enzyme_identifiers</span><span class="p">,</span>
            <span class="n">k_cat</span><span class="o">=</span><span class="n">k_cat</span><span class="p">,</span>
            <span class="n">k_cat_references</span><span class="o">=</span><span class="n">k_cat_references</span><span class="p">,</span>
            <span class="n">k_ms</span><span class="o">=</span><span class="n">k_ms</span><span class="p">,</span>
            <span class="n">k_m_references</span><span class="o">=</span><span class="n">k_m_references</span><span class="p">,</span>
            <span class="n">k_is</span><span class="o">=</span><span class="n">k_is</span><span class="p">,</span>
            <span class="n">k_i_references</span><span class="o">=</span><span class="n">k_i_references</span><span class="p">,</span>
            <span class="n">k_as</span><span class="o">=</span><span class="n">k_as</span><span class="p">,</span>
            <span class="n">k_a_references</span><span class="o">=</span><span class="n">k_a_references</span><span class="p">,</span>
            <span class="n">hill_coefficients</span><span class="o">=</span><span class="n">hills</span><span class="p">,</span>
            <span class="n">hill_coefficient_references</span><span class="o">=</span><span class="n">HillParameterReferences</span><span class="p">(</span>
                <span class="n">kappa</span><span class="o">=</span><span class="n">hill_references</span><span class="p">,</span>
                <span class="n">iota</span><span class="o">=</span><span class="n">hill_references</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">hill_references</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

    <span class="n">enzyme_reaction_data</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">enzyme_reaction_data</span><span class="p">,</span> <span class="o">**</span><span class="n">custom_enzyme_kinetic_data</span><span class="p">}</span>

    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">kcat_overwrite</span><span class="p">:</span>  <span class="c1"># noqa: PLC0206</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">enzyme_reaction_data</span><span class="p">:</span>
            <span class="n">reaction</span> <span class="o">=</span> <span class="n">cobra_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">get_by_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>
            <span class="n">enzyme_identifiers</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">gene_reaction_rule</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; and &quot;</span><span class="p">)</span>
            <span class="n">enzyme_reaction_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnzymeReactionData</span><span class="p">(</span>
                <span class="n">identifiers</span><span class="o">=</span><span class="n">enzyme_identifiers</span><span class="p">,</span>
                <span class="n">k_cat</span><span class="o">=</span><span class="n">kcat_overwrite</span><span class="p">[</span><span class="n">reac_id</span><span class="p">],</span>
                <span class="n">k_cat_references</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">ParameterReference</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="s2">&quot;OVERWRITE&quot;</span><span class="p">,</span> <span class="n">tax_distance</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
                <span class="p">],</span>
                <span class="n">k_ms</span><span class="o">=</span><span class="p">{},</span>
                <span class="n">k_is</span><span class="o">=</span><span class="p">{},</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">enzyme_reaction_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.spreadsheet_functionality" class="doc doc-heading">
            <code>spreadsheet_functionality</code>


</h2>

    <div class="doc doc-contents ">

        <p>Functions for generating spreadsheet overviews of variability/optimization results</p>









  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="cobrak.spreadsheet_functionality.ABS_EPSILON" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ABS_EPSILON</span> <span class="o">=</span> <span class="mf">1e-12</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Lower absolute values are shown as 0 in the spreadsheet</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.spreadsheet_functionality.EMPTY_CELL" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">EMPTY_CELL</span> <span class="o">=</span> <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Represents an empty spreadsheeet cell without content</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.spreadsheet_functionality.FONT_BOLD" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FONT_BOLD</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Bold font for spreadsheet cells</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.spreadsheet_functionality.FONT_BOLD_AND_UNDERLINED" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FONT_BOLD_AND_UNDERLINED</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">underline</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Bold and underlined font for spreadsheet cells</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.spreadsheet_functionality.FONT_DEFAULT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">FONT_DEFAULT</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Default font for spreadsheet cells</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="cobrak.spreadsheet_functionality.WIDTH_DEFAULT" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">WIDTH_DEFAULT</span> <span class="o">=</span> <span class="mi">12</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Default spreadsheel column width</p>

    </div>

</div>


<div class="doc doc-object doc-class">



<h3 id="cobrak.spreadsheet_functionality.OptimizationDataset" class="doc doc-heading">
            <code>OptimizationDataset</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Represents an optimization result and which of its data shall be shown in the spreadsheet</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/spreadsheet_functionality.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">OptimizationDataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents an optimization result and which of its data shall be shown in the spreadsheet&quot;&quot;&quot;</span>

    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The optimization result&quot;&quot;&quot;</span>
    <span class="n">with_df</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shall driving forces be shown in the spreadsheet?&quot;&quot;&quot;</span>
    <span class="n">with_vplus</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shall V+ values be shown in the spreadsheet?&quot;&quot;&quot;</span>
    <span class="n">with_kappa</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shall saturation term values be shown in the spreadsheet?&quot;&quot;&quot;</span>
    <span class="n">with_gamma</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shall gamma values be shown in the spreadsheet?&quot;&quot;&quot;</span>
    <span class="n">with_iota</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shall iota values (inhibition terms) be shown in the spreadsheet?&quot;&quot;&quot;</span>
    <span class="n">with_alpha</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shall alpha values (activation terms) be shown in the spreadsheet?&quot;&quot;&quot;</span>
    <span class="n">with_kinetic_differences</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shall differences between NLP fluxes and &#39;real&#39; fluxes from kinetics be shown in the spreadsheet?&quot;&quot;&quot;</span>
    <span class="n">with_error_corrections</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shall error corrections be shown as their own sheet?&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.OptimizationDataset.data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">data</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The optimization result</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.OptimizationDataset.with_alpha" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">with_alpha</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Shall alpha values (activation terms) be shown in the spreadsheet?</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.OptimizationDataset.with_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">with_df</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Shall driving forces be shown in the spreadsheet?</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.OptimizationDataset.with_error_corrections" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">with_error_corrections</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Shall error corrections be shown as their own sheet?</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.OptimizationDataset.with_gamma" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">with_gamma</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Shall gamma values be shown in the spreadsheet?</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.OptimizationDataset.with_iota" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">with_iota</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Shall iota values (inhibition terms) be shown in the spreadsheet?</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.OptimizationDataset.with_kappa" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">with_kappa</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Shall saturation term values be shown in the spreadsheet?</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.OptimizationDataset.with_kinetic_differences" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">with_kinetic_differences</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Shall differences between NLP fluxes and 'real' fluxes from kinetics be shown in the spreadsheet?</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.OptimizationDataset.with_vplus" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">with_vplus</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Shall V+ values be shown in the spreadsheet?</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.spreadsheet_functionality.SpreadsheetCell" class="doc doc-heading">
            <code>SpreadsheetCell</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Represents the content of a spreadsheet cell.</p>
<p>Includes the shown value, background color, font style
and border setting.</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/spreadsheet_functionality.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SpreadsheetCell</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents the content of a spreadsheet cell.</span>

<span class="sd">    Includes the shown value, background color, font style</span>
<span class="sd">    and border setting.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The cell&#39;s shown content value (if None, nothing is shown)&quot;&quot;&quot;</span>
    <span class="n">bg_color</span><span class="p">:</span> <span class="n">PatternFill</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">BG_COLOR_DEFAULT</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The cell&#39;s background color (default: BG_COLOR_DEFAULT)&quot;&quot;&quot;</span>
    <span class="n">font</span><span class="p">:</span> <span class="n">Font</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">FONT_DEFAULT</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The cell&#39;s font style (default: FONT_DEFAULT)&quot;&quot;&quot;</span>
    <span class="n">border</span><span class="p">:</span> <span class="n">Border</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The cell&#39;s border style (None if no style given; default: None)&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.SpreadsheetCell.bg_color" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bg_color</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">BG_COLOR_DEFAULT</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The cell's background color (default: BG_COLOR_DEFAULT)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.SpreadsheetCell.border" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">border</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The cell's border style (None if no style given; default: None)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.SpreadsheetCell.font" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">font</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">FONT_DEFAULT</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The cell's font style (default: FONT_DEFAULT)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.SpreadsheetCell.value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">value</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The cell's shown content value (if None, nothing is shown)</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.spreadsheet_functionality.Title" class="doc doc-heading">
            <code>Title</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Represents a title or metatitle used in visualizations.</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/spreadsheet_functionality.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Title</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a title or metatitle used in visualizations.&quot;&quot;&quot;</span>

    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Title text content&quot;&quot;&quot;</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">float</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;With of column&quot;&quot;&quot;</span>
    <span class="n">is_metatitle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;If True, the title is shown *under* a the major title line in a second line. Defaults to False.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.Title.is_metatitle" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_metatitle</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>If True, the title is shown <em>under</em> a the major title line in a second line. Defaults to False.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.Title.text" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">text</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Title text content</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.Title.width" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">width</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>With of column</p>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cobrak.spreadsheet_functionality.VariabilityDataset" class="doc doc-heading">
            <code>VariabilityDataset</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Represents a dataset with variability for plotting, including error bars or ranges.</p>







              <details class="quote">
                <summary>Source code in <code>cobrak/spreadsheet_functionality.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">VariabilityDataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a dataset with variability for plotting, including error bars or ranges.&quot;&quot;&quot;</span>

    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The variability data dict, as returned by COBRAk&#39;s variability functions&quot;&quot;&quot;</span>
    <span class="n">with_df</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shall driving force variabilities be shown?&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.VariabilityDataset.data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">data</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The variability data dict, as returned by COBRAk's variability functions</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cobrak.spreadsheet_functionality.VariabilityDataset.with_df" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">with_df</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Shall driving force variabilities be shown?</p>

    </div>

</div>





  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="cobrak.spreadsheet_functionality.create_cobrak_spreadsheet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_cobrak_spreadsheet</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="p">,</span> <span class="n">variability_datasets</span><span class="p">,</span> <span class="n">optimization_datasets</span><span class="p">,</span> <span class="n">is_maximization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sheet_description</span><span class="o">=</span><span class="p">[],</span> <span class="n">min_var_value</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span> <span class="n">min_rel_correction</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">kinetic_difference_precision</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">objective_overwrite</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extra_optstatistics_data</span><span class="o">=</span><span class="p">{})</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a comprehensive Excel spreadsheet summarizing variability and optimization results for a COBRAk model.</p>
<p>This function creates an Excel file that organizes and visualizes various aspects of the model's reactions, metabolites, enzymes, and optimization results.
It includes multiple sheets, each focusing on different components of the model and their corresponding data.</p>
<p>In particular, the generated Excel workbook includes the following sheets:</p>
<ol>
<li><strong>Index</strong>: Provides an overview of the different sections in the spreadsheet.</li>
<li><strong>A) Optimization statistics</strong>: Displays statistical summaries of the optimization results, including objective values, solver status, and flux comparisons.</li>
<li><strong>B) Model settings</strong>: Lists the model's parameters such as protein pool, gas constant, temperature, and annotations.</li>
<li><strong>C) Reactions</strong>: Details each reaction's properties, including reaction strings, G' values, enzyme associations, and kinetic parameters.</li>
<li><strong>D) Metabolites</strong>: Shows metabolite concentrations, their ranges, and annotations.</li>
<li><strong>E) Enzymes</strong>: Lists individual enzymes with their molecular weights and concentration ranges.</li>
<li><strong>F) Complexes</strong>: Provides information on enzyme complexes, including associated reactions and molecular weights.</li>
<li><strong>G) Corrections (optional)</strong>: If error corrections are included in the optimization datasets, this sheet displays the corrections applied.</li>
</ol>
<p>Each sheet is populated with data from the provided variability and optimization datasets, formatted for readability with appropriate styling,
including background colors and borders to highlight important information.</p>
<p>The function also handles various edge cases, such as missing data and low-flux reactions, ensuring that the spreadsheet remains organized and informative.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file path where the Excel workbook will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing reactions, metabolites, and enzymes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variability_datasets</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="VariabilityDataset


  
      dataclass
   (cobrak.spreadsheet_functionality.VariabilityDataset)" href="#cobrak.spreadsheet_functionality.VariabilityDataset">VariabilityDataset</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of variability datasets, where each key is a dataset name and the value contains
                                                 the data and flags for what to display.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimization_datasets</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="OptimizationDataset


  
      dataclass
   (cobrak.spreadsheet_functionality.OptimizationDataset)" href="#cobrak.spreadsheet_functionality.OptimizationDataset">OptimizationDataset</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of optimization results, where each key is a dataset name and the value contains
                                                    the optimization data and flags for what to display.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_maximization</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indicates whether the optimization is a maximization problem. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sheet_description</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of description lines to include in the index sheet. Defaults to an empty list.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_var_value</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Where applicable (e.g. for fluxes), the minimum value to display a variable's value. Does not apply for error correction value (see next argument for that.
                             Defaults to 1e-6.</p>
              </div>
            </td>
            <td>
                  <code>1e-06</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_rel_correction</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimal relative change to associated original value for which an error correction value is shown.</p>
              </div>
            </td>
            <td>
                  <code>0.01</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kinetic_difference_precision</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of decimal places to round kinetic differences. Defaults to 6.</p>
              </div>
            </td>
            <td>
                  <code>6</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>None</code></td>            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function does not return any value but saves the Excel workbook to the specified path.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/spreadsheet_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_cobrak_spreadsheet</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">variability_datasets</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">VariabilityDataset</span><span class="p">],</span>
    <span class="n">optimization_datasets</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">OptimizationDataset</span><span class="p">],</span>
    <span class="n">is_maximization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">sheet_description</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">min_var_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span>
    <span class="n">min_rel_correction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="n">kinetic_difference_precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">objective_overwrite</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">extra_optstatistics_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a comprehensive Excel spreadsheet summarizing variability and optimization results for a COBRAk model.</span>

<span class="sd">    This function creates an Excel file that organizes and visualizes various aspects of the model&#39;s reactions, metabolites, enzymes, and optimization results.</span>
<span class="sd">    It includes multiple sheets, each focusing on different components of the model and their corresponding data.</span>

<span class="sd">    In particular, the generated Excel workbook includes the following sheets:</span>

<span class="sd">    1. **Index**: Provides an overview of the different sections in the spreadsheet.</span>
<span class="sd">    2. **A) Optimization statistics**: Displays statistical summaries of the optimization results, including objective values, solver status, and flux comparisons.</span>
<span class="sd">    3. **B) Model settings**: Lists the model&#39;s parameters such as protein pool, gas constant, temperature, and annotations.</span>
<span class="sd">    4. **C) Reactions**: Details each reaction&#39;s properties, including reaction strings, G&#39; values, enzyme associations, and kinetic parameters.</span>
<span class="sd">    5. **D) Metabolites**: Shows metabolite concentrations, their ranges, and annotations.</span>
<span class="sd">    6. **E) Enzymes**: Lists individual enzymes with their molecular weights and concentration ranges.</span>
<span class="sd">    7. **F) Complexes**: Provides information on enzyme complexes, including associated reactions and molecular weights.</span>
<span class="sd">    8. **G) Corrections (optional)**: If error corrections are included in the optimization datasets, this sheet displays the corrections applied.</span>

<span class="sd">    Each sheet is populated with data from the provided variability and optimization datasets, formatted for readability with appropriate styling,</span>
<span class="sd">    including background colors and borders to highlight important information.</span>

<span class="sd">    The function also handles various edge cases, such as missing data and low-flux reactions, ensuring that the spreadsheet remains organized and informative.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): The file path where the Excel workbook will be saved.</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing reactions, metabolites, and enzymes.</span>
<span class="sd">        variability_datasets (dict[str, VariabilityDataset]): A dictionary of variability datasets, where each key is a dataset name and the value contains</span>
<span class="sd">                                                             the data and flags for what to display.</span>
<span class="sd">        optimization_datasets (dict[str, OptimizationDataset]): A dictionary of optimization results, where each key is a dataset name and the value contains</span>
<span class="sd">                                                                the optimization data and flags for what to display.</span>
<span class="sd">        is_maximization (bool, optional): Indicates whether the optimization is a maximization problem. Defaults to True.</span>
<span class="sd">        sheet_description (list[str], optional): A list of description lines to include in the index sheet. Defaults to an empty list.</span>
<span class="sd">        min_var_value (float, optional): Where applicable (e.g. for fluxes), the minimum value to display a variable&#39;s value. Does not apply for error correction value (see next argument for that.</span>
<span class="sd">                                         Defaults to 1e-6.</span>
<span class="sd">        min_rel_correction (float, optional): Minimal relative change to associated original value for which an error correction value is shown.</span>
<span class="sd">        kinetic_difference_precision (int, optional): The number of decimal places to round kinetic differences. Defaults to 6.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: The function does not return any value but saves the Excel workbook to the specified path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_reac_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">all_met_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">all_enzyme_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">enzymes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">all_met_var_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">LNCONC_VAR_PREFIX</span> <span class="o">+</span> <span class="n">met_id</span> <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">all_met_ids</span><span class="p">]</span>
    <span class="n">all_enzcomplex_ids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">all_enzcomplex_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_reaction_enzyme_var_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span><span class="p">))</span>

    <span class="n">has_any_vplus</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
        <span class="n">opt_data</span><span class="o">.</span><span class="n">with_vplus</span> <span class="k">for</span> <span class="n">opt_data</span> <span class="ow">in</span> <span class="n">optimization_datasets</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">has_any_df</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">opt_data</span><span class="o">.</span><span class="n">with_vplus</span> <span class="k">for</span> <span class="n">opt_data</span> <span class="ow">in</span> <span class="n">optimization_datasets</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">has_any_kappa</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
        <span class="n">opt_data</span><span class="o">.</span><span class="n">with_kappa</span> <span class="k">for</span> <span class="n">opt_data</span> <span class="ow">in</span> <span class="n">optimization_datasets</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">has_any_gamma</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
        <span class="n">opt_data</span><span class="o">.</span><span class="n">with_gamma</span> <span class="k">for</span> <span class="n">opt_data</span> <span class="ow">in</span> <span class="n">optimization_datasets</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">has_any_iota</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
        <span class="n">opt_data</span><span class="o">.</span><span class="n">with_iota</span> <span class="k">for</span> <span class="n">opt_data</span> <span class="ow">in</span> <span class="n">optimization_datasets</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">has_any_alpha</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
        <span class="n">opt_data</span><span class="o">.</span><span class="n">with_alpha</span> <span class="k">for</span> <span class="n">opt_data</span> <span class="ow">in</span> <span class="n">optimization_datasets</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">has_any_kinetic_differences</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
        <span class="n">opt_data</span><span class="o">.</span><span class="n">with_kinetic_differences</span> <span class="k">for</span> <span class="n">opt_data</span> <span class="ow">in</span> <span class="n">optimization_datasets</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="n">kappa_gamma_iota_alpha_str_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">has_any_kappa</span><span class="p">:</span>
        <span class="n">kappa_gamma_iota_alpha_str_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">has_any_gamma</span><span class="p">:</span>
        <span class="n">kappa_gamma_iota_alpha_str_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">has_any_iota</span><span class="p">:</span>
        <span class="n">kappa_gamma_iota_alpha_str_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">has_any_alpha</span><span class="p">:</span>
        <span class="n">kappa_gamma_iota_alpha_str_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">kappa_gamma_iota_alpha_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kappa_gamma_iota_alpha_str_list</span><span class="p">)</span>

    <span class="c1"># Index sheet</span>
    <span class="n">index_titles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Title</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">index_cells</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">SpreadsheetCell</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">sheet_line</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">description_line</span> <span class="ow">in</span> <span class="n">sheet_description</span><span class="p">:</span>
        <span class="n">index_cells</span><span class="p">[</span><span class="n">_num_to_sheet_letter</span><span class="p">(</span><span class="n">sheet_line</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span>
                <span class="n">description_line</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">]</span>
        <span class="n">sheet_line</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">sheet_line</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">sheet_line</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># No description lines provided, first line can be used for A) to ... as following</span>
    <span class="n">index_cells</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">_num_to_sheet_letter</span><span class="p">(</span><span class="n">sheet_line</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span>
                <span class="s2">&quot;A) Optimization statistics: Objective values, minimal/maximal occurring kinetic values, ...&quot;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">],</span>
        <span class="n">_num_to_sheet_letter</span><span class="p">(</span><span class="n">sheet_line</span> <span class="o">+</span> <span class="mi">2</span><span class="p">):</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span>
                <span class="s2">&quot;B) Global setting: Model settings such as the temperature, protein pool, ...&quot;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">],</span>
        <span class="n">_num_to_sheet_letter</span><span class="p">(</span><span class="n">sheet_line</span> <span class="o">+</span> <span class="mi">3</span><span class="p">):</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span>
                <span class="s2">&quot;C) Reactions: Their fluxes, driving forces, kinetic values...&quot;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">],</span>
        <span class="n">_num_to_sheet_letter</span><span class="p">(</span><span class="n">sheet_line</span> <span class="o">+</span> <span class="mi">4</span><span class="p">):</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span>
                <span class="s2">&quot;D) Metabolites: Their concentrations, formulas, ...&quot;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">],</span>
        <span class="n">_num_to_sheet_letter</span><span class="p">(</span><span class="n">sheet_line</span> <span class="o">+</span> <span class="mi">5</span><span class="p">):</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span>
                <span class="s2">&quot;E) Enzymes: The single enzymes occurring in the model with their concentration settings (if any given)&quot;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">],</span>
        <span class="n">_num_to_sheet_letter</span><span class="p">(</span><span class="n">sheet_line</span> <span class="o">+</span> <span class="mi">6</span><span class="p">):</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span>
                <span class="s2">&quot;F) Complexes: The (multi- or single-)enzyme complexes occurring in the model with protein pool fraction data&quot;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">],</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">has_any_kappa</span> <span class="ow">or</span> <span class="n">has_any_gamma</span> <span class="ow">or</span> <span class="n">has_any_iota</span> <span class="ow">or</span> <span class="n">has_any_alpha</span><span class="p">:</span>
        <span class="n">index_cells</span> <span class="o">|=</span> <span class="p">{</span>
            <span class="n">_num_to_sheet_letter</span><span class="p">(</span><span class="n">sheet_line</span> <span class="o">+</span> <span class="mi">6</span><span class="p">):</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span>
                    <span class="s2">&quot;F) Complexes: The (multi- or single-)enzyme complexes occurring in the model with protein pool fraction data&quot;</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">],</span>
        <span class="p">}</span>

    <span class="c1"># Model settings sheet</span>
    <span class="n">model_titles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Title</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">model_cells</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">SpreadsheetCell</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Protein pool [ggDW]&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">max_prot_pool</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;R [kJKmol)]&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">R</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;T [K]&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">T</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;RT [kJmol]&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">T</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;-ignored metabolites&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">kinetic_ignored_metabolites</span><span class="p">)),</span>
        <span class="p">],</span>
        <span class="s2">&quot;F&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Model annotation&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">annotation</span><span class="p">)),</span>
        <span class="p">],</span>
        <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Maximal concentration sum [M]:&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">max_conc_sum</span><span class="p">)),</span>
        <span class="p">],</span>
    <span class="p">}</span>

    <span class="c1"># Statistics sheet</span>
    <span class="n">comparisons</span> <span class="o">=</span> <span class="n">compare_multiple_results_to_best</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="p">,</span>
        <span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">optimization_datasets</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>
        <span class="n">is_maximization</span><span class="p">,</span>
        <span class="n">min_var_value</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">stats_titles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Title</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">)]</span>
    <span class="n">stats_cells</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">SpreadsheetCell</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span>
                <span class="s2">&quot;Objective value&quot;</span>
                <span class="k">if</span> <span class="n">objective_overwrite</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">objective_overwrite</span><span class="si">}</span><span class="s2"> value&quot;</span><span class="p">,</span>
                <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">],</span>
        <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Solver status (see COBRAk documentation)&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span>
                <span class="s2">&quot;Termination condition (see COBRAk documentaiton)&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span>
            <span class="p">),</span>
        <span class="p">],</span>
    <span class="p">}</span>

    <span class="n">statline</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">if</span> <span class="n">has_any_vplus</span><span class="p">:</span>
        <span class="n">stats_cells</span> <span class="o">|=</span> <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Used protein pool [ggDW]&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">}</span>
        <span class="n">statline</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">has_any_df</span><span class="p">:</span>
        <span class="n">stats_cells</span> <span class="o">|=</span> <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Min driving force [kJmol]&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Max driving force [kJmol]&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Mean driving force [kJmol]&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Median driving force [kJmol]&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">}</span>
        <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>

    <span class="k">if</span> <span class="n">has_any_gamma</span><span class="p">:</span>
        <span class="n">stats_cells</span> <span class="o">|=</span> <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Min &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Max &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Mean &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Median &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">}</span>
        <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>

    <span class="k">if</span> <span class="n">has_any_kappa</span><span class="p">:</span>
        <span class="n">stats_cells</span> <span class="o">|=</span> <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Min &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Max &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Mean &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Median &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">}</span>
        <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>

    <span class="k">if</span> <span class="n">has_any_iota</span><span class="p">:</span>
        <span class="n">stats_cells</span> <span class="o">|=</span> <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Min &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Max &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Mean &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Median &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">}</span>
        <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>

    <span class="k">if</span> <span class="n">has_any_alpha</span><span class="p">:</span>
        <span class="n">stats_cells</span> <span class="o">|=</span> <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Min &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Max &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Mean &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Median &quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">}</span>
        <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>

    <span class="k">if</span> <span class="n">has_any_kappa</span> <span class="ow">or</span> <span class="n">has_any_gamma</span> <span class="ow">or</span> <span class="n">has_any_alpha</span> <span class="ow">or</span> <span class="n">has_any_iota</span><span class="p">:</span>
        <span class="n">stats_cells</span> <span class="o">|=</span> <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Min </span><span class="si">{</span><span class="n">kappa_gamma_iota_alpha_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max </span><span class="si">{</span><span class="n">kappa_gamma_iota_alpha_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean </span><span class="si">{</span><span class="n">kappa_gamma_iota_alpha_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median </span><span class="si">{</span><span class="n">kappa_gamma_iota_alpha_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">}</span>
        <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>

    <span class="n">stats_cells</span> <span class="o">|=</span> <span class="p">{</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Min flux difference to best&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Max flux difference to best&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Sum of flux differences to best&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Mean flux difference to best&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Median flux difference to best&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;Objective difference to best&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">6</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span>
                <span class="s2">&quot;Only in this to best (regarding active reactions)&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span>
            <span class="p">),</span>
        <span class="p">],</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">7</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span>
                <span class="s2">&quot;Only in best to this (regarding active reactions)&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span>
            <span class="p">),</span>
        <span class="p">],</span>
    <span class="p">}</span>
    <span class="n">statline</span> <span class="o">+=</span> <span class="mi">8</span>

    <span class="k">if</span> <span class="n">has_any_kinetic_differences</span><span class="p">:</span>
        <span class="n">stats_cells</span> <span class="o">|=</span> <span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="s2">&quot;&#39;Really&#39; used protein pool [ggDW]&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="n">statline</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">extrai</span><span class="p">,</span> <span class="n">extratitle</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">extra_optstatistics_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">extrai</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">extratitle</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_BOLD</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="c1"># Optimization data</span>
    <span class="k">for</span> <span class="n">current_dataset_i</span><span class="p">,</span> <span class="p">(</span><span class="n">opt_dataset_name</span><span class="p">,</span> <span class="n">opt_dataset</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
        <span class="n">optimization_datasets</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">):</span>
        <span class="n">statline</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">stats_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Title</span><span class="p">(</span><span class="n">opt_dataset_name</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">objective_overwrite</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">objective_overwrite</span><span class="p">])</span>
        <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">SOLVER_STATUS_KEY</span><span class="p">])</span>
        <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">TERMINATION_CONDITION_KEY</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">statline</span> <span class="o">+=</span> <span class="mi">3</span>

        <span class="k">if</span> <span class="n">PROT_POOL_REAC_NAME</span> <span class="ow">in</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">PROT_POOL_REAC_NAME</span><span class="p">])</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">has_any_vplus</span><span class="p">:</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_df</span><span class="p">:</span>
            <span class="n">df_stats</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_df_and_efficiency_factors_sorted_lists</span><span class="p">(</span>
                <span class="n">cobrak_model</span><span class="p">,</span>
                <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                <span class="n">min_var_value</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">df_stats</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">df_stats</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">df_stats</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">median</span><span class="p">(</span><span class="n">df_stats</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>
        <span class="k">elif</span> <span class="n">has_any_df</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line_letter</span> <span class="ow">in</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
                <span class="n">stats_cells</span><span class="p">[</span><span class="n">line_letter</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>

        <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_gamma</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">gamma_stats</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_df_and_efficiency_factors_sorted_lists</span><span class="p">(</span>
                <span class="n">cobrak_model</span><span class="p">,</span>
                <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                <span class="n">min_var_value</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">gamma_stats</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">gamma_stats</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">gamma_stats</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">median</span><span class="p">(</span><span class="n">gamma_stats</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>
        <span class="k">elif</span> <span class="n">has_any_gamma</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line_letter</span> <span class="ow">in</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
                <span class="n">stats_cells</span><span class="p">[</span><span class="n">line_letter</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>

        <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_kappa</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">kappa_stats</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_df_and_efficiency_factors_sorted_lists</span><span class="p">(</span>
                <span class="n">cobrak_model</span><span class="p">,</span>
                <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                <span class="n">min_var_value</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">kappa_stats</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">kappa_stats</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">kappa_stats</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">median</span><span class="p">(</span><span class="n">kappa_stats</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>
        <span class="k">elif</span> <span class="n">has_any_kappa</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line_letter</span> <span class="ow">in</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
                <span class="n">stats_cells</span><span class="p">[</span><span class="n">line_letter</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>

        <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_iota</span><span class="p">:</span>
            <span class="n">iota_values</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span>
                <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">IOTA_VAR_PREFIX</span><span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">IOTA_VAR_PREFIX</span><span class="p">)</span> <span class="p">:]]</span> <span class="o">&gt;</span> <span class="n">min_var_value</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">iota_values</span><span class="p">))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">iota_values</span><span class="p">))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">iota_values</span><span class="p">))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">median</span><span class="p">(</span><span class="n">iota_values</span><span class="p">))</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>
        <span class="k">elif</span> <span class="n">has_any_iota</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line_letter</span> <span class="ow">in</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
                <span class="n">stats_cells</span><span class="p">[</span><span class="n">line_letter</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>

        <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_alpha</span><span class="p">:</span>
            <span class="n">alpha_values</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span>
                <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">ALPHA_VAR_PREFIX</span><span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">ALPHA_VAR_PREFIX</span><span class="p">)</span> <span class="p">:]]</span> <span class="o">&gt;</span> <span class="n">min_var_value</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">alpha_values</span><span class="p">))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">alpha_values</span><span class="p">))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">alpha_values</span><span class="p">))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">median</span><span class="p">(</span><span class="n">alpha_values</span><span class="p">))</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>
        <span class="k">elif</span> <span class="n">has_any_alpha</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line_letter</span> <span class="ow">in</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
                <span class="n">stats_cells</span><span class="p">[</span><span class="n">line_letter</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_kappa</span>
            <span class="ow">or</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_gamma</span>
            <span class="ow">or</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_alpha</span>
            <span class="ow">or</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_iota</span>
        <span class="p">):</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">multiplier_stats</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">get_df_and_efficiency_factors_sorted_lists</span><span class="p">(</span>
                    <span class="n">cobrak_model</span><span class="p">,</span>
                    <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                    <span class="n">min_var_value</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">efficiencies_product_stats_values</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">multiplier_stats</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
            <span class="p">]</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">efficiencies_product_stats_values</span><span class="p">))</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="nb">max</span><span class="p">(</span><span class="n">efficiencies_product_stats_values</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">mean</span><span class="p">(</span><span class="n">efficiencies_product_stats_values</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">median</span><span class="p">(</span><span class="n">efficiencies_product_stats_values</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>
        <span class="k">elif</span> <span class="n">has_any_gamma</span> <span class="ow">and</span> <span class="n">has_any_kappa</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line_letter</span> <span class="ow">in</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
                <span class="n">stats_cells</span><span class="p">[</span><span class="n">line_letter</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">4</span>

        <span class="k">if</span> <span class="n">current_dataset_i</span> <span class="ow">in</span> <span class="n">comparisons</span><span class="p">:</span>
            <span class="n">dataset_comparison_stats</span><span class="p">,</span> <span class="n">dataset_unique_reacs</span> <span class="o">=</span> <span class="n">comparisons</span><span class="p">[</span>
                <span class="n">current_dataset_i</span>
            <span class="p">]</span>
            <span class="n">tempstatline</span> <span class="o">=</span> <span class="n">statline</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">comparison_value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset_comparison_stats</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comparison_value</span><span class="p">)</span>
                <span class="n">tempstatline</span> <span class="o">=</span> <span class="n">statline</span> <span class="o">+</span> <span class="n">j</span>
            <span class="n">statline</span> <span class="o">=</span> <span class="n">tempstatline</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dataset_unique_reacs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
            <span class="p">)</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dataset_unique_reacs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">1</span><span class="p">])</span>
            <span class="p">)</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line_letter</span> <span class="ow">in</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)):</span>
                <span class="n">stats_cells</span><span class="p">[</span><span class="n">line_letter</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;(is best)&quot;</span><span class="p">)</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">8</span>

        <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_kinetic_differences</span><span class="p">:</span>
            <span class="n">unoptimized_reactions</span> <span class="o">=</span> <span class="n">get_unoptimized_reactions_in_nlp_solution</span><span class="p">(</span>
                <span class="n">cobrak_model</span><span class="p">,</span>
                <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                <span class="n">regard_iota</span><span class="o">=</span><span class="n">has_any_iota</span><span class="p">,</span>
                <span class="n">regard_alpha</span><span class="o">=</span><span class="n">has_any_alpha</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">prot_pool_sum</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reac_data</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">min_var_value</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">reac_data</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">enzyme_var_id</span> <span class="o">=</span> <span class="n">get_reaction_enzyme_var_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reac_data</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">enzyme_var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">enzyme_conc</span> <span class="o">=</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">enzyme_var_id</span><span class="p">]</span>
                <span class="n">mw</span> <span class="o">=</span> <span class="n">get_full_enzyme_mw</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">reac_data</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">unoptimized_reactions</span><span class="p">:</span>
                    <span class="n">ratio</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">unoptimized_reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="o">/</span> <span class="n">unoptimized_reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">ratio</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
                        <span class="n">ratio</span> <span class="o">=</span> <span class="mf">1.0</span>
                    <span class="n">prot_pool_sum</span> <span class="o">+=</span> <span class="n">mw</span> <span class="o">*</span> <span class="n">enzyme_conc</span> <span class="o">*</span> <span class="p">(</span><span class="n">ratio</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">prot_pool_sum</span> <span class="o">+=</span> <span class="n">mw</span> <span class="o">*</span> <span class="n">enzyme_conc</span>

            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prot_pool_sum</span><span class="p">)</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">has_any_kinetic_differences</span><span class="p">:</span>
            <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
            <span class="n">statline</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">extrai</span><span class="p">,</span> <span class="n">extravalues</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">extra_optstatistics_data</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
        <span class="n">stats_cells</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">statline</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">extrai</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">[</span><span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">extravalue</span><span class="p">)</span> <span class="k">for</span> <span class="n">extravalue</span> <span class="ow">in</span> <span class="n">extravalues</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="c1"># Reaction sheet</span>
    <span class="n">reac_titles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Title</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;String&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;G&#39; [kJmol]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Enzyme(s)&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;kcat [h]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;kms [M]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;kis [M]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;kas [M]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Hill coefficients [-]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">reac_cells</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">SpreadsheetCell</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">reac_id</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">all_reac_ids</span>
    <span class="p">}</span>
    <span class="c1"># Reaction data</span>
    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">all_reac_ids</span><span class="p">:</span>
        <span class="n">reaction</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
        <span class="c1"># Reac ID</span>
        <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>
        <span class="c1"># Reac string</span>
        <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_reaction_string</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">))</span>
        <span class="c1"># Reac G&#39;</span>
        <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">_na_str_or_value</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span><span class="p">)))</span>
        <span class="n">enzyme_reaction_data</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span>
        <span class="k">match</span> <span class="n">enzyme_reaction_data</span><span class="p">:</span>
            <span class="k">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">enzyme_id</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">k_cat</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">k_ms</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">k_is</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">k_as</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">hills</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="n">enzyme_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span><span class="p">)</span>
                <span class="n">k_cat</span> <span class="o">=</span> <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span>
                <span class="n">k_ms</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">)</span>
                <span class="n">k_is</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_is</span><span class="p">)</span>
                <span class="n">k_as</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_as</span><span class="p">)</span>
                <span class="n">hills</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="p">)</span>
        <span class="c1"># Enzyme ID</span>
        <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">enzyme_id</span><span class="p">)</span>
        <span class="c1"># kcat</span>
        <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k_cat</span><span class="p">)</span>
        <span class="c1"># kms</span>
        <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k_ms</span><span class="p">)</span>
        <span class="c1"># kis</span>
        <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k_is</span><span class="p">)</span>
        <span class="c1"># kas</span>
        <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k_as</span><span class="p">)</span>
        <span class="c1"># Hill coefficients</span>
        <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hills</span><span class="p">)</span>

    <span class="c1"># Variability data</span>
    <span class="k">for</span> <span class="n">var_dataset_name</span><span class="p">,</span> <span class="n">var_dataset</span> <span class="ow">in</span> <span class="n">variability_datasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">reac_titles</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">Title</span><span class="p">(</span><span class="n">var_dataset_name</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">,</span> <span class="n">is_metatitle</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Min flux [mmolgDWh]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Max flux [mmolgDWh]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">var_dataset</span><span class="o">.</span><span class="n">with_df</span><span class="p">:</span>
            <span class="n">reac_titles</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Min driving force [kJmol]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                    <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Max driving force [kJmol]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="n">var_reac_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_reac_ids</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">var_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">var_reac_ids</span><span class="p">:</span>
            <span class="n">variability_tuple</span> <span class="o">=</span> <span class="n">var_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
            <span class="n">min_flux</span> <span class="o">=</span> <span class="n">variability_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">max_flux</span> <span class="o">=</span> <span class="n">variability_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">bg_color</span> <span class="o">=</span> <span class="n">_get_variability_bg_color</span><span class="p">(</span><span class="n">min_flux</span><span class="p">,</span> <span class="n">max_flux</span><span class="p">)</span>
            <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">min_flux</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="n">BORDER_BLACK_LEFT</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">max_flux</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">var_dataset</span><span class="o">.</span><span class="n">with_df</span><span class="p">:</span>
                <span class="n">df_var_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DF_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">df_var_id</span> <span class="ow">in</span> <span class="n">var_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                    <span class="n">min_df</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">var_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">df_var_id</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
                    <span class="n">max_df</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">var_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">df_var_id</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">min_df</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
                    <span class="n">max_df</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">min_df</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
                <span class="n">max_df</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
            <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">min_df</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">))</span>
            <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">max_df</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">))</span>
        <span class="n">missing_reac_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_reac_ids</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">var_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">missing_reac_id</span> <span class="ow">in</span> <span class="n">missing_reac_ids</span><span class="p">:</span>
            <span class="n">reac_cells</span><span class="p">[</span><span class="n">missing_reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>
            <span class="n">reac_cells</span><span class="p">[</span><span class="n">missing_reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">var_dataset</span><span class="o">.</span><span class="n">with_df</span><span class="p">:</span>
                <span class="n">reac_cells</span><span class="p">[</span><span class="n">missing_reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>
                <span class="n">reac_cells</span><span class="p">[</span><span class="n">missing_reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>

    <span class="c1"># Optimization data</span>
    <span class="k">for</span> <span class="n">opt_dataset_name</span><span class="p">,</span> <span class="n">opt_dataset</span> <span class="ow">in</span> <span class="n">optimization_datasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">reac_titles</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">Title</span><span class="p">(</span><span class="n">opt_dataset_name</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">,</span> <span class="n">is_metatitle</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Flux&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_df</span><span class="p">:</span>
            <span class="n">reac_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Driving force [kJmol]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_vplus</span><span class="p">:</span>
            <span class="n">reac_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Title</span><span class="p">(</span><span class="s2">&quot;V [mmolgDWh]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_kappa</span><span class="p">:</span>
            <span class="n">reac_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Title</span><span class="p">(</span><span class="s2">&quot; [0,1]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_gamma</span><span class="p">:</span>
            <span class="n">reac_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Title</span><span class="p">(</span><span class="s2">&quot; [0,1]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_iota</span><span class="p">:</span>
            <span class="n">reac_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Title</span><span class="p">(</span><span class="s2">&quot; [0,1]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_alpha</span><span class="p">:</span>
            <span class="n">reac_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Title</span><span class="p">(</span><span class="s2">&quot; [0,1]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_kinetic_differences</span><span class="p">:</span>
            <span class="n">reac_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Title</span><span class="p">(</span><span class="s1">&#39;&quot;Real&quot; flux&#39;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">))</span>
            <span class="n">unoptimized_reactions</span> <span class="o">=</span> <span class="n">get_unoptimized_reactions_in_nlp_solution</span><span class="p">(</span>
                <span class="n">cobrak_model</span><span class="p">,</span>
                <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                <span class="n">regard_alpha</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">regard_iota</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">opt_reac_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_reac_ids</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">reacs_with_too_low_flux</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">opt_reac_ids</span><span class="p">:</span>
            <span class="n">flux</span> <span class="o">=</span> <span class="n">get_fwd_rev_corrected_flux</span><span class="p">(</span>
                <span class="n">reac_id</span><span class="o">=</span><span class="n">reac_id</span><span class="p">,</span>
                <span class="n">usable_reac_ids</span><span class="o">=</span><span class="n">opt_reac_ids</span><span class="p">,</span>
                <span class="n">result</span><span class="o">=</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                <span class="n">fwd_suffix</span><span class="o">=</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span><span class="p">,</span>
                <span class="n">rev_suffix</span><span class="o">=</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">flux</span> <span class="o">&lt;</span> <span class="n">min_var_value</span><span class="p">:</span>
                <span class="n">reacs_with_too_low_flux</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">bg_color</span> <span class="o">=</span> <span class="n">_get_optimization_bg_color</span><span class="p">(</span><span class="n">flux</span><span class="p">)</span>
            <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="n">BORDER_BLACK_LEFT</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">enzyme_reaction_data</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span>
            <span class="n">reaction</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_df</span><span class="p">:</span>
                <span class="n">df_var_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DF_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">df_var_id</span> <span class="ow">in</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                    <span class="n">df_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">df_var_id</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">df_value</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
                <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">df_value</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_vplus</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">vplus</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
                        <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span>
                        <span class="o">*</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span>
                            <span class="n">get_reaction_enzyme_var_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)</span>
                        <span class="p">]</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">vplus</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
                <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">vplus</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_kappa</span><span class="p">:</span>
                <span class="n">kappa_var_id</span> <span class="o">=</span> <span class="n">KAPPA_VAR_PREFIX</span> <span class="o">+</span> <span class="n">reac_id</span>
                <span class="k">if</span> <span class="n">kappa_var_id</span> <span class="ow">in</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                    <span class="n">kappa_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">kappa_var_id</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">kappa_value</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
                <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">kappa_value</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_gamma</span><span class="p">:</span>
                <span class="n">gamma_var_id</span> <span class="o">=</span> <span class="n">GAMMA_VAR_PREFIX</span> <span class="o">+</span> <span class="n">reac_id</span>
                <span class="k">if</span> <span class="n">gamma_var_id</span> <span class="ow">in</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                    <span class="n">gamma_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">gamma_var_id</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gamma_value</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
                <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">gamma_value</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_iota</span><span class="p">:</span>
                <span class="n">iota_var_id</span> <span class="o">=</span> <span class="n">IOTA_VAR_PREFIX</span> <span class="o">+</span> <span class="n">reac_id</span>
                <span class="k">if</span> <span class="n">iota_var_id</span> <span class="ow">in</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                    <span class="n">iota_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">iota_var_id</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">iota_value</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
                <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">iota_value</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_alpha</span><span class="p">:</span>
                <span class="n">alpha_var_id</span> <span class="o">=</span> <span class="n">ALPHA_VAR_PREFIX</span> <span class="o">+</span> <span class="n">reac_id</span>
                <span class="k">if</span> <span class="n">alpha_var_id</span> <span class="ow">in</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                    <span class="n">alpha_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">alpha_var_id</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">alpha_value</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
                <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">alpha_value</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_kinetic_differences</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">unoptimized_reactions</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="nb">round</span><span class="p">(</span>
                        <span class="n">unoptimized_reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">kinetic_difference_precision</span>
                    <span class="p">)</span>
                    <span class="o">!=</span> <span class="nb">round</span><span class="p">(</span>
                        <span class="n">unoptimized_reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">kinetic_difference_precision</span>
                    <span class="p">)</span>
                <span class="p">):</span>
                    <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">SpreadsheetCell</span><span class="p">(</span>
                            <span class="n">unoptimized_reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">reac_cells</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">FONT_ITALIC</span><span class="p">)</span>
                    <span class="p">)</span>
        <span class="n">missing_reac_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_reac_ids</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">missing_reac_ids</span> <span class="o">|=</span> <span class="nb">set</span><span class="p">(</span><span class="n">reacs_with_too_low_flux</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">missing_reac_id</span> <span class="ow">in</span> <span class="n">missing_reac_ids</span><span class="p">:</span>
            <span class="n">reac_cells</span><span class="p">[</span><span class="n">missing_reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>
            <span class="n">num_extra</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_df</span><span class="p">,</span>
                    <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_vplus</span><span class="p">,</span>
                    <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_kappa</span><span class="p">,</span>
                    <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_gamma</span><span class="p">,</span>
                    <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_iota</span><span class="p">,</span>
                    <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_alpha</span><span class="p">,</span>
                    <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_kinetic_differences</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_extra</span><span class="p">):</span>
                <span class="n">reac_cells</span><span class="p">[</span><span class="n">missing_reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>

    <span class="c1"># Single enzyme sheet</span>
    <span class="n">enzyme_titles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Title</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;MW&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Conc. range [mmolgDW]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">enzyme_cells</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">SpreadsheetCell</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">enzyme_id</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">enzyme_id</span> <span class="ow">in</span> <span class="n">all_enzyme_ids</span>
    <span class="p">}</span>
    <span class="c1"># Single enzyme data</span>
    <span class="k">for</span> <span class="n">enzyme_id</span> <span class="ow">in</span> <span class="n">all_enzyme_ids</span><span class="p">:</span>
        <span class="n">enzyme</span><span class="p">:</span> <span class="n">Enzyme</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">enzymes</span><span class="p">[</span><span class="n">enzyme_id</span><span class="p">]</span>
        <span class="c1"># Enzyme ID</span>
        <span class="n">enzyme_cells</span><span class="p">[</span><span class="n">enzyme_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">enzyme_id</span><span class="p">)</span>
        <span class="c1"># Enzyme MW</span>
        <span class="n">enzyme_cells</span><span class="p">[</span><span class="n">enzyme_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">enzyme</span><span class="o">.</span><span class="n">molecular_weight</span><span class="p">)</span>
        <span class="c1"># Enzyme concentration range</span>
        <span class="k">match</span> <span class="n">enzyme</span><span class="o">.</span><span class="n">min_conc</span><span class="p">:</span>
            <span class="k">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">min_conc</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">bg_color</span> <span class="o">=</span> <span class="n">BG_COLOR_BLACK</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="n">min_conc</span> <span class="o">=</span> <span class="n">enzyme</span><span class="o">.</span><span class="n">min_conc</span>
                <span class="n">bg_color</span> <span class="o">=</span> <span class="n">BG_COLOR_DEFAULT</span>
        <span class="k">match</span> <span class="n">enzyme</span><span class="o">.</span><span class="n">max_conc</span><span class="p">:</span>
            <span class="k">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">max_conc</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">bg_color</span> <span class="o">=</span> <span class="n">BG_COLOR_BLACK</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="n">max_conc</span> <span class="o">=</span> <span class="n">enzyme</span><span class="o">.</span><span class="n">max_conc</span>
                <span class="n">bg_color</span> <span class="o">=</span> <span class="n">BG_COLOR_DEFAULT</span>

        <span class="n">enzyme_cells</span><span class="p">[</span><span class="n">enzyme_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">min_conc</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">))</span>
        <span class="n">enzyme_cells</span><span class="p">[</span><span class="n">enzyme_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">min_conc</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">))</span>

    <span class="c1"># Enzyme complexes sheet</span>
    <span class="n">enzcomplex_titles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Title</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Reactions&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;MW&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">enzcomplex_cells</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">SpreadsheetCell</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">enzcomplex_id</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">enzcomplex_id</span> <span class="ow">in</span> <span class="n">all_enzcomplex_ids</span><span class="p">}</span>
    <span class="c1"># Enzyme complex data</span>
    <span class="k">for</span> <span class="n">enzcomplex_id</span> <span class="ow">in</span> <span class="n">all_enzcomplex_ids</span><span class="p">:</span>
        <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="o">=</span> <span class="n">_get_enzcomplex_reaction</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">enzcomplex_id</span><span class="p">)</span>
        <span class="c1"># Enzyme complex ID</span>
        <span class="n">enzcomplex_cells</span><span class="p">[</span><span class="n">enzcomplex_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">enzcomplex_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ENZYME_VAR_PREFIX</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">ENZYME_VAR_INFIX</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="c1"># Associated reaction</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]:</span>
            <span class="k">continue</span>
        <span class="n">enzcomplex_cells</span><span class="p">[</span><span class="n">enzcomplex_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>
        <span class="c1"># Enzyme complex MW</span>
        <span class="n">full_mw</span> <span class="o">=</span> <span class="n">get_full_enzyme_mw</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)</span>
        <span class="n">enzcomplex_cells</span><span class="p">[</span><span class="n">enzcomplex_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">full_mw</span><span class="p">)</span>

    <span class="c1"># Variability data</span>
    <span class="k">for</span> <span class="n">var_dataset_name</span><span class="p">,</span> <span class="n">var_dataset</span> <span class="ow">in</span> <span class="n">variability_datasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">enzcomplex_titles</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">Title</span><span class="p">(</span><span class="n">var_dataset_name</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">,</span> <span class="n">is_metatitle</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Min conc. [mmolgDW]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Max conc. [mmolgDW]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">var_enzcomplex_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_enzcomplex_ids</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">var_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">enzcomplex_id</span> <span class="ow">in</span> <span class="n">var_enzcomplex_ids</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">reaction</span> <span class="o">=</span> <span class="n">_get_enzcomplex_reaction</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">enzcomplex_id</span><span class="p">)</span>
            <span class="n">variability_tuple</span> <span class="o">=</span> <span class="n">var_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">enzcomplex_id</span><span class="p">]</span>
            <span class="n">min_conc</span> <span class="o">=</span> <span class="n">variability_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">max_conc</span> <span class="o">=</span> <span class="n">variability_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">bg_color</span> <span class="o">=</span> <span class="n">_get_variability_bg_color</span><span class="p">(</span><span class="n">min_conc</span><span class="p">,</span> <span class="n">max_conc</span><span class="p">)</span>
            <span class="n">enzcomplex_cells</span><span class="p">[</span><span class="n">enzcomplex_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">min_conc</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="n">BORDER_BLACK_LEFT</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">enzcomplex_cells</span><span class="p">[</span><span class="n">enzcomplex_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">max_conc</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="n">missing_enzcomplex_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_enzcomplex_ids</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">var_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">missing_enzcomplex_id</span> <span class="ow">in</span> <span class="n">missing_enzcomplex_ids</span><span class="p">:</span>
            <span class="n">enzcomplex_cells</span><span class="p">[</span><span class="n">missing_enzcomplex_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>
            <span class="n">enzcomplex_cells</span><span class="p">[</span><span class="n">missing_enzcomplex_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>

    <span class="c1"># Enzyme complex data</span>
    <span class="k">for</span> <span class="n">opt_dataset_name</span><span class="p">,</span> <span class="n">opt_dataset</span> <span class="ow">in</span> <span class="n">optimization_datasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">enzcomplex_titles</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">Title</span><span class="p">(</span><span class="n">opt_dataset_name</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">,</span> <span class="n">is_metatitle</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Concentration [mmolgDW]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f pool&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">opt_enzcomplex_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_enzcomplex_ids</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">enzcomplex_id</span> <span class="ow">in</span> <span class="n">opt_enzcomplex_ids</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">reaction</span> <span class="o">=</span> <span class="n">_get_enzcomplex_reaction</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">enzcomplex_id</span><span class="p">)</span>
            <span class="n">complexconc</span> <span class="o">=</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">enzcomplex_id</span><span class="p">]</span>
            <span class="n">pool_pct</span> <span class="o">=</span> <span class="p">(</span>
                <span class="mi">100</span>
                <span class="o">*</span> <span class="n">complexconc</span>
                <span class="o">*</span> <span class="n">get_full_enzyme_mw</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)</span>
                <span class="o">/</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">max_prot_pool</span>
            <span class="p">)</span>
            <span class="n">bg_color</span> <span class="o">=</span> <span class="n">_get_optimization_bg_color</span><span class="p">(</span><span class="n">complexconc</span><span class="p">)</span>
            <span class="n">enzcomplex_cells</span><span class="p">[</span><span class="n">enzcomplex_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span>
                    <span class="n">complexconc</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="n">BORDER_BLACK_LEFT</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">enzcomplex_cells</span><span class="p">[</span><span class="n">enzcomplex_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">pool_pct</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="n">missing_enzcomplex_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_enzcomplex_ids</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">missing_enzcomplex_id</span> <span class="ow">in</span> <span class="n">missing_enzcomplex_ids</span><span class="p">:</span>
            <span class="n">enzcomplex_cells</span><span class="p">[</span><span class="n">missing_enzcomplex_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>
            <span class="n">enzcomplex_cells</span><span class="p">[</span><span class="n">missing_enzcomplex_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_get_empty_cell</span><span class="p">())</span>

    <span class="c1"># Metabolite sheet</span>
    <span class="n">met_titles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Title</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Min set concentration [mmolgDWh)]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Max set concentration [mmolgDWh)]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Annotation&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">met_cells</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">SpreadsheetCell</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">met_id</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">all_met_ids</span>
    <span class="p">}</span>
    <span class="c1"># Metabolite data</span>
    <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">all_met_ids</span><span class="p">:</span>
        <span class="n">met</span><span class="p">:</span> <span class="n">Metabolite</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span>
        <span class="c1"># Met ID</span>
        <span class="n">met_cells</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">met_id</span><span class="p">)</span>
        <span class="c1"># Min conc</span>
        <span class="n">met_cells</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">log_min_conc</span><span class="p">))</span>
        <span class="c1"># Max conc</span>
        <span class="n">met_cells</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">log_max_conc</span><span class="p">))</span>
        <span class="c1"># Annotation</span>
        <span class="n">met_cells</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">annotation</span><span class="p">))</span>

    <span class="c1"># Variability data</span>
    <span class="k">for</span> <span class="n">var_dataset_name</span><span class="p">,</span> <span class="n">var_dataset</span> <span class="ow">in</span> <span class="n">variability_datasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">met_titles</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">Title</span><span class="p">(</span><span class="n">var_dataset_name</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">,</span> <span class="n">is_metatitle</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Min concentration [mmolgDWh)]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Max concentration [mmolgDWh)]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">all_met_var_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">LNCONC_VAR_PREFIX</span> <span class="o">+</span> <span class="n">met_id</span> <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">all_met_ids</span><span class="p">]</span>
        <span class="n">var_met_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_met_var_ids</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">var_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">met_var_id</span> <span class="ow">in</span> <span class="n">var_met_ids</span><span class="p">:</span>
            <span class="n">variability_tuple</span> <span class="o">=</span> <span class="n">var_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">met_var_id</span><span class="p">]</span>
            <span class="n">min_conc</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">variability_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">max_conc</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">variability_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">bg_color</span> <span class="o">=</span> <span class="n">BG_COLOR_RED</span> <span class="k">if</span> <span class="n">min_conc</span> <span class="o">==</span> <span class="n">max_conc</span> <span class="k">else</span> <span class="n">BG_COLOR_GREEN</span>
            <span class="n">met_cells</span><span class="p">[</span><span class="n">_get_met_id_from_met_var_id</span><span class="p">(</span><span class="n">met_var_id</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">min_conc</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="n">BORDER_BLACK_LEFT</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">met_cells</span><span class="p">[</span><span class="n">_get_met_id_from_met_var_id</span><span class="p">(</span><span class="n">met_var_id</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">max_conc</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="n">missing_met_var_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_met_var_ids</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">var_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">missing_met_var_id</span> <span class="ow">in</span> <span class="n">missing_met_var_ids</span><span class="p">:</span>
            <span class="n">met_cells</span><span class="p">[</span><span class="n">_get_met_id_from_met_var_id</span><span class="p">(</span><span class="n">missing_met_var_id</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">_get_empty_cell</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">met_cells</span><span class="p">[</span><span class="n">_get_met_id_from_met_var_id</span><span class="p">(</span><span class="n">missing_met_var_id</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">_get_empty_cell</span><span class="p">()</span>
            <span class="p">)</span>

    <span class="c1"># Optimization data</span>
    <span class="k">for</span> <span class="n">opt_dataset_name</span><span class="p">,</span> <span class="n">opt_dataset</span> <span class="ow">in</span> <span class="n">optimization_datasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">met_titles</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">Title</span><span class="p">(</span><span class="n">opt_dataset_name</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">,</span> <span class="n">is_metatitle</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Concentration [M]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Consumption [mmolgDWh]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Production [mmolgDWh]&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">opt_met_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_met_var_ids</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">met_var_id</span> <span class="ow">in</span> <span class="n">opt_met_ids</span><span class="p">:</span>
            <span class="n">conc</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">met_var_id</span><span class="p">])</span>
            <span class="n">consumption</span><span class="p">,</span> <span class="n">production</span> <span class="o">=</span> <span class="n">get_metabolite_consumption_and_production</span><span class="p">(</span>
                <span class="n">cobrak_model</span><span class="p">,</span> <span class="n">_get_met_id_from_met_var_id</span><span class="p">(</span><span class="n">met_var_id</span><span class="p">),</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span>
            <span class="p">)</span>
            <span class="n">bg_color</span> <span class="o">=</span> <span class="n">_get_optimization_bg_color</span><span class="p">(</span><span class="n">consumption</span><span class="p">)</span>
            <span class="n">met_cells</span><span class="p">[</span><span class="n">_get_met_id_from_met_var_id</span><span class="p">(</span><span class="n">met_var_id</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">conc</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="n">BORDER_BLACK_LEFT</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">met_cells</span><span class="p">[</span><span class="n">_get_met_id_from_met_var_id</span><span class="p">(</span><span class="n">met_var_id</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">consumption</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">met_cells</span><span class="p">[</span><span class="n">_get_met_id_from_met_var_id</span><span class="p">(</span><span class="n">met_var_id</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">SpreadsheetCell</span><span class="p">(</span><span class="n">production</span><span class="p">,</span> <span class="n">bg_color</span><span class="o">=</span><span class="n">bg_color</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="n">missing_met_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_met_var_ids</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">missing_met_id</span> <span class="ow">in</span> <span class="n">missing_met_ids</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="n">met_cells</span><span class="p">[</span><span class="n">_get_met_id_from_met_var_id</span><span class="p">(</span><span class="n">missing_met_id</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">_get_empty_cell</span><span class="p">()</span>
                <span class="p">)</span>

    <span class="c1">#  and  statistics</span>
    <span class="n">kgstats_titles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Title</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Rank&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">,</span> <span class="n">is_metatitle</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
    <span class="n">kgstats_cells</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">SpreadsheetCell</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">))}</span>
    <span class="k">for</span> <span class="n">opt_dataset_name</span><span class="p">,</span> <span class="n">opt_dataset</span> <span class="ow">in</span> <span class="n">optimization_datasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">kgstats_titles</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">Title</span><span class="p">(</span><span class="n">opt_dataset_name</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">,</span> <span class="n">is_metatitle</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Reaction ID&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Reaction ID&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Reaction ID&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Reaction ID&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Reaction ID&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
                <span class="n">Title</span><span class="p">(</span><span class="n">kappa_gamma_iota_alpha_str</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">kappa_stats</span><span class="p">,</span> <span class="n">gamma_stats</span><span class="p">,</span> <span class="n">iota_stats</span><span class="p">,</span> <span class="n">alpha_stats</span><span class="p">,</span> <span class="n">multiplier_stats</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">get_df_and_efficiency_factors_sorted_lists</span><span class="p">(</span>
                <span class="n">cobrak_model</span><span class="p">,</span>
                <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                <span class="n">min_var_value</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">kappa_stats_titles</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">kappa_stats</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">gamma_stats_titles</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">gamma_stats</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">iota_stats_titles</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">iota_stats</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">alpha_stats_titles</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">alpha_stats</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">kappa_times_gamma_stats_titles</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">multiplier_stats</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">cell_list</span> <span class="ow">in</span> <span class="n">kgstats_cells</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># </span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kappa_stats_titles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                <span class="n">cell_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="n">kappa_stats_titles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">)],</span>
                        <span class="n">kappa_stats</span><span class="p">[</span><span class="n">kappa_stats_titles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">)]],</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cell_list</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="c1"># </span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gamma_stats_titles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                <span class="n">cell_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="n">gamma_stats_titles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">)],</span>
                        <span class="n">gamma_stats</span><span class="p">[</span><span class="n">gamma_stats_titles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">)]],</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cell_list</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="c1"># </span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iota_stats_titles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                <span class="n">cell_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="n">iota_stats_titles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">)],</span>
                        <span class="n">iota_stats</span><span class="p">[</span><span class="n">iota_stats_titles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">)]],</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cell_list</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="c1"># </span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">alpha_stats_titles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                <span class="n">cell_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="n">alpha_stats_titles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">)],</span>
                        <span class="n">alpha_stats</span><span class="p">[</span><span class="n">alpha_stats_titles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">)]],</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cell_list</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="c1"># </span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kappa_times_gamma_stats_titles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                <span class="n">cell_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="n">kappa_times_gamma_stats_titles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">)],</span>
                        <span class="n">multiplier_stats</span><span class="p">[</span><span class="n">kappa_times_gamma_stats_titles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">)]][</span><span class="mi">0</span><span class="p">],</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cell_list</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

    <span class="n">titles_and_data_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="nb">tuple</span><span class="p">[</span>
            <span class="nb">list</span><span class="p">[</span><span class="n">Title</span><span class="p">],</span>
            <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">SpreadsheetCell</span><span class="p">]],</span>
        <span class="p">],</span>
    <span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Index&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">index_titles</span><span class="p">,</span> <span class="n">index_cells</span><span class="p">),</span>
        <span class="s2">&quot;A) Optimization statistics&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">stats_titles</span><span class="p">,</span> <span class="n">stats_cells</span><span class="p">),</span>
        <span class="s2">&quot;B) Model settings&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">model_titles</span><span class="p">,</span> <span class="n">model_cells</span><span class="p">),</span>
        <span class="s2">&quot;C) Reactions&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">reac_titles</span><span class="p">,</span> <span class="n">reac_cells</span><span class="p">),</span>
        <span class="s2">&quot;D) Metabolites&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">met_titles</span><span class="p">,</span> <span class="n">met_cells</span><span class="p">),</span>
        <span class="s2">&quot;E) Enzymes&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">enzyme_titles</span><span class="p">,</span> <span class="n">enzyme_cells</span><span class="p">),</span>
        <span class="s2">&quot;F) Complexes&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">enzcomplex_titles</span><span class="p">,</span> <span class="n">enzcomplex_cells</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">has_any_gamma</span> <span class="ow">or</span> <span class="n">has_any_kappa</span><span class="p">:</span>
        <span class="n">titles_and_data_dict</span> <span class="o">|=</span> <span class="p">{</span>
            <span class="s2">&quot;G) Efficiency factor statistics&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">kgstats_titles</span><span class="p">,</span> <span class="n">kgstats_cells</span><span class="p">),</span>
        <span class="p">}</span>

    <span class="c1"># Correction data (if given)</span>
    <span class="n">correction_titles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Title</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Affected parameter&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
        <span class="n">Title</span><span class="p">(</span><span class="s2">&quot;Original value&quot;</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">correction_cells</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">SpreadsheetCell</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">num_processed_datasets</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">opt_dataset_name</span><span class="p">,</span> <span class="n">opt_dataset</span> <span class="ow">in</span> <span class="n">optimization_datasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">with_error_corrections</span><span class="p">:</span>
            <span class="n">num_processed_datasets</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">continue</span>
        <span class="n">correction_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Title</span><span class="p">(</span><span class="n">opt_dataset_name</span><span class="p">,</span> <span class="n">WIDTH_DEFAULT</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">var_value</span> <span class="ow">in</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">displayed_var</span> <span class="o">=</span> <span class="n">var_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ERROR_VAR_PREFIX</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">var_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">ERROR_VAR_PREFIX</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">displayed_var</span> <span class="ow">in</span> <span class="n">correction_cells</span><span class="p">:</span>
                    <span class="n">correction_cells</span><span class="p">[</span><span class="n">displayed_var</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="n">round_value</span> <span class="o">=</span> <span class="mi">12</span>
            <span class="n">is_dataset_dependent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">is_relative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">original_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">if</span> <span class="s2">&quot;kcat_times_e_&quot;</span> <span class="ow">in</span> <span class="n">displayed_var</span><span class="p">:</span>
                <span class="n">reac_id</span> <span class="o">=</span> <span class="n">displayed_var</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;kcat_times_e_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">enzyme_id</span> <span class="o">=</span> <span class="n">get_reaction_enzyme_var_id</span><span class="p">(</span>
                    <span class="n">reac_id</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">original_value</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span>
                    <span class="o">*</span> <span class="n">opt_dataset</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">enzyme_id</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">displayed_original_value</span> <span class="o">=</span> <span class="s2">&quot;(see comments)&quot;</span>
                <span class="n">error_value</span> <span class="o">=</span> <span class="n">var_value</span> <span class="o">-</span> <span class="n">original_value</span>
                <span class="n">is_dataset_dependent</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">displayed_var</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;_substrate&quot;</span><span class="p">,</span> <span class="s2">&quot;_product&quot;</span><span class="p">)):</span>
                <span class="n">reac_id</span> <span class="o">=</span> <span class="n">displayed_var</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;____&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">met_id</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">displayed_var</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;____&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_substrate&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_product&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">original_value</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span>
                    <span class="n">reac_id</span>
                <span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span>
                <span class="n">displayed_original_value</span> <span class="o">=</span> <span class="n">original_value</span>
                <span class="n">error_mult</span> <span class="o">=</span> <span class="o">+</span><span class="mi">1</span> <span class="k">if</span> <span class="n">displayed_var</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_product&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">error_value</span> <span class="o">=</span> <span class="n">error_mult</span> <span class="o">*</span> <span class="o">-</span><span class="p">(</span>
                    <span class="n">original_value</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">original_value</span><span class="p">)</span> <span class="o">+</span> <span class="n">error_mult</span> <span class="o">*</span> <span class="n">var_value</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">round_value</span> <span class="o">=</span> <span class="mi">12</span>
                <span class="k">if</span> <span class="n">displayed_var</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_substrate&quot;</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="n">displayed_var</span><span class="p">,</span>
                        <span class="n">original_value</span><span class="p">,</span>
                        <span class="n">error_value</span><span class="p">,</span>
                        <span class="nb">abs</span><span class="p">(</span><span class="n">error_value</span><span class="p">)</span> <span class="o">/</span> <span class="n">original_value</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">displayed_var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;dG0_&quot;</span><span class="p">):</span>
                <span class="n">reac_id</span> <span class="o">=</span> <span class="n">displayed_var</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;dG0_&quot;</span><span class="p">)</span> <span class="p">:]</span>
                <span class="n">original_value</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">dG0</span>
                <span class="n">is_relative</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">displayed_var</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;_plus&quot;</span><span class="p">,</span> <span class="s2">&quot;_minus&quot;</span><span class="p">)):</span>
                <span class="n">valueblock</span> <span class="o">=</span> <span class="n">displayed_var</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_origstart_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_origend_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">min_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">valueblock</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">))</span>
                <span class="n">max_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">valueblock</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;__&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">))</span>
                <span class="n">displayed_original_value</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">min_value</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">max_value</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">min_difference</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">var_value</span> <span class="o">-</span> <span class="n">min_value</span><span class="p">)</span>
                <span class="n">max_difference</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">var_value</span> <span class="o">-</span> <span class="n">max_value</span><span class="p">)</span>
                <span class="n">original_value</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">min_value</span> <span class="k">if</span> <span class="n">min_difference</span> <span class="o">&lt;</span> <span class="n">max_difference</span> <span class="k">else</span> <span class="n">max_value</span>
                <span class="p">)</span>
                <span class="n">error_value</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_difference</span><span class="p">,</span> <span class="n">min_difference</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_relative</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">displayed_var</span><span class="p">,</span> <span class="n">error_value</span><span class="p">,</span> <span class="n">original_value</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
                <span class="n">is_relative</span> <span class="ow">and</span> <span class="p">(</span><span class="n">error_value</span> <span class="o">/</span> <span class="n">original_value</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">min_rel_correction</span>
            <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">is_relative</span> <span class="ow">and</span> <span class="n">error_value</span> <span class="o">&gt;=</span> <span class="n">min_var_value</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">displayed_var</span> <span class="ow">in</span> <span class="n">correction_cells</span><span class="p">:</span>
                    <span class="n">correction_cells</span><span class="p">[</span><span class="n">displayed_var</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">displayed_var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">correction_cells</span><span class="p">:</span>
                <span class="n">correction_cells</span><span class="p">[</span><span class="n">displayed_var</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">displayed_var</span><span class="p">,</span>
                    <span class="n">displayed_original_value</span><span class="p">,</span>
                <span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_processed_datasets</span><span class="p">)]</span>
            <span class="n">correction_cells</span><span class="p">[</span><span class="n">displayed_var</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">error_value</span><span class="p">,</span><span class="w"> </span><span class="n">round_value</span><span class="p">)</span><span class="si">}{</span><span class="sa">f</span><span class="s1">&#39; from </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">original_value</span><span class="p">,</span><span class="w"> </span><span class="n">round_value</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_dataset_dependent</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">num_processed_datasets</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">correction_cells</span> <span class="o">!=</span> <span class="p">{}:</span>
        <span class="n">titles_and_data_dict</span><span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;H&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">has_any_alpha</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">has_any_iota</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">has_any_gamma</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">has_any_kappa</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="si">}</span><span class="s2">) Corrections&quot;</span>
        <span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">correction_titles</span><span class="p">,</span> <span class="n">correction_cells</span><span class="p">)</span>

    <span class="n">_create_xlsx_from_datadicts</span><span class="p">(</span>
        <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span>
        <span class="n">titles_and_data_dict</span><span class="o">=</span><span class="n">titles_and_data_dict</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.standard_solvers" class="doc doc-heading">
            <code>standard_solvers</code>


</h2>

    <div class="doc doc-contents ">

        <p>Includes definitions of some (MI)LP and NLP solvers.</p>
<p>Instead of these pre-definitions, you can also use pyomo's solver definitions.</p>









  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.tellurium_functionality" class="doc doc-heading">
            <code>tellurium_functionality</code>


</h2>

    <div class="doc doc-contents ">

        <p>Functions for exporting COBRA-k model and solution to a kinetic model with the help of Tellurium.</p>
<p>Note: Tellurium's description language for kinetic models is called 'Antimony'.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.tellurium_functionality.get_tellurium_string_from_cobrak_model_and_solution" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_tellurium_string_from_cobrak_model_and_solution</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">cell_density</span><span class="p">,</span> <span class="n">e_concs</span><span class="p">,</span> <span class="n">met_concs</span><span class="p">,</span> <span class="n">nlp_results</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert a complete COBRAk model and its optimisation solution into an
Antimony string that can be loaded by Tellurium.</p>
<p>The function iterates over all reactions, skips those with negligible net
flux, and concatenates the Antimony fragments produced by
:func:<code>_get_reaction_string_of_cobrak_reaction</code>.  After processing reactions,
it adds definitions for metabolites (either userprovided concentrations or
concentrations inferred from the NLP solution) and the global constants
<code>R</code> and <code>T</code>.</p>
<h5 id="cobrak.tellurium_functionality.get_tellurium_string_from_cobrak_model_and_solution--parameters">Parameters</h5>
<p>cobrak_model : Model
    The COBRAk model containing reactions, metabolites, and modelwide
    parameters.
cell_density : float
    Cell density (gL) used to convert between substanceonly and molar
    concentrations.
e_concs : dict[str, float]
    Optional enzyme concentrations keyed by reaction ID. Missing entries
    default to <code>1.0</code>.
met_concs : dict[str, float]
    Optional metabolite concentrations (molL) keyed by metabolite ID.
nlp_results : dict[str, float]
    Optimisation variables returned by the NLP solver (logconcentrations,
    fluxes, etc.).</p>
<h5 id="cobrak.tellurium_functionality.get_tellurium_string_from_cobrak_model_and_solution--returns">Returns</h5>
<p>str
    A complete Antimony model string ready for <code>tellurium.loada</code>.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/tellurium_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_tellurium_string_from_cobrak_model_and_solution</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">cell_density</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">e_concs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">met_concs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">nlp_results</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a complete COBRAk model and its optimisation solution into an</span>
<span class="sd">    Antimony string that can be loaded by Tellurium.</span>

<span class="sd">    The function iterates over all reactions, skips those with negligible net</span>
<span class="sd">    flux, and concatenates the Antimony fragments produced by</span>
<span class="sd">    :func:`_get_reaction_string_of_cobrak_reaction`.  After processing reactions,</span>
<span class="sd">    it adds definitions for metabolites (either userprovided concentrations or</span>
<span class="sd">    concentrations inferred from the NLP solution) and the global constants</span>
<span class="sd">    ``R`` and ``T``.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cobrak_model : Model</span>
<span class="sd">        The COBRAk model containing reactions, metabolites, and modelwide</span>
<span class="sd">        parameters.</span>
<span class="sd">    cell_density : float</span>
<span class="sd">        Cell density (gL) used to convert between substanceonly and molar</span>
<span class="sd">        concentrations.</span>
<span class="sd">    e_concs : dict[str, float]</span>
<span class="sd">        Optional enzyme concentrations keyed by reaction ID. Missing entries</span>
<span class="sd">        default to ``1.0``.</span>
<span class="sd">    met_concs : dict[str, float]</span>
<span class="sd">        Optional metabolite concentrations (molL) keyed by metabolite ID.</span>
<span class="sd">    nlp_results : dict[str, float]</span>
<span class="sd">        Optimisation variables returned by the NLP solver (logconcentrations,</span>
<span class="sd">        fluxes, etc.).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        A complete Antimony model string ready for ``tellurium.loada``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unoptimized_reactions</span> <span class="o">=</span> <span class="n">get_unoptimized_reactions_in_nlp_solution</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">nlp_results</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">tellurium_string</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;# General constants</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;R = </span><span class="si">{</span><span class="n">STANDARD_R</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;T = </span><span class="si">{</span><span class="n">STANDARD_T</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">cobrak_reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span><span class="p">):</span>
            <span class="n">reverse_id</span> <span class="o">=</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">):</span>
            <span class="n">reverse_id</span> <span class="o">=</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reverse_id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">if</span> <span class="n">reverse_id</span> <span class="ow">in</span> <span class="n">nlp_results</span><span class="p">:</span>
            <span class="n">reac_flux</span> <span class="o">=</span> <span class="n">nlp_results</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">-</span> <span class="n">nlp_results</span><span class="p">[</span><span class="n">reverse_id</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reac_flux</span> <span class="o">=</span> <span class="n">nlp_results</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">reac_flux</span> <span class="o">&lt;=</span> <span class="nb">abs</span><span class="p">(</span><span class="mf">1e-12</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="n">e_conc</span> <span class="o">=</span> <span class="n">e_concs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

        <span class="n">tellurium_string</span> <span class="o">+=</span> <span class="n">_get_reaction_string_of_cobrak_reaction</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="o">=</span><span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">reac_id</span><span class="o">=</span><span class="n">reac_id</span><span class="p">,</span>
            <span class="n">cobrak_reaction</span><span class="o">=</span><span class="n">cobrak_reaction</span><span class="p">,</span>
            <span class="n">e_conc</span><span class="o">=</span><span class="n">e_conc</span><span class="p">,</span>
            <span class="n">met_concs</span><span class="o">=</span><span class="n">met_concs</span><span class="p">,</span>
            <span class="n">reac_flux</span><span class="o">=</span><span class="n">reac_flux</span><span class="p">,</span>
            <span class="n">nlp_results</span><span class="o">=</span><span class="n">nlp_results</span><span class="p">,</span>
            <span class="n">kinetic_ignored_metabolites</span><span class="o">=</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">kinetic_ignored_metabolites</span><span class="p">,</span>
            <span class="n">unoptimized_reactions</span><span class="o">=</span><span class="n">unoptimized_reactions</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">cobrak_model</span> <span class="o">=</span> <span class="n">delete_orphaned_metabolites_and_enzymes</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">unsafe_met_id</span><span class="p">,</span> <span class="n">metabolite</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">metabolites</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">original_met_id</span> <span class="o">=</span> <span class="n">unsafe_met_id</span>
        <span class="n">met_id</span> <span class="o">=</span> <span class="n">_get_numbersafe_id</span><span class="p">(</span><span class="n">unsafe_met_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">met_concs</span><span class="p">:</span>
            <span class="n">tellurium_string</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">const substanceOnly species </span><span class="si">{</span><span class="n">met_id</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">met_concs</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1_000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">cell_density</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">met_id</span><span class="si">}</span><span class="s2">_molar := </span><span class="si">{</span><span class="n">met_id</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">cell_density</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1_000</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;x_&quot;</span> <span class="o">+</span> <span class="n">original_met_id</span> <span class="ow">in</span> <span class="n">nlp_results</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="n">metabolite</span><span class="o">.</span><span class="n">log_min_conc</span> <span class="o">!=</span> <span class="n">metabolite</span><span class="o">.</span><span class="n">log_max_conc</span>
            <span class="p">):</span>
                <span class="n">exp_conc</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">exp</span><span class="p">(</span><span class="n">nlp_results</span><span class="p">[</span><span class="n">LNCONC_VAR_PREFIX</span> <span class="o">+</span> <span class="n">original_met_id</span><span class="p">])</span>
                    <span class="o">*</span> <span class="mi">1_000</span>
                    <span class="o">/</span> <span class="n">cell_density</span>
                <span class="p">)</span>
                <span class="n">tellurium_string</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">substanceOnly species </span><span class="si">{</span><span class="n">met_id</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">exp_conc</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">met_id</span><span class="si">}</span><span class="s2">_molar := </span><span class="si">{</span><span class="n">met_id</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">cell_density</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1_000</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;const &quot;</span> <span class="k">if</span> <span class="n">original_met_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_e&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
                <span class="n">tellurium_string</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">substanceOnly species </span><span class="si">{</span><span class="n">met_id</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">exp</span><span class="p">(</span><span class="n">metabolite</span><span class="o">.</span><span class="n">log_min_conc</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1_000</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">cell_density</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">met_id</span><span class="si">}</span><span class="s2">_molar := </span><span class="si">{</span><span class="n">met_id</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">cell_density</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1_000</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

    <span class="k">return</span> <span class="n">tellurium_string</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.tellurium_functionality.write_kinetic_sbml_model_from_cobrak_model_and_solution" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_kinetic_sbml_model_from_cobrak_model_and_solution</span><span class="p">(</span><span class="n">sbml_path</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="p">,</span> <span class="n">cell_density</span><span class="p">,</span> <span class="n">e_concs</span><span class="p">,</span> <span class="n">met_concs</span><span class="p">,</span> <span class="n">nlp_results</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Export a kinetic model derived from a COBRAk model to an SBML file.</p>
<p>The function first builds an Antimony string via
:func:<code>get_tellurium_string_from_cobrak_model_and_solution</code>, loads it into a
Tellurium <code>RoadRunner</code> instance, and then writes the model to the specified
SBML file path.</p>
<h5 id="cobrak.tellurium_functionality.write_kinetic_sbml_model_from_cobrak_model_and_solution--parameters">Parameters</h5>
<p>sbml_path : str
    Destination file path for the SBML document (e.g. <code>"model.xml"</code>).
cobrak_model : Model
    The source COBRAk model.
cell_density : float
    Cell density used for concentration conversions.
e_concs : dict[str, float]
    Enzyme concentrations per reaction.
met_concs : dict[str, float]
    Metabolite concentrations per species.
nlp_results : dict[str, float]
    NLP optimisation results (logconcentrations, fluxes, etc.).</p>
<h5 id="cobrak.tellurium_functionality.write_kinetic_sbml_model_from_cobrak_model_and_solution--returns">Returns</h5>
<p>None
    The function writes the SBML file as a side effect.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/tellurium_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span>
<span class="k">def</span><span class="w"> </span><span class="nf">write_kinetic_sbml_model_from_cobrak_model_and_solution</span><span class="p">(</span>
    <span class="n">sbml_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">cell_density</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">e_concs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">met_concs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">nlp_results</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Export a kinetic model derived from a COBRAk model to an SBML file.</span>

<span class="sd">    The function first builds an Antimony string via</span>
<span class="sd">    :func:`get_tellurium_string_from_cobrak_model_and_solution`, loads it into a</span>
<span class="sd">    Tellurium ``RoadRunner`` instance, and then writes the model to the specified</span>
<span class="sd">    SBML file path.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sbml_path : str</span>
<span class="sd">        Destination file path for the SBML document (e.g. ``&quot;model.xml&quot;``).</span>
<span class="sd">    cobrak_model : Model</span>
<span class="sd">        The source COBRAk model.</span>
<span class="sd">    cell_density : float</span>
<span class="sd">        Cell density used for concentration conversions.</span>
<span class="sd">    e_concs : dict[str, float]</span>
<span class="sd">        Enzyme concentrations per reaction.</span>
<span class="sd">    met_concs : dict[str, float]</span>
<span class="sd">        Metabolite concentrations per species.</span>
<span class="sd">    nlp_results : dict[str, float]</span>
<span class="sd">        NLP optimisation results (logconcentrations, fluxes, etc.).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>
<span class="sd">        The function writes the SBML file as a side effect.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tellurium_string</span> <span class="o">=</span> <span class="n">get_tellurium_string_from_cobrak_model_and_solution</span><span class="p">(</span>
        <span class="n">cobrak_model</span><span class="o">=</span><span class="n">cobrak_model</span><span class="p">,</span>
        <span class="n">cell_density</span><span class="o">=</span><span class="n">cell_density</span><span class="p">,</span>
        <span class="n">e_concs</span><span class="o">=</span><span class="n">e_concs</span><span class="p">,</span>
        <span class="n">met_concs</span><span class="o">=</span><span class="n">met_concs</span><span class="p">,</span>
        <span class="n">nlp_results</span><span class="o">=</span><span class="n">nlp_results</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">tellurium_runner</span> <span class="o">=</span> <span class="n">tellurium</span><span class="o">.</span><span class="n">loada</span><span class="p">(</span><span class="n">tellurium_string</span><span class="p">)</span>
    <span class="n">tellurium_runner</span><span class="o">.</span><span class="n">exportToSBML</span><span class="p">(</span><span class="n">sbml_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.uniprot_functionality" class="doc doc-heading">
            <code>uniprot_functionality</code>


</h2>

    <div class="doc doc-contents ">

        <p>get_protein_mass_mapping.py</p>
<p>Functions for the generation of a model's mapping of its proteins and their masses.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.uniprot_functionality.uniprot_get_enzyme_molecular_weights" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">uniprot_get_enzyme_molecular_weights</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">cache_basepath</span><span class="p">,</span> <span class="n">multiplication_factor</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a JSON with a mapping of protein IDs as keys, and as values the protein mass in kDa.</p>
<p>The protein masses are taken  from UniProt (retrieved using
UniProt's REST API).</p>
<h5 id="cobrak.uniprot_functionality.uniprot_get_enzyme_molecular_weights--arguments">Arguments</h5>
<ul>
<li>model: cobra.Model ~ The model in the cobrapy format</li>
</ul>
<h5 id="cobrak.uniprot_functionality.uniprot_get_enzyme_molecular_weights--output">Output</h5>
<p>A JSON file with the path project_folder+project_name+'_protein_id_mass_mapping.json'
and the following structure:</p>
<pre>
{
    "$PROTEIN_ID": $PROTEIN_MASS_IN_KDA,
    (...),
}
</pre>


            <details class="quote">
              <summary>Source code in <code>cobrak/uniprot_functionality.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">uniprot_get_enzyme_molecular_weights</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">,</span>
    <span class="n">cache_basepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">multiplication_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a JSON with a mapping of protein IDs as keys, and as values the protein mass in kDa.</span>

<span class="sd">    The protein masses are taken  from UniProt (retrieved using</span>
<span class="sd">    UniProt&#39;s REST API).</span>

<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">    * model: cobra.Model ~ The model in the cobrapy format</span>

<span class="sd">    Output</span>
<span class="sd">    ----------</span>
<span class="sd">    A JSON file with the path project_folder+project_name+&#39;_protein_id_mass_mapping.json&#39;</span>
<span class="sd">    and the following structure:</span>
<span class="sd">    &lt;pre&gt;</span>
<span class="sd">    {</span>
<span class="sd">        &quot;$PROTEIN_ID&quot;: $PROTEIN_MASS_IN_KDA,</span>
<span class="sd">        (...),</span>
<span class="sd">    }</span>
<span class="sd">    &lt;/pre&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># GET UNIPROT ID - PROTEIN MAPPING</span>
    <span class="n">uniprot_id_protein_id_mapping</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">genes</span><span class="p">:</span>
        <span class="c1"># Without a UniProt ID, no mass mapping can be found</span>
        <span class="k">if</span> <span class="s2">&quot;uniprot&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gene</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
            <span class="n">uniprot_id_protein_id_mapping</span><span class="p">[</span><span class="n">gene</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">gene</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>
            <span class="k">continue</span>
        <span class="n">uniprot_id</span> <span class="o">=</span> <span class="n">gene</span><span class="o">.</span><span class="n">annotation</span><span class="p">[</span><span class="s2">&quot;uniprot&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">uniprot_id</span> <span class="ow">in</span> <span class="n">uniprot_id_protein_id_mapping</span><span class="p">:</span>
            <span class="n">uniprot_id_protein_id_mapping</span><span class="p">[</span><span class="n">uniprot_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gene</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">uniprot_id_protein_id_mapping</span><span class="p">[</span><span class="n">uniprot_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">gene</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>

    <span class="c1"># GET UNIPROT ID&lt;-&gt;PROTEIN MASS MAPPING</span>
    <span class="n">uniprot_id_protein_mass_mapping</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># The cache stored UniProt masses for already searched</span>
    <span class="c1"># UniProt IDs (each file in the cache folder has the name</span>
    <span class="c1"># of the corresponding UniProt ID). This prevents searching</span>
    <span class="c1"># UniProt for already found protein masses. :-)</span>
    <span class="n">cache_basepath</span> <span class="o">=</span> <span class="n">standardize_folder</span><span class="p">(</span><span class="n">cache_basepath</span><span class="p">)</span>
    <span class="n">ensure_folder_existence</span><span class="p">(</span><span class="n">cache_basepath</span><span class="p">)</span>
    <span class="n">cache_filepath</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cache_basepath</span><span class="si">}</span><span class="s2">_cache_uniprot_molecular_weights.json&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">cache_json</span> <span class="o">=</span> <span class="n">json_load</span><span class="p">(</span><span class="n">cache_filepath</span><span class="p">,</span> <span class="n">Any</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">cache_json</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># Go through each batch of UniProt IDs (multiple UniProt IDs</span>
    <span class="c1"># are searched at once in order to save an amount of UniProt API calls)</span>
    <span class="c1"># and retrieve the amino acid sequences and using these sequences, their</span>
    <span class="c1"># masses.</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting UniProt ID&lt;-&gt;Protein mass search using UniProt API...&quot;</span><span class="p">)</span>
    <span class="n">uniprot_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">uniprot_id_protein_id_mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">15</span>
    <span class="n">batch_start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">batch_start</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">uniprot_ids</span><span class="p">):</span>
        <span class="c1"># Create the batch with all UniProt IDs</span>
        <span class="n">prebatch</span> <span class="o">=</span> <span class="n">uniprot_ids</span><span class="p">[</span><span class="n">batch_start</span> <span class="p">:</span> <span class="n">batch_start</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">]</span>
        <span class="n">batch</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Remove all IDs which are present in the cache (i.e.,</span>
        <span class="c1"># which were searched for already).</span>
        <span class="c1"># The cache consists of pickled protein mass floats, each</span>
        <span class="c1"># onein a file with the name of the associated protein.</span>
        <span class="k">for</span> <span class="n">uniprot_id</span> <span class="ow">in</span> <span class="n">prebatch</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">uniprot_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cache_json</span><span class="p">:</span>
                <span class="n">batch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">uniprot_id</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">uniprot_id_protein_mass_mapping</span><span class="p">[</span><span class="n">uniprot_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">cache_json</span><span class="p">[</span><span class="n">uniprot_id</span><span class="p">]</span>
                <span class="c1"># print(uniprot_id + &quot;:&quot;, uniprot_id_protein_mass_mapping[uniprot_id])</span>

        <span class="c1"># If all IDs could be found in the cache, continue with the next batch.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">batch_start</span> <span class="o">+=</span> <span class="n">batch_size</span>
            <span class="k">continue</span>

        <span class="c1"># Create the UniProt query for the batch</span>
        <span class="c1"># With &#39;OR&#39;, all given IDs are searched, and subsequently in this script,</span>
        <span class="c1"># the right associated masses are being picked.</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot; OR &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">uniprot_query_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://rest.uniprot.org/uniprotkb/search?query=</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&amp;format=tsv&amp;fields=accession,id,mass&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;UniProt batch search for: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Call UniProt&#39;s API :-)</span>
        <span class="n">uniprot_data</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">uniprot_query_url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1e6</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Wait in order to cool down their server :-)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>

        <span class="c1"># Read out the API-returned lines</span>
        <span class="n">found_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">uniprot_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">accession_id</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
            <span class="n">entry_id</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
            <span class="n">mass_string</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Note that the mass entry from UniProt uses a comma as a thousand separator, so it has to be removed before parsing</span>
                <span class="n">mass</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mass_string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># We may also risk the entry is missing</span>
                <span class="c1"># print(f&quot;No protein mass obtainable for protein ID {uniprot_id}&quot;)</span>
                <span class="k">continue</span>
            <span class="n">uniprot_id_protein_mass_mapping</span><span class="p">[</span><span class="n">accession_id</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span>
            <span class="n">uniprot_id_protein_mass_mapping</span><span class="p">[</span><span class="n">entry_id</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span>
            <span class="n">found_ids</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">accession_id</span><span class="p">,</span> <span class="n">entry_id</span><span class="p">))</span>

        <span class="c1"># Create the pickled cache files for the searched protein masses</span>
        <span class="k">for</span> <span class="n">uniprot_id</span> <span class="ow">in</span> <span class="n">found_ids</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">uniprot_id</span> <span class="ow">in</span> <span class="n">uniprot_id_protein_mass_mapping</span>
            <span class="p">):</span>  <span class="c1"># Takes into account that we may fail to obtain a UniProt ID</span>
                <span class="n">cache_json</span><span class="p">[</span><span class="n">uniprot_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">uniprot_id_protein_mass_mapping</span><span class="p">[</span><span class="n">uniprot_id</span><span class="p">]</span>

        <span class="c1"># Continue with the next batch :D</span>
        <span class="n">batch_start</span> <span class="o">+=</span> <span class="n">batch_size</span>

    <span class="c1"># Create the final protein ID &lt;-&gt; mass mapping</span>
    <span class="n">protein_id_mass_mapping</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">uniprot_id</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">uniprot_id_protein_mass_mapping</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">protein_ids</span> <span class="o">=</span> <span class="n">uniprot_id_protein_id_mapping</span><span class="p">[</span><span class="n">uniprot_id</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">protein_id</span> <span class="ow">in</span> <span class="n">protein_ids</span><span class="p">:</span>
            <span class="n">protein_id_mass_mapping</span><span class="p">[</span><span class="n">protein_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">uniprot_id_protein_mass_mapping</span><span class="p">[</span><span class="n">uniprot_id</span><span class="p">]</span> <span class="o">*</span> <span class="n">multiplication_factor</span>
            <span class="p">)</span>

    <span class="c1"># Return protein mass list JSON :D</span>
    <span class="n">json_write</span><span class="p">(</span><span class="n">cache_filepath</span><span class="p">,</span> <span class="n">cache_json</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">protein_id_mass_mapping</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="cobrak.utilities" class="doc doc-heading">
            <code>utilities</code>


</h2>

    <div class="doc doc-contents ">

        <p>General utility functions for COBRAk dataclasses and more.</p>
<p>This module does not include I/O functions which are found in COBRAk's "io" module.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.add_objective_value_as_extra_linear_constraint" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_objective_value_as_extra_linear_constraint</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">objective_value</span><span class="p">,</span> <span class="n">objective_target</span><span class="p">,</span> <span class="n">objective_sense</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Adds a linear constraint to a COBRA-k model that enforces the objective value.</p>
<p>This function creates an extra linear constraint that limits the objective
value to be within a small range around the original objective value. This
can be useful for enforcing constraints during model manipulation or
optimization.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRA-k Model object to be modified.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_value</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The original objective value.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_target</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string representing the objective variable or a dictionary
mapping variables to their coefficients in the objective function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_sense</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sense of the objective function (1 for maximization, -1 for minimization).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The modified COBRA-k Model object with the extra linear constraint added.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_objective_value_as_extra_linear_constraint</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">objective_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">objective_target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">objective_sense</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds a linear constraint to a COBRA-k model that enforces the objective value.</span>

<span class="sd">    This function creates an extra linear constraint that limits the objective</span>
<span class="sd">    value to be within a small range around the original objective value. This</span>
<span class="sd">    can be useful for enforcing constraints during model manipulation or</span>
<span class="sd">    optimization.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model: The COBRA-k Model object to be modified.</span>
<span class="sd">        objective_value: The original objective value.</span>
<span class="sd">        objective_target: A string representing the objective variable or a dictionary</span>
<span class="sd">            mapping variables to their coefficients in the objective function.</span>
<span class="sd">        objective_sense: The sense of the objective function (1 for maximization, -1 for minimization).</span>

<span class="sd">    Returns:</span>
<span class="sd">        The modified COBRA-k Model object with the extra linear constraint added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_objsense_maximization</span><span class="p">(</span><span class="n">objective_sense</span><span class="p">):</span>
        <span class="n">lower_value</span> <span class="o">=</span> <span class="n">objective_value</span> <span class="o">-</span> <span class="mf">1e-12</span>
        <span class="n">upper_value</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lower_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">upper_value</span> <span class="o">=</span> <span class="n">objective_value</span> <span class="o">+</span> <span class="mf">1e-12</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">objective_target</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">objective_target</span> <span class="o">=</span> <span class="p">{</span><span class="n">objective_target</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
    <span class="n">cobrak_model</span><span class="o">.</span><span class="n">extra_linear_constraints</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">ExtraLinearConstraint</span><span class="p">(</span>
            <span class="n">stoichiometries</span><span class="o">=</span><span class="n">objective_target</span><span class="p">,</span>
            <span class="n">lower_value</span><span class="o">=</span><span class="n">lower_value</span><span class="p">,</span>
            <span class="n">upper_value</span><span class="o">=</span><span class="n">upper_value</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">cobrak_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.add_statuses_to_optimziation_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_statuses_to_optimziation_dict</span><span class="p">(</span><span class="n">optimization_dict</span><span class="p">,</span> <span class="n">pyomo_results</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Adds solver statuses to the optimization dict.</p>
<p>This includes:
* SOLVER_STATUS_KEY's value, which is 0 for ok, 1 for warning
   and higher values for problems.
* TERMINATION_CONDITION_KEY's value, which is 0.1 for globally optimal,
  0.2 for optimal, 0.3 for locally optimal and &gt;=1 for any result with problems.
* ALL_OK_KEY's value, which is True if SOLVER_STATUS_KEY's value &lt; 0
  and TERMINATION_CONDITION_KEY's value &lt; 1.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>optimization_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optimization dict</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pyomo_results</code>
            </td>
            <td>
                  <code><span title="pyomo.opt.results.SolverResults">SolverResults</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pyomo results object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unknown pyomo_results.solver.status or termination_condition</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, float]: The pyomo results dict with the added statuses.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_statuses_to_optimziation_dict</span><span class="p">(</span>
    <span class="n">optimization_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">pyomo_results</span><span class="p">:</span> <span class="n">SolverResults</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds solver statuses to the optimization dict.</span>

<span class="sd">    This includes:</span>
<span class="sd">    * SOLVER_STATUS_KEY&#39;s value, which is 0 for ok, 1 for warning</span>
<span class="sd">       and higher values for problems.</span>
<span class="sd">    * TERMINATION_CONDITION_KEY&#39;s value, which is 0.1 for globally optimal,</span>
<span class="sd">      0.2 for optimal, 0.3 for locally optimal and &gt;=1 for any result with problems.</span>
<span class="sd">    * ALL_OK_KEY&#39;s value, which is True if SOLVER_STATUS_KEY&#39;s value &lt; 0</span>
<span class="sd">      and TERMINATION_CONDITION_KEY&#39;s value &lt; 1.</span>

<span class="sd">    Args:</span>
<span class="sd">        optimization_dict (dict[str, float]): The optimization dict</span>
<span class="sd">        pyomo_results (SolverResults): The pyomo results object</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Unknown pyomo_results.solver.status or termination_condition</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, float]: The pyomo results dict with the added statuses.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">solver_status</span> <span class="o">=</span> <span class="n">get_solver_status_from_pyomo_results</span><span class="p">(</span><span class="n">pyomo_results</span><span class="p">)</span>

    <span class="n">termination_condition</span> <span class="o">=</span> <span class="n">get_termination_condition_from_pyomo_results</span><span class="p">(</span><span class="n">pyomo_results</span><span class="p">)</span>

    <span class="n">optimization_dict</span><span class="p">[</span><span class="n">SOLVER_STATUS_KEY</span><span class="p">]</span> <span class="o">=</span> <span class="n">solver_status</span>
    <span class="n">optimization_dict</span><span class="p">[</span><span class="n">TERMINATION_CONDITION_KEY</span><span class="p">]</span> <span class="o">=</span> <span class="n">termination_condition</span>
    <span class="n">optimization_dict</span><span class="p">[</span><span class="n">ALL_OK_KEY</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">termination_condition</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">termination_condition</span> <span class="o">&lt;</span> <span class="mi">1</span>
    <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">solver_status</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">optimization_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.apply_error_correction_on_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_error_correction_on_model</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">correction_result</span><span class="p">,</span> <span class="n">min_abs_error_value</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">min_rel_error_value</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Applies error corrections to a COBRAl model based on a correction result dictionary.</p>
<p>This function iterates through the <code>correction_result</code> dictionary and applies corrections
to reaction k_cat values, Michaelis-Menten constants (k_M), Gibbs free energy changes (G')
as well as the inhibition terms (k_I) and activation terms (k_A).
The corrections are applied only if the (for all parameters except G') relative or (for G') absolute
error exceeds specified thresholds.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAl model to be corrected.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>correction_result</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing error correction values.  Keys are expected to
contain information about the reaction, metabolite or other variable value being corrected.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_abs_error_value</code>
            </td>
            <td>
                  <code><span title="pydantic.NonNegativeFloat">NonNegativeFloat</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum absolute error value for applying corrections.</p>
              </div>
            </td>
            <td>
                  <code>0.01</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_rel_error_value</code>
            </td>
            <td>
                  <code><span title="pydantic.NonNegativeFloat">NonNegativeFloat</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum relative error value for applying corrections.</p>
              </div>
            </td>
            <td>
                  <code>0.01</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, prints details of the corrections being applied.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A deep copy of the COBRAk model with the error corrections applied.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">apply_error_correction_on_model</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">correction_result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">min_abs_error_value</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="n">min_rel_error_value</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Applies error corrections to a COBRAl model based on a correction result dictionary.</span>

<span class="sd">    This function iterates through the `correction_result` dictionary and applies corrections</span>
<span class="sd">    to reaction k_cat values, Michaelis-Menten constants (k_M), Gibbs free energy changes (G&#39;)</span>
<span class="sd">    as well as the inhibition terms (k_I) and activation terms (k_A).</span>
<span class="sd">    The corrections are applied only if the (for all parameters except G&#39;) relative or (for G&#39;) absolute</span>
<span class="sd">    error exceeds specified thresholds.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model: The COBRAl model to be corrected.</span>
<span class="sd">        correction_result: A dictionary containing error correction values.  Keys are expected to</span>
<span class="sd">            contain information about the reaction, metabolite or other variable value being corrected.</span>
<span class="sd">        min_abs_error_value: The minimum absolute error value for applying corrections.</span>
<span class="sd">        min_rel_error_value: The minimum relative error value for applying corrections.</span>
<span class="sd">        verbose: If True, prints details of the corrections being applied.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A deep copy of the COBRAk model with the error corrections applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">changed_model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
    <span class="n">error_entries</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">correction_result</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">ERROR_VAR_PREFIX</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">error_entries</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="s2">&quot;_kcat_times_e_&quot;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
            <span class="n">reac_id</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_kcat_times_e_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">enzyme_id</span> <span class="o">=</span> <span class="n">get_reaction_enzyme_var_id</span><span class="p">(</span>
                <span class="n">reac_id</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">k_cat</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span>
            <span class="n">enzyme_conc</span> <span class="o">=</span> <span class="n">correction_result</span><span class="p">[</span><span class="n">enzyme_id</span><span class="p">]</span>
            <span class="n">e_times_kcat</span> <span class="o">=</span> <span class="n">k_cat</span> <span class="o">*</span> <span class="n">enzyme_conc</span>
            <span class="k">if</span> <span class="n">e_times_kcat</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">kcat_correction</span> <span class="o">=</span> <span class="p">(</span><span class="n">e_times_kcat</span> <span class="o">+</span> <span class="n">value</span><span class="p">)</span> <span class="o">/</span> <span class="n">e_times_kcat</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">kcat_correction</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_rel_error_value</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">changed_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span>
                <span class="n">reac_id</span>
            <span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span> <span class="o">*=</span> <span class="n">kcat_correction</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Correct kcat of </span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">k_cat</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">changed_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;_substrate&quot;</span><span class="p">,</span> <span class="s2">&quot;_product&quot;</span><span class="p">)):</span>
            <span class="n">reac_id</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;____&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ERROR_VAR_PREFIX</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">met_id</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;____&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_substrate&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_product&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">original_km</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span>
                <span class="n">met_id</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_product&quot;</span><span class="p">):</span>
                <span class="n">new_value</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">original_km</span><span class="p">)</span> <span class="o">+</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">new_value</span> <span class="o">/</span> <span class="n">original_km</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">min_rel_error_value</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">changed_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">exp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">original_km</span><span class="p">)</span> <span class="o">+</span> <span class="n">value</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_value</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">original_km</span><span class="p">)</span> <span class="o">-</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">original_km</span> <span class="o">/</span> <span class="n">new_value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">min_rel_error_value</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">changed_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">exp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">original_km</span><span class="p">)</span> <span class="o">-</span> <span class="n">value</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Correct km of </span><span class="si">{</span><span class="n">met_id</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">original_km</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">changed_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_iota&quot;</span><span class="p">):</span>
            <span class="n">reac_id</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;____&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">met_id</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;____&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">original_ki</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_i</span><span class="p">[</span>
                <span class="n">met_id</span>
            <span class="p">]</span>
            <span class="n">new_value</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">original_ki</span><span class="p">)</span> <span class="o">+</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">new_value</span> <span class="o">/</span> <span class="n">original_ki</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">min_rel_error_value</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">changed_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_is</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span>
                <span class="n">log</span><span class="p">(</span><span class="n">original_ki</span><span class="p">)</span> <span class="o">+</span> <span class="n">value</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Correct ki of </span><span class="si">{</span><span class="n">met_id</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">original_ki</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">changed_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_is</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">key</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_alpha&quot;</span><span class="p">):</span>
            <span class="n">reac_id</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;____&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">met_id</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;____&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">original_ka</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_a</span><span class="p">[</span>
                <span class="n">met_id</span>
            <span class="p">]</span>
            <span class="n">new_value</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">original_ka</span><span class="p">)</span> <span class="o">+</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">new_value</span> <span class="o">/</span> <span class="n">original_ka</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">min_rel_error_value</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">changed_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_as</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span>
                <span class="n">log</span><span class="p">(</span><span class="n">original_ka</span><span class="p">)</span> <span class="o">+</span> <span class="n">value</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Correct ka of </span><span class="si">{</span><span class="n">met_id</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">original_ka</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">changed_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_as</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="s2">&quot;dG0_&quot;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">min_abs_error_value</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">reac_id</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;dG0_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">changed_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">dG0</span> <span class="o">-=</span> <span class="n">value</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">original_dG0</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">dG0</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Correct G&#39; </span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">original_dG0</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">changed_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">dG0</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

    <span class="k">return</span> <span class="n">changed_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.apply_variability_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_variability_dict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">,</span> <span class="n">error_scenario</span><span class="o">=</span><span class="p">{},</span> <span class="n">abs_epsilon</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Applies the variability data as new variable bounds in the pyomo model</p>
<p>I.e., if the variaility of a variable A is [-10;10],
A is now set to be -10 &lt;= A &lt;= 10 by changing
its lower and upper bound.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="pyomo.environ.ConcreteModel">ConcreteModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pyomo model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variability_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The variability data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>abs_epsilon</code>
            </td>
            <td>
                  <code><span title="_type_">_type_</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Under this value, the given value is assumed to be 0.0. Defaults to 1e-9.</p>
              </div>
            </td>
            <td>
                  <code>1e-05</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ConcreteModel</code></td>            <td>
                  <code><span title="pyomo.environ.ConcreteModel">ConcreteModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pyomo model with newly set variable bounds</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">apply_variability_dict</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">ConcreteModel</span><span class="p">,</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">error_scenario</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">abs_epsilon</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConcreteModel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Applies the variability data as new variable bounds in the pyomo model</span>

<span class="sd">    I.e., if the variaility of a variable A is [-10;10],</span>
<span class="sd">    A is now set to be -10 &lt;= A &lt;= 10 by changing</span>
<span class="sd">    its lower and upper bound.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (ConcreteModel): The pyomo model</span>
<span class="sd">        variability_dict (dict[str, tuple[float, float]]): The variability data</span>
<span class="sd">        abs_epsilon (_type_, optional): Under this value, the given value is assumed to be 0.0. Defaults to 1e-9.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ConcreteModel: The pyomo model with newly set variable bounds</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model_varnames</span> <span class="o">=</span> <span class="n">get_model_var_names</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">var_id</span><span class="p">,</span> <span class="n">variability</span> <span class="ow">in</span> <span class="n">variability_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">error_scenario</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">variability</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">abs_epsilon</span><span class="p">:</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">var_id</span><span class="p">)</span><span class="o">.</span><span class="n">setlb</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lbchange_var_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ERROR_BOUND_LOWER_CHANGE_PREFIX</span><span class="si">}{</span><span class="n">var_id</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">lbchange_var_id</span> <span class="ow">in</span> <span class="n">model_varnames</span><span class="p">:</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">var_id</span><span class="p">)</span><span class="o">.</span><span class="n">setlb</span><span class="p">(</span>
                        <span class="n">variability</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">lbchange_var_id</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">var_id</span><span class="p">)</span><span class="o">.</span><span class="n">setlb</span><span class="p">(</span><span class="n">variability</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">variability</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">abs_epsilon</span><span class="p">:</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">var_id</span><span class="p">)</span><span class="o">.</span><span class="n">setub</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ubchange_var_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ERROR_BOUND_UPPER_CHANGE_PREFIX</span><span class="si">}{</span><span class="n">var_id</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">ubchange_var_id</span> <span class="ow">in</span> <span class="n">model_varnames</span><span class="p">:</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">var_id</span><span class="p">)</span><span class="o">.</span><span class="n">setub</span><span class="p">(</span>
                        <span class="n">variability</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ubchange_var_id</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">var_id</span><span class="p">)</span><span class="o">.</span><span class="n">setub</span><span class="p">(</span><span class="n">variability</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.combine_enzyme_reaction_datasets" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">combine_enzyme_reaction_datasets</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Combines the enzyme reaction data from the given sources</p>
<p>The first given dataset has precedence, meaning that its data (k_cats, k_ms, ...)
will be set first. For any reaction/metabolite where data is missing, it is then looked
up in the second given dataset, then in the third and so on.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>datasets</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="EnzymeReactionData (cobrak.dataclasses.EnzymeReactionData)" href="#cobrak.dataclasses.EnzymeReactionData">EnzymeReactionData</a> | None]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The enzyme reaction datasets</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="EnzymeReactionData (cobrak.dataclasses.EnzymeReactionData)" href="#cobrak.dataclasses.EnzymeReactionData">EnzymeReactionData</a> | None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, EnzymeReactionData | None]: The combined enzyme reaction data</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">combine_enzyme_reaction_datasets</span><span class="p">(</span>
    <span class="n">datasets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EnzymeReactionData</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EnzymeReactionData</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Combines the enzyme reaction data from the given sources</span>

<span class="sd">    The first given dataset has precedence, meaning that its data (k_cats, k_ms, ...)</span>
<span class="sd">    will be set first. For any reaction/metabolite where data is missing, it is then looked</span>
<span class="sd">    up in the second given dataset, then in the third and so on.</span>

<span class="sd">    Args:</span>
<span class="sd">        datasets (list[dict[str, EnzymeReactionData  |  None]]): The enzyme reaction datasets</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, EnzymeReactionData | None]: The combined enzyme reaction data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">combined_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EnzymeReactionData</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">enzyme_reaction_data</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">combined_data</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">k_cat_references</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="o">&gt;</span> <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat_references</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
            <span class="p">):</span>
                <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnzymeReactionData</span><span class="p">(</span>
                    <span class="n">identifiers</span><span class="o">=</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span><span class="p">,</span>
                    <span class="n">k_cat</span><span class="o">=</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span><span class="p">,</span>
                    <span class="n">k_cat_references</span><span class="o">=</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat_references</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">k_m</span> <span class="ow">in</span> <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">k_ms</span> <span class="ow">or</span> <span class="p">(</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">k_m_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                    <span class="o">&gt;</span> <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_m_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="p">):</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_m</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">k_m_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_m_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span>
                    <span class="p">)</span>

            <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">k_i</span> <span class="ow">in</span> <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_is</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">k_is</span> <span class="ow">or</span> <span class="p">(</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">k_i_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                    <span class="o">&gt;</span> <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_i_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="p">):</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">k_is</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_i</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">k_i_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_i_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span>
                    <span class="p">)</span>

            <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">k_a</span> <span class="ow">in</span> <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_as</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">k_as</span> <span class="ow">or</span> <span class="p">(</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">k_a_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                    <span class="o">&gt;</span> <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_a_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="p">):</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">k_as</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_a</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">k_a_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_a_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span>
                    <span class="p">)</span>

            <span class="n">hills</span> <span class="o">=</span> <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficients</span>
            <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">hills</span><span class="o">.</span><span class="n">kappa</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="o">.</span><span class="n">kappa</span> <span class="ow">or</span> <span class="p">(</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
                    <span class="o">.</span><span class="n">hill_coefficient_references</span><span class="o">.</span><span class="n">kappa</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="o">.</span><span class="n">tax_distance</span>
                    <span class="o">&gt;</span> <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficient_references</span><span class="o">.</span><span class="n">kappa</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span>
                        <span class="mi">0</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="p">):</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="o">.</span><span class="n">kappa</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">hills</span><span class="o">.</span><span class="n">kappa</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">hill_coefficient_references</span><span class="o">.</span><span class="n">kappa</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficient_references</span><span class="o">.</span><span class="n">kappa</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span>
                    <span class="p">)</span>
            <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">hills</span><span class="o">.</span><span class="n">iota</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="o">.</span><span class="n">iota</span> <span class="ow">or</span> <span class="p">(</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
                    <span class="o">.</span><span class="n">hill_coefficient_references</span><span class="o">.</span><span class="n">iota</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="o">.</span><span class="n">tax_distance</span>
                    <span class="o">&gt;</span> <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficient_references</span><span class="o">.</span><span class="n">iota</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span>
                        <span class="mi">0</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="p">):</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="o">.</span><span class="n">iota</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">hills</span><span class="o">.</span><span class="n">iota</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">hill_coefficient_references</span><span class="o">.</span><span class="n">iota</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficient_references</span><span class="o">.</span><span class="n">iota</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span>
                    <span class="p">)</span>
            <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">hills</span><span class="o">.</span><span class="n">alpha</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="o">.</span><span class="n">alpha</span> <span class="ow">or</span> <span class="p">(</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
                    <span class="o">.</span><span class="n">hill_coefficient_references</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="o">.</span><span class="n">tax_distance</span>
                    <span class="o">&gt;</span> <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficient_references</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span>
                        <span class="mi">0</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="p">):</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">hills</span><span class="o">.</span><span class="n">alpha</span>
                    <span class="n">combined_data</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">hill_coefficient_references</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficient_references</span><span class="o">.</span><span class="n">alpha</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span>
                    <span class="p">)</span>

    <span class="k">return</span> <span class="n">combined_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.compare_multiple_results_to_best" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compare_multiple_results_to_best</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">is_maximization</span><span class="p">,</span> <span class="n">min_reac_flux</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compares multiple optimization results to the best result and returns a dictionary with statistics and comparisons.</p>
<p>This function first identifies the best result based on the objective value.
It then compares each result to the best result and calculates statistics and comparisons.
The comparisons include the difference between the objective values and the reaction fluxes.
Reactions with fluxes below the minimum reaction flux threshold are ignored.</p>
<p>Args:
cobrak_model (Model): The COBRA-k model used for the optimization.
results (list[dict[str, float]]): A list of optimization results.
is_maximization (bool): Whether the optimization is a maximization problem.
min_reac_flux (float, optional): The minimum reaction flux to consider. Defaults to 1e-8.</p>
<p>Returns:
dict[int, tuple[dict[str, float], dict[int, list[str]]]]: A dictionary where each key is the index of a result and each value is a tuple containing:
- A dictionary with reaction statistics, including:
- "min": The minimum absolute flux difference.
- "max": The maximum absolute flux difference.
- "sum": The sum of all absolute flux differences.
- "mean": The mean of all absolute flux differences.
- "median": The median of all absolute flux differences.
- "obj_difference": The difference between the objective value of the current result and the best result.
- A dictionary with reaction comparisons, where each key is an integer indicating which result has a higher flux:
- 0: The best result has a higher flux.
- 1: The current result has a higher flux.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compare_multiple_results_to_best</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">is_maximization</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">min_reac_flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compares multiple optimization results to the best result and returns a dictionary with statistics and comparisons.</span>

<span class="sd">    This function first identifies the best result based on the objective value.</span>
<span class="sd">    It then compares each result to the best result and calculates statistics and comparisons.</span>
<span class="sd">    The comparisons include the difference between the objective values and the reaction fluxes.</span>
<span class="sd">    Reactions with fluxes below the minimum reaction flux threshold are ignored.</span>

<span class="sd">    Args:</span>
<span class="sd">    cobrak_model (Model): The COBRA-k model used for the optimization.</span>
<span class="sd">    results (list[dict[str, float]]): A list of optimization results.</span>
<span class="sd">    is_maximization (bool): Whether the optimization is a maximization problem.</span>
<span class="sd">    min_reac_flux (float, optional): The minimum reaction flux to consider. Defaults to 1e-8.</span>

<span class="sd">    Returns:</span>
<span class="sd">    dict[int, tuple[dict[str, float], dict[int, list[str]]]]: A dictionary where each key is the index of a result and each value is a tuple containing:</span>
<span class="sd">    - A dictionary with reaction statistics, including:</span>
<span class="sd">    - &quot;min&quot;: The minimum absolute flux difference.</span>
<span class="sd">    - &quot;max&quot;: The maximum absolute flux difference.</span>
<span class="sd">    - &quot;sum&quot;: The sum of all absolute flux differences.</span>
<span class="sd">    - &quot;mean&quot;: The mean of all absolute flux differences.</span>
<span class="sd">    - &quot;median&quot;: The median of all absolute flux differences.</span>
<span class="sd">    - &quot;obj_difference&quot;: The difference between the objective value of the current result and the best result.</span>
<span class="sd">    - A dictionary with reaction comparisons, where each key is an integer indicating which result has a higher flux:</span>
<span class="sd">    - 0: The best result has a higher flux.</span>
<span class="sd">    - 1: The current result has a higher flux.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">objective_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">OBJECTIVE_VAR_NAME</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>
    <span class="n">best_objective</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">objective_values</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_maximization</span> <span class="k">else</span> <span class="nb">min</span><span class="p">(</span><span class="n">objective_values</span><span class="p">)</span>
    <span class="n">best_idx</span> <span class="o">=</span> <span class="n">objective_values</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">best_objective</span><span class="p">)</span>

    <span class="n">comparisons</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="n">best_idx</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">obj_difference</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">objective_values</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">best_objective</span>
            <span class="k">if</span> <span class="n">is_maximization</span>
            <span class="k">else</span> <span class="n">best_objective</span> <span class="o">-</span> <span class="n">objective_values</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">reac_statistics</span><span class="p">,</span> <span class="n">reac_comparisons</span> <span class="o">=</span> <span class="n">_compare_two_results_with_statistics</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">results</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
            <span class="n">results</span><span class="p">[</span><span class="n">best_idx</span><span class="p">],</span>
            <span class="n">min_reac_flux</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">reac_statistics</span><span class="p">[</span><span class="s2">&quot;obj_difference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj_difference</span>
        <span class="n">comparisons</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">reac_statistics</span><span class="p">,</span> <span class="n">reac_comparisons</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">comparisons</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.compare_optimization_result_fluxes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compare_optimization_result_fluxes</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">result_1</span><span class="p">,</span> <span class="n">result_2</span><span class="p">,</span> <span class="n">min_reac_flux</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compares the fluxes of two optimization results and returns a dictionary with the absolute differences and indicators of which result has a higher flux.</p>
<p>This function first corrects the fluxes of the two results by considering the forward and reverse reactions.
It then calculates the absolute differences between the corrected fluxes and determines which result has a higher flux for each reaction.
Reactions with fluxes below the minimum reaction flux threshold are ignored.</p>
<p>Args:
cobrak_model (Model): The COBRA-k model used for the optimization.
result_1 (dict[str, float]): The first optimization result.
result_2 (dict[str, float]): The second optimization result.
min_reac_flux (float, optional): The minimum reaction flux to consider. Defaults to 1e-8.</p>
<p>Returns:
dict[str, tuple[float, int]]: A dictionary where each key is a reaction ID and each value is a tuple containing:
- The absolute difference between the fluxes of the two results.
- An indicator of which result has a higher flux:
- 0: Both results have the same flux.
- 1: The first result has a higher flux.
- 2: The second result has a higher flux.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compare_optimization_result_fluxes</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">result_1</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">result_2</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">min_reac_flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-8</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compares the fluxes of two optimization results and returns a dictionary with the absolute differences and indicators of which result has a higher flux.</span>

<span class="sd">    This function first corrects the fluxes of the two results by considering the forward and reverse reactions.</span>
<span class="sd">    It then calculates the absolute differences between the corrected fluxes and determines which result has a higher flux for each reaction.</span>
<span class="sd">    Reactions with fluxes below the minimum reaction flux threshold are ignored.</span>

<span class="sd">    Args:</span>
<span class="sd">    cobrak_model (Model): The COBRA-k model used for the optimization.</span>
<span class="sd">    result_1 (dict[str, float]): The first optimization result.</span>
<span class="sd">    result_2 (dict[str, float]): The second optimization result.</span>
<span class="sd">    min_reac_flux (float, optional): The minimum reaction flux to consider. Defaults to 1e-8.</span>

<span class="sd">    Returns:</span>
<span class="sd">    dict[str, tuple[float, int]]: A dictionary where each key is a reaction ID and each value is a tuple containing:</span>
<span class="sd">    - The absolute difference between the fluxes of the two results.</span>
<span class="sd">    - An indicator of which result has a higher flux:</span>
<span class="sd">    - 0: Both results have the same flux.</span>
<span class="sd">    - 1: The first result has a higher flux.</span>
<span class="sd">    - 2: The second result has a higher flux.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">corrected_result_1</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">corrected_result_2</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">result</span><span class="p">,</span> <span class="n">corrected_result</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">result_1</span><span class="p">,</span> <span class="n">corrected_result_1</span><span class="p">),</span>
        <span class="p">(</span><span class="n">result_2</span><span class="p">,</span> <span class="n">corrected_result_2</span><span class="p">),</span>
    <span class="p">]:</span>
        <span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">flux</span> <span class="o">=</span> <span class="n">get_fwd_rev_corrected_flux</span><span class="p">(</span>
                <span class="n">var_id</span><span class="p">,</span>
                <span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
                <span class="n">result</span><span class="p">,</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span><span class="p">,</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">flux</span> <span class="o">&gt;=</span> <span class="n">min_reac_flux</span><span class="p">:</span>
                <span class="n">corrected_result</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">flux</span>

    <span class="n">abs_results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">in</span> <span class="n">corrected_result_1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">in</span> <span class="n">corrected_result_2</span><span class="p">):</span>
            <span class="n">flux_1</span><span class="p">,</span> <span class="n">flux_2</span> <span class="o">=</span> <span class="n">corrected_result_1</span><span class="p">[</span><span class="n">reac_id</span><span class="p">],</span> <span class="n">corrected_result_2</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
            <span class="c1"># if other_id not in abs_results:</span>
            <span class="n">abs_results</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">flux_1</span> <span class="o">-</span> <span class="n">flux_2</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">corrected_result_1</span><span class="p">:</span>
            <span class="n">flux_1</span> <span class="o">=</span> <span class="n">corrected_result_1</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
            <span class="c1"># if other_id not in abs_results:</span>
            <span class="n">abs_results</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">flux_1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">corrected_result_2</span><span class="p">:</span>
            <span class="n">flux_2</span> <span class="o">=</span> <span class="n">corrected_result_2</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
            <span class="c1"># if other_id not in abs_results:</span>
            <span class="n">abs_results</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">flux_2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">abs_results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.compare_optimization_result_reaction_uses" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compare_optimization_result_reaction_uses</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">min_abs_flux</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compares the usage of reactions across multiple optimization (e.g. FBA) results.</p>
<p>This function analyzes the frequency of reaction usage in a set of optimization results
from a COBRAk Model. It identifies which reactions are used in each solution and prints
the number of solutions in which each reaction is active, considering a minimum absolute
flux threshold.</p>
<p>Parameters:
- cobrak_model (Model): The COBRAk model containing the reactions to be analyzed.
- results (list[dict[str, float]]): A list of dictionaries, each representing an optimization
  result with reaction IDs as keys and their corresponding flux values as values.
- min_abs_flux (float, optional): The minimum absolute flux value to consider a reaction as used.
  Reactions with absolute flux values below this threshold are ignored. Defaults to 1e-6.</p>
        <ul>
<li>None: This function does not return a value. It prints the number of solutions in which each
  reaction is used, grouped by the number of solutions.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compare_optimization_result_reaction_uses</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">results</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">min_abs_flux</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compares the usage of reactions across multiple optimization (e.g. FBA) results.</span>

<span class="sd">    This function analyzes the frequency of reaction usage in a set of optimization results</span>
<span class="sd">    from a COBRAk Model. It identifies which reactions are used in each solution and prints</span>
<span class="sd">    the number of solutions in which each reaction is active, considering a minimum absolute</span>
<span class="sd">    flux threshold.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - cobrak_model (Model): The COBRAk model containing the reactions to be analyzed.</span>
<span class="sd">    - results (list[dict[str, float]]): A list of dictionaries, each representing an optimization</span>
<span class="sd">      result with reaction IDs as keys and their corresponding flux values as values.</span>
<span class="sd">    - min_abs_flux (float, optional): The minimum absolute flux value to consider a reaction as used.</span>
<span class="sd">      Reactions with absolute flux values below this threshold are ignored. Defaults to 1e-6.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - None: This function does not return a value. It prints the number of solutions in which each</span>
<span class="sd">      reaction is used, grouped by the number of solutions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">get_base_id_optimzation_result</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">result</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span>
    <span class="p">]</span>

    <span class="n">reac_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">get_base_id</span><span class="p">(</span>
            <span class="n">reac_id</span><span class="p">,</span>
            <span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span><span class="p">,</span>
            <span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">,</span>
            <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reac_enz_separator</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span>
    <span class="p">]</span>
    <span class="n">reacs_to_uses</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="n">reac_id</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">reac_ids</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">reac_ids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">reac_id</span><span class="p">])</span> <span class="o">&lt;=</span> <span class="n">min_abs_flux</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">reacs_to_uses</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="n">reacs_to_uses</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="n">min_num_results</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">reacs_to_uses</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">max_num_results</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">reacs_to_uses</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">min_num_results</span><span class="p">,</span> <span class="n">max_num_results</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">num_results</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">min_num_results</span><span class="p">,</span> <span class="n">max_num_results</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reactions used in </span><span class="si">{</span><span class="n">num_results</span><span class="si">}</span><span class="s2"> solutions:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">uses</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">uses</span> <span class="ow">in</span> <span class="n">reacs_to_uses</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">uses</span><span class="p">)</span> <span class="o">==</span> <span class="n">num_results</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;===&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.count_last_equal_elements" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">count_last_equal_elements</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Counts the number of consecutive equal elements from the end of the list.</p>
<p>Parameters:
lst (list[Any]): A Python list.</p>
<p>Returns:
int: The number of consecutive equal elements from the end of the list.</p>
<p>Examples:</p>
<blockquote>
<blockquote>
<blockquote>
<p>count_last_equal_elements([1.0, 2.0, 1.0, 3.0, 3.0, 3.0])
3
count_last_equal_elements([1.0, 2.0, 2.0, 1.0])
1
count_last_equal_elements([1.0, 1.0, 1.0, 1.0])
4
count_last_equal_elements([])
0</p>
</blockquote>
</blockquote>
</blockquote>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">count_last_equal_elements</span><span class="p">(</span><span class="n">lst</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Counts the number of consecutive equal elements from the end of the list.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    lst (list[Any]): A Python list.</span>

<span class="sd">    Returns:</span>
<span class="sd">    int: The number of consecutive equal elements from the end of the list.</span>

<span class="sd">    Examples:</span>
<span class="sd">    &gt;&gt;&gt; count_last_equal_elements([1.0, 2.0, 1.0, 3.0, 3.0, 3.0])</span>
<span class="sd">    3</span>
<span class="sd">    &gt;&gt;&gt; count_last_equal_elements([1.0, 2.0, 2.0, 1.0])</span>
<span class="sd">    1</span>
<span class="sd">    &gt;&gt;&gt; count_last_equal_elements([1.0, 1.0, 1.0, 1.0])</span>
<span class="sd">    4</span>
<span class="sd">    &gt;&gt;&gt; count_last_equal_elements([])</span>
<span class="sd">    0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">lst</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># Return 0 if the list is empty</span>

    <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Start with the last element</span>
    <span class="n">last_element</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Iterate from the second last element to the beginning</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">lst</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">last_element</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>  <span class="c1"># Stop counting when a different element is found</span>

    <span class="k">return</span> <span class="n">count</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.create_cnapy_scenario_out_of_optimization_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_cnapy_scenario_out_of_optimization_dict</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="p">,</span> <span class="n">optimization_dict</span><span class="p">,</span> <span class="n">desplit_reactions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a CNApy scenario file from an optimization dictionary and a COBRAk Model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file path where the CNApy scenario will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk Model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimization_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optimization result dict.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>desplit_reactions</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bool: Whether or not the fluxes of split reversible reaction
                     shall be recombined. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>None</code></td>            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function saves the CNApy scenario to the specified path.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_cnapy_scenario_out_of_optimization_dict</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">optimization_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">desplit_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a CNApy scenario file from an optimization dictionary and a COBRAk Model.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): The file path where the CNApy scenario will be saved.</span>
<span class="sd">        cobrak_model (Model): The COBRAk Model.</span>
<span class="sd">        optimization_dict (dict[str, float]): An optimization result dict.</span>
<span class="sd">        desplit_reactions: bool: Whether or not the fluxes of split reversible reaction</span>
<span class="sd">                                 shall be recombined. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: The function saves the CNApy scenario to the specified path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_id_result</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">get_base_id_optimzation_result</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="p">,</span>
            <span class="n">optimization_dict</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">desplit_reactions</span>
        <span class="k">else</span> <span class="n">optimization_dict</span>
    <span class="p">)</span>
    <span class="n">cnapy_scenario</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">key</span><span class="p">:</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">base_id_result</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="n">json_write</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cnapy_scenario</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.create_cnapy_scenario_out_of_variability_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_cnapy_scenario_out_of_variability_dict</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">,</span> <span class="n">desplit_reactions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a CNApy scenario file from a variability dictionary and a COBRAk model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file path where the CNApy scenario file will be saved.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRA-k model containing reactions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variability_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="list">list</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping reaction IDs to their minimum and maximum flux values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>desplit_reactions</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bool: Whether or not the fluxes of split reversible reaction
                     shall be recombined. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns:
    None: The function saves the CNApy scenario to the specified path.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_cnapy_scenario_out_of_variability_dict</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">desplit_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a CNApy scenario file from a variability dictionary and a COBRAk model.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): The file path where the CNApy scenario file will be saved.</span>
<span class="sd">        cobrak_model (Model): The COBRA-k model containing reactions.</span>
<span class="sd">        variability_dict (dict[str, list[float]]): A dictionary mapping reaction IDs to their minimum and maximum flux values.</span>
<span class="sd">        desplit_reactions: bool: Whether or not the fluxes of split reversible reaction</span>
<span class="sd">                                 shall be recombined. Defaults to True.</span>
<span class="sd">    Returns:</span>
<span class="sd">        None: The function saves the CNApy scenario to the specified path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cnapy_scenario</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">variability_dict</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">base_id</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">get_base_id</span><span class="p">(</span>
                <span class="n">reac_id</span><span class="p">,</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span><span class="p">,</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">,</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reac_enz_separator</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">desplit_reactions</span>
            <span class="k">else</span> <span class="n">reac_id</span>
        <span class="p">)</span>

        <span class="n">multiplier</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span><span class="p">)</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">min_flux</span> <span class="o">=</span> <span class="n">variability_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">max_flux</span> <span class="o">=</span> <span class="n">variability_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">base_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cnapy_scenario</span><span class="p">:</span>
            <span class="n">cnapy_scenario</span><span class="p">[</span><span class="n">base_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>

        <span class="n">cnapy_scenario</span><span class="p">[</span><span class="n">base_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">multiplier</span> <span class="o">*</span> <span class="n">min_flux</span>
        <span class="n">cnapy_scenario</span><span class="p">[</span><span class="n">base_id</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">multiplier</span> <span class="o">*</span> <span class="n">max_flux</span>

    <span class="n">json_write</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">cnapy_scenario</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.delete_orphaned_metabolites_and_enzymes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_orphaned_metabolites_and_enzymes</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Removes orphaned metabolites and enzymes from a COBRAk model.</p>
<p>This function cleans up a COBRAk model by deleting metabolites and enzymes that are not used
in any reactions. A metabolite is considered orphaned if it does not appear in the stoichiometries
of any reactions. Similarly, an enzyme is considered orphaned if it is not associated with any
enzyme reaction data in the model's reactions.</p>
        <ul>
<li>cobrak_model (Model): The COBRAk model to be cleaned. This model contains reactions,
  metabolites, and enzymes that may include unused entries.</li>
</ul>
<p>Returns:
- Model: The cleaned COBRAk model with orphaned metabolites and enzymes removed.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">delete_orphaned_metabolites_and_enzymes</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes orphaned metabolites and enzymes from a COBRAk model.</span>

<span class="sd">    This function cleans up a COBRAk model by deleting metabolites and enzymes that are not used</span>
<span class="sd">    in any reactions. A metabolite is considered orphaned if it does not appear in the stoichiometries</span>
<span class="sd">    of any reactions. Similarly, an enzyme is considered orphaned if it is not associated with any</span>
<span class="sd">    enzyme reaction data in the model&#39;s reactions.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - cobrak_model (Model): The COBRAk model to be cleaned. This model contains reactions,</span>
<span class="sd">      metabolites, and enzymes that may include unused entries.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - Model: The cleaned COBRAk model with orphaned metabolites and enzymes removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">used_metabolites</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">used_enzyme_ids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">used_metabolites</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">used_enzyme_ids</span> <span class="o">+=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span>

    <span class="c1"># Delete metabolites</span>
    <span class="n">mets_to_delete</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">met_id</span> <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">metabolites</span> <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">used_metabolites</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">met_to_delete</span> <span class="ow">in</span> <span class="n">mets_to_delete</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">[</span><span class="n">met_to_delete</span><span class="p">]</span>

    <span class="c1"># Delete enzymes</span>
    <span class="n">enzymes_to_delete</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">enzyme_id</span>
        <span class="k">for</span> <span class="n">enzyme_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">enzymes</span>
        <span class="k">if</span> <span class="n">enzyme_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">used_enzyme_ids</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">enzyme_to_delete</span> <span class="ow">in</span> <span class="n">enzymes_to_delete</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">enzymes</span><span class="p">[</span><span class="n">enzyme_to_delete</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">cobrak_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.delete_unused_reactions_in_optimization_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_unused_reactions_in_optimization_dict</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">optimization_dict</span><span class="p">,</span> <span class="n">exception_prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">delete_missing_reactions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_abs_flux</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">,</span> <span class="n">do_not_delete_with_z_var_one</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete unused reactions in a COBRAk model based on an optimization dictionary.</p>
<p>This function creates a deep copy of the provided COBRAk model and removes reactions that are either not present
in the optimization dictionary or have flux values below a specified threshold. Optionally,
reactions with a specific prefix can be excluded from deletion.
Additionally, orphaned metabolites (those not used in any remaining reactions) are also removed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>COBRAk model containing reactions and metabolites.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimization_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping reaction IDs to their optimized flux values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exception_prefix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A prefix for reaction IDs that should not be deleted. Defaults to "".</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>delete_missing_reactions</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to delete reactions not present in the optimization dictionary. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_abs_flux</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum absolute flux value below which reactions are considered unused. Defaults to 1e-10.</p>
              </div>
            </td>
            <td>
                  <code>1e-15</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Model</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new COBRAk model with unused reactions and orphaned metabolites removed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">delete_unused_reactions_in_optimization_dict</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">optimization_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">exception_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">delete_missing_reactions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">min_abs_flux</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">=</span> <span class="mf">1e-15</span><span class="p">,</span>
    <span class="n">do_not_delete_with_z_var_one</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete unused reactions in a COBRAk model based on an optimization dictionary.</span>

<span class="sd">    This function creates a deep copy of the provided COBRAk model and removes reactions that are either not present</span>
<span class="sd">    in the optimization dictionary or have flux values below a specified threshold. Optionally,</span>
<span class="sd">    reactions with a specific prefix can be excluded from deletion.</span>
<span class="sd">    Additionally, orphaned metabolites (those not used in any remaining reactions) are also removed.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): COBRAk model containing reactions and metabolites.</span>
<span class="sd">        optimization_dict (dict[str, float]): Dictionary mapping reaction IDs to their optimized flux values.</span>
<span class="sd">        exception_prefix (str, optional): A prefix for reaction IDs that should not be deleted. Defaults to &quot;&quot;.</span>
<span class="sd">        delete_missing_reactions (bool, optional): Whether to delete reactions not present in the optimization dictionary. Defaults to True.</span>
<span class="sd">        min_abs_flux (float, optional): The minimum absolute flux value below which reactions are considered unused. Defaults to 1e-10.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Model: A new COBRAk model with unused reactions and orphaned metabolites removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cobrak_model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
    <span class="n">reacs_to_delete</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="n">to_delete</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">optimization_dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">delete_missing_reactions</span><span class="p">:</span>
            <span class="n">to_delete</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">in</span> <span class="n">optimization_dict</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span>
            <span class="n">optimization_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
        <span class="p">)</span> <span class="o">&lt;=</span> <span class="n">min_abs_flux</span><span class="p">:</span>
            <span class="n">z_var_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Z_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">z_var_id</span> <span class="ow">in</span> <span class="n">optimization_dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">do_not_delete_with_z_var_one</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="n">optimization_dict</span><span class="p">[</span><span class="n">z_var_id</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">1e-6</span>
                <span class="p">):</span>
                    <span class="n">to_delete</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">to_delete</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">to_delete</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">to_delete</span><span class="p">:</span>
            <span class="n">reacs_to_delete</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">reac_to_delete</span> <span class="ow">in</span> <span class="n">reacs_to_delete</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">exception_prefix</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">reac_to_delete</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">exception_prefix</span><span class="p">)):</span>
            <span class="k">continue</span>
        <span class="k">del</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_to_delete</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">delete_orphaned_metabolites_and_enzymes</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.delete_unused_reactions_in_variability_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_unused_reactions_in_variability_dict</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">,</span> <span class="n">extra_reacs_to_delete</span><span class="o">=</span><span class="p">[])</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Delete unused reactions in a COBRAk model based on a variability dictionary.</p>
<p>This function creates a deep copy of the provided COBRA-k model and removes reactions that have both minimum and maximum flux values
equal to zero, as indicated in the variability dictionary.
Additionally, any extra reactions specified in the <code>extra_reacs_to_delete</code> list are also removed.
Orphaned metabolites (those not used in any remaining reactions) are subsequently deleted, too.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing reactions and metabolites.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variability_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping reaction IDs to their minimum and maximum flux values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>extra_reacs_to_delete</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of additional reaction IDs to be deleted. Defaults to an empty list.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Model</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new COBRAk model with unused reactions and orphaned metabolites removed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">delete_unused_reactions_in_variability_dict</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span>
    <span class="n">extra_reacs_to_delete</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete unused reactions in a COBRAk model based on a variability dictionary.</span>

<span class="sd">    This function creates a deep copy of the provided COBRA-k model and removes reactions that have both minimum and maximum flux values</span>
<span class="sd">    equal to zero, as indicated in the variability dictionary.</span>
<span class="sd">    Additionally, any extra reactions specified in the `extra_reacs_to_delete` list are also removed.</span>
<span class="sd">    Orphaned metabolites (those not used in any remaining reactions) are subsequently deleted, too.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing reactions and metabolites.</span>
<span class="sd">        variability_dict (dict[str, tuple[float, float]]): A dictionary mapping reaction IDs to their minimum and maximum flux values.</span>
<span class="sd">        extra_reacs_to_delete (list[str], optional): A list of additional reaction IDs to be deleted. Defaults to an empty list.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Model: A new COBRAk model with unused reactions and orphaned metabolites removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cobrak_model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
    <span class="n">reacs_to_delete</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span> <span class="o">+</span> <span class="n">extra_reacs_to_delete</span>
    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">variability_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="n">variability_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span>
        <span class="p">):</span>
            <span class="n">reacs_to_delete</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">reac_to_delete</span> <span class="ow">in</span> <span class="n">reacs_to_delete</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_to_delete</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">delete_orphaned_metabolites_and_enzymes</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_active_reacs_from_optimization_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_active_reacs_from_optimization_dict</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">fba_dict</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get a list of active reactions from an optimization (e.g. FBA (Flux Balance Analysis)) dictionary.</p>
<p>This function iterates through the reactions in a COBRAk model and identifies those that have a positive flux value in the provided FBA dictionary.
Only reactions present in the optimization dictionary and with a flux greater than zero are considered active.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing reactions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fba_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping reaction IDs to their flux values from an optimization.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]: A list of reaction IDs that are active (i.e., have a positive flux) according to the optimization dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_active_reacs_from_optimization_dict</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">fba_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a list of active reactions from an optimization (e.g. FBA (Flux Balance Analysis)) dictionary.</span>

<span class="sd">    This function iterates through the reactions in a COBRAk model and identifies those that have a positive flux value in the provided FBA dictionary.</span>
<span class="sd">    Only reactions present in the optimization dictionary and with a flux greater than zero are considered active.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing reactions.</span>
<span class="sd">        fba_dict (dict[str, float]): A dictionary mapping reaction IDs to their flux values from an optimization.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: A list of reaction IDs that are active (i.e., have a positive flux) according to the optimization dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">active_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fba_dict</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">fba_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">active_reacs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">active_reacs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_base_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_base_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">fwd_suffix</span><span class="o">=</span><span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span> <span class="n">rev_suffix</span><span class="o">=</span><span class="n">REAC_REV_SUFFIX</span><span class="p">,</span> <span class="n">reac_enz_separator</span><span class="o">=</span><span class="n">REAC_ENZ_SEPARATOR</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Extract the base ID from a reaction ID by removing specified suffixes and separators.</p>
<p>Processes a reaction ID to remove forward and reverse suffixes
as well as any enzyme separators, to obtain the base reaction ID.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>reac_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reaction ID to be processed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fwd_suffix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The suffix indicating forward reactions. Defaults to REAC_FWD_SUFFIX.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="REAC_FWD_SUFFIX = '_FWD'

  
      module-attribute
   (cobrak.constants.REAC_FWD_SUFFIX)" href="#cobrak.constants.REAC_FWD_SUFFIX">REAC_FWD_SUFFIX</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rev_suffix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The suffix indicating reverse reactions. Defaults to REAC_REV_SUFFIX.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="REAC_REV_SUFFIX = '_REV'

  
      module-attribute
   (cobrak.constants.REAC_REV_SUFFIX)" href="#cobrak.constants.REAC_REV_SUFFIX">REAC_REV_SUFFIX</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reac_enz_separator</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The separator used between reaction and enzyme identifiers. Defaults to REAC_ENZ_SEPARATOR.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="REAC_ENZ_SEPARATOR = '_ENZ_'

  
      module-attribute
   (cobrak.constants.REAC_ENZ_SEPARATOR)" href="#cobrak.constants.REAC_ENZ_SEPARATOR">REAC_ENZ_SEPARATOR</a></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base reaction ID with specified suffixes and separators removed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_base_id</span><span class="p">(</span>
    <span class="n">reac_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">fwd_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span>
    <span class="n">rev_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_REV_SUFFIX</span><span class="p">,</span>
    <span class="n">reac_enz_separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_ENZ_SEPARATOR</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract the base ID from a reaction ID by removing specified suffixes and separators.</span>

<span class="sd">    Processes a reaction ID to remove forward and reverse suffixes</span>
<span class="sd">    as well as any enzyme separators, to obtain the base reaction ID.</span>

<span class="sd">    Args:</span>
<span class="sd">        reac_id (str): The reaction ID to be processed.</span>
<span class="sd">        fwd_suffix (str, optional): The suffix indicating forward reactions. Defaults to REAC_FWD_SUFFIX.</span>
<span class="sd">        rev_suffix (str, optional): The suffix indicating reverse reactions. Defaults to REAC_REV_SUFFIX.</span>
<span class="sd">        reac_enz_separator (str, optional): The separator used between reaction and enzyme identifiers. Defaults to REAC_ENZ_SEPARATOR.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The base reaction ID with specified suffixes and separators removed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reac_id_split</span> <span class="o">=</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">reac_enz_separator</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">reac_id_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\b</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fwd_suffix</span><span class="si">}</span><span class="se">\b</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rev_suffix</span><span class="si">}</span><span class="se">\b</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\b</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_base_id_optimzation_result" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_base_id_optimzation_result</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">optimization_dict</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Converts an optimization result to a base reaction ID format in a COBRAk model.</p>
<p>This function processes an optimization result dictionary, which contains reaction IDs with
their corresponding flux values, and consolidates these fluxes into base reaction IDs. It
accounts for forward and reverse reaction suffixes to ensure that the net flux for each base
reaction ID is calculated correctly.</p>
<p>Parameters:
- cobrak_model (Model): The COBRAk model containing the reactions to be processed.
- optimization_dict (dict[str, float]): A dictionary mapping reaction IDs to their flux values
  from an optimization result.</p>
        <ul>
<li>dict[str, float]: A dictionary mapping base reaction IDs to their net flux values, consolidating
  forward and reverse reactions.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_base_id_optimzation_result</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">optimization_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts an optimization result to a base reaction ID format in a COBRAk model.</span>

<span class="sd">    This function processes an optimization result dictionary, which contains reaction IDs with</span>
<span class="sd">    their corresponding flux values, and consolidates these fluxes into base reaction IDs. It</span>
<span class="sd">    accounts for forward and reverse reaction suffixes to ensure that the net flux for each base</span>
<span class="sd">    reaction ID is calculated correctly.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - cobrak_model (Model): The COBRAk model containing the reactions to be processed.</span>
<span class="sd">    - optimization_dict (dict[str, float]): A dictionary mapping reaction IDs to their flux values</span>
<span class="sd">      from an optimization result.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - dict[str, float]: A dictionary mapping base reaction IDs to their net flux values, consolidating</span>
<span class="sd">      forward and reverse reactions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_id_scenario</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">optimization_dict</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">base_id</span> <span class="o">=</span> <span class="n">get_base_id</span><span class="p">(</span>
            <span class="n">reac_id</span><span class="p">,</span>
            <span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span><span class="p">,</span>
            <span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">,</span>
            <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reac_enz_separator</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">multiplier</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">)</span> <span class="k">else</span> <span class="o">+</span><span class="mi">1</span>
        <span class="n">flux</span> <span class="o">=</span> <span class="n">optimization_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">base_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">base_id_scenario</span><span class="p">:</span>
            <span class="n">base_id_scenario</span><span class="p">[</span><span class="n">base_id</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="n">base_id_scenario</span><span class="p">[</span><span class="n">base_id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">multiplier</span> <span class="o">*</span> <span class="n">flux</span>

    <span class="k">return</span> <span class="n">base_id_scenario</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_cobrak_enzyme_reactions_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_cobrak_enzyme_reactions_string</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">enzyme_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get string of reaction IDs associated with a specific enzyme in the COBRAk model.</p>
<p>This function iterates through the reactions in a COBRAk model and collects the IDs of reaction
that involve the specified enzyme.
The collected reaction IDs are then concatenated into a single string, separated by semicolons.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing reactions and enzyme data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enzyme_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the enzyme for which associated reactions are to be found.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A semicolon-separated string of reaction IDs that involve the specified enzyme.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_cobrak_enzyme_reactions_string</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span> <span class="n">enzyme_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get string of reaction IDs associated with a specific enzyme in the COBRAk model.</span>

<span class="sd">    This function iterates through the reactions in a COBRAk model and collects the IDs of reaction</span>
<span class="sd">    that involve the specified enzyme.</span>
<span class="sd">    The collected reaction IDs are then concatenated into a single string, separated by semicolons.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing reactions and enzyme data.</span>
<span class="sd">        enzyme_id (str): The ID of the enzyme for which associated reactions are to be found.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A semicolon-separated string of reaction IDs that involve the specified enzyme.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">enzyme_reactions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">enzyme_id</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span><span class="p">:</span>
            <span class="n">enzyme_reactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">enzyme_reactions</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_df_and_efficiency_factors_sorted_lists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_df_and_efficiency_factors_sorted_lists</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">min_flux</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Extracts and sorts lists of flux values (df) and , , ,  values from a result dictionary.</p>
<p>This function processes a dictionary of results of a COBRA-k optimization
to extract and sort lists of flux values (df) and , , ,  values values. It filters
these values based on a minimum flux threshold and returns them as sorted dictionaries.
The function also calculates and returns a dictionary of kappa times gamma values,
along with a status indicator representing the number of these values present for each reaction.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRA-k Model object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>result</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing optimization results.  Keys are expected to
start with prefixes like 'DF_VAR_PREFIX', 'KAPPA_VAR_PREFIX', and 'GAMMA_VAR_PREFIX'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_flux</code>
            </td>
            <td>
                  <code><span title="pydantic.NonNegativeFloat">NonNegativeFloat</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum flux value to consider when filtering the results.  Values below this
threshold are excluded.  Defaults to 0.0.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing four dictionaries:</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ol>
<li>A dictionary of sorted flux values (df) above the minimum flux.</li>
</ol>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ol>
<li>A dictionary of sorted  values above the minimum flux.</li>
</ol>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ol>
<li>A dictionary of sorted  values above the minimum flux.</li>
</ol>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ol>
<li>A dictionary of sorted  values above the minimum flux.</li>
</ol>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ol>
<li>A dictionary of sorted  values above the minimum flux.</li>
</ol>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>], <span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>], <span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>], <span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>], <span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>], <span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="int">int</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ol>
<li>A dictionary of sorted  values, along with a status indicator. If, for a reaction,
one or more of these efficiency factors is missing, the respective factor is assumed to be 1.0
thus having no effect on the multiplied value.</li>
</ol>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_df_and_efficiency_factors_sorted_lists</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">min_flux</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span>
    <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span>
<span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts and sorts lists of flux values (df) and , , ,  values from a result dictionary.</span>

<span class="sd">    This function processes a dictionary of results of a COBRA-k optimization</span>
<span class="sd">    to extract and sort lists of flux values (df) and , , ,  values values. It filters</span>
<span class="sd">    these values based on a minimum flux threshold and returns them as sorted dictionaries.</span>
<span class="sd">    The function also calculates and returns a dictionary of kappa times gamma values,</span>
<span class="sd">    along with a status indicator representing the number of these values present for each reaction.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model: The COBRA-k Model object.</span>
<span class="sd">        result: A dictionary containing optimization results.  Keys are expected to</span>
<span class="sd">            start with prefixes like &#39;DF_VAR_PREFIX&#39;, &#39;KAPPA_VAR_PREFIX&#39;, and &#39;GAMMA_VAR_PREFIX&#39;.</span>
<span class="sd">        min_flux: The minimum flux value to consider when filtering the results.  Values below this</span>
<span class="sd">            threshold are excluded.  Defaults to 0.0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple containing four dictionaries:</span>
<span class="sd">        1. A dictionary of sorted flux values (df) above the minimum flux.</span>
<span class="sd">        2. A dictionary of sorted  values above the minimum flux.</span>
<span class="sd">        3. A dictionary of sorted  values above the minimum flux.</span>
<span class="sd">        4. A dictionary of sorted  values above the minimum flux.</span>
<span class="sd">        5. A dictionary of sorted  values above the minimum flux.</span>
<span class="sd">        6. A dictionary of sorted  values, along with a status indicator. If, for a reaction,</span>
<span class="sd">           one or more of these efficiency factors is missing, the respective factor is assumed to be 1.0</span>
<span class="sd">           thus having no effect on the multiplied value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dfs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">kappas</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">gammas</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">iotas</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">alphas</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">var_id</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">var_id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">DF_VAR_PREFIX</span><span class="p">):</span>
            <span class="n">reac_id</span> <span class="o">=</span> <span class="n">var_id</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">DF_VAR_PREFIX</span><span class="p">)</span> <span class="p">:]</span>
            <span class="n">dfs</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="n">var_id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">KAPPA_VAR_PREFIX</span><span class="p">):</span>
            <span class="n">reac_id</span> <span class="o">=</span> <span class="n">var_id</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">KAPPA_VAR_PREFIX</span><span class="p">)</span> <span class="p">:]</span>
            <span class="n">kappas</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="n">var_id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">GAMMA_VAR_PREFIX</span><span class="p">):</span>
            <span class="n">reac_id</span> <span class="o">=</span> <span class="n">var_id</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">GAMMA_VAR_PREFIX</span><span class="p">)</span> <span class="p">:]</span>
            <span class="n">gammas</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="n">var_id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">IOTA_VAR_PREFIX</span><span class="p">):</span>
            <span class="n">reac_id</span> <span class="o">=</span> <span class="n">var_id</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">IOTA_VAR_PREFIX</span><span class="p">)</span> <span class="p">:]</span>
            <span class="n">iotas</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="n">var_id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">ALPHA_VAR_PREFIX</span><span class="p">):</span>
            <span class="n">reac_id</span> <span class="o">=</span> <span class="n">var_id</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">ALPHA_VAR_PREFIX</span><span class="p">)</span> <span class="p">:]</span>
            <span class="n">alphas</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="n">all_multiplied_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="n">status</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">product</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">kappas</span><span class="p">:</span>
            <span class="n">product</span> <span class="o">*=</span> <span class="n">kappas</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
            <span class="n">status</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">gammas</span><span class="p">:</span>
            <span class="n">product</span> <span class="o">*=</span> <span class="n">gammas</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
            <span class="n">status</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">iotas</span><span class="p">:</span>
            <span class="n">product</span> <span class="o">*=</span> <span class="n">iotas</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
            <span class="n">status</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
            <span class="n">product</span> <span class="o">*=</span> <span class="n">alphas</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
            <span class="n">status</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">all_multiplied_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>

    <span class="n">sorted_df_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dfs</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">dfs</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">sorted_kappa_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">kappas</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">kappas</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">sorted_gamma_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">gammas</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">gammas</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">sorted_iota_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">iotas</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">iotas</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">sorted_alpha_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">alphas</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">alphas</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">sorted_product_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
        <span class="n">all_multiplied_dict</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">all_multiplied_dict</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">dfs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sorted_df_keys</span> <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">min_flux</span><span class="p">},</span>
        <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">kappas</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sorted_kappa_keys</span> <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">min_flux</span><span class="p">},</span>
        <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">gammas</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sorted_gamma_keys</span> <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">min_flux</span><span class="p">},</span>
        <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">iotas</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sorted_iota_keys</span> <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">min_flux</span><span class="p">},</span>
        <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">alphas</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sorted_alpha_keys</span> <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">min_flux</span><span class="p">},</span>
        <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="n">all_multiplied_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sorted_product_keys</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">result</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">min_flux</span>
        <span class="p">},</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_elementary_conservation_relations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_elementary_conservation_relations</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate and return the elementary conservation relations (ECRs) of a COBRAk model as a string.</p>
<p>Computes the null space of the stoichiometric matrix of a COBRAk model to determine the elementary conservation relations.
It then formats these relations into a human-readable string such as "1 ATP * 1 ADP"</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing reactions and metabolites.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string representation of the elementary conservation relations, where each relation is expressed as a linear combination of metabolites.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_elementary_conservation_relations</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate and return the elementary conservation relations (ECRs) of a COBRAk model as a string.</span>

<span class="sd">    Computes the null space of the stoichiometric matrix of a COBRAk model to determine the elementary conservation relations.</span>
<span class="sd">    It then formats these relations into a human-readable string such as &quot;1 ATP * 1 ADP&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing reactions and metabolites.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A string representation of the elementary conservation relations, where each relation is expressed as a linear combination of metabolites.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert the list of lists to a sympy Matrix</span>
    <span class="n">S_matrix</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">get_stoichiometric_matrix</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># type: ignore</span>

    <span class="c1"># Calculate the null space of the stoichiometric matrix</span>
    <span class="n">null_space</span> <span class="o">=</span> <span class="n">S_matrix</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span>

    <span class="c1"># Convert the null space vectors to a NumPy array</span>
    <span class="n">ECRs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ns</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ns</span> <span class="ow">in</span> <span class="n">null_space</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="n">ecrs_list</span> <span class="o">=</span> <span class="n">ECRs</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">met_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">)</span>
    <span class="n">conservation_relations</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">current_ecr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ecrs_list</span><span class="p">)):</span>
        <span class="n">ecr</span> <span class="o">=</span> <span class="n">ecrs_list</span><span class="p">[</span><span class="n">current_ecr</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">current_met</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">met_ids</span><span class="p">)):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">ecr</span><span class="p">[</span><span class="n">current_met</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">conservation_relations</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">met_ids</span><span class="p">[</span><span class="n">current_met</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="n">conservation_relations</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">conservation_relations</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_enzyme_usage_by_protein_pool_fraction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_enzyme_usage_by_protein_pool_fraction</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">min_conc</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return enzyme usage as a fraction of the total protein pool in a COBRAk model.</p>
<p>This function computes the fraction of the total protein pool used by each enzyme based on the given result dictionary.
It filters out enzymes with concentrations below a specified minimum and groups the reactions by their protein pool fractions.
The dictionary is sorted, i.e., low fractions occur first and high fractions last as keys.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing reactions and enzyme data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>result</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping variable names to their values, typically from an optimization result.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_conc</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum concentration threshold for considering enzyme usage. Defaults to 1e-12.</p>
              </div>
            </td>
            <td>
                  <code>1e-12</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rounding</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of decimal places to round the protein pool fractions. Defaults to 5.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="pydantic.NonNegativeFloat">NonNegativeFloat</span>, <span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[NonNegativeFloat, list[str]]: A dictionary where the keys are protein pool fractions and the values are lists of
                    reaction IDs that use that fraction of the protein pool.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_enzyme_usage_by_protein_pool_fraction</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">min_conc</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">=</span> <span class="mf">1e-12</span><span class="p">,</span>
    <span class="n">rounding</span><span class="p">:</span> <span class="n">NonNegativeInt</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">NonNegativeFloat</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return enzyme usage as a fraction of the total protein pool in a COBRAk model.</span>

<span class="sd">    This function computes the fraction of the total protein pool used by each enzyme based on the given result dictionary.</span>
<span class="sd">    It filters out enzymes with concentrations below a specified minimum and groups the reactions by their protein pool fractions.</span>
<span class="sd">    The dictionary is sorted, i.e., low fractions occur first and high fractions last as keys.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing reactions and enzyme data.</span>
<span class="sd">        result (dict[str, float]): A dictionary mapping variable names to their values, typically from an optimization result.</span>
<span class="sd">        min_conc (float, optional): The minimum concentration threshold for considering enzyme usage. Defaults to 1e-12.</span>
<span class="sd">        rounding (int, optional): The number of decimal places to round the protein pool fractions. Defaults to 5.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[NonNegativeFloat, list[str]]: A dictionary where the keys are protein pool fractions and the values are lists of</span>
<span class="sd">                                reaction IDs that use that fraction of the protein pool.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">protein_pool_fractions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">var_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">ENZYME_VAR_PREFIX</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">reac_id</span> <span class="o">=</span> <span class="n">var_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">ENZYME_VAR_INFIX</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">full_mw</span> <span class="o">=</span> <span class="n">get_full_enzyme_mw</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">min_conc</span><span class="p">:</span>
            <span class="n">protein_pool_fraction</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
                <span class="p">(</span><span class="n">full_mw</span> <span class="o">*</span> <span class="n">value</span><span class="p">)</span> <span class="o">/</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">max_prot_pool</span><span class="p">,</span> <span class="n">rounding</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">protein_pool_fraction</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">protein_pool_fractions</span><span class="p">:</span>
            <span class="n">protein_pool_fractions</span><span class="p">[</span><span class="n">protein_pool_fraction</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">protein_pool_fractions</span><span class="p">[</span><span class="n">protein_pool_fraction</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">protein_pool_fractions</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_extra_linear_constraint_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_extra_linear_constraint_string</span><span class="p">(</span><span class="n">extra_linear_constraint</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a string representation of an extra linear constraint.</p>
<p>The returned format is:
"lower_value  stoichiometry * var_id + ...  upper_value"</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>extra_linear_constraint</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ExtraLinearConstraint (cobrak.dataclasses.ExtraLinearConstraint)" href="#cobrak.dataclasses.ExtraLinearConstraint">ExtraLinearConstraint</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The extra linear constraint to convert to a string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string representation of the extra linear constraint</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_extra_linear_constraint_string</span><span class="p">(</span>
    <span class="n">extra_linear_constraint</span><span class="p">:</span> <span class="n">ExtraLinearConstraint</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a string representation of an extra linear constraint.</span>

<span class="sd">    The returned format is:</span>
<span class="sd">    &quot;lower_value  stoichiometry * var_id + ...  upper_value&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        extra_linear_constraint (ExtraLinearConstraint): The extra linear constraint to convert to a string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A string representation of the extra linear constraint</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">if</span> <span class="n">extra_linear_constraint</span><span class="o">.</span><span class="n">lower_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">extra_linear_constraint</span><span class="o">.</span><span class="n">lower_value</span><span class="si">}</span><span class="s2">  &quot;</span>

    <span class="k">for</span> <span class="n">var_id</span><span class="p">,</span> <span class="n">stoichiometry</span> <span class="ow">in</span> <span class="n">sort_dict_keys</span><span class="p">(</span>
        <span class="n">extra_linear_constraint</span><span class="o">.</span><span class="n">stoichiometries</span>
    <span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">stoichiometry</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">printed_stoichiometry</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; + </span><span class="si">{</span><span class="n">stoichiometry</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">printed_stoichiometry</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">stoichiometry</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">printed_stoichiometry</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">var_id</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="n">extra_linear_constraint</span><span class="o">.</span><span class="n">upper_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">extra_linear_constraint</span><span class="o">.</span><span class="n">upper_value</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_full_enzyme_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_full_enzyme_id</span><span class="p">(</span><span class="n">identifiers</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generate a full enzyme ID by concatenating the list of enzyme identifiers with a specific separator.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>identifiers</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of enzyme identifiers.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A single string representing the full enzyme ID, with single identifiers separated by "<em>AND</em>".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_full_enzyme_id</span><span class="p">(</span><span class="n">identifiers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a full enzyme ID by concatenating the list of enzyme identifiers with a specific separator.</span>

<span class="sd">    Args:</span>
<span class="sd">        identifiers (list[str]): A list of enzyme identifiers.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A single string representing the full enzyme ID, with single identifiers separated by &quot;_AND_&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;_AND_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">identifiers</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_full_enzyme_mw" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_full_enzyme_mw</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the full molecular weight of enzymes (in kDa) involved in a given reaction.</p>
<p>This function computes the total molecular weight of all enzymes associated with a specified reaction in the COBRAk model.
If the reaction does not have any enzyme reaction data, a ValueError is raised.</p>
<ul>
<li>If special (i.e. non-1) stoichiometries are provided in the reaction's <code>enzyme_reaction_data</code>, they are used to scale the molecular weights accordingly.</li>
<li>If no special stoichiometry is provided for an enzyme, a default stoichiometry of 1 is assumed.</li>
<li>The function sums up the molecular weights of all enzymes, multiplied by their respective stoichiometries, to compute the total.</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRA-k model containing enzyme data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reaction</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Reaction (cobrak.dataclasses.Reaction)" href="#cobrak.dataclasses.Reaction">Reaction</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reaction for which the full enzyme molecular weight is to be calculated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The total molecular weight of all enzymes involved in the reaction in kDa</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the reaction does not have any enzyme reaction data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_full_enzyme_mw</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span> <span class="n">reaction</span><span class="p">:</span> <span class="n">Reaction</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the full molecular weight of enzymes (in kDa) involved in a given reaction.</span>

<span class="sd">    This function computes the total molecular weight of all enzymes associated with a specified reaction in the COBRAk model.</span>
<span class="sd">    If the reaction does not have any enzyme reaction data, a ValueError is raised.</span>

<span class="sd">    - If special (i.e. non-1) stoichiometries are provided in the reaction&#39;s `enzyme_reaction_data`, they are used to scale the molecular weights accordingly.</span>
<span class="sd">    - If no special stoichiometry is provided for an enzyme, a default stoichiometry of 1 is assumed.</span>
<span class="sd">    - The function sums up the molecular weights of all enzymes, multiplied by their respective stoichiometries, to compute the total.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRA-k model containing enzyme data.</span>
<span class="sd">        reaction (Reaction): The reaction for which the full enzyme molecular weight is to be calculated.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The total molecular weight of all enzymes involved in the reaction in kDa</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the reaction does not have any enzyme reaction data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="n">full_mw</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">identifier</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">special_stoichiometries</span><span class="p">:</span>
            <span class="n">stoichiometry</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">special_stoichiometries</span><span class="p">[</span>
                <span class="n">identifier</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">stoichiometry</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">full_mw</span> <span class="o">+=</span> <span class="n">stoichiometry</span> <span class="o">*</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">enzymes</span><span class="p">[</span><span class="n">identifier</span><span class="p">]</span><span class="o">.</span><span class="n">molecular_weight</span>
    <span class="k">return</span> <span class="n">full_mw</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_fwd_rev_corrected_flux" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_fwd_rev_corrected_flux</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">usable_reac_ids</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">fwd_suffix</span><span class="o">=</span><span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span> <span class="n">rev_suffix</span><span class="o">=</span><span class="n">REAC_REV_SUFFIX</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculates the direction-corrected flux for a reaction, taking into account the flux of its reverse reaction.</p>
<p>If the reverse reaction exists and its flux is greater than the flux of the forward reaction, the corrected flux is set to 0.0.
Otherwise, the corrected flux is calculated as the difference between the flux of the forward reaction and the flux of the reverse reaction.
If the reverse reaction does not exist or is not usable, the corrected flux is set to the flux of the forward reaction.</p>
<p>Args:
reac_id (str): The ID of the reaction.
usable_reac_ids (list[str] | set[str]): A list or set of IDs of reactions that can be used for correction.
result (dict[str, float]): A dictionary containing the flux values for each reaction.
fwd_suffix (str, optional): The suffix used to identify forward reactions. Defaults to REAC_FWD_SUFFIX.
rev_suffix (str, optional): The suffix used to identify reverse reactions. Defaults to REAC_REV_SUFFIX.</p>
<p>Returns:
float: The corrected flux value for the reaction.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_fwd_rev_corrected_flux</span><span class="p">(</span>
    <span class="n">reac_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">usable_reac_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">result</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">fwd_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span>
    <span class="n">rev_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_REV_SUFFIX</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the direction-corrected flux for a reaction, taking into account the flux of its reverse reaction.</span>

<span class="sd">    If the reverse reaction exists and its flux is greater than the flux of the forward reaction, the corrected flux is set to 0.0.</span>
<span class="sd">    Otherwise, the corrected flux is calculated as the difference between the flux of the forward reaction and the flux of the reverse reaction.</span>
<span class="sd">    If the reverse reaction does not exist or is not usable, the corrected flux is set to the flux of the forward reaction.</span>

<span class="sd">    Args:</span>
<span class="sd">    reac_id (str): The ID of the reaction.</span>
<span class="sd">    usable_reac_ids (list[str] | set[str]): A list or set of IDs of reactions that can be used for correction.</span>
<span class="sd">    result (dict[str, float]): A dictionary containing the flux values for each reaction.</span>
<span class="sd">    fwd_suffix (str, optional): The suffix used to identify forward reactions. Defaults to REAC_FWD_SUFFIX.</span>
<span class="sd">    rev_suffix (str, optional): The suffix used to identify reverse reactions. Defaults to REAC_REV_SUFFIX.</span>

<span class="sd">    Returns:</span>
<span class="sd">    float: The corrected flux value for the reaction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">other_id</span> <span class="o">=</span> <span class="n">get_reverse_reac_id_if_existing</span><span class="p">(</span>
        <span class="n">reac_id</span><span class="p">,</span>
        <span class="n">fwd_suffix</span><span class="p">,</span>
        <span class="n">rev_suffix</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">other_id</span> <span class="ow">in</span> <span class="n">usable_reac_ids</span><span class="p">:</span>
        <span class="n">other_flux</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">other_id</span><span class="p">]</span>
        <span class="n">this_flux</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
        <span class="n">flux</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="k">if</span> <span class="n">other_flux</span> <span class="o">&gt;</span> <span class="n">this_flux</span> <span class="k">else</span> <span class="n">this_flux</span> <span class="o">-</span> <span class="n">other_flux</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">flux</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">flux</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_metabolite_consumption_and_production" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_metabolite_consumption_and_production</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">optimization_dict</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the consumption and production rates of a metabolite in a COBRAk model.</p>
<p>This function computes the total consumption and production of a specified metabolite
based on the flux values provided in an optimization dictionary.
It iterates through the reactions in the COBRAk model, checking the stoichiometries to determine the metabolite's
consumption or production in each reaction.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing reactions and metabolites.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>met_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the metabolite for which consumption and production rates are to be calculated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimization_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping reaction IDs to their optimized flux values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[float, float]: A tuple containing the total consumption and production rates of the specified metabolite.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_metabolite_consumption_and_production</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span> <span class="n">met_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">optimization_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the consumption and production rates of a metabolite in a COBRAk model.</span>

<span class="sd">    This function computes the total consumption and production of a specified metabolite</span>
<span class="sd">    based on the flux values provided in an optimization dictionary.</span>
<span class="sd">    It iterates through the reactions in the COBRAk model, checking the stoichiometries to determine the metabolite&#39;s</span>
<span class="sd">    consumption or production in each reaction.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing reactions and metabolites.</span>
<span class="sd">        met_id (str): The ID of the metabolite for which consumption and production rates are to be calculated.</span>
<span class="sd">        optimization_dict (dict[str, float]): A dictionary mapping reaction IDs to their optimized flux values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[float, float]: A tuple containing the total consumption and production rates of the specified metabolite.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">consumption</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">production</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">optimization_dict</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">stoichiometry</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">stoichiometry</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">consumption</span> <span class="o">+=</span> <span class="n">optimization_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">*</span> <span class="n">stoichiometry</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">production</span> <span class="o">+=</span> <span class="n">optimization_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">*</span> <span class="n">stoichiometry</span>
    <span class="k">return</span> <span class="n">consumption</span><span class="p">,</span> <span class="n">production</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_metabolites_in_elementary_conservation_relations" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_metabolites_in_elementary_conservation_relations</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Identify metabolites involved in elementary conservation relations (ECRs) in a COBRAk model.</p>
<p>Calculates the null space of the stoichiometric matrix of a COBRAk model to determine the elementary conservation relations.
It then identifies the metabolites that are part of these relations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing reactions and metabolites.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]: A list of metabolite IDs that are involved in elementary conservation relations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_metabolites_in_elementary_conservation_relations</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Identify metabolites involved in elementary conservation relations (ECRs) in a COBRAk model.</span>

<span class="sd">    Calculates the null space of the stoichiometric matrix of a COBRAk model to determine the elementary conservation relations.</span>
<span class="sd">    It then identifies the metabolites that are part of these relations.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing reactions and metabolites.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: A list of metabolite IDs that are involved in elementary conservation relations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert the list of lists to a sympy Matrix</span>
    <span class="n">S_matrix</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">get_stoichiometric_matrix</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># Calculate the null space of the stoichiometric matrix using Gaussian elimination</span>
    <span class="n">null_spacex</span> <span class="o">=</span> <span class="n">null_space</span><span class="p">(</span><span class="n">S_matrix</span><span class="p">)</span>

    <span class="c1"># Convert the null space vectors to a NumPy array</span>
    <span class="n">ECRs</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">null_spacex</span><span class="o">.</span><span class="n">T</span>
    <span class="p">)</span>  <span class="c1"># np.array([ns.T.tolist()[0] for ns in null_spacex], dtype=float)</span>

    <span class="c1"># Simplify the ECRs by removing near-zero elements</span>
    <span class="n">threshold</span> <span class="o">=</span> <span class="mf">1e-10</span>
    <span class="n">ECRs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ECRs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">met_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">)</span>

    <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ecr</span> <span class="ow">in</span> <span class="n">ECRs</span><span class="o">.</span><span class="n">tolist</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">entry_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ecr</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">ecr</span><span class="p">[</span><span class="n">entry_num</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">dependencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">met_ids</span><span class="p">[</span><span class="n">entry_num</span><span class="p">])</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">dependencies</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_model_dG0s" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_model_dG0s</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">abs_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Extracts standard Gibbs free energy changes (dG0) from reactions in the model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing reactions with thermodynamic data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>abs_values</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, returns absolute values of dG0. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[float]: A list of dG0 values, possibly as absolute values if specified.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_model_dG0s</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span> <span class="n">abs_values</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts standard Gibbs free energy changes (dG0) from reactions in the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing reactions with thermodynamic data.</span>
<span class="sd">        abs_values (bool, optional): If True, returns absolute values of dG0. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[float]: A list of dG0 values, possibly as absolute values if specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dG0s</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_bw&quot;</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dG0s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span><span class="p">)</span> <span class="k">if</span> <span class="n">abs_values</span> <span class="k">else</span> <span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dG0s</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_model_hill_coefficients" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_model_hill_coefficients</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">return_only_values_with_reference</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Collects k_A values from a COBRA-k model.</p>
<p>This function iterates through the reactions in a COBRA-k model and extracts the
k_A values associated with each metabolite</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRA-k Model object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_only_values_with_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns only values with a given database reference. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="pydantic.PositiveFloat">PositiveFloat</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing three lists: the first list contains  Hill coefficients, the second</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="pydantic.PositiveFloat">PositiveFloat</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p> Hill coefficients, the third  Hill coefficients.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_model_hill_coefficients</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">return_only_values_with_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">PositiveFloat</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Collects k_A values from a COBRA-k model.</span>

<span class="sd">    This function iterates through the reactions in a COBRA-k model and extracts the</span>
<span class="sd">    k_A values associated with each metabolite</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model: The COBRA-k Model object.</span>
<span class="sd">        return_only_values_with_reference: Returns only values with a given database reference. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple containing three lists: the first list contains  Hill coefficients, the second</span>
<span class="sd">         Hill coefficients, the third  Hill coefficients.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kappa_hills</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PositiveFloat</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">iota_hills</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PositiveFloat</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">alpha_hills</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PositiveFloat</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1">#  Hills</span>
        <span class="k">for</span> <span class="p">(</span>
            <span class="n">met_id</span><span class="p">,</span>
            <span class="n">hill_coefficient</span><span class="p">,</span>
        <span class="p">)</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="o">.</span><span class="n">kappa</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">return_only_values_with_reference</span><span class="p">:</span>
                <span class="n">references</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficient_references</span><span class="o">.</span><span class="n">kappa</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">references</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">tax_distance</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tax_distance</span> <span class="o">=</span> <span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="k">if</span> <span class="n">tax_distance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="n">kappa_hills</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hill_coefficient</span><span class="p">)</span>

        <span class="c1">#  Hills</span>
        <span class="k">for</span> <span class="p">(</span>
            <span class="n">met_id</span><span class="p">,</span>
            <span class="n">hill_coefficient</span><span class="p">,</span>
        <span class="p">)</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="o">.</span><span class="n">iota</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">return_only_values_with_reference</span><span class="p">:</span>
                <span class="n">references</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficient_references</span><span class="o">.</span><span class="n">iota</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">references</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">tax_distance</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tax_distance</span> <span class="o">=</span> <span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="k">if</span> <span class="n">tax_distance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="n">iota_hills</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hill_coefficient</span><span class="p">)</span>

        <span class="c1">#  Hills</span>
        <span class="k">for</span> <span class="p">(</span>
            <span class="n">met_id</span><span class="p">,</span>
            <span class="n">hill_coefficient</span><span class="p">,</span>
        <span class="p">)</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">return_only_values_with_reference</span><span class="p">:</span>
                <span class="n">references</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficient_references</span><span class="o">.</span><span class="n">alpha</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">references</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">tax_distance</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tax_distance</span> <span class="o">=</span> <span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="k">if</span> <span class="n">tax_distance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="n">alpha_hills</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hill_coefficient</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">kappa_hills</span><span class="p">,</span> <span class="n">iota_hills</span><span class="p">,</span> <span class="n">alpha_hills</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_model_kas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_model_kas</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">return_only_values_with_reference</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Collects k_A values from a COBRA-k model.</p>
<p>This function iterates through the reactions in a COBRA-k model and extracts the
k_A values associated with each metabolite</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRA-k Model object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_only_values_with_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns only values with a given database reference. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="pydantic.PositiveFloat">PositiveFloat</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list containing the k_A values</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_model_kas</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">return_only_values_with_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">PositiveFloat</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Collects k_A values from a COBRA-k model.</span>

<span class="sd">    This function iterates through the reactions in a COBRA-k model and extracts the</span>
<span class="sd">    k_A values associated with each metabolite</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model: The COBRA-k Model object.</span>
<span class="sd">        return_only_values_with_reference: Returns only values with a given database reference. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list containing the k_A values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_kas</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PositiveFloat</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">k_a</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_as</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">return_only_values_with_reference</span><span class="p">:</span>
                <span class="n">references</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_a_references</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">references</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">tax_distance</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tax_distance</span> <span class="o">=</span> <span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="k">if</span> <span class="n">tax_distance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="n">all_kas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k_a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">all_kas</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_model_kcats" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_model_kcats</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Extracts k_cat values from reactions with enzyme data in the model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing reactions with enzyme data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[float]: A list of k_cat values for reactions with available enzyme data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_model_kcats</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts k_cat values from reactions with enzyme data in the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing reactions with enzyme data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[float]: A list of k_cat values for reactions with available enzyme data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kcats</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kcats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kcats</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_model_kis" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_model_kis</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">return_only_values_with_reference</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Collects k_I values from a COBRA-k model.</p>
<p>This function iterates through the reactions in a COBRA-k model and extracts the
k_I values associated with each metabolite</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRA-k Model object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_only_values_with_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns only values with a given database reference. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="pydantic.PositiveFloat">PositiveFloat</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list containing the k_I values</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_model_kis</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">return_only_values_with_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">PositiveFloat</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Collects k_I values from a COBRA-k model.</span>

<span class="sd">    This function iterates through the reactions in a COBRA-k model and extracts the</span>
<span class="sd">    k_I values associated with each metabolite</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model: The COBRA-k Model object.</span>
<span class="sd">        return_only_values_with_reference: Returns only values with a given database reference. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list containing the k_I values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_kis</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PositiveFloat</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">k_i</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_is</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">return_only_values_with_reference</span><span class="p">:</span>
                <span class="n">references</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_i_references</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">references</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">tax_distance</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tax_distance</span> <span class="o">=</span> <span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="k">if</span> <span class="n">tax_distance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="n">all_kis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k_i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">all_kis</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_model_kms" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_model_kms</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Extracts k_m values from reactions with enzyme data in the model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing reactions with enzyme data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[float]: A flat list of k_m values from all reactions with available enzyme data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_model_kms</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts k_m values from reactions with enzyme data in the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing reactions with enzyme data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[float]: A flat list of k_m values from all reactions with available enzyme data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">kms</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_model_kms_by_usage" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_model_kms_by_usage</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">return_only_values_with_reference</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Collects k_M values from a COBRA-k model, separating them into substrate and product lists.</p>
<p>This function iterates through the reactions in a COBRA-k model and extracts the
k_M values associated with each metabolite. It distinguishes between substrates
(metabolites with negative stoichiometry) and products (metabolites with positive
stoichiometry) and separates the corresponding Kms values into two lists.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRA-k Model object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>return_only_values_with_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns only values with a given database reference. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="pydantic.PositiveFloat">PositiveFloat</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing two lists: the first list contains k_M values for substrates,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="pydantic.PositiveFloat">PositiveFloat</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>and the second list contains k_M values for products.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_model_kms_by_usage</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">return_only_values_with_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">PositiveFloat</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">PositiveFloat</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Collects k_M values from a COBRA-k model, separating them into substrate and product lists.</span>

<span class="sd">    This function iterates through the reactions in a COBRA-k model and extracts the</span>
<span class="sd">    k_M values associated with each metabolite. It distinguishes between substrates</span>
<span class="sd">    (metabolites with negative stoichiometry) and products (metabolites with positive</span>
<span class="sd">    stoichiometry) and separates the corresponding Kms values into two lists.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model: The COBRA-k Model object.</span>
<span class="sd">        return_only_values_with_reference: Returns only values with a given database reference. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple containing two lists: the first list contains k_M values for substrates,</span>
<span class="sd">        and the second list contains k_M values for products.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">substrate_kms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PositiveFloat</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">product_kms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PositiveFloat</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">stoichiometry</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">return_only_values_with_reference</span><span class="p">:</span>
                <span class="n">references</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_m_references</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">references</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">tax_distance</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tax_distance</span> <span class="o">=</span> <span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="k">if</span> <span class="n">tax_distance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="n">met_km</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">stoichiometry</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">substrate_kms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">met_km</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">product_kms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">met_km</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">substrate_kms</span><span class="p">,</span> <span class="n">product_kms</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_model_max_kcat_times_e_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_model_max_kcat_times_e_values</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculates the maximum k_cat * E (enzyme concentration in terms of its molecular weight)
for each reaction with enzyme data and returns these values.</p>
<p>The maximal k_cat<em>E is </em>k_cat/W, with  as protein pool and W as enzyme molecular weight.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A metabolic model instance that includes enzymatic constraints,
                  which must contain Reaction instances with enzyme_reaction_data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="pydantic.NonNegativeFloat">NonNegativeFloat</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[float]: A list containing the calculated maximum k_cat * E values for reactions
         having enzyme reaction data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The function requires 'reaction.enzyme_reaction_data.k_cat' and
  'get_full_enzyme_mw(cobrak_model, reaction)' to be non-zero.</li>
<li>If a reaction lacks enzyme reaction data, it is skipped in the calculation.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_model_max_kcat_times_e_values</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">NonNegativeFloat</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the maximum k_cat * E (enzyme concentration in terms of its molecular weight)</span>
<span class="sd">    for each reaction with enzyme data and returns these values.</span>

<span class="sd">    The maximal k_cat*E is *k_cat/W, with  as protein pool and W as enzyme molecular weight.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        cobrak_model (Model): A metabolic model instance that includes enzymatic constraints,</span>
<span class="sd">                              which must contain Reaction instances with enzyme_reaction_data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[float]: A list containing the calculated maximum k_cat * E values for reactions</span>
<span class="sd">                     having enzyme reaction data.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The function requires &#39;reaction.enzyme_reaction_data.k_cat&#39; and</span>
<span class="sd">          &#39;get_full_enzyme_mw(cobrak_model, reaction)&#39; to be non-zero.</span>
<span class="sd">        - If a reaction lacks enzyme reaction data, it is skipped in the calculation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">max_kcat_times_e_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">max_kcat_times_e_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span>
            <span class="o">*</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">max_prot_pool</span>
            <span class="o">/</span> <span class="n">get_full_enzyme_mw</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">max_kcat_times_e_values</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_model_mws" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_model_mws</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Extracts molecular weights of enzymes from the model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing enzyme data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="pydantic.PositiveFloat">PositiveFloat</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[PositiveFloat]: A list of molecular weights for each enzyme in the model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_model_mws</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">PositiveFloat</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts molecular weights of enzymes from the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing enzyme data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[PositiveFloat]: A list of molecular weights for each enzyme in the model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mws</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">enzyme</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">enzymes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">mws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">enzyme</span><span class="o">.</span><span class="n">molecular_weight</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mws</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_model_with_filled_missing_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_model_with_filled_missing_parameters</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">add_dG0_extra_constraints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">param_percentile</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">ignore_prefixes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;EX_&#39;</span><span class="p">],</span> <span class="n">use_median_for_kms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_median_for_kcats</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Fills missing parameters in a COBRA-k model, including dG0, k_cat, and k_ms values.</p>
<p>This function iterates through the reactions in a COBRA-k model and fills in missing
parameters based on percentile values from the entire model.  Missing dG0 values
are filled using a percentile of the absolute dG0 values.  Missing k_cat values
are filled using a percentile or median of the k_cat values.  Missing k_ms values
are filled using a percentile or median of the k_ms values, depending on whether
the metabolite is a substrate or a product.  Optionally, extra linear constraints
can be added to enforce consistency between the dG0 values of coupled reversible
reactions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRA-k Model object to be modified.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>add_dG0_extra_constraints</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to add extra linear constraints for reversible reactions. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>param_percentile</code>
            </td>
            <td>
                  <code><span title="pydantic.conint">conint</span>(ge=0, le=100)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The percentile to use for filling missing parameters. Defaults to 90.</p>
              </div>
            </td>
            <td>
                  <code>90</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ignore_prefixes</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of prefixes to ignore when processing reactions. Defaults to ["EX_"] (i.e. exchange reactions).</p>
              </div>
            </td>
            <td>
                  <code>[&#39;EX_&#39;]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_median_for_kms</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use the median instead of the percentile for k_ms values. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_median_for_kcats</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use the median instead of the percentile for k_cat values. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A deep copy of the input COBRA-k model with missing parameters filled.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_model_with_filled_missing_parameters</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">add_dG0_extra_constraints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">param_percentile</span><span class="p">:</span> <span class="n">conint</span><span class="p">(</span><span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span>
    <span class="n">ignore_prefixes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;EX_&quot;</span><span class="p">],</span>
    <span class="n">use_median_for_kms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_median_for_kcats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fills missing parameters in a COBRA-k model, including dG0, k_cat, and k_ms values.</span>

<span class="sd">    This function iterates through the reactions in a COBRA-k model and fills in missing</span>
<span class="sd">    parameters based on percentile values from the entire model.  Missing dG0 values</span>
<span class="sd">    are filled using a percentile of the absolute dG0 values.  Missing k_cat values</span>
<span class="sd">    are filled using a percentile or median of the k_cat values.  Missing k_ms values</span>
<span class="sd">    are filled using a percentile or median of the k_ms values, depending on whether</span>
<span class="sd">    the metabolite is a substrate or a product.  Optionally, extra linear constraints</span>
<span class="sd">    can be added to enforce consistency between the dG0 values of coupled reversible</span>
<span class="sd">    reactions.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model: The COBRA-k Model object to be modified.</span>
<span class="sd">        add_dG0_extra_constraints: Whether to add extra linear constraints for reversible reactions. Defaults to False.</span>
<span class="sd">        param_percentile: The percentile to use for filling missing parameters. Defaults to 90.</span>
<span class="sd">        ignore_prefixes: List of prefixes to ignore when processing reactions. Defaults to [&quot;EX_&quot;] (i.e. exchange reactions).</span>
<span class="sd">        use_median_for_kms: Whether to use the median instead of the percentile for k_ms values. Defaults to True.</span>
<span class="sd">        use_median_for_kcats: Whether to use the median instead of the percentile for k_cat values. Defaults to True.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A deep copy of the input COBRA-k model with missing parameters filled.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cobrak_model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>

    <span class="n">all_mws</span> <span class="o">=</span> <span class="n">get_model_mws</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
    <span class="n">all_kcats</span> <span class="o">=</span> <span class="n">get_model_kcats</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
    <span class="n">substrate_kms</span><span class="p">,</span> <span class="n">product_kms</span> <span class="o">=</span> <span class="n">get_model_kms_by_usage</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
    <span class="n">all_abs_dG0s</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">dG0</span><span class="p">)</span> <span class="k">for</span> <span class="n">dG0</span> <span class="ow">in</span> <span class="n">get_model_dG0s</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)]</span>
    <span class="n">dG0_reverse_couples</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">reac_id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">ignore_prefix</span><span class="p">)</span> <span class="k">for</span> <span class="n">ignore_prefix</span> <span class="ow">in</span> <span class="n">ignore_prefixes</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">reverse_id</span> <span class="o">=</span> <span class="n">get_reverse_reac_id_if_existing</span><span class="p">(</span>
                <span class="n">reac_id</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">fwd_suffix</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">rev_suffix</span>
            <span class="p">)</span>
            <span class="n">reverse_id</span> <span class="o">=</span> <span class="n">reverse_id</span> <span class="k">if</span> <span class="n">reverse_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">add_dG0_extra_constraints</span> <span class="ow">and</span> <span class="n">reverse_id</span><span class="p">:</span>
                <span class="n">dG0_reverse_couples</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reverse_id</span><span class="p">])))</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">dG0</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">dG0_uncertainty</span> <span class="o">=</span> <span class="n">percentile</span><span class="p">(</span>
                    <span class="n">all_abs_dG0s</span><span class="p">,</span> <span class="n">param_percentile</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">dG0</span> <span class="o">=</span> <span class="o">-</span><span class="n">percentile</span><span class="p">(</span>
                    <span class="n">all_abs_dG0s</span><span class="p">,</span> <span class="n">param_percentile</span>
                <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="s2">&quot;&quot;</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span>
        <span class="p">):</span>
            <span class="n">enzyme_substitue_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">_enzyme_substitute&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">use_median_for_kcats</span><span class="p">:</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span>
                    <span class="n">reac_id</span>
                <span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="o">=</span> <span class="n">EnzymeReactionData</span><span class="p">(</span>
                    <span class="n">identifiers</span><span class="o">=</span><span class="p">[</span><span class="n">enzyme_substitue_id</span><span class="p">],</span>
                    <span class="n">k_cat</span><span class="o">=</span><span class="n">percentile</span><span class="p">(</span><span class="n">all_kcats</span><span class="p">,</span> <span class="n">param_percentile</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span>
                    <span class="n">reac_id</span>
                <span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="o">=</span> <span class="n">EnzymeReactionData</span><span class="p">(</span>
                    <span class="n">identifiers</span><span class="o">=</span><span class="p">[</span><span class="n">enzyme_substitue_id</span><span class="p">],</span>
                    <span class="n">k_cat</span><span class="o">=</span><span class="n">median</span><span class="p">(</span><span class="n">all_kcats</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="n">cobrak_model</span><span class="o">.</span><span class="n">enzymes</span><span class="p">[</span><span class="n">enzyme_substitue_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">Enzyme</span><span class="p">(</span>
                <span class="n">molecular_weight</span><span class="o">=</span><span class="n">percentile</span><span class="p">(</span><span class="n">all_mws</span><span class="p">,</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">param_percentile</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">have_all_unignored_km</span><span class="p">(</span>
            <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">],</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">kinetic_ignored_metabolites</span>
        <span class="p">):</span>
            <span class="n">existing_kms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">stoichiometry</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span>
                <span class="n">reac_id</span>
            <span class="p">]</span><span class="o">.</span><span class="n">stoichiometries</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">met_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">kinetic_ignored_metabolites</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                    <span class="n">met_id</span> <span class="ow">in</span> <span class="n">existing_kms</span>
                <span class="p">):</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">use_median_for_kms</span><span class="p">:</span>
                    <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span>
                        <span class="n">met_id</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                        <span class="n">percentile</span><span class="p">(</span>
                            <span class="n">product_kms</span> <span class="k">if</span> <span class="n">stoichiometry</span> <span class="o">&gt;</span> <span class="mf">0.0</span> <span class="k">else</span> <span class="n">substrate_kms</span><span class="p">,</span>
                            <span class="n">param_percentile</span>
                            <span class="k">if</span> <span class="n">stoichiometry</span> <span class="o">&gt;</span> <span class="mf">0.0</span>
                            <span class="k">else</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">param_percentile</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span>
                        <span class="n">met_id</span>
                    <span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">median</span><span class="p">(</span><span class="n">substrate_kms</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">stoichiometry</span> <span class="o">&lt;</span> <span class="mf">0.0</span>
                        <span class="k">else</span> <span class="n">median</span><span class="p">(</span><span class="n">product_kms</span><span class="p">)</span>
                    <span class="p">)</span>

    <span class="k">for</span> <span class="n">dG0_reverse_couple</span> <span class="ow">in</span> <span class="n">dG0_reverse_couples</span><span class="p">:</span>
        <span class="n">reac_id_1</span><span class="p">,</span> <span class="n">reac_id_2</span> <span class="o">=</span> <span class="n">dG0_reverse_couple</span>
        <span class="n">cobrak_model</span><span class="o">.</span><span class="n">extra_linear_constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">ExtraLinearConstraint</span><span class="p">(</span>
                <span class="n">stoichiometries</span><span class="o">=</span><span class="p">{</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DG0_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id_1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">DG0_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id_2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                <span class="p">},</span>
                <span class="n">lower_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="n">upper_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">cobrak_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_model_with_varied_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_model_with_varied_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">max_km_variation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_kcat_variation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_ki_variation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_ka_variation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_dG0_variation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">varied_reacs</span><span class="o">=</span><span class="p">[],</span> <span class="n">change_unknown_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">change_known_values</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_shuffling_instead_of_uniform_random</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shuffle_using_distribution_of_values_with_reference</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generates a modified copy of the input Model with varied reaction parameters.</p>
<p>This function creates a deep copy of the input Model and introduces random variations
to several reaction parameters, including dG0, k_cat, k_ms, k_is, and k_as.  The
magnitude of the variation is controlled by the provided <code>max_..._variation</code>
parameters.  If a <code>max_..._variation</code> parameter is not provided (i.e., is None),
the corresponding parameter will not be varied.  Variations are applied randomly
using a uniform distribution.  For reactions with a reverse reaction, the dG0 values
of the forward and reverse reactions are updated to maintain thermodynamic consistency.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Model object to be modified.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_km_variation</code>
            </td>
            <td>
                  <code><span title="pydantic.NonNegativeFloat">NonNegativeFloat</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum factor by which to vary Kms.  Defaults to None.
No effect (except if it is None, then nothing happens) if <code>use_shuffling_instead_of_uniform_random=True</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_kcat_variation</code>
            </td>
            <td>
                  <code><span title="pydantic.NonNegativeFloat">NonNegativeFloat</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum factor by which to vary k_cat. Defaults to None.
No effect (except if it is None, then nothing happens) if <code>use_shuffling_instead_of_uniform_random=True</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_ki_variation</code>
            </td>
            <td>
                  <code><span title="pydantic.NonNegativeFloat">NonNegativeFloat</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum factor by which to vary k_is. Defaults to None.
No effect (except if it is None, then nothing happens) if <code>use_shuffling_instead_of_uniform_random=True</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_ka_variation</code>
            </td>
            <td>
                  <code><span title="pydantic.NonNegativeFloat">NonNegativeFloat</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum factor by which to vary k_as. Defaults to None.
No effect (except if it is None, then nothing happens) if <code>use_shuffling_instead_of_uniform_random=True</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_dG0_variation</code>
            </td>
            <td>
                  <code><span title="pydantic.NonNegativeFloat">NonNegativeFloat</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum factor by which to vary dG0. Defaults to None.
No effect (except if it is None, then nothing happens) if <code>use_shuffling_instead_of_uniform_random=True</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>varied_reacs</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If not [], only reactions with IDs in this list are varied. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>change_known_values</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Change values if they <em>are</em> set with a
taxonomic distance in their reference. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>change_unknown_values</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Change values if they are <em>not</em> set with a
taxonomic distance in their reference. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_shuffling_instead_of_uniform_random</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Overwrites max variation parameters, and switches
to shuffling inside the known kcats, educt kms, product kms and so on.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shuffle_using_distribution_of_values_with_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True (the default), the shuffling will only
choose values with a reference for the shuffling; note that if <code>change_unknown_values=True</code>,
the unknown values will still be shuffled, but if ```shuffle_using_distribution_of_values_with_reference=True````
just using the distribution with values with references.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A deep copy of the input model with varied reaction parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_model_with_varied_parameters</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">max_km_variation</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_kcat_variation</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_ki_variation</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_ka_variation</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_dG0_variation</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">varied_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">change_unknown_values</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">change_known_values</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">use_shuffling_instead_of_uniform_random</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">shuffle_using_distribution_of_values_with_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates a modified copy of the input Model with varied reaction parameters.</span>

<span class="sd">    This function creates a deep copy of the input Model and introduces random variations</span>
<span class="sd">    to several reaction parameters, including dG0, k_cat, k_ms, k_is, and k_as.  The</span>
<span class="sd">    magnitude of the variation is controlled by the provided `max_..._variation`</span>
<span class="sd">    parameters.  If a `max_..._variation` parameter is not provided (i.e., is None),</span>
<span class="sd">    the corresponding parameter will not be varied.  Variations are applied randomly</span>
<span class="sd">    using a uniform distribution.  For reactions with a reverse reaction, the dG0 values</span>
<span class="sd">    of the forward and reverse reactions are updated to maintain thermodynamic consistency.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: The Model object to be modified.</span>
<span class="sd">        max_km_variation: Maximum factor by which to vary Kms.  Defaults to None.</span>
<span class="sd">            No effect (except if it is None, then nothing happens) if ```use_shuffling_instead_of_uniform_random=True```.</span>
<span class="sd">        max_kcat_variation: Maximum factor by which to vary k_cat. Defaults to None.</span>
<span class="sd">            No effect (except if it is None, then nothing happens) if ```use_shuffling_instead_of_uniform_random=True```.</span>
<span class="sd">        max_ki_variation: Maximum factor by which to vary k_is. Defaults to None.</span>
<span class="sd">            No effect (except if it is None, then nothing happens) if ```use_shuffling_instead_of_uniform_random=True```.</span>
<span class="sd">        max_ka_variation: Maximum factor by which to vary k_as. Defaults to None.</span>
<span class="sd">            No effect (except if it is None, then nothing happens) if ```use_shuffling_instead_of_uniform_random=True```.</span>
<span class="sd">        max_dG0_variation: Maximum factor by which to vary dG0. Defaults to None.</span>
<span class="sd">            No effect (except if it is None, then nothing happens) if ```use_shuffling_instead_of_uniform_random=True```.</span>
<span class="sd">        varied_reacs: If not [], only reactions with IDs in this list are varied. Defaults to [].</span>
<span class="sd">        change_known_values: Change values if they *are* set with a</span>
<span class="sd">            taxonomic distance in their reference. Defaults to True.</span>
<span class="sd">        change_unknown_values: Change values if they are *not* set with a</span>
<span class="sd">            taxonomic distance in their reference. Defaults to True.</span>
<span class="sd">        use_shuffling_instead_of_uniform_random: Overwrites max variation parameters, and switches</span>
<span class="sd">            to shuffling inside the known kcats, educt kms, product kms and so on.</span>
<span class="sd">        shuffle_using_distribution_of_values_with_reference: If True (the default), the shuffling will only</span>
<span class="sd">            choose values with a reference for the shuffling; note that if ```change_unknown_values=True```,</span>
<span class="sd">            the unknown values will still be shuffled, but if ```shuffle_using_distribution_of_values_with_reference=True````</span>
<span class="sd">            just using the distribution with values with references.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A deep copy of the input model with varied reaction parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">varied_model</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">tested_rev_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">use_shuffling_instead_of_uniform_random</span><span class="p">:</span>
        <span class="n">substrate_kms</span><span class="p">,</span> <span class="n">product_kms</span> <span class="o">=</span> <span class="n">get_model_kms_by_usage</span><span class="p">(</span>
            <span class="n">model</span><span class="p">,</span>
            <span class="n">return_only_values_with_reference</span><span class="o">=</span><span class="n">shuffle_using_distribution_of_values_with_reference</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">max_dG0_variation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">all_dG0s</span> <span class="o">=</span> <span class="n">get_model_dG0s</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">max_kcat_variation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">all_kcats</span> <span class="o">=</span> <span class="n">get_model_kcats</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">max_ki_variation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">all_kis</span> <span class="o">=</span> <span class="n">get_model_kis</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">max_ka_variation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">all_kas</span> <span class="o">=</span> <span class="n">get_model_kas</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">varied_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">varied_reacs</span> <span class="o">!=</span> <span class="p">[])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">varied_reacs</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">max_dG0_variation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tested_rev_reacs</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">use_shuffling_instead_of_uniform_random</span><span class="p">:</span>
                <span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span><span class="n">all_dG0s</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="o">+=</span> <span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="n">max_dG0_variation</span><span class="p">,</span> <span class="o">+</span><span class="n">max_dG0_variation</span><span class="p">)</span>  <span class="c1"># noqa: NPY002</span>
            <span class="n">rev_id</span> <span class="o">=</span> <span class="n">get_reverse_reac_id_if_existing</span><span class="p">(</span>
                <span class="n">reac_id</span><span class="o">=</span><span class="n">reac_id</span><span class="p">,</span>
                <span class="n">fwd_suffix</span><span class="o">=</span><span class="n">varied_model</span><span class="o">.</span><span class="n">fwd_suffix</span><span class="p">,</span>
                <span class="n">rev_suffix</span><span class="o">=</span><span class="n">varied_model</span><span class="o">.</span><span class="n">rev_suffix</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">rev_id</span> <span class="ow">in</span> <span class="n">varied_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">:</span>
                <span class="n">varied_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">rev_id</span><span class="p">]</span><span class="o">.</span><span class="n">dG0</span> <span class="o">=</span> <span class="o">-</span><span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span>
                <span class="n">tested_rev_reacs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rev_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">max_kcat_variation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kcat_tax_distance</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="o">-</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat_references</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
                    <span class="k">else</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat_references</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">change_known_values</span> <span class="ow">and</span> <span class="n">kcat_tax_distance</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                    <span class="n">change_unknown_values</span> <span class="ow">and</span> <span class="n">kcat_tax_distance</span> <span class="o">&lt;</span> <span class="mi">0</span>
                <span class="p">):</span>
                    <span class="k">if</span> <span class="n">use_shuffling_instead_of_uniform_random</span><span class="p">:</span>
                        <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span><span class="n">all_kcats</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span> <span class="o">*=</span> <span class="n">max_kcat_variation</span> <span class="o">**</span> <span class="p">(</span>
                            <span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># noqa: NPY002</span>
                        <span class="p">)</span>  <span class="c1"># noqa: NPY002</span>
            <span class="k">if</span> <span class="n">max_km_variation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">:</span>
                    <span class="n">references</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_m_references</span>
                    <span class="n">km_tax_distance</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="o">-</span><span class="mi">1</span>
                        <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">references</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span>
                        <span class="k">else</span> <span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
                        <span class="p">(</span><span class="n">change_known_values</span> <span class="ow">and</span> <span class="n">km_tax_distance</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="ow">or</span> <span class="p">(</span><span class="n">change_unknown_values</span> <span class="ow">and</span> <span class="n">km_tax_distance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="n">met_id</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span>
                        <span class="ow">and</span> <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span>
                    <span class="p">):</span>  <span class="c1"># Substrate k_ms</span>
                        <span class="k">if</span> <span class="n">use_shuffling_instead_of_uniform_random</span><span class="p">:</span>
                            <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span>
                                <span class="n">substrate_kms</span>
                            <span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">*=</span> <span class="p">(</span>
                                <span class="n">max_km_variation</span> <span class="o">**</span> <span class="p">(</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># noqa: NPY002</span>
                            <span class="p">)</span>  <span class="c1"># noqa: NPY002</span>
                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Product k_ms</span>
                        <span class="k">if</span> <span class="n">use_shuffling_instead_of_uniform_random</span><span class="p">:</span>
                            <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span>
                                <span class="n">product_kms</span>
                            <span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">*=</span> <span class="p">(</span>
                                <span class="n">max_km_variation</span> <span class="o">**</span> <span class="p">(</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># noqa: NPY002</span>
                            <span class="p">)</span>  <span class="c1"># noqa: NPY002</span>
            <span class="k">if</span> <span class="n">max_ki_variation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">references</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_i_references</span>
                <span class="n">ki_tax_distance</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="o">-</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">references</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span>
                    <span class="k">else</span> <span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
                    <span class="p">(</span><span class="n">change_known_values</span> <span class="ow">and</span> <span class="n">ki_tax_distance</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="p">(</span><span class="n">change_unknown_values</span> <span class="ow">and</span> <span class="n">ki_tax_distance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="k">continue</span>
                <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_is</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">use_shuffling_instead_of_uniform_random</span><span class="p">:</span>
                        <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_is</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span><span class="n">all_kis</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_is</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">*=</span> <span class="p">(</span>
                            <span class="n">max_ki_variation</span>
                            <span class="o">**</span> <span class="p">(</span>
                                <span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># noqa: NPY002</span>
                            <span class="p">)</span>
                        <span class="p">)</span>  <span class="c1"># noqa: NPY002</span>
            <span class="k">if</span> <span class="n">max_ka_variation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">references</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_a_references</span>
                <span class="n">ka_tax_distance</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="o">-</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">references</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span>
                    <span class="k">else</span> <span class="n">references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
                    <span class="p">(</span><span class="n">change_known_values</span> <span class="ow">and</span> <span class="n">ka_tax_distance</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="p">(</span><span class="n">change_unknown_values</span> <span class="ow">and</span> <span class="n">ka_tax_distance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="k">continue</span>
                <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_as</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">use_shuffling_instead_of_uniform_random</span><span class="p">:</span>
                        <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_as</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">choice</span><span class="p">(</span><span class="n">all_kas</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_as</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">*=</span> <span class="p">(</span>
                            <span class="n">max_ka_variation</span>
                            <span class="o">**</span> <span class="p">(</span>
                                <span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># noqa: NPY002</span>
                            <span class="p">)</span>
                        <span class="p">)</span>  <span class="c1"># noqa: NPY002</span>
    <span class="k">return</span> <span class="n">varied_model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_potentially_active_reactions_in_variability_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_potentially_active_reactions_in_variability_dict</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Identify potentially active reactions in a COBRAk model based on a variability dictionary.</p>
<p>This function returns a list of reaction IDs that are present in both the COBRAk model and the variability dictionary,
and have a maximum flux greater than zero while having a minimum flux equal to zero. These reactions are considered potentially active.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing reactions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variability_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping reaction IDs to their minimum and maximum flux values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[str]: A list of reaction IDs that are potentially active.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_potentially_active_reactions_in_variability_dict</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span> <span class="n">variability_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Identify potentially active reactions in a COBRAk model based on a variability dictionary.</span>

<span class="sd">    This function returns a list of reaction IDs that are present in both the COBRAk model and the variability dictionary,</span>
<span class="sd">    and have a maximum flux greater than zero while having a minimum flux equal to zero. These reactions are considered potentially active.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing reactions.</span>
<span class="sd">        variability_dict (dict[str, tuple[float, float]]): A dictionary mapping reaction IDs to their minimum and maximum flux values.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[str]: A list of reaction IDs that are potentially active.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">reac_id</span>
        <span class="k">for</span> <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">variability_dict</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">reac_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">variability_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">variability_dict</span><span class="p">[</span><span class="n">reac_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_pyomo_solution_as_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_pyomo_solution_as_dict</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the pyomo solution as a dictionary of { "<span class="arithmatex">\(VAR_NAME": "\)</span>VAR_VALUE", ... }</p>
<p>Value is None for all uninitialized variables.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="pyomo.environ.ConcreteModel">ConcreteModel</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pyomo model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, float]: The solution dictionary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_pyomo_solution_as_dict</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">ConcreteModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the pyomo solution as a dictionary of { &quot;$VAR_NAME&quot;: &quot;$VAR_VALUE&quot;, ... }</span>

<span class="sd">    Value is None for all uninitialized variables.</span>

<span class="sd">    Args:</span>
<span class="sd">        model (ConcreteModel): The pyomo model</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, float]: The solution dictionary</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model_var_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">component_objects</span><span class="p">(</span><span class="n">Var</span><span class="p">)]</span>
    <span class="n">solution_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">model_var_name</span> <span class="ow">in</span> <span class="n">model_var_names</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">var_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model_var_name</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">var_value</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Uninitialized variable (e.g., x_Biomass)</span>
        <span class="n">solution_dict</span><span class="p">[</span><span class="n">model_var_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">var_value</span>
    <span class="k">return</span> <span class="n">solution_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_reaction_enzyme_var_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_reaction_enzyme_var_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the pyomo model name of the reaction's enzyme</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>reac_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reaction ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reaction</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Reaction (cobrak.dataclasses.Reaction)" href="#cobrak.dataclasses.Reaction">Reaction</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reaction instance</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reaction enzyme's name</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_reaction_enzyme_var_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">reaction</span><span class="p">:</span> <span class="n">Reaction</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the pyomo model name of the reaction&#39;s enzyme</span>

<span class="sd">    Args:</span>
<span class="sd">        reac_id (str): Reaction ID</span>
<span class="sd">        reaction (Reaction): Reaction instance</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Reaction enzyme&#39;s name</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">ENZYME_VAR_PREFIX</span>
        <span class="o">+</span> <span class="n">get_full_enzyme_id</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">ENZYME_VAR_INFIX</span>
        <span class="o">+</span> <span class="n">reac_id</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_reaction_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_reaction_string</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generate a string representation of a reaction in a COBRAk model.</p>
<p>This function constructs a string that represents the stoichiometry of a specified reaction,
including the direction of the reaction based on its flux bounds. E.g., a reaction
R1: A  B, [0, 1000]
is returned
as "1 A  1 B"</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing the reaction.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reac_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the reaction to be represented as a string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string representation of the reaction, showing educts, products, and the reaction direction.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_reaction_string</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a string representation of a reaction in a COBRAk model.</span>

<span class="sd">    This function constructs a string that represents the stoichiometry of a specified reaction,</span>
<span class="sd">    including the direction of the reaction based on its flux bounds. E.g., a reaction</span>
<span class="sd">    R1: A  B, [0, 1000]</span>
<span class="sd">    is returned</span>
<span class="sd">    as &quot;1 A  1 B&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing the reaction.</span>
<span class="sd">        reac_id (str): The ID of the reaction to be represented as a string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A string representation of the reaction, showing educts, products, and the reaction direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reaction</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
    <span class="n">educt_parts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">product_parts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">stoichiometry</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">met_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stoichiometry</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">met_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">stoichiometry</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">product_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">met_string</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">educt_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">met_string</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">min_flux</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">max_flux</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">min_flux</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">max_flux</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">return</span> <span class="s2">&quot; + &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">educt_parts</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">arrow</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot; + &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">product_parts</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_reverse_reac_id_if_existing" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_reverse_reac_id_if_existing</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">fwd_suffix</span><span class="o">=</span><span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span> <span class="n">rev_suffix</span><span class="o">=</span><span class="n">REAC_REV_SUFFIX</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the ID of the reverse reaction if it exists, otherwise returns an empty string.</p>
<p>Args:
reac_id (str): The ID of the reaction.
fwd_suffix (str, optional): The suffix used to identify forward reactions. Defaults to REAC_FWD_SUFFIX.
rev_suffix (str, optional): The suffix used to identify reverse reactions. Defaults to REAC_REV_SUFFIX.</p>
<p>Returns:
str: The ID of the reverse reaction if it exists, otherwise an empty string.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_reverse_reac_id_if_existing</span><span class="p">(</span>
    <span class="n">reac_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">fwd_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_FWD_SUFFIX</span><span class="p">,</span>
    <span class="n">rev_suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">REAC_REV_SUFFIX</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the ID of the reverse reaction if it exists, otherwise returns an empty string.</span>

<span class="sd">    Args:</span>
<span class="sd">    reac_id (str): The ID of the reaction.</span>
<span class="sd">    fwd_suffix (str, optional): The suffix used to identify forward reactions. Defaults to REAC_FWD_SUFFIX.</span>
<span class="sd">    rev_suffix (str, optional): The suffix used to identify reverse reactions. Defaults to REAC_REV_SUFFIX.</span>

<span class="sd">    Returns:</span>
<span class="sd">    str: The ID of the reverse reaction if it exists, otherwise an empty string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">fwd_suffix</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">fwd_suffix</span><span class="p">,</span> <span class="n">rev_suffix</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">rev_suffix</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">reac_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">rev_suffix</span><span class="p">,</span> <span class="n">fwd_suffix</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_solver_status_from_pyomo_results" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_solver_status_from_pyomo_results</span><span class="p">(</span><span class="n">pyomo_results</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the solver status from the pyomo results as an integer code.</p>
<p>This function interprets the solver status from a <code>SolverResults</code> object and returns a corresponding integer code.
The mapping is as follows:
- 0 for <code>SolverStatus.ok</code>
- 1 for <code>SolverStatus.warning</code>
- 2 for <code>SolverStatus.error</code>
- 3 for <code>SolverStatus.aborted</code>
- 4 for <code>SolverStatus.unknown</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pyomo_results</code>
            </td>
            <td>
                  <code><span title="pyomo.opt.results.SolverResults">SolverResults</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The results object from a Pyomo solver containing the solver status.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the solver status is not recognized.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="pydantic.NonNegativeInt">NonNegativeInt</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An integer code representing the solver status.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_solver_status_from_pyomo_results</span><span class="p">(</span>
    <span class="n">pyomo_results</span><span class="p">:</span> <span class="n">SolverResults</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NonNegativeInt</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the solver status from the pyomo results as an integer code.</span>

<span class="sd">    This function interprets the solver status from a `SolverResults` object and returns a corresponding integer code.</span>
<span class="sd">    The mapping is as follows:</span>
<span class="sd">    - 0 for `SolverStatus.ok`</span>
<span class="sd">    - 1 for `SolverStatus.warning`</span>
<span class="sd">    - 2 for `SolverStatus.error`</span>
<span class="sd">    - 3 for `SolverStatus.aborted`</span>
<span class="sd">    - 4 for `SolverStatus.unknown`</span>

<span class="sd">    Args:</span>
<span class="sd">        pyomo_results (SolverResults): The results object from a Pyomo solver containing the solver status.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the solver status is not recognized.</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: An integer code representing the solver status.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">pyomo_results</span><span class="o">.</span><span class="n">solver</span><span class="o">.</span><span class="n">status</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">SolverStatus</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">case</span> <span class="n">SolverStatus</span><span class="o">.</span><span class="n">warning</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">case</span> <span class="n">SolverStatus</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span>
        <span class="k">case</span> <span class="n">SolverStatus</span><span class="o">.</span><span class="n">aborted</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">3</span>
        <span class="k">case</span> <span class="n">SolverStatus</span><span class="o">.</span><span class="n">unknown</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">4</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_stoichiometric_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_stoichiometric_matrix</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the model's stoichiometric matrix.</p>
<p>The matrix is returned as a list of float lists, where each float list
stands for a reaction and each entry in the float list for a metabolite.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[list[float]]: The stoichiometric matrix</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_stoichiometric_matrix</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the model&#39;s stoichiometric matrix.</span>

<span class="sd">    The matrix is returned as a list of float lists, where each float list</span>
<span class="sd">    stands for a reaction and each entry in the float list for a metabolite.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The model</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[list[float]]: The stoichiometric matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matrix</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">metabolites</span><span class="p">:</span>
        <span class="n">met_row</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">reac_data</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">reac_data</span><span class="o">.</span><span class="n">stoichiometries</span><span class="p">:</span>
                <span class="n">met_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_data</span><span class="o">.</span><span class="n">stoichiometries</span><span class="p">[</span><span class="n">met_id</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">met_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="n">matrix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">met_row</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">matrix</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_stoichiometrically_coupled_reactions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_stoichiometrically_coupled_reactions</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns stoichiometrically coupled reactions.</p>
<p>The returned format is as follows: Say that reactions (R1 &amp; R2) as well
as (R5 &amp; R6 &amp; R7) are stoichiometrically coupled (i.e, their fluxes are
in a strict linear relationship to each other), then this function
returns [["R1", "R2"], ["R5", "R6", "R7"].</p>
<p>The identification of stoichiometrically coupled reactions happens through
the calculation of the model's stoichiometric matrix nullspace.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rounding</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Precision for the calculation of the nullspace. Defaults to 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[list[str]]: The stoichiometrically coupled reactions</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_stoichiometrically_coupled_reactions</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span> <span class="n">rounding</span><span class="p">:</span> <span class="n">NonNegativeInt</span> <span class="o">=</span> <span class="mi">10</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns stoichiometrically coupled reactions.</span>

<span class="sd">    The returned format is as follows: Say that reactions (R1 &amp; R2) as well</span>
<span class="sd">    as (R5 &amp; R6 &amp; R7) are stoichiometrically coupled (i.e, their fluxes are</span>
<span class="sd">    in a strict linear relationship to each other), then this function</span>
<span class="sd">    returns [[&quot;R1&quot;, &quot;R2&quot;], [&quot;R5&quot;, &quot;R6&quot;, &quot;R7&quot;].</span>

<span class="sd">    The identification of stoichiometrically coupled reactions happens through</span>
<span class="sd">    the calculation of the model&#39;s stoichiometric matrix nullspace.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The model</span>
<span class="sd">        rounding (int, optional): Precision for the calculation of the nullspace. Defaults to 10.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[list[str]]: The stoichiometrically coupled reactions</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate nullspace and convert each row to rounded tuples</span>
    <span class="n">null_space_matrix</span> <span class="o">=</span> <span class="n">null_space</span><span class="p">(</span><span class="n">get_stoichiometric_matrix</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">))</span>
    <span class="n">null_space_tuples</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">tuple</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">rounding</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">null_space_matrix</span>
    <span class="p">]</span>

    <span class="c1"># Map the null space tuples to reaction indices</span>
    <span class="n">occcurences</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">reac_idx</span><span class="p">,</span> <span class="n">null_space_tuple</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">null_space_tuples</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">null_space_tuple</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">occcurences</span><span class="p">:</span>
            <span class="n">occcurences</span><span class="p">[</span><span class="n">null_space_tuple</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">occcurences</span><span class="p">[</span><span class="n">null_space_tuple</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_idx</span><span class="p">)</span>

    <span class="c1"># Map the reaction indices to the final couples reactions list</span>
    <span class="n">coupled_reacs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">reac_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">coupled_indices</span> <span class="ow">in</span> <span class="n">occcurences</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">coupled_reacs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">reac_ids</span><span class="p">[</span><span class="n">reac_idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">reac_idx</span> <span class="ow">in</span> <span class="n">coupled_indices</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">coupled_reacs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_substrate_and_product_exchanges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_substrate_and_product_exchanges</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">optimization_dict</span><span class="o">=</span><span class="p">{})</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Identifies and categorizes reactions as substrate or product exchanges based on reaction stoichiometries.</p>
<p>This function analyzes each reaction in the provided COBRAk model to determine whether it primarily represents substrate consumption or product formation.
It categorizes reactions into substrate reactions (where all stoichiometries are positive, indicating metabolite consumption) and product reactions
(where all stoichiometries are negative, indicating metabolite production).</p>
<ul>
<li>A reaction is classified as a substrate reaction if all its stoichiometries are positive, indicating that all metabolites involved are being consumed.</li>
<li>A reaction is classified as a product reaction if all its stoichiometries are negative, indicating that all metabolites involved are being produced.</li>
<li>If the <code>optimization_dict</code> is provided, only the reactions listed in this dictionary are considered for classification.</li>
<li>The function returns tuples of reaction IDs, which can be used for further processing or analysis of substrate and product reactions.</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing reactions to be analyzed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimization_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional dictionary to filter reactions. Only reactions whose IDs are present in this dictionary will be considered.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="tuple">tuple</span>[<span title="str">str</span>, ...], <span title="tuple">tuple</span>[<span title="str">str</span>, ...]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[tuple[str, ...], tuple[str, ...]]: A tuple containing two elements:
- The first element is a tuple of reaction IDs identified as substrate reactions.
- The second element is a tuple of reaction IDs identified as product reactions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_substrate_and_product_exchanges</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span> <span class="n">optimization_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Identifies and categorizes reactions as substrate or product exchanges based on reaction stoichiometries.</span>

<span class="sd">    This function analyzes each reaction in the provided COBRAk model to determine whether it primarily represents substrate consumption or product formation.</span>
<span class="sd">    It categorizes reactions into substrate reactions (where all stoichiometries are positive, indicating metabolite consumption) and product reactions</span>
<span class="sd">    (where all stoichiometries are negative, indicating metabolite production).</span>

<span class="sd">    * A reaction is classified as a substrate reaction if all its stoichiometries are positive, indicating that all metabolites involved are being consumed.</span>
<span class="sd">    * A reaction is classified as a product reaction if all its stoichiometries are negative, indicating that all metabolites involved are being produced.</span>
<span class="sd">    * If the `optimization_dict` is provided, only the reactions listed in this dictionary are considered for classification.</span>
<span class="sd">    * The function returns tuples of reaction IDs, which can be used for further processing or analysis of substrate and product reactions.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing reactions to be analyzed.</span>
<span class="sd">        optimization_dict (dict[str, Any], optional): An optional dictionary to filter reactions. Only reactions whose IDs are present in this dictionary will be considered.</span>
<span class="sd">        Defaults to {}.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[tuple[str, ...], tuple[str, ...]]: A tuple containing two elements:</span>
<span class="sd">            - The first element is a tuple of reaction IDs identified as substrate reactions.</span>
<span class="sd">            - The second element is a tuple of reaction IDs identified as product reactions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">substrate_reac_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">product_reac_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">optimization_dict</span> <span class="o">!=</span> <span class="p">{}</span> <span class="ow">and</span> <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">optimization_dict</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">stoichiometries</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">stoichiometries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="n">stoichiometries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">substrate_reac_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">min</span><span class="p">(</span><span class="n">stoichiometries</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="n">stoichiometries</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">product_reac_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reac_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">substrate_reac_ids</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">product_reac_ids</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_termination_condition_from_pyomo_results" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_termination_condition_from_pyomo_results</span><span class="p">(</span><span class="n">pyomo_results</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the termination condition from the pyomo results as a float code.</p>
<p>This function interprets the termination condition from a <code>SolverResults</code> object and returns a corresponding float code.
The mapping is as follows:
- 0.1 for <code>TerminationCondition.globallyOptimal</code>
- 0.2 for <code>TerminationCondition.optimal</code>
- 0.3 for <code>TerminationCondition.locallyOptimal</code>
- 1 for <code>TerminationCondition.maxTimeLimit</code>
- 2 for <code>TerminationCondition.maxIterations</code>
- 3 for <code>TerminationCondition.minFunctionValue</code>
- 4 for <code>TerminationCondition.minStepLength</code>
- 5 for <code>TerminationCondition.maxEvaluations</code>
- 6 for <code>TerminationCondition.other</code>
- 7 for <code>TerminationCondition.unbounded</code>
- 8 for <code>TerminationCondition.infeasible</code>
- 9 for <code>TerminationCondition.invalidProblem</code>
- 10 for <code>TerminationCondition.solverFailure</code>
- 11 for <code>TerminationCondition.internalSolverError</code>
- 12 for <code>TerminationCondition.error</code>
- 13 for <code>TerminationCondition.userInterrupt</code>
- 14 for <code>TerminationCondition.resourceInterrupt</code>
- 15 for <code>TerminationCondition.licensingProblem</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pyomo_results</code>
            </td>
            <td>
                  <code><span title="pyomo.opt.results.SolverResults">SolverResults</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The results object from a Pyomo solver containing the termination condition.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the termination condition is not recognized.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="pydantic.NonNegativeFloat">NonNegativeFloat</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A float code representing the termination condition.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_termination_condition_from_pyomo_results</span><span class="p">(</span>
    <span class="n">pyomo_results</span><span class="p">:</span> <span class="n">SolverResults</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NonNegativeFloat</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the termination condition from the pyomo results as a float code.</span>

<span class="sd">    This function interprets the termination condition from a `SolverResults` object and returns a corresponding float code.</span>
<span class="sd">    The mapping is as follows:</span>
<span class="sd">    - 0.1 for `TerminationCondition.globallyOptimal`</span>
<span class="sd">    - 0.2 for `TerminationCondition.optimal`</span>
<span class="sd">    - 0.3 for `TerminationCondition.locallyOptimal`</span>
<span class="sd">    - 1 for `TerminationCondition.maxTimeLimit`</span>
<span class="sd">    - 2 for `TerminationCondition.maxIterations`</span>
<span class="sd">    - 3 for `TerminationCondition.minFunctionValue`</span>
<span class="sd">    - 4 for `TerminationCondition.minStepLength`</span>
<span class="sd">    - 5 for `TerminationCondition.maxEvaluations`</span>
<span class="sd">    - 6 for `TerminationCondition.other`</span>
<span class="sd">    - 7 for `TerminationCondition.unbounded`</span>
<span class="sd">    - 8 for `TerminationCondition.infeasible`</span>
<span class="sd">    - 9 for `TerminationCondition.invalidProblem`</span>
<span class="sd">    - 10 for `TerminationCondition.solverFailure`</span>
<span class="sd">    - 11 for `TerminationCondition.internalSolverError`</span>
<span class="sd">    - 12 for `TerminationCondition.error`</span>
<span class="sd">    - 13 for `TerminationCondition.userInterrupt`</span>
<span class="sd">    - 14 for `TerminationCondition.resourceInterrupt`</span>
<span class="sd">    - 15 for `TerminationCondition.licensingProblem`</span>

<span class="sd">    Args:</span>
<span class="sd">        pyomo_results (SolverResults): The results object from a Pyomo solver containing the termination condition.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the termination condition is not recognized.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: A float code representing the termination condition.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">pyomo_results</span><span class="o">.</span><span class="n">solver</span><span class="o">.</span><span class="n">termination_condition</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">globallyOptimal</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.1</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">optimal</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.2</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">locallyOptimal</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.3</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">maxTimeLimit</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">maxIterations</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">minFunctionValue</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">3</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">minStepLength</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">4</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">maxEvaluations</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">5</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">other</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">6</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">unbounded</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">7</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">infeasible</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">8</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">invalidProblem</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">9</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">solverFailure</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">10</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">internalSolverError</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">11</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">12</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">userInterrupt</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">13</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">resourceInterrupt</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">14</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">licensingProblems</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">15</span>
        <span class="k">case</span> <span class="n">TerminationCondition</span><span class="o">.</span><span class="n">intermediateNonInteger</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">16</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.get_unoptimized_reactions_in_nlp_solution" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_unoptimized_reactions_in_nlp_solution</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">solution</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">regard_iota</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">regard_alpha</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Identify unoptimized reactions in the NLP (Non-Linear Programming) solution.</p>
<p>This function checks each reaction in the COBRAk model to determine if the flux values in the provided NLP solution match
the expected values based on enzyme kinetics and thermodynamics.
Reactions with discrepancies are considered unoptimized and are returned in a dictionary.</p>
<p>Discrepancies occur because, in COBRAk, the saturation term and the thermodynamic restriction are set as maximal values (&lt;=),
they are not fixed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRAk model containing reactions and enzyme data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solution</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping variable names to their values from an NLP solution.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bool: Whether or not to print the discrepancies for each reaction</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, tuple[float, float]]: Dictionary where the keys are reaction IDs and the values are
                            tuples containing the NLP solution flux and the real flux for unoptimized reactions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_unoptimized_reactions_in_nlp_solution</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span>
    <span class="n">solution</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">regard_iota</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">regard_alpha</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Identify unoptimized reactions in the NLP (Non-Linear Programming) solution.</span>

<span class="sd">    This function checks each reaction in the COBRAk model to determine if the flux values in the provided NLP solution match</span>
<span class="sd">    the expected values based on enzyme kinetics and thermodynamics.</span>
<span class="sd">    Reactions with discrepancies are considered unoptimized and are returned in a dictionary.</span>

<span class="sd">    Discrepancies occur because, in COBRAk, the saturation term and the thermodynamic restriction are set as maximal values (&lt;=),</span>
<span class="sd">    they are not fixed.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model (Model): The COBRAk model containing reactions and enzyme data.</span>
<span class="sd">        solution (dict[str, float]): A dictionary mapping variable names to their values from an NLP solution.</span>
<span class="sd">        verbose: bool: Whether or not to print the discrepancies for each reaction</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, tuple[float, float]]: Dictionary where the keys are reaction IDs and the values are</span>
<span class="sd">                                        tuples containing the NLP solution flux and the real flux for unoptimized reactions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unoptimized_reactions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">RT</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">T</span>

    <span class="k">for</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reac_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span> <span class="o">==</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]:</span>
            <span class="k">continue</span>

        <span class="n">nlp_flux</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>
        <span class="n">has_problem</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Kappa check</span>
        <span class="k">if</span> <span class="n">have_all_unignored_km</span><span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">kinetic_ignored_metabolites</span><span class="p">):</span>
            <span class="n">kappa_substrates</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">kappa_products</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">raw_stoichiometry</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">kinetic_ignored_metabolites</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">stoichiometry</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">raw_stoichiometry</span>
                    <span class="o">*</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="o">.</span><span class="n">kappa</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                        <span class="n">met_id</span><span class="p">,</span> <span class="mf">1.0</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="n">expconc</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">LNCONC_VAR_PREFIX</span><span class="si">}{</span><span class="n">met_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
                <span class="n">multiplier</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">expconc</span> <span class="o">/</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span>
                <span class="p">)</span> <span class="o">**</span> <span class="nb">abs</span><span class="p">(</span><span class="n">stoichiometry</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">stoichiometry</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">kappa_substrates</span> <span class="o">*=</span> <span class="n">multiplier</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">kappa_products</span> <span class="o">*=</span> <span class="n">multiplier</span>

            <span class="n">real_kappa</span> <span class="o">=</span> <span class="n">kappa_substrates</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">kappa_substrates</span> <span class="o">+</span> <span class="n">kappa_products</span><span class="p">)</span>
            <span class="n">nlp_kappa</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">KAPPA_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">nlp_kappa</span> <span class="o">-</span> <span class="n">real_kappa</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">:</span>
                <span class="n">has_problem</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot; problem in </span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">: Real is </span><span class="si">{</span><span class="n">real_kappa</span><span class="si">}</span><span class="s2">, NLP value is </span><span class="si">{</span><span class="n">nlp_kappa</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">real_kappa</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">nlp_kappa</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="c1"># Iota and alpha check</span>
        <span class="n">real_iota</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">real_alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">reac_id</span> <span class="ow">in</span> <span class="n">solution</span>
            <span class="ow">and</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">identifiers</span> <span class="o">!=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="n">alpha_and_iota_mets</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
                <span class="nb">list</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_is</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_as</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">alpha_and_iota_mets</span><span class="p">:</span>
                <span class="n">met_var_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">LNCONC_VAR_PREFIX</span><span class="si">}{</span><span class="n">met_id</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">met_var_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">expconc</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="n">met_var_id</span><span class="p">])</span>
                <span class="n">stoichiometry_iota</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span>
                    <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">met_id</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
                <span class="p">)</span> <span class="o">*</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="o">.</span><span class="n">iota</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="n">met_id</span><span class="p">,</span> <span class="mf">1.0</span>
                <span class="p">)</span>
                <span class="n">stoichiometry_alpha</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span>
                    <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">met_id</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
                <span class="p">)</span> <span class="o">*</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">hill_coefficients</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="n">met_id</span><span class="p">,</span> <span class="mf">1.0</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_is</span> <span class="ow">and</span> <span class="n">regard_iota</span><span class="p">:</span>
                    <span class="n">real_iota</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span>
                        <span class="mi">1</span>
                        <span class="o">+</span> <span class="p">(</span><span class="n">expconc</span> <span class="o">/</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_is</span><span class="p">[</span><span class="n">met_id</span><span class="p">])</span>
                        <span class="o">**</span> <span class="n">stoichiometry_iota</span>
                    <span class="p">)</span>
                <span class="k">if</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_as</span> <span class="ow">and</span> <span class="n">regard_alpha</span><span class="p">:</span>
                    <span class="n">real_alpha</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span>
                        <span class="mi">1</span>
                        <span class="o">+</span> <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_as</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">/</span> <span class="n">expconc</span><span class="p">)</span>
                        <span class="o">**</span> <span class="n">stoichiometry_alpha</span>
                    <span class="p">)</span>

        <span class="n">nlp_iota</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">solution</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">IOTA_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">if</span> <span class="n">regard_iota</span> <span class="k">else</span> <span class="mf">1.0</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">nlp_iota</span> <span class="o">-</span> <span class="n">real_iota</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">:</span>
            <span class="n">has_problem</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot; problem in </span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">: Real is </span><span class="si">{</span><span class="n">real_iota</span><span class="si">}</span><span class="s2">, NLP value is </span><span class="si">{</span><span class="n">nlp_iota</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="n">nlp_alpha</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">solution</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ALPHA_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">if</span> <span class="n">regard_alpha</span> <span class="k">else</span> <span class="mf">1.0</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">nlp_alpha</span> <span class="o">-</span> <span class="n">real_alpha</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">:</span>
            <span class="n">has_problem</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot; problem in </span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">: Real is </span><span class="si">{</span><span class="n">real_alpha</span><span class="si">}</span><span class="s2">, NLP value is </span><span class="si">{</span><span class="n">nlp_alpha</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Gamma check</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gamma_substrates</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">gamma_products</span> <span class="o">=</span> <span class="mf">1.0</span>

            <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">stoichiometry</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">multiplier</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">LNCONC_VAR_PREFIX</span><span class="si">}{</span><span class="n">met_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span> <span class="o">**</span> <span class="nb">abs</span><span class="p">(</span>
                    <span class="n">stoichiometry</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">stoichiometry</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">gamma_substrates</span> <span class="o">*=</span> <span class="n">multiplier</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">gamma_products</span> <span class="o">*=</span> <span class="n">multiplier</span>

            <span class="n">dg</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">dG0</span> <span class="o">+</span> <span class="n">RT</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">gamma_products</span><span class="p">)</span> <span class="o">-</span> <span class="n">RT</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="n">gamma_substrates</span><span class="p">))</span>
            <span class="n">real_gamma</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dg</span> <span class="o">/</span> <span class="n">RT</span><span class="p">)</span>
            <span class="n">nlp_gamma</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">GAMMA_VAR_PREFIX</span><span class="si">}{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">nlp_gamma</span> <span class="o">-</span> <span class="n">real_gamma</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">:</span>
                <span class="n">has_problem</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot; problem in </span><span class="si">{</span><span class="n">reac_id</span><span class="si">}</span><span class="s2">: Real is </span><span class="si">{</span><span class="n">real_gamma</span><span class="si">}</span><span class="s2">, NLP value is </span><span class="si">{</span><span class="n">nlp_gamma</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;G&#39;: Real is </span><span class="si">{</span><span class="n">dg</span><span class="si">}</span><span class="s2">, NLP value is </span><span class="si">{</span><span class="n">solution</span><span class="p">[</span><span class="n">DF_VAR_PREFIX</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">reac_id</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="n">solution</span><span class="p">[</span><span class="n">get_reaction_enzyme_var_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)])</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="s2">&quot;E_use&quot;</span><span class="p">,</span>
                        <span class="n">solution</span><span class="p">[</span><span class="n">get_reaction_enzyme_var_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)]</span>
                        <span class="o">*</span> <span class="n">get_full_enzyme_mw</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">reaction</span><span class="p">),</span>
                    <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">real_gamma</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">nlp_gamma</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="c1"># V plus</span>
        <span class="n">enzyme_conc</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="n">get_reaction_enzyme_var_id</span><span class="p">(</span><span class="n">reac_id</span><span class="p">,</span> <span class="n">reaction</span><span class="p">)]</span>
        <span class="n">v_plus</span> <span class="o">=</span> <span class="n">enzyme_conc</span> <span class="o">*</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_cat</span>

        <span class="n">nlp_flux</span> <span class="o">=</span> <span class="n">v_plus</span> <span class="o">*</span> <span class="n">nlp_gamma</span> <span class="o">*</span> <span class="n">nlp_kappa</span> <span class="o">*</span> <span class="n">nlp_alpha</span> <span class="o">*</span> <span class="n">nlp_iota</span>
        <span class="n">real_flux</span> <span class="o">=</span> <span class="n">v_plus</span> <span class="o">*</span> <span class="n">real_gamma</span> <span class="o">*</span> <span class="n">real_kappa</span> <span class="o">*</span> <span class="n">real_alpha</span> <span class="o">*</span> <span class="n">real_iota</span>
        <span class="k">if</span> <span class="n">has_problem</span> <span class="ow">and</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">nlp_flux</span><span class="p">,</span> <span class="n">real_flux</span><span class="p">,</span> <span class="n">solution</span><span class="p">[</span><span class="n">reac_id</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">real_flux</span> <span class="o">!=</span> <span class="n">solution</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]:</span>
            <span class="n">unoptimized_reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">solution</span><span class="p">[</span><span class="n">reac_id</span><span class="p">],</span> <span class="n">real_flux</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">unoptimized_reactions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.have_all_unignored_km" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">have_all_unignored_km</span><span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="n">kinetic_ignored_metabolites</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if all non-ignored metabolites in a reaction have associated Michaelis-Menten constants (k_m).</p>
<p>This function checks whether all substrates and products of a reaction, excluding those specified in the kinetically ignored metabolites list,
have associated Km values. It also ensures that there is at least one substrate and one product with a k_m value.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>reaction</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Reaction (cobrak.dataclasses.Reaction)" href="#cobrak.dataclasses.Reaction">Reaction</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reaction to be checked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kinetic_ignored_metabolites</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of metabolite IDs to be ignored in the k_m check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if all non-ignored metabolites have Km values and there is at least one substrate and one product with Km values, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">have_all_unignored_km</span><span class="p">(</span>
    <span class="n">reaction</span><span class="p">:</span> <span class="n">Reaction</span><span class="p">,</span> <span class="n">kinetic_ignored_metabolites</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if all non-ignored metabolites in a reaction have associated Michaelis-Menten constants (k_m).</span>

<span class="sd">    This function checks whether all substrates and products of a reaction, excluding those specified in the kinetically ignored metabolites list,</span>
<span class="sd">    have associated Km values. It also ensures that there is at least one substrate and one product with a k_m value.</span>

<span class="sd">    Args:</span>
<span class="sd">        reaction (Reaction): The reaction to be checked.</span>
<span class="sd">        kinetic_ignored_metabolites (list[str]): A list of metabolite IDs to be ignored in the k_m check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if all non-ignored metabolites have Km values and there is at least one substrate and one product with Km values, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">eligible_mets</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">met_id</span>
        <span class="k">for</span> <span class="n">met_id</span><span class="p">,</span> <span class="n">stoichiometry</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">met_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kinetic_ignored_metabolites</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">eligible_met</span> <span class="ow">in</span> <span class="n">eligible_mets</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">eligible_met</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="n">substrates_with_km</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">met_id</span>
        <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">eligible_mets</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">met_id</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">products_with_km</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">met_id</span>
        <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">eligible_mets</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">met_id</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">substrates_with_km</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">products_with_km</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.is_any_error_term_active" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_any_error_term_active</span><span class="p">(</span><span class="n">correction_config</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Checks if any error term is active in the correction configuration.</p>
<p>This function determines whether any of the error terms specified in the
<code>CorrectionConfig</code> object are enabled.  It sums the boolean values of the
flags indicating whether each error term is active.  If the sum is greater
than zero, it means at least one error term is active.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>correction_config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="CorrectionConfig (cobrak.dataclasses.CorrectionConfig)" href="#cobrak.dataclasses.CorrectionConfig">CorrectionConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The CorrectionConfig object to check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if at least one error term is active, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span>
<span class="normal">2626</span>
<span class="normal">2627</span>
<span class="normal">2628</span>
<span class="normal">2629</span>
<span class="normal">2630</span>
<span class="normal">2631</span>
<span class="normal">2632</span>
<span class="normal">2633</span>
<span class="normal">2634</span>
<span class="normal">2635</span>
<span class="normal">2636</span>
<span class="normal">2637</span>
<span class="normal">2638</span>
<span class="normal">2639</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">is_any_error_term_active</span><span class="p">(</span><span class="n">correction_config</span><span class="p">:</span> <span class="n">CorrectionConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if any error term is active in the correction configuration.</span>

<span class="sd">    This function determines whether any of the error terms specified in the</span>
<span class="sd">    `CorrectionConfig` object are enabled.  It sums the boolean values of the</span>
<span class="sd">    flags indicating whether each error term is active.  If the sum is greater</span>
<span class="sd">    than zero, it means at least one error term is active.</span>

<span class="sd">    Args:</span>
<span class="sd">        correction_config: The CorrectionConfig object to check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if at least one error term is active, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span>
        <span class="nb">sum</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">correction_config</span><span class="o">.</span><span class="n">add_flux_error_term</span><span class="p">,</span>
                <span class="n">correction_config</span><span class="o">.</span><span class="n">add_met_logconc_error_term</span><span class="p">,</span>
                <span class="n">correction_config</span><span class="o">.</span><span class="n">add_enzyme_conc_error_term</span><span class="p">,</span>
                <span class="n">correction_config</span><span class="o">.</span><span class="n">add_kcat_times_e_error_term</span><span class="p">,</span>
                <span class="n">correction_config</span><span class="o">.</span><span class="n">add_dG0_error_term</span><span class="p">,</span>
                <span class="n">correction_config</span><span class="o">.</span><span class="n">add_km_error_term</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.is_objsense_maximization" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_objsense_maximization</span><span class="p">(</span><span class="n">objsense</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Checks if the objective sense is maximization.</p>
<p>Args:
objsense (int): The objective sense, where in this function's definition:
- &gt;0: Maximization
- 0: Minimization</p>
<p>Returns:
bool: True if the objective sense is maximization, False otherwise.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2642</span>
<span class="normal">2643</span>
<span class="normal">2644</span>
<span class="normal">2645</span>
<span class="normal">2646</span>
<span class="normal">2647</span>
<span class="normal">2648</span>
<span class="normal">2649</span>
<span class="normal">2650</span>
<span class="normal">2651</span>
<span class="normal">2652</span>
<span class="normal">2653</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">is_objsense_maximization</span><span class="p">(</span><span class="n">objsense</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the objective sense is maximization.</span>

<span class="sd">    Args:</span>
<span class="sd">    objsense (int): The objective sense, where in this function&#39;s definition:</span>
<span class="sd">    - &gt;0: Maximization</span>
<span class="sd">    - 0: Minimization</span>

<span class="sd">    Returns:</span>
<span class="sd">    bool: True if the objective sense is maximization, False otherwise.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">objsense</span> <span class="o">&gt;</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.last_n_elements_equal" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">last_n_elements_equal</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Check if the last n elements of a list are equal.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lst</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list to check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of elements from the end of the list to compare.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the last n elements are equal, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>last_n_elements_equal([1, 2, 3, 4, 4, 4], 3)
True
last_n_elements_equal([1, 2, 3, 4, 5, 6], 3)
False</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2656</span>
<span class="normal">2657</span>
<span class="normal">2658</span>
<span class="normal">2659</span>
<span class="normal">2660</span>
<span class="normal">2661</span>
<span class="normal">2662</span>
<span class="normal">2663</span>
<span class="normal">2664</span>
<span class="normal">2665</span>
<span class="normal">2666</span>
<span class="normal">2667</span>
<span class="normal">2668</span>
<span class="normal">2669</span>
<span class="normal">2670</span>
<span class="normal">2671</span>
<span class="normal">2672</span>
<span class="normal">2673</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">last_n_elements_equal</span><span class="p">(</span><span class="n">lst</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the last n elements of a list are equal.</span>

<span class="sd">    Args:</span>
<span class="sd">        lst (list[Any]): The list to check.</span>
<span class="sd">        n (int): The number of elements from the end of the list to compare.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the last n elements are equal, False otherwise.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; last_n_elements_equal([1, 2, 3, 4, 4, 4], 3)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; last_n_elements_equal([1, 2, 3, 4, 5, 6], 3)</span>
<span class="sd">        False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">n</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">lst</span><span class="p">[</span><span class="o">-</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">[</span><span class="o">-</span><span class="n">n</span><span class="p">:]))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.make_kms_better_by_factor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_kms_better_by_factor</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Adjusts the Michaelis constants (Km) for substrates and products of a specified reaction in the metabolic model.</p>
<ul>
<li>Substrate's Michaelis constants are divided by 'factor'.</li>
<li>Product's Michaelis constants are multiplied by 'factor'.</li>
<li>Only affects metabolites with existing enzyme reaction data.</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The metabolic model containing enzymatic constraints.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reac_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the reaction to adjust the Km values for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>factor</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The multiplication/division factor used to modify the Michaelis constants.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>None</code></td>            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>This function modifies the input Model object in place and does not return any value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2676</span>
<span class="normal">2677</span>
<span class="normal">2678</span>
<span class="normal">2679</span>
<span class="normal">2680</span>
<span class="normal">2681</span>
<span class="normal">2682</span>
<span class="normal">2683</span>
<span class="normal">2684</span>
<span class="normal">2685</span>
<span class="normal">2686</span>
<span class="normal">2687</span>
<span class="normal">2688</span>
<span class="normal">2689</span>
<span class="normal">2690</span>
<span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span>
<span class="normal">2699</span>
<span class="normal">2700</span>
<span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span>
<span class="normal">2706</span>
<span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_kms_better_by_factor</span><span class="p">(</span>
    <span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">,</span> <span class="n">reac_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">factor</span><span class="p">:</span> <span class="n">NonNegativeFloat</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adjusts the Michaelis constants (Km) for substrates and products of a specified reaction in the metabolic model.</span>

<span class="sd">    - Substrate&#39;s Michaelis constants are divided by &#39;factor&#39;.</span>
<span class="sd">    - Product&#39;s Michaelis constants are multiplied by &#39;factor&#39;.</span>
<span class="sd">    - Only affects metabolites with existing enzyme reaction data.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        cobrak_model (Model): The metabolic model containing enzymatic constraints.</span>
<span class="sd">        reac_id (str): The ID of the reaction to adjust the Km values for.</span>
<span class="sd">        factor (float): The multiplication/division factor used to modify the Michaelis constants.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: This function modifies the input Model object in place and does not return any value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reaction</span> <span class="o">=</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">reac_id</span><span class="p">]</span>

    <span class="n">substrate_ids</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">met_id</span>
        <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">substrate_id</span> <span class="ow">in</span> <span class="n">substrate_ids</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">substrate_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span><span class="n">substrate_id</span><span class="p">]</span> <span class="o">/=</span> <span class="n">factor</span>

    <span class="n">product_ids</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">met_id</span>
        <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">stoichiometries</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">product_id</span> <span class="ow">in</span> <span class="n">product_ids</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">product_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span><span class="o">.</span><span class="n">k_ms</span><span class="p">[</span><span class="n">product_id</span><span class="p">]</span> <span class="o">*=</span> <span class="n">factor</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.parse_external_resources" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_external_resources</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">brenda_version</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Parse and verify the presence of external resource files required for a COBRAk model.</p>
<p>This function checks if the necessary external resource files are present in the specified directory.
If any required files are missing, it provides instructions on where to download them. Additionally,
it processes certain files if their parsed versions are not found.</p>
<p>The particular files that are lloked after are the NCBI TAXONOMY taxdump file and
the BRENDA JSON TAR GZ as wel as the bigg_models_metabolites.txt file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The directory path where the external resource files are located.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>brenda_version</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The version of the BRENDA database to be used.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the specified path is not a directory.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any required files are missing from the specified directory.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span>
<span class="normal">2723</span>
<span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span>
<span class="normal">2740</span>
<span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span>
<span class="normal">2745</span>
<span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span>
<span class="normal">2758</span>
<span class="normal">2759</span>
<span class="normal">2760</span>
<span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">parse_external_resources</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">brenda_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse and verify the presence of external resource files required for a COBRAk model.</span>

<span class="sd">    This function checks if the necessary external resource files are present in the specified directory.</span>
<span class="sd">    If any required files are missing, it provides instructions on where to download them. Additionally,</span>
<span class="sd">    it processes certain files if their parsed versions are not found.</span>

<span class="sd">    The particular files that are lloked after are the NCBI TAXONOMY taxdump file and</span>
<span class="sd">    the BRENDA JSON TAR GZ as wel as the bigg_models_metabolites.txt file.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): The directory path where the external resource files are located.</span>
<span class="sd">        brenda_version (str): The version of the BRENDA database to be used.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the specified path is not a directory.</span>
<span class="sd">        FileNotFoundError: If any required files are missing from the specified directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">standardize_folder</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;ERROR: Given external resources path </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2"> does not seem to be a folder!&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">needed_filename_data</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;taxdmp.zip&quot;</span><span class="p">,</span> <span class="s2">&quot;https://ftp.ncbi.nih.gov/pub/taxonomy/&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;bigg_models_metabolites.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;http://bigg.ucsd.edu/data_access&quot;</span><span class="p">),</span>
        <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;brenda_</span><span class="si">{</span><span class="n">brenda_version</span><span class="si">}</span><span class="s2">.json.tar.gz&quot;</span><span class="p">,</span>
            <span class="s2">&quot;https://www.brenda-enzymes.org/download.php&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">needed_filename</span><span class="p">,</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">needed_filename_data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">needed_filename</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;ERROR: File bigg_models_metabolites.txt not found in given external resources path </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">!&quot;</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Solution: Either change the path if it is wrong, or download the file from:&quot;</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;(Accessed on Jun 24 2024, open link at your own risk!)&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span>
    <span class="k">if</span> <span class="s2">&quot;parsed_taxdmp.json.zip&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
        <span class="n">parse_ncbi_taxonomy</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">taxdmp.zip&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">parsed_taxdmp.json&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;bigg_models_metabolites.json&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
        <span class="n">bigg_parse_metabolites_file</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">bigg_models_metabolites.txt&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">bigg_models_metabolites.json&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.print_model_parameter_statistics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_model_parameter_statistics</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Prints statistics about reaction parameters (kcats and kms) in a COBRA-k model.</p>
<p>This function calculates and prints statistics about the kcat and Km values
associated with reactions in a COBRA-k model. It groups these values by their
taxonomic distance (as indicated by references) and prints the counts for each
distance group.  It also prints the median kcat and the median Km values for
substrates and products separately.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cobrak_model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Model (cobrak.dataclasses.Model)" href="#cobrak.dataclasses.Model">Model</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The COBRA Model object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None.  Prints statistics to the console.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span>
<span class="normal">2791</span>
<span class="normal">2792</span>
<span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span>
<span class="normal">2800</span>
<span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span>
<span class="normal">2809</span>
<span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span>
<span class="normal">2827</span>
<span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span>
<span class="normal">2831</span>
<span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">print_model_parameter_statistics</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">:</span> <span class="n">Model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints statistics about reaction parameters (kcats and kms) in a COBRA-k model.</span>

<span class="sd">    This function calculates and prints statistics about the kcat and Km values</span>
<span class="sd">    associated with reactions in a COBRA-k model. It groups these values by their</span>
<span class="sd">    taxonomic distance (as indicated by references) and prints the counts for each</span>
<span class="sd">    distance group.  It also prints the median kcat and the median Km values for</span>
<span class="sd">    substrates and products separately.</span>

<span class="sd">    Args:</span>
<span class="sd">        cobrak_model: The COBRA Model object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None.  Prints statistics to the console.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">substrate_kms</span><span class="p">,</span> <span class="n">product_kms</span> <span class="o">=</span> <span class="n">get_model_kms_by_usage</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>
    <span class="n">all_kms</span> <span class="o">=</span> <span class="n">substrate_kms</span> <span class="o">+</span> <span class="n">product_kms</span>
    <span class="n">all_kcats</span> <span class="o">=</span> <span class="n">get_model_kcats</span><span class="p">(</span><span class="n">cobrak_model</span><span class="p">)</span>

    <span class="n">kcats_by_taxonomy_score</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">kms_by_taxonomy_score</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">enzdata</span> <span class="o">=</span> <span class="n">reaction</span><span class="o">.</span><span class="n">enzyme_reaction_data</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">enzdata</span><span class="o">.</span><span class="n">k_cat_references</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tax_distance</span> <span class="o">=</span> <span class="n">enzdata</span><span class="o">.</span><span class="n">k_cat_references</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tax_distance</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
        <span class="k">if</span> <span class="n">tax_distance</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kcats_by_taxonomy_score</span><span class="p">:</span>
            <span class="n">kcats_by_taxonomy_score</span><span class="p">[</span><span class="n">tax_distance</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">kcats_by_taxonomy_score</span><span class="p">[</span><span class="n">tax_distance</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">met_id</span> <span class="ow">in</span> <span class="n">enzdata</span><span class="o">.</span><span class="n">k_ms</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">met_id</span> <span class="ow">in</span> <span class="n">enzdata</span><span class="o">.</span><span class="n">k_m_references</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span>
                <span class="n">enzdata</span><span class="o">.</span><span class="n">k_m_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">]</span>
            <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tax_distance</span> <span class="o">=</span> <span class="n">enzdata</span><span class="o">.</span><span class="n">k_m_references</span><span class="p">[</span><span class="n">met_id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tax_distance</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tax_distance</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
            <span class="k">if</span> <span class="n">tax_distance</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kms_by_taxonomy_score</span><span class="p">:</span>
                <span class="n">kms_by_taxonomy_score</span><span class="p">[</span><span class="n">tax_distance</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">kms_by_taxonomy_score</span><span class="p">[</span><span class="n">tax_distance</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;kcats:&quot;</span><span class="p">,</span>
        <span class="n">sort_dict_keys</span><span class="p">(</span><span class="n">kcats_by_taxonomy_score</span><span class="p">),</span>
        <span class="nb">sum</span><span class="p">(</span><span class="n">kcats_by_taxonomy_score</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">all_kcats</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; -&gt;median:&quot;</span><span class="p">,</span> <span class="n">median</span><span class="p">(</span><span class="n">all_kcats</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;kms:&quot;</span><span class="p">,</span>
        <span class="n">sort_dict_keys</span><span class="p">(</span><span class="n">kms_by_taxonomy_score</span><span class="p">),</span>
        <span class="nb">sum</span><span class="p">(</span><span class="n">kms_by_taxonomy_score</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">all_kms</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot; -&gt;median substrates:&quot;</span><span class="p">,</span>
        <span class="n">median</span><span class="p">(</span><span class="n">substrate_kms</span><span class="p">),</span>
        <span class="s2">&quot;-&gt;median products:&quot;</span><span class="p">,</span>
        <span class="n">median</span><span class="p">(</span><span class="n">product_kms</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cobrak_model</span><span class="o">.</span><span class="n">reactions</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.sort_dict_keys" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sort_dict_keys</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Sorts all keys in a dictionary alphabetically.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dictionary</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary to sort.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="cobrak.utilities.T">T</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new dictionary with the keys sorted alphabetically.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sort_dict_keys</span><span class="p">(</span><span class="n">dictionary</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sorts all keys in a dictionary alphabetically.</span>

<span class="sd">    Args:</span>
<span class="sd">        dictionary (dict): The dictionary to sort.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A new dictionary with the keys sorted alphabetically.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">dictionary</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cobrak.utilities.split_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">split_list</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Split a list into <code>n</code> nearly equal parts.</p>
<p>This function divides a given list into <code>n</code> sublists, distributing the elements as evenly as possible.</p>
<p>Parameters:
- lst (list[Any]): The list to be split.
- n (int): The number of sublists to create.</p>
<p>Returns:
- list[list[Any]]: A list of <code>n</code> sublists, each containing a portion of the original list's elements.</p>
<p>Example:
<div class="highlight"><pre><span></span><code>result = _split_list([1, 2, 3, 4, 5], 3)
# result: [[1, 2], [3, 4], [5]]
</code></pre></div></p>
<p>Raises:
- ValueError: If <code>n</code> is less than or equal to 0.</p>


            <details class="quote">
              <summary>Source code in <code>cobrak/utilities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2852</span>
<span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span>
<span class="normal">2861</span>
<span class="normal">2862</span>
<span class="normal">2863</span>
<span class="normal">2864</span>
<span class="normal">2865</span>
<span class="normal">2866</span>
<span class="normal">2867</span>
<span class="normal">2868</span>
<span class="normal">2869</span>
<span class="normal">2870</span>
<span class="normal">2871</span>
<span class="normal">2872</span>
<span class="normal">2873</span>
<span class="normal">2874</span>
<span class="normal">2875</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">validate_return</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">split_list</span><span class="p">(</span><span class="n">lst</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">n</span><span class="p">:</span> <span class="n">PositiveInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Split a list into `n` nearly equal parts.</span>

<span class="sd">    This function divides a given list into `n` sublists, distributing the elements as evenly as possible.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - lst (list[Any]): The list to be split.</span>
<span class="sd">    - n (int): The number of sublists to create.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - list[list[Any]]: A list of `n` sublists, each containing a portion of the original list&#39;s elements.</span>

<span class="sd">    Example:</span>
<span class="sd">    ```</span>
<span class="sd">    result = _split_list([1, 2, 3, 4, 5], 3)</span>
<span class="sd">    # result: [[1, 2], [3, 4], [5]]</span>
<span class="sd">    ```</span>

<span class="sd">    Raises:</span>
<span class="sd">    - ValueError: If `n` is less than or equal to 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">),</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">lst</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">k</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">k</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": ["content.code.copy"], "search": "assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="javascript/katex/katex.min.js"></script>
      
        <script src="javascript/katex/contrib/auto-render.min.js"></script>
      
        <script src="javascript/init_katex.js"></script>
      
        <script src="assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>
      
    
  </body>
</html>